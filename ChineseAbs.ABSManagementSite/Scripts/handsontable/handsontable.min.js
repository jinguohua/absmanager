(function(Kb){"object"===typeof exports&&"undefined"!==typeof module?module.exports=Kb():"function"===typeof define&&define.amd?define([],Kb):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Handsontable=Kb()})(function(){return function p(q,r,k){function d(e,g){if(!r[e]){if(!q[e]){var m="function"==typeof require&&require;if(!g&&m)return m(e,!0);if(h)return h(e,!0);if(l[e]&&"undefined"!==typeof window[l[e]])return window[l[e]];m=Error("Cannot find module '"+e+"'");m.code="MODULE_NOT_FOUND";throw m;}m=r[e]={exports:{}};q[e][0].call(m.exports,function(a){var b=q[e][1][a];return d(b?b:a)},m,m.exports,p,q,r,k)}return r[e].exports}for(var h="function"==typeof require&&require,l=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","numbro":"numbro","pikaday":"Pikaday","hot-formula-parser":"formulaParser"}')||{},g=0;g<k.length;g++)d(k[g]);return d}({1:[function(p,q,r){},{}],2:[function(p,q,r){window.jQuery&&function(k){k.fn.handsontable=function(d){var h,l,g,e,n=this.first(),m=n.data("handsontable");if("string"!==typeof d)return h=d||{},m?m.updateSettings(h):(m=new Handsontable.Core(n[0],h),n.data("handsontable",m),m.init()),n;g=[];if(1<arguments.length)for(h=1,l=arguments.length;h<l;h++)g.push(arguments[h]);if(m)if("undefined"!==typeof m[d])e=m[d].apply(m,g),"destroy"===d&&n.removeData();else throw Error("Handsontable do not provide action: "+d);return e}}(window.jQuery)},{}],3:[function(p,q,r){Object.defineProperties(r,{WalkontableBorder:{get:function(){return z}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var e=q.getComputedStyle,n=q.getTrimmingContainer,m=q.innerWidth,a=q.innerHeight,b=q.offset,f=q.outerHeight,t=q.outerWidth,u=(d=p("helpers/dom/event"),d&&d.__esModule&&d||{"default":d}).stopImmediatePropagation,v=(h=p("helpers/browser"),h&&h.__esModule&&h||{"default":h}).isMobileBrowser,y=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager,w=(g=p("cell/coords"),g&&g.__esModule&&g||{"default":g}).WalkontableCellCoords;p("overlay/_base.js");var z=function(a,b){b&&(this.eventManager=new y(a),this.wot=this.instance=a,this.settings=b,this.mouseDown=!1,this.rightStyle=this.bottomStyle=this.leftStyle=this.topStyle=this.right=this.bottom=this.left=this.top=this.main=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.cornerStyle=this.corner=null,this.createBorders(b),this.registerListeners())};$traceurRuntime.createClass(z,{registerListeners:function(){var a=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return a.onMouseDown()});this.eventManager.addEventListener(document.body,"mouseup",function(){return a.onMouseUp()});for(var b=this,f=function(f,e){b.eventManager.addEventListener(b.main.childNodes[f],"mouseenter",function(b){return a.onMouseEnter(b,a.main.childNodes[f])})},e=0,m=this.main.childNodes.length;e<m;e++)f(e,m)},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDown=!1},onMouseEnter:function(a,b){function f(a){a=a.clientY<Math.floor(m.top)||a.clientY>Math.ceil(m.top+m.height)||a.clientX<Math.floor(m.left)||a.clientX>Math.ceil(m.left+m.width)?!0:void 0;a&&(e.eventManager.removeEventListener(document.body,"mousemove",f),b.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){a.preventDefault();u(a);var e=this,m=b.getBoundingClientRect();b.style.display="none";this.eventManager.addEventListener(document.body,"mousemove",f)}},createBorders:function(a){this.main=document.createElement("div");var b=["top","left","bottom","right","corner"],f=this.main.style;f.position="absolute";f.top=0;for(var e=f.left=0;5>e;e++){var m=b[e],d=document.createElement("div");d.className="wtBorder "+(this.settings.className||"");this.settings[m]&&this.settings[m].hide&&(d.className+=" hidden");f=d.style;f.backgroundColor=this.settings[m]&&this.settings[m].color?this.settings[m].color:a.border.color;f.height=this.settings[m]&&this.settings[m].width?this.settings[m].width+"px":a.border.width+"px";f.width=this.settings[m]&&this.settings[m].width?this.settings[m].width+"px":a.border.width+"px";this.main.appendChild(d)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");v()&&this.createMultipleSelectorHandles();this.disappear();this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder));this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var a={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"},b;for(b in a)a.hasOwnProperty(b)&&(this.selectionHandles.styles.bottomRightHitArea[b]=a[b],this.selectionHandles.styles.topLeftHitArea[b]=a[b]);var a={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"},f;for(f in a)a.hasOwnProperty(f)&&(this.selectionHandles.styles.bottomRight[f]=a[f],this.selectionHandles.styles.topLeft[f]=a[f]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function(a,b){return!this.wot.selections.area.cellRange||a==this.wot.selections.area.cellRange.to.row&&b==this.wot.selections.area.cellRange.to.col?!1:!0},updateMultipleSelectionHandlesPosition:function(a,b,f,e,m,d){var g=parseInt(this.selectionHandles.styles.topLeft.width,10),n=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(f-g,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(e-g,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(f-n/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(e-n/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(f+d,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(e+m,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(f+d-n/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(e+m-n/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(a,b)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");a==this.wot.wtSettings.getSetting("fixedRowsTop")||b==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},appear:function(d){if(!this.disabled){var g,l,h,u,y,x,k,z,p,q,I;g=this.wot.wtTable.getRenderedRowsCount();for(h=0;h<g;h++)if(l=this.wot.wtTable.rowFilter.renderedToSource(h),l>=d[0]&&l<=d[2]){z=l;break}for(--g;0<=g;g--)if(h=this.wot.wtTable.rowFilter.renderedToSource(g),h>=d[0]&&h<=d[2]){q=h;break}g=this.wot.wtTable.getRenderedColumnsCount();for(h=0;h<g;h++)if(l=this.wot.wtTable.columnFilter.renderedToSource(h),l>=d[1]&&l<=d[3]){p=l;break}for(--g;0<=g;g--)if(h=this.wot.wtTable.columnFilter.renderedToSource(g),h>=d[1]&&h<=d[3]){I=h;break}void 0===z||void 0===p?this.disappear():(g=z!==q||p!==I,l=this.wot.wtTable.getCell(new w(z,p)),d=g?this.wot.wtTable.getCell(new w(q,I)):l,h=b(l),u=g?b(d):h,y=b(this.wot.wtTable.TABLE),x=h.top,g=u.top+f(d)-x,k=h.left,h=u.left+t(d)-k,x=x-y.top-1,y=k-y.left-1,l=e(l),0<parseInt(l.borderTopWidth,10)&&(x+=1,g=0<g?g-1:0),0<parseInt(l.borderLeftWidth,10)&&(y+=1,h=0<h?h-1:0),this.topStyle.top=x+"px",this.topStyle.left=y+"px",this.topStyle.width=h+"px",this.topStyle.display="block",this.leftStyle.top=x+"px",this.leftStyle.left=y+"px",this.leftStyle.height=g+"px",this.leftStyle.display="block",l=Math.floor(this.settings.border.width/2),this.bottomStyle.top=x+g-l+"px",this.bottomStyle.left=y+"px",this.bottomStyle.width=h+"px",this.bottomStyle.display="block",this.rightStyle.top=x+"px",this.rightStyle.left=y+h-l+"px",this.rightStyle.height=g+1+"px",this.rightStyle.display="block",v()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(q,I)?this.cornerStyle.display="none":(this.cornerStyle.top=x+g-4+"px",this.cornerStyle.left=y+h-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",l=n(this.wot.wtTable.TABLE),I===this.wot.getSetting("totalColumns")-1&&(I=d.offsetLeft+t(d)+parseInt(this.cornerDefaultStyle.width)/2>=m(l))&&(this.cornerStyle.left=Math.floor(y+h-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0),q===this.wot.getSetting("totalRows")-1&&(I=d.offsetTop+f(d)+parseInt(this.cornerDefaultStyle.height)/2>=a(l))&&(this.cornerStyle.top=Math.floor(x+g-3-parseInt(this.cornerDefaultStyle.height)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"),v()&&this.updateMultipleSelectionHandlesPosition(z,p,x,y,h,g))}},disappear:function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";v()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},hasSetting:function(a){return"function"===typeof a?a():!!a}},{});window.WalkontableBorder=z},{"cell/coords":6,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/dom/event":48,"overlay/_base.js":12}],4:[function(p,q,r){Object.defineProperties(r,{WalkontableViewportColumnsCalculator:{get:function(){return d}},__esModule:{value:!0}});var k=new WeakMap,d=function(d,g,e,n,m,a,b,f){k.set(this,{viewportWidth:d,scrollOffset:g,totalColumns:e,columnWidthFn:n,overrideFn:m,onlyFullyVisible:a,stretchingColumnWidthFn:void 0!==f?f:function(a){return a}});this.count=0;this.startPosition=this.endColumn=this.startColumn=null;this.stretchLastWidth=this.stretchAllRatio=0;this.stretch=b;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()},h=d;$traceurRuntime.createClass(d,{calculate:function(){for(var d=0,g=!0,e=[],n,m=k.get(this),a=m.onlyFullyVisible,b=m.overrideFn,f=m.scrollOffset,t=m.totalColumns,m=m.viewportWidth,h=0;h<t;h++){n=this._getColumnWidth(h);d<=f&&!a&&(this.startColumn=h);var v=0<f?m+1:m;d>=f&&d+n<=f+v&&(null==this.startColumn&&(this.startColumn=h),this.endColumn=h);e.push(d);d+=n;a||(this.endColumn=h);if(d>=f+m){g=!1;break}}if(this.endColumn===t-1&&g)for(this.startColumn=this.endColumn;0<this.startColumn&&!(d=e[this.endColumn]+n-e[this.startColumn-1],(d<=m||!a)&&this.startColumn--,d>m););null!==this.startColumn&&b&&b(this);this.startPosition=e[this.startColumn];void 0==this.startPosition&&(this.startPosition=null);null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(d){if("none"!==this.stretch){this.totalTargetWidth=d;for(var g=k.get(this),e=g.totalColumns,n=0,m=0;m<e;m++){var a=this._getColumnWidth(m),b=g.stretchingColumnWidthFn(void 0,m);"number"===typeof b?d-=b:n+=a}g=d-n;"all"===this.stretch&&0<g?(this.stretchAllRatio=d/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&Infinity!==d&&(d=this._getColumnWidth(e-1),e=g+d,this.stretchLastWidth=0<=e?e:d)}},getStretchedColumnWidth:function(d,g){var e=null;"all"===this.stretch&&0!==this.stretchAllRatio?e=this._getStretchedAllColumnWidth(d,g):"last"===this.stretch&&0!==this.stretchLastWidth&&(e=this._getStretchedLastColumnWidth(d));return e},_getStretchedAllColumnWidth:function(d,g){var e=0,n=k.get(this),m=n.totalColumns;if(!this.stretchAllColumnsWidth[d]){var a=Math.round(g*this.stretchAllRatio),n=n.stretchingColumnWidthFn(a,d);this.stretchAllColumnsWidth[d]=void 0===n?a:isNaN(n)?this._getColumnWidth(d):n}if(this.stretchAllColumnsWidth.length===m&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(m=0;m<this.stretchAllColumnsWidth.length;m++)e+=this.stretchAllColumnsWidth[m];e!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-e)}return this.stretchAllColumnsWidth[d]},_getStretchedLastColumnWidth:function(d){var g=k.get(this).totalColumns;return d===g-1?this.stretchLastWidth:null},_getColumnWidth:function(d){d=k.get(this).columnWidthFn(d);void 0===d&&(d=h.DEFAULT_WIDTH);return d}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=d},{}],5:[function(p,q,r){Object.defineProperties(r,{WalkontableViewportRowsCalculator:{get:function(){return d}},__esModule:{value:!0}});var k=new WeakMap,d=function(d,g,e,n,m,a,b){k.set(this,{viewportHeight:d,scrollOffset:g,totalRows:e,rowHeightFn:n,overrideFn:m,onlyFullyVisible:a,horizontalScrollbarHeight:b});this.count=0;this.startPosition=this.endRow=this.startRow=null;this.calculate()},h=d;$traceurRuntime.createClass(d,{calculate:function(){for(var d=0,g=!0,e=[],n=k.get(this),m=n.onlyFullyVisible,a=n.overrideFn,b=n.rowHeightFn,f=n.scrollOffset,t=n.totalRows,u=n.viewportHeight,n=n.horizontalScrollbarHeight||0,v=0;v<t;v++){var y=b(v);void 0===y&&(y=h.DEFAULT_HEIGHT);d<=f&&!m&&(this.startRow=v);d>=f&&d+y<=f+u-n&&(null===this.startRow&&(this.startRow=v),this.endRow=v);e.push(d);d+=y;m||(this.endRow=v);if(d>=f+u-n){g=!1;break}}if(this.endRow===t-1&&g)for(this.startRow=this.endRow;0<this.startRow&&!(d=e[this.endRow]+y-e[this.startRow-1],(d<=u-n||!m)&&this.startRow--,d>=u-n););null!==this.startRow&&a&&a(this);this.startPosition=e[this.startRow];void 0==this.startPosition&&(this.startPosition=null);null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}});window.WalkontableViewportRowsCalculator=d},{}],6:[function(p,q,r){Object.defineProperties(r,{WalkontableCellCoords:{get:function(){return k}},__esModule:{value:!0}});var k=function(d,h){"undefined"!==typeof d&&"undefined"!==typeof h?(this.row=d,this.col=h):this.col=this.row=null};$traceurRuntime.createClass(k,{isValid:function(d){return 0>this.row||0>this.col||this.row>=d.getSetting("totalRows")||this.col>=d.getSetting("totalColumns")?!1:!0},isEqual:function(d){return d===this?!0:this.row===d.row&&this.col===d.col},isSouthEastOf:function(d){return this.row>=d.row&&this.col>=d.col},isNorthWestOf:function(d){return this.row<=d.row&&this.col<=d.col},isSouthWestOf:function(d){return this.row>=d.row&&this.col<=d.col},isNorthEastOf:function(d){return this.row<=d.row&&this.col>=d.col}},{});window.WalkontableCellCoords=k},{}],7:[function(p,q,r){Object.defineProperties(r,{WalkontableCellRange:{get:function(){return h}},__esModule:{value:!0}});var k,d=(k=p("cell/coords"),k&&k.__esModule&&k||{"default":k}).WalkontableCellCoords,h=function(d,e,n){this.highlight=d;this.from=e;this.to=n},l=h;$traceurRuntime.createClass(h,{isValid:function(d){return this.from.isValid(d)&&this.to.isValid(d)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(d){var e=d.row;d=d.col;var g=this.getTopLeftCorner(),m=this.getBottomRightCorner();return g.row<=e&&m.row>=e&&g.col<=d&&m.col>=d},includesRange:function(d){return this.includes(d.getTopLeftCorner())&&this.includes(d.getBottomRightCorner())},isEqual:function(d){return Math.min(this.from.row,this.to.row)==Math.min(d.from.row,d.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(d.from.row,d.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(d.from.col,d.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(d.from.col,d.to.col)},overlaps:function(d){return d.isSouthEastOf(this.getTopLeftCorner())&&d.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(d){return this.getTopLeftCorner().isSouthEastOf(d)||this.getBottomRightCorner().isSouthEastOf(d)},isNorthWestOf:function(d){return this.getTopLeftCorner().isNorthWestOf(d)||this.getBottomRightCorner().isNorthWestOf(d)},expand:function(g){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return g.row<e.row||g.col<e.col||g.row>n.row||g.col>n.col?(this.from=new d(Math.min(e.row,g.row),Math.min(e.col,g.col)),this.to=new d(Math.max(n.row,g.row),Math.max(n.col,g.col)),!0):!1},expandByRange:function(g){if(this.includesRange(g)||!this.overlaps(g))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();this.getTopRightCorner();this.getBottomLeftCorner();var m=g.getTopLeftCorner(),a=g.getBottomRightCorner(),b=Math.min(e.row,m.row),e=Math.min(e.col,m.col),m=Math.max(n.row,a.row),n=Math.max(n.col,a.col),a=new d(b,e),f=new d(m,n),t=(new l(a,a,f)).isCorner(this.from,g);g=g.isEqual(new l(a,a,f));t&&!g&&(this.from.col>a.col&&(a.col=n,f.col=e),this.from.row>a.row&&(a.row=m,f.row=b));this.from=a;this.to=f;return!0},getDirection:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"},setDirection:function(d){switch(d){case "NW-SE":d=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=d[0];this.to=d[1];d;break;case "NE-SW":d=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=d[0];this.to=d[1];d;break;case "SE-NW":d=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=d[0];this.to=d[1];d;break;case "SW-NE":d=[this.getBottomLeftCorner(),this.getTopRightCorner()],this.from=d[0],this.to=d[1],d}},getTopLeftCorner:function(){return new d(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new d(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new d(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new d(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(g,e){return e&&e.includes(g)&&(this.getTopLeftCorner().isEqual(new d(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new d(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new d(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new d(e.to.row,e.to.col)))?!0:g.isEqual(this.getTopLeftCorner())||g.isEqual(this.getTopRightCorner())||g.isEqual(this.getBottomLeftCorner())||g.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(g,e){if(!(g instanceof d))return!1;if(e&&e.includes(g)){if(this.getTopLeftCorner().isEqual(new d(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new d(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new d(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new d(e.to.row,e.to.col)))return this.getTopLeftCorner()}if(g.isEqual(this.getBottomRightCorner()))return this.getTopLeftCorner();if(g.isEqual(this.getTopLeftCorner()))return this.getBottomRightCorner();if(g.isEqual(this.getTopRightCorner()))return this.getBottomLeftCorner();if(g.isEqual(this.getBottomLeftCorner()))return this.getTopRightCorner()},getBordersSharedWith:function(d){if(!this.includesRange(d))return[];var e=Math.max(this.from.row,this.to.row),g=Math.min(this.from.col,this.to.col),m=Math.max(this.from.col,this.to.col),a=Math.max(d.from.row,d.to.row),b=Math.min(d.from.col,d.to.col),f=Math.max(d.from.col,d.to.col),t=[];Math.min(this.from.row,this.to.row)==Math.min(d.from.row,d.to.row)&&t.push("top");m==f&&t.push("right");e==a&&t.push("bottom");g==b&&t.push("left");return t},getInner:function(){for(var g=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],m=g.row;m<=e.row;m++)for(var a=g.col;a<=e.col;a++)this.from.row===m&&this.from.col===a||this.to.row===m&&this.to.col===a||n.push(new d(m,a));return n},getAll:function(){for(var g=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],m=g.row;m<=e.row;m++)for(var a=g.col;a<=e.col;a++)g.row===m&&g.col===a?n.push(g):e.row===m&&e.col===a?n.push(e):n.push(new d(m,a));return n},forAll:function(d){for(var e=this.getTopLeftCorner(),g=this.getBottomRightCorner(),m=e.row;m<=g.row;m++)for(var a=e.col;a<=g.col;a++)if(!1===d(m,a))return}},{});window.WalkontableCellRange=h},{"cell/coords":6}],8:[function(p,q,r){Object.defineProperties(r,{Walkontable:{get:function(){return G}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var b=q.addClass,f=q.fastInnerText,t=q.isVisible,u=q.removeClass,v=(d=p("helpers/object"),d&&d.__esModule&&d||{"default":d}).objectEach;k=(h=p("helpers/string"),h&&h.__esModule&&h||{"default":h});var y=k.toUpperCaseFirst,w=k.randomString,z=(l=p("event"),l&&l.__esModule&&l||{"default":l}).WalkontableEvent,x=(g=p("overlays"),g&&g.__esModule&&g||{"default":g}).WalkontableOverlays,C=(e=p("scroll"),e&&e.__esModule&&e||{"default":e}).WalkontableScroll,E=(n=p("settings"),n&&n.__esModule&&n||{"default":n}).WalkontableSettings,A=(m=p("table"),m&&m.__esModule&&m||{"default":m}).WalkontableTable,B=(a=p("viewport"),a&&a.__esModule&&a||{"default":a}).WalkontableViewport;p("overlay/_base.js");p("overlay/top.js");p("overlay/left.js");p("overlay/debug.js");p("overlay/topLeftCorner.js");var G=function(a){var b=[];this.guid="wt_"+w();a.cloneSource?(this.cloneSource=a.cloneSource,this.cloneOverlay=a.cloneOverlay,this.wtSettings=a.cloneSource.wtSettings,this.wtTable=new A(this,a.table,a.wtRootElement),this.wtScroll=new C(this),this.wtViewport=a.cloneSource.wtViewport,this.wtEvent=new z(this),this.selections=this.cloneSource.selections):(this.wtSettings=new E(this,a),this.wtTable=new A(this,a.table),this.wtScroll=new C(this),this.wtViewport=new B(this),this.wtEvent=new z(this),this.selections=this.getSetting("selections"),this.wtOverlays=new x(this),this.exportSettingsAsClassNames());if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){a=0;for(var e=this.wtTable.THEAD.childNodes[0].childNodes.length;a<e;a++)b.push(this.wtTable.THEAD.childNodes[0].childNodes[a].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(a,e){f(e,b[a])}])}this.drawInterrupted=this.drawn=!1};$traceurRuntime.createClass(G,{draw:function(a){a=void 0!==a?a:!1;this.drawInterrupted=!1;a||t(this.wtTable.TABLE)?this.wtTable.draw(a):this.drawInterrupted=!0;return this},getCell:function(a,b){if(void 0===b||!b)return this.wtTable.getCell(a);var f=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsTop"),d=this.wtSettings.getSetting("fixedRowsBottom"),m=this.wtSettings.getSetting("fixedColumnsLeft");if(a.row<e&&a.col<m)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(a);if(a.row<e)return this.wtOverlays.topOverlay.clone.wtTable.getCell(a);if(a.col<m&&a.row>=f-d){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(a)}else{if(a.col<m)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(a);if(a.row<f&&a.row>f-d&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(a)}return this.wtTable.getCell(a)},update:function(a,b){return this.wtSettings.update(a,b)},scrollVertical:function(a){this.wtOverlays.topOverlay.scrollTo(a);this.getSetting("onScrollVertically");return this},scrollHorizontal:function(a){this.wtOverlays.leftOverlay.scrollTo(a);this.getSetting("onScrollHorizontally");return this},scrollViewport:function(a){this.wtScroll.scrollViewport(a);return this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},isOverlayName:function(a){return this.cloneOverlay?this.cloneOverlay.type===a:!1},exportSettingsAsClassNames:function(){var a=this,f=[],e=[];v({rowHeaders:["array"],columnHeaders:["array"]},function(b,d){-1<b.indexOf("array")&&a.getSetting(d).length&&e.push("ht"+y(d));f.push("ht"+y(d))});u(this.wtTable.wtRootElement.parentNode,f);b(this.wtTable.wtRootElement.parentNode,e)},getSetting:function(a,b,f,e,d){return this.wtSettings.getSetting(a,b,f,e,d)},hasSetting:function(a){return this.wtSettings.has(a)},destroy:function(){this.wtOverlays.destroy();this.wtEvent.destroy()}},{});window.Walkontable=G},{event:9,"helpers/dom/element":47,"helpers/object":53,"helpers/string":55,"overlay/_base.js":12,"overlay/debug.js":13,"overlay/left.js":14,"overlay/top.js":15,"overlay/topLeftCorner.js":16,overlays:17,scroll:18,settings:20,table:21,viewport:23}],9:[function(p,q,r){function k(d){var g=this,l=t(d);this.instance=d;var h=[null,null];this.dblClickTimeout=[null,null];var u=function(f){var e=document.activeElement,d=b(a,f.realTarget),m=f.realTarget;m!==e&&d(0)!==e&&d(1)!==e&&(e=g.parentCell(m),n(m,"corner")?g.instance.getSetting("onCellCornerMouseDown",f,m):e.TD&&g.instance.hasSetting("onCellMouseDown")&&g.instance.getSetting("onCellMouseDown",f,e.coords,e.TD,g.instance),2!==f.button&&e.TD&&(h[0]=e.TD,clearTimeout(g.dblClickTimeout[0]),g.dblClickTimeout[0]=setTimeout(function(){h[0]=null},1E3)))},x=function(a){g.instance.touchMoving=!0},k=function(a){l.addEventListener(this,"touchmove",x);g.checkIfTouchMove=setTimeout(function(){!0===g.instance.touchMoving?(g.instance.touchMoving=void 0,l.removeEventListener("touchmove",x,!1)):u(a)},30)},E=function(a){if(2!==a.button){var b=g.parentCell(a.realTarget);b.TD===h[0]&&b.TD===h[1]?(n(a.realTarget,"corner")?g.instance.getSetting("onCellCornerDblClick",a,b.coords,b.TD,g.instance):g.instance.getSetting("onCellDblClick",a,b.coords,b.TD,g.instance),h[0]=null,h[1]=null):b.TD===h[0]?(g.instance.getSetting("onCellMouseUp",a,b.coords,b.TD,g.instance),h[1]=b.TD,clearTimeout(g.dblClickTimeout[1]),g.dblClickTimeout[1]=setTimeout(function(){h[1]=null},500)):b.TD&&g.instance.hasSetting("onCellMouseUp")&&g.instance.getSetting("onCellMouseUp",a,b.coords,b.TD,g.instance)}},p=function(a){clearTimeout(void 0);a.preventDefault();E(a)};l.addEventListener(this.instance.wtTable.holder,"mousedown",u);l.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(a){var b,f,d;g.instance.hasSetting("onCellMouseOver")&&(b=g.instance.wtTable.TABLE,f=e(a.realTarget,["TD","TH"],b),d=g.instance.cloneSource||g.instance,f&&f!==d.lastMouseOver&&m(f,b)&&(d.lastMouseOver=f,g.instance.getSetting("onCellMouseOver",a,g.instance.wtTable.getCoords(f),f,g.instance)))});l.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(a){var b,f,d;g.instance.hasSetting("onCellMouseOut")&&(b=g.instance.wtTable.TABLE,f=e(a.realTarget,["TD","TH"],b),d=e(a.relatedTarget,["TD","TH"],b),f&&f!==d&&m(f,b)&&g.instance.getSetting("onCellMouseOut",a,g.instance.wtTable.getCoords(f),f,g.instance))});l.addEventListener(this.instance.wtTable.holder,"mouseup",E);if(this.instance.wtTable.holder.parentNode.parentNode&&f()&&!g.instance.wtTable.isWorkingOnClone()){var B="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");l.addEventListener(this.instance.wtTable.holder,"touchstart",function(a){g.instance.touchApplied=!0;m(a.target,B)&&k.call(a.target,a)});l.addEventListener(this.instance.wtTable.holder,"touchend",function(a){g.instance.touchApplied=!1;m(a.target,B)&&p.call(a.target,a)});g.instance.momentumScrolling||(g.instance.momentumScrolling={});l.addEventListener(this.instance.wtTable.holder,"scroll",function(a){clearTimeout(g.instance.momentumScrolling._timeout);g.instance.momentumScrolling.ongoing||g.instance.getSetting("onBeforeTouchScroll");g.instance.momentumScrolling.ongoing=!0;g.instance.momentumScrolling._timeout=setTimeout(function(){g.instance.touchApplied||(g.instance.momentumScrolling.ongoing=!1,g.instance.getSetting("onAfterMomentumScroll"))},200)})}l.addEventListener(window,"resize",function(){"none"!==g.instance.getSetting("stretchH")&&g.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);l.destroy()}}Object.defineProperties(r,{WalkontableEvent:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g;q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var e=q.closestDown,n=q.hasClass,m=q.isChildOf,a=q.getParent,b=(h=p("helpers/function"),h&&h.__esModule&&h||{"default":h}).partial,f=(l=p("helpers/browser"),l&&l.__esModule&&l||{"default":l}).isMobileBrowser,t=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).eventManager;k.prototype.parentCell=function(a){var b={},f=e(a,["TD","TH"],this.instance.wtTable.TABLE);f?(b.coords=this.instance.wtTable.getCoords(f),b.TD=f):n(a,"wtBorder")&&n(a,"current")?(b.coords=this.instance.selections.current.cellRange.highlight,b.TD=this.instance.wtTable.getCell(b.coords)):n(a,"wtBorder")&&n(a,"area")&&this.instance.selections.area.cellRange&&(b.coords=this.instance.selections.area.cellRange.to,b.TD=this.instance.wtTable.getCell(b.coords));return b};window.WalkontableEvent=k},{eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/function":50}],10:[function(p,q,r){Object.defineProperties(r,{WalkontableColumnFilter:{get:function(){return k}},__esModule:{value:!0}});var k=function(d,h,l){this.offset=d;this.total=h;this.countTH=l};$traceurRuntime.createClass(k,{offsetted:function(d){return d+this.offset},unOffsetted:function(d){return d-this.offset},renderedToSource:function(d){return this.offsetted(d)},sourceToRendered:function(d){return this.unOffsetted(d)},offsettedTH:function(d){return d-this.countTH},unOffsettedTH:function(d){return d+this.countTH},visibleRowHeadedColumnToSourceColumn:function(d){return this.renderedToSource(this.offsettedTH(d))},sourceColumnToVisibleRowHeadedColumn:function(d){return this.unOffsettedTH(this.sourceToRendered(d))}},{});window.WalkontableColumnFilter=k},{}],11:[function(p,q,r){Object.defineProperties(r,{WalkontableRowFilter:{get:function(){return k}},__esModule:{value:!0}});var k=function(d,h,l){this.offset=d;this.total=h;this.countTH=l};$traceurRuntime.createClass(k,{offsetted:function(d){return d+this.offset},unOffsetted:function(d){return d-this.offset},renderedToSource:function(d){return this.offsetted(d)},sourceToRendered:function(d){return this.unOffsetted(d)},offsettedTH:function(d){return d-this.countTH},unOffsettedTH:function(d){return d+this.countTH},visibleColHeadedRowToSourceRow:function(d){return this.renderedToSource(this.offsettedTH(d))},sourceRowToVisibleColHeadedRow:function(d){return this.unOffsettedTH(this.sourceToRendered(d))}},{});window.WalkontableRowFilter=k},{}],12:[function(p,q,r){Object.defineProperties(r,{WalkontableOverlay:{get:function(){return f}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var g=q.getScrollableElement,e=q.getTrimmingContainer,n=(d=p("helpers/object"),d&&d.__esModule&&d||{"default":d}).defineGetter,m=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,a=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager,b={},f=function(a){n(this,"wot",a,{writable:!1});this.instance=this.wot;this.type="";this.mainTableScrollableElement=null;this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=e(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=!1;this.updateStateOfRendering()},t=f;$traceurRuntime.createClass(f,{updateStateOfRendering:function(){var a=this.needFullRender;this.needFullRender=this.shouldBeRendered();(a=a!==this.needFullRender)&&!this.needFullRender&&this.reset();return a},shouldBeRendered:function(){return!0},updateTrimmingContainer:function(){this.trimmingContainer=e(this.hider.parentNode.parentNode)},updateMainScrollableElement:function(){this.mainTableScrollableElement=g(this.wot.wtTable.TABLE)},makeClone:function(a){if(-1===t.CLONE_TYPES.indexOf(a))throw Error('Clone type "'+a+'" is not supported.');var b=document.createElement("DIV"),f=document.createElement("TABLE");b.className="ht_clone_"+a+" handsontable";b.style.position="absolute";b.style.top=0;b.style.left=0;b.style.overflow="hidden";f.className=this.wot.wtTable.TABLE.className;b.appendChild(f);this.type=a;this.wot.wtTable.wtRootElement.parentNode.appendChild(b);a=this.wot.getSetting("preventOverflow");this.mainTableScrollableElement=!0===a||"horizontal"===a&&this.type===t.CLONE_TOP||"vertical"===a&&this.type===t.CLONE_LEFT?window:g(this.wot.wtTable.TABLE);return new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:f})},refresh:function(a){a=void 0!==a?a:!1;var b=this.shouldBeRendered();this.clone&&(this.needFullRender||b)&&this.clone.draw(a);this.needFullRender=b},reset:function(){if(this.clone){var a=this.clone.wtTable.holder;m([a.style,this.clone.wtTable.hider.style,a.parentNode.style],function(a){a.width="";a.height=""})}},destroy:function(){a(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[t.CLONE_TOP,t.CLONE_BOTTOM,t.CLONE_LEFT,t.CLONE_TOP_LEFT_CORNER,t.CLONE_BOTTOM_LEFT_CORNER,t.CLONE_DEBUG]},registerOverlay:function(a,f){if(-1===t.CLONE_TYPES.indexOf(a))throw Error("Unsupported overlay ("+a+").");b[a]=f},createOverlay:function(a,f){return new b[a](f)},isOverlayTypeOf:function(a,f){return a&&b[f]?a instanceof b[f]:!1}});window.WalkontableOverlay=f},{eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/object":53}],13:[function(p,q,r){Object.defineProperties(r,{WalkontableDebugOverlay:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,l=(d=p("_base"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,g=function(d){$traceurRuntime.superConstructor(e).call(this,d);this.clone=this.makeClone(l.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";h(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},e=g;$traceurRuntime.createClass(g,{},{},l);window.WalkontableDebugOverlay=g;l.registerOverlay(l.CLONE_DEBUG,g)},{_base:12,"helpers/dom/element":47}],14:[function(p,q,r){Object.defineProperties(r,{WalkontableLeftOverlay:{get:function(){return v}},__esModule:{value:!0}});var k,d;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.addClass,l=q.getScrollbarWidth,g=q.getScrollLeft,e=q.getWindowScrollTop,n=q.hasClass,m=q.outerWidth,a=q.innerHeight,b=q.removeClass,f=q.setOverlayPosition,t=q.resetCssTransform,u=(d=p("_base"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,v=function(a){$traceurRuntime.superConstructor(y).call(this,a);this.clone=this.makeClone(u.CLONE_LEFT)},y=v;$traceurRuntime.createClass(v,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b,e=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||e&&"horizontal"===e)b=this.getScrollPosition(),t(a);else{e=this.wot.wtTable.hider.getBoundingClientRect();b=Math.ceil(e.left);var d=Math.ceil(e.right),e=this.wot.wtTable.hider.style.top;b=d=0>b&&0<d-a.offsetWidth?-b:0;f(a,d+"px",""===e?0:e)}this.adjustHeaderBordersPosition(b);this.adjustElementsSize()}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(a,e()):this.mainTableScrollableElement.scrollLeft=a},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(a,b){for(var f=0,e=this.wot.wtSettings.defaultColumnWidth;a<b;)f+=this.wot.wtTable.getStretchedColumnWidth(a)||e,a++;return f},adjustElementsSize:function(a){a=void 0!==a?a:!1;this.updateTrimmingContainer();if(this.needFullRender||a)this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0)},adjustRootElementSize:function(){var b=this.wot.wtTable.holder,f=b.clientHeight===b.offsetHeight?0:l(),b=this.clone.wtTable.holder.parentNode.style,e=this.wot.getSetting("preventOverflow");this.trimmingContainer!==window||"vertical"===e?(f=this.wot.wtViewport.getWorkspaceHeight()-f,f=Math.min(f,a(this.wot.wtTable.wtRootElement)),b.height=f+"px"):b.height="";this.clone.wtTable.holder.style.height=b.height;f=m(this.clone.wtTable.TABLE);b.width=(0===f?f:f+4)+"px"},adjustRootChildrenSize:function(){var a=l();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;0===a&&(a=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalColumns");this.areElementSizesAdjusted||this.adjustElementsSize();if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(0===a)this.spreader.style.left="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.top="number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""},scrollTo:function(a,b){var f=this.getTableParentOffset(),e=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,d=0;b&&e.offsetWidth!==e.clientWidth&&(d=l());b?(f+=this.sumCellSizes(0,a+1),f-=this.wot.wtViewport.getViewportWidth()):f+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),a);this.setScrollPosition(f+d)},getTableParentOffset:function(){var a=0;this.wot.getSetting("preventOverflow")||this.trimmingContainer!==window||(a=this.wot.wtTable.holderOffset.left);return a},getScrollPosition:function(){return g(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(a){var f=this.wot.wtTable.holder.parentNode,e=this.wot.getSetting("rowHeaders"),d=this.wot.getSetting("fixedColumnsLeft");this.wot.getSetting("totalRows")?b(f,"emptyRows"):h(f,"emptyRows");d&&!e.length?h(f,"innerBorderLeft"):!d&&e.length&&(e=n(f,"innerBorderLeft"),a?h(f,"innerBorderLeft"):b(f,"innerBorderLeft"),(!e&&a||e&&!a)&&this.wot.wtOverlays.adjustElementsSize())}},{},u);window.WalkontableLeftOverlay=v;u.registerOverlay(u.CLONE_LEFT,v)},{_base:12,"helpers/dom/element":47}],15:[function(p,q,r){Object.defineProperties(r,{WalkontableTopOverlay:{get:function(){return v}},__esModule:{value:!0}});var k,d;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.addClass,l=q.getScrollbarWidth,g=q.getScrollTop,e=q.getWindowScrollLeft,n=q.hasClass,m=q.outerHeight,a=q.innerWidth,b=q.removeClass,f=q.setOverlayPosition,t=q.resetCssTransform,u=(d=p("_base"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,v=function(a){$traceurRuntime.superConstructor(y).call(this,a);this.clone=this.makeClone(u.CLONE_TOP)},y=v;$traceurRuntime.createClass(v,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b,e=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||e&&"vertical"===e)b=this.getScrollPosition(),t(a);else{e=this.wot.wtTable.hider.getBoundingClientRect();b=Math.ceil(e.top);var d=Math.ceil(e.bottom),e=this.wot.wtTable.hider.style.left;b=d=0>b&&0<d-a.offsetHeight?-b:0;f(a,""===e?0:e,d+"px")}this.adjustHeaderBordersPosition(b);this.adjustElementsSize()}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(e(),a):this.mainTableScrollableElement.scrollTop=a},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(a,b){for(var f=0,e=this.wot.wtSettings.settings.defaultRowHeight;a<b;){var d=this.wot.wtTable.getRowHeight(a),f=f+(void 0===d?e:d);a++}return f},adjustElementsSize:function(a){a=void 0!==a?a:!1;this.updateTrimmingContainer();if(this.needFullRender||a)this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0)},adjustRootElementSize:function(){var b=this.wot.wtTable.holder,f=b.clientWidth===b.offsetWidth?0:l(),b=this.clone.wtTable.holder.parentNode.style,e=this.wot.getSetting("preventOverflow");this.trimmingContainer!==window||"horizontal"===e?(f=this.wot.wtViewport.getWorkspaceWidth()-f,f=Math.min(f,a(this.wot.wtTable.wtRootElement)),b.width=f+"px"):b.width="";this.clone.wtTable.holder.style.width=b.width;f=m(this.clone.wtTable.TABLE);b.height=(0===f?f:f+4)+"px"},adjustRootChildrenSize:function(){var a=l();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;0===a&&(a=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalRows");this.areElementSizesAdjusted||this.adjustElementsSize();if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(0===a)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.left="number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""},scrollTo:function(a,b){var f=this.getTableParentOffset(),e=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,d=0;b&&e.offsetHeight!==e.clientHeight&&(d=l());if(b){e=this.wot.getSetting("fixedRowsBottom");this.wot.getSetting("fixedRowsTop");var m=this.wot.getSetting("totalRows"),f=f+this.sumCellSizes(0,a+1),f=f-(this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(m-e,m)),f=f+1}else f+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),a);this.setScrollPosition(f+d)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return g(this.mainTableScrollableElement)},redrawSelectionBorders:function(a){if(a&&a.cellRange){var b=a.getBorder(this.wot);b&&(a=a.getCorners(),b.disappear(),b.appear(a))}},redrawAllSelectionsBorders:function(){var a=this.wot.selections;this.redrawSelectionBorders(a.current);this.redrawSelectionBorders(a.area);this.redrawSelectionBorders(a.fill);this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()},adjustHeaderBordersPosition:function(a){var f=this.wot.wtTable.holder.parentNode;this.wot.getSetting("totalColumns")?b(f,"emptyColumns"):h(f,"emptyColumns");if(0===this.wot.getSetting("fixedRowsTop")&&0<this.wot.getSetting("columnHeaders").length){var e=n(f,"innerBorderTop");a||0===this.wot.getSetting("totalRows")?h(f,"innerBorderTop"):b(f,"innerBorderTop");if(!e&&a||e&&!a)this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders()}if(0===this.wot.getSetting("rowHeaders").length&&(a=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)")))for(f=0;f<a.length;f++)a[f].style["border-left-width"]=0}},{},u);window.WalkontableTopOverlay=v;u.registerOverlay(u.CLONE_TOP,v)},{_base:12,"helpers/dom/element":47}],16:[function(p,q,r){Object.defineProperties(r,{WalkontableTopLeftCornerOverlay:{get:function(){return m}},__esModule:{value:!0}});var k,d;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.outerHeight,l=q.outerWidth,g=q.setOverlayPosition,e=q.resetCssTransform,n=(d=p("_base"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(a).call(this,b);this.clone=this.makeClone(n.CLONE_TOP_LEFT_CORNER)},a=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},resetFixedPosition:function(){this.updateTrimmingContainer();if(this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,f=h(this.clone.wtTable.TABLE),d=l(this.clone.wtTable.TABLE),m=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var n=this.wot.wtTable.hider.getBoundingClientRect(),y=Math.ceil(n.top),k=Math.ceil(n.left),z=Math.ceil(n.bottom),n=Math.ceil(n.right),x="0",C="0";m&&"vertical"!==m||0>k&&0<n-a.offsetWidth&&(x=-k+"px");m&&"horizontal"!==m||0>y&&0<z-a.offsetHeight&&(C=-y+"px");g(a,x,C)}else e(a);a.style.height=(0===f?f:f+4)+"px";a.style.width=(0===d?d:d+4)+"px"}}},{},n);window.WalkontableTopLeftCornerOverlay=m;n.registerOverlay(n.CLONE_TOP_LEFT_CORNER,m)},{_base:12,"helpers/dom/element":47}],17:[function(p,q,r){Object.defineProperties(r,{WalkontableOverlays:{get:function(){return v}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var e=q.getScrollableElement,n=q.getScrollbarWidth,m=q.getScrollLeft,a=q.getScrollTop,b=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,f=(h=p("helpers/unicode"),h&&h.__esModule&&h||{"default":h}).isKey,t=(l=p("helpers/browser"),l&&l.__esModule&&l||{"default":l}).isMobileBrowser,u=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).EventManager,v=function(a){this.instance=this.wot=a;this.eventManager=new u(this.wot);this.wot.update("scrollbarWidth",n());this.wot.update("scrollbarHeight",n());this.scrollableElement=e(this.wot.wtTable.TABLE);this.prepareOverlays();this.keyPressed=this.destroyed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}};this.delegatedScrollCallback=this.horizontalScrolling=this.verticalScrolling=!1;this.registeredListeners=[];this.registerListeners()};$traceurRuntime.createClass(v,{prepareOverlays:function(){var a=!1;this.topOverlay?a=this.topOverlay.updateStateOfRendering()||a:this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot);"undefined"===typeof WalkontableBottomOverlay&&(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}});"undefined"===typeof WalkontableBottomLeftCornerOverlay&&(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}});this.bottomOverlay?a=this.bottomOverlay.updateStateOfRendering()||a:this.bottomOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot);this.leftOverlay?a=this.leftOverlay.updateStateOfRendering()||a:this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot);this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?a=this.topLeftCornerOverlay.updateStateOfRendering()||a:this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot));this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?a=this.bottomLeftCornerOverlay.updateStateOfRendering()||a:this.bottomLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot));this.wot.getSetting("debug")&&!this.debug&&(this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot));return a},refreshAll:function(){if(this.wot.drawn)if(this.wot.wtTable.holder.parentNode){this.wot.draw(!0);if(this.verticalScrolling)this.leftOverlay.onScroll();if(this.horizontalScrolling)this.topOverlay.onScroll();this.horizontalScrolling=this.verticalScrolling=!1}else this.destroy()},registerListeners:function(){var a=this,b=this.topOverlay.mainTableScrollableElement,f=this.leftOverlay.mainTableScrollableElement,e=[];e.push([document.documentElement,"keydown",function(b){return a.onKeyDown(b)}]);e.push([document.documentElement,"keyup",function(){return a.onKeyUp()}]);e.push([document,"visibilitychange",function(){return a.onKeyUp()}]);e.push([b,"scroll",function(b){return a.onTableScroll(b)}]);b!==f&&e.push([f,"scroll",function(b){return a.onTableScroll(b)}]);this.topOverlay.needFullRender&&(e.push([this.topOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),e.push([this.topOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]));this.bottomOverlay.needFullRender&&(e.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),e.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]));this.leftOverlay.needFullRender&&(e.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),e.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]));this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&e.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]);this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&e.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]);for(this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&e.push([window,"wheel",function(b){var f,e=b.wheelDeltaY||b.deltaY,d=b.wheelDeltaX||b.deltaX;a.topOverlay.clone.wtTable.holder.contains(b.realTarget)?f="top":a.bottomOverlay.clone&&a.bottomOverlay.clone.wtTable.holder.contains(b.realTarget)?f="bottom":a.leftOverlay.clone.wtTable.holder.contains(b.realTarget)?f="left":a.topLeftCornerOverlay&&a.topLeftCornerOverlay.clone&&a.topLeftCornerOverlay.clone.wtTable.holder.contains(b.realTarget)?f="topLeft":a.bottomLeftCornerOverlay&&a.bottomLeftCornerOverlay.clone&&a.bottomLeftCornerOverlay.clone.wtTable.holder.contains(b.realTarget)&&(f="bottomLeft");("top"==f&&0!==e||"left"==f&&0!==d||"bottom"==f&&0!==e||!("topLeft"!==f&&"bottomLeft"!==f||0===e&&0===d))&&b.preventDefault()}]);e.length;)b=e.pop(),this.eventManager.addEventListener(b[0],b[1],b[2]),this.registeredListeners.push(b)},deregisterListeners:function(){for(;this.registeredListeners.length;){var a=this.registeredListeners.pop();this.eventManager.removeEventListener(a[0],a[1],a[2])}},onTableScroll:function(a){if(!t()){var b=this.leftOverlay.mainTableScrollableElement,f=this.topOverlay.mainTableScrollableElement,e=a.target;this.keyPressed&&(f!==window&&e!==window&&!a.target.contains(f)||b!==window&&e!==window&&!a.target.contains(b))||("scroll"===a.type?this.syncScrollPositions(a):this.translateMouseWheelToScroll(a))}},onKeyDown:function(a){this.keyPressed=f(a.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(a){var b=this.topOverlay.clone.wtTable.holder,f=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,e=this.leftOverlay.clone.wtTable.holder,d=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,m=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,g=a.wheelDeltaY||-1*a.deltaY,n=a.wheelDeltaX||-1*a.deltaX,t=null,l={type:"wheel"},h=a.target,u=null;1===a.deltaMode&&(g*=120,n*=120);for(;h!=document&&null!=h;){if(-1<h.className.indexOf("wtHolder")){t=h;break}h=h.parentNode}l.target=t;t===d||t===m?(this.syncScrollPositions(l,-.2*n,"x"),this.syncScrollPositions(l,-.2*g,"y")):(t===b||t===f?u=g:t===e&&(u=n),this.syncScrollPositions(l,-.2*u));return!1},syncScrollPositions:function(b){var f=void 0!==arguments[1]?arguments[1]:null,e=void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed)if(0===arguments.length)this.syncScrollWithMaster();else{var d=this.leftOverlay.mainTableScrollableElement,g=this.topOverlay.mainTableScrollableElement,n=b.target,t=!1,l,h,u,v,y,k=!1,p=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(l=this.topOverlay.clone.wtTable.holder);this.bottomOverlay.needFullRender&&(y=this.bottomOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(h=this.leftOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(u=this.topLeftCornerOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(v=this.bottomLeftCornerOverlay.clone.wtTable.holder);n===document&&(n=window);n===d||n===g?(e=p?m(this.scrollableElement):m(n),this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=e,0<this.pendingScrollCallbacks.master.left?this.pendingScrollCallbacks.master.left--:(l&&l.scrollLeft!==e&&(null==f&&this.pendingScrollCallbacks.top.left++,l.scrollLeft=e,k=d!==window),y&&y.scrollLeft!==e&&(null==f&&this.pendingScrollCallbacks.bottom.left++,y.scrollLeft=e,k=d!==window)),e=a(n),this.verticalScrolling=!0,this.overlayScrollPositions.master.top=e,t=!0,0<this.pendingScrollCallbacks.master.top?this.pendingScrollCallbacks.master.top--:h&&h.scrollTop!==e&&(null==f&&this.pendingScrollCallbacks.left.top++,h.scrollTop=e,k=g!==window)):n===y?(e=m(n),this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=e,t=!0,0<this.pendingScrollCallbacks.bottom.left?this.pendingScrollCallbacks.bottom.left--:(null==f&&this.pendingScrollCallbacks.master.left++,d.scrollLeft=e,l&&l.scrollLeft!==e&&(null==f&&this.pendingScrollCallbacks.top.left++,l.scrollLeft=e,k=g!==window)),null!==f&&(t=!0,g.scrollTop+=f)):n===l?(e=m(n),this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=e,t=!0,0<this.pendingScrollCallbacks.top.left?this.pendingScrollCallbacks.top.left--:(null==f&&this.pendingScrollCallbacks.master.left++,d.scrollLeft=e),null!==f&&(t=!0,g.scrollTop+=f),y&&y.scrollLeft!==e&&(null==f&&this.pendingScrollCallbacks.bottom.left++,y.scrollLeft=e,k=g!==window)):n===h?(e=a(n),this.overlayScrollPositions.left.top!==e&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=e,t=!0,0<this.pendingScrollCallbacks.left.top?this.pendingScrollCallbacks.left.top--:(null==f&&this.pendingScrollCallbacks.master.top++,g.scrollTop=e)),null!==f&&(t=!0,g.scrollLeft+=f)):n!==u&&n!==v||null===f||(t=!0,"x"===e?g.scrollLeft+=f:"y"===e&&(g.scrollTop+=f));!this.keyPressed&&t&&"scroll"===b.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),k&&(this.delegatedScrollCallback=!0))}},syncScrollWithMaster:function(){var a=this.topOverlay.mainTableScrollableElement,b=a.scrollLeft,a=a.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=b);this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=b);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=a)},updateMainScrollableElements:function(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();this.scrollableElement=e(this.wot.wtTable.TABLE);this.registerListeners()},destroy:function(){this.eventManager.destroy();this.topOverlay.destroy();this.bottomOverlay.clone&&this.bottomOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0},refresh:function(a){a=void 0!==a?a:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var b=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,f=b.clientWidth,b=b.clientHeight;if(f!==this.spreaderLastSize.width||b!==this.spreaderLastSize.height)this.spreaderLastSize.width=f,this.spreaderLastSize.height=b,this.adjustElementsSize()}this.bottomOverlay.clone&&this.bottomOverlay.refresh(a);this.leftOverlay.refresh(a);this.topOverlay.refresh(a);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(a);this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(a);this.debug&&this.debug.refresh(a)},adjustElementsSize:function(a){a=void 0!==a?a:!1;var b=this.wot.getSetting("totalColumns"),f=this.wot.getSetting("totalRows"),e=this.wot.wtViewport.getRowHeaderWidth(),d=this.wot.wtViewport.getColumnHeaderHeight(),m=this.wot.wtTable.hider.style;m.width=e+this.leftOverlay.sumCellSizes(0,b)+"px";m.height=d+this.topOverlay.sumCellSizes(0,f)+1+"px";this.topOverlay.adjustElementsSize(a);this.leftOverlay.adjustElementsSize(a);this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(a)},applyToDOM:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM();this.leftOverlay.applyToDOM()},getParentOverlay:function(a){if(!a)return null;var f=null;b([this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],function(b,e){b&&b.clone&&b.clone.wtTable.TABLE.contains(a)&&(f=b.clone)});return f}},{});window.WalkontableOverlays=v},{eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/dom/element":47,"helpers/unicode":56}],18:[function(p,q,r){Object.defineProperties(r,{WalkontableScroll:{get:function(){return b}},__esModule:{value:!0}});var k,d;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.innerHeight,l=q.innerWidth,g=q.getScrollLeft,e=q.getScrollTop,n=q.offset;p=(d=p("helpers/number"),d&&d.__esModule&&d||{"default":d});var m=p.rangeEach,a=p.rangeEachReverse,b=function(a){this.instance=this.wot=a};$traceurRuntime.createClass(b,{scrollViewport:function(a){if(this.wot.drawn){var b=this._getVariables(),f=b.topOverlay,e=b.leftOverlay,d=b.totalRows,m=b.totalColumns,g=b.fixedRowsTop,n=b.fixedRowsBottom,b=b.fixedColumnsLeft;if(0>a.row||a.row>Math.max(d-1,0))throw Error("row "+a.row+" does not exist");if(0>a.col||a.col>Math.max(m-1,0))throw Error("column "+a.col+" does not exist");a.row>=g&&a.row<this.getFirstVisibleRow()?f.scrollTo(a.row):a.row>this.getLastVisibleRow()&&a.row<d-n&&f.scrollTo(a.row,!0);a.col>=b&&a.col<this.getFirstVisibleColumn()?e.scrollTo(a.col):a.col>this.getLastVisibleColumn()&&e.scrollTo(a.col,!0)}},getFirstVisibleRow:function(){var b=this._getVariables(),d=b.topOverlay,m=b.wtTable,g=b.wtViewport,l=b.totalRows,b=b.fixedRowsTop,k=m.getFirstVisibleRow();if(d.mainTableScrollableElement===window){var z=n(m.wtRootElement),x=h(m.hider),m=h(window),p=e(window);if(z.top+x-m<=p){var E=g.getColumnHeaderHeight(),E=E+d.sumCellSizes(0,b);a(l,1,function(a){E+=d.sumCellSizes(a-1,a);if(z.top+x-E<=p)return k=a,!1})}}return k},getLastVisibleRow:function(){var a=this._getVariables(),b=a.topOverlay,d=a.wtTable,g=a.wtViewport,a=a.totalRows,l=d.getLastVisibleRow();if(b.mainTableScrollableElement===window){var k=n(d.wtRootElement),z=h(window),x=e(window);if(k.top>x){var p=g.getColumnHeaderHeight();m(1,a,function(a){p+=b.sumCellSizes(a-1,a);if(k.top+p-x>=z)return l=a-2,!1})}}return l},getFirstVisibleColumn:function(){var b=this._getVariables(),e=b.leftOverlay,d=b.wtTable,m=b.wtViewport,b=b.totalColumns,h=d.getFirstVisibleColumn();if(e.mainTableScrollableElement===window){var k=n(d.wtRootElement),z=l(d.hider),d=l(window),x=g(window);if(k.left+z-d<=x){var p=m.getRowHeaderWidth();a(b,1,function(a){p+=e.sumCellSizes(a-1,a);if(k.left+z-p<=x)return h=a,!1})}}return h},getLastVisibleColumn:function(){var a=this._getVariables(),b=a.leftOverlay,e=a.wtTable,d=a.wtViewport,a=a.totalColumns,h=e.getLastVisibleColumn();if(b.mainTableScrollableElement===window){var k=n(e.wtRootElement),z=l(window),x=g(window);if(k.left>x){var p=d.getRowHeaderWidth();m(1,a,function(a){p+=b.sumCellSizes(a-1,a);if(k.left+p-x>=z)return h=a-2,!1})}}return h},_getVariables:function(){var a=this.wot,b=a.wtOverlays.topOverlay,e=a.wtOverlays.leftOverlay,d=a.wtTable,m=a.wtViewport,g=a.getSetting("totalRows"),n=a.getSetting("totalColumns"),l=a.getSetting("fixedRowsTop"),h=a.getSetting("fixedRowsBottom"),a=a.getSetting("fixedColumnsLeft");return{topOverlay:b,leftOverlay:e,wtTable:d,wtViewport:m,totalRows:g,totalColumns:n,fixedRowsTop:l,fixedRowsBottom:h,fixedColumnsLeft:a}}},{});window.WalkontableScroll=b},{"helpers/dom/element":47,"helpers/number":52}],19:[function(p,q,r){Object.defineProperties(r,{WalkontableSelection:{get:function(){return a}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,e=(d=p("border"),d&&d.__esModule&&d||{"default":d}).WalkontableBorder,n=(h=p("cell/coords"),h&&h.__esModule&&h||{"default":h}).WalkontableCellCoords,m=(l=p("cell/range"),l&&l.__esModule&&l||{"default":l}).WalkontableCellRange,a=function(a,f){this.settings=a;this.cellRange=f||null;this.instanceBorders={}};$traceurRuntime.createClass(a,{getBorder:function(a){if(this.instanceBorders[a.guid])return this.instanceBorders[a.guid];this.instanceBorders[a.guid]=new e(a,this.settings)},isEmpty:function(){return null===this.cellRange},add:function(a){this.isEmpty()?this.cellRange=new m(a,a,a):this.cellRange.expand(a)},replace:function(a,f){if(!this.isEmpty()){if(this.cellRange.from.isEqual(a))return this.cellRange.from=f,!0;if(this.cellRange.to.isEqual(a))return this.cellRange.to=f,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var a=this.cellRange.getTopLeftCorner(),f=this.cellRange.getBottomRightCorner();return[a.row,a.col,f.row,f.col]},addClassAtCoords:function(a,f,e,d){a=a.wtTable.getCell(new n(f,e));"object"===typeof a&&g(a,d)},draw:function(a){if(this.isEmpty()){if(this.settings.border){var b=this.getBorder(a);b&&b.disappear()}}else{var e=a.wtTable.getRenderedRowsCount(),d=a.wtTable.getRenderedColumnsCount(),b=this.getCorners(),m,n;for(m=0;m<d;m++)if(n=a.wtTable.columnFilter.renderedToSource(m),n>=b[1]&&n<=b[3]&&(n=a.wtTable.getColumnHeader(n))){var l=[];this.settings.highlightHeaderClassName&&l.push(this.settings.highlightHeaderClassName);this.settings.highlightColumnClassName&&l.push(this.settings.highlightColumnClassName);g(n,l)}for(l=0;l<e;l++){m=a.wtTable.rowFilter.renderedToSource(l);if(m>=b[0]&&m<=b[2]&&(n=a.wtTable.getRowHeader(m))){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName);this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName);g(n,h)}for(h=0;h<d;h++)n=a.wtTable.columnFilter.renderedToSource(h),m>=b[0]&&m<=b[2]&&n>=b[1]&&n<=b[3]?this.settings.className&&this.addClassAtCoords(a,m,n,this.settings.className):m>=b[0]&&m<=b[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(a,m,n,this.settings.highlightRowClassName):n>=b[1]&&n<=b[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(a,m,n,this.settings.highlightColumnClassName)}a.getSetting("onBeforeDrawBorders",b,this.settings.className);this.settings.border&&(a=this.getBorder(a))&&a.appear(b)}}},{});window.WalkontableSelection=a},{border:3,"cell/coords":6,"cell/range":7,"helpers/dom/element":47}],20:[function(p,q,r){Object.defineProperties(r,{WalkontableSettings:{get:function(){return h}},__esModule:{value:!0}});var k,d=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).fastInnerText,h=function(l,g){var e=this;this.instance=this.wot=l;this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(m,a,b){m=e.getSetting("data",m,a);d(b,void 0===m||null===m?"":m)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};for(var n in this.defaults)if(this.defaults.hasOwnProperty(n))if(void 0!==g[n])this.settings[n]=g[n];else{if(void 0===this.defaults[n])throw Error('A required setting "'+n+'" was not provided');this.settings[n]=this.defaults[n]}};$traceurRuntime.createClass(h,{update:function(d,g){if(void 0===g)for(var e in d)d.hasOwnProperty(e)&&(this.settings[e]=d[e]);else this.settings[d]=g;return this.wot},getSetting:function(d,g,e,n,m){return"function"===typeof this.settings[d]?this.settings[d](g,e,n,m):void 0!==g&&Array.isArray(this.settings[d])?this.settings[d][g]:this.settings[d]},has:function(d){return!!this.settings[d]}},{});window.WalkontableSettings=h},{"helpers/dom/element":47}],21:[function(p,q,r){Object.defineProperties(r,{WalkontableTable:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e;q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var n=q.getStyle,m=q.getTrimmingContainer,a=q.hasClass,b=q.index,f=q.offset,t=q.removeClass,u=q.removeTextNodes,v=q.overlayContainsElement,y=q.closest,w=(d=p("helpers/function"),d&&d.__esModule&&d||{"default":d}).isFunction,z=(h=p("cell/coords"),h&&h.__esModule&&h||{"default":h}).WalkontableCellCoords;p("cell/range");var x=(l=p("filter/column"),l&&l.__esModule&&l||{"default":l}).WalkontableColumnFilter,C=(g=p("filter/row"),g&&g.__esModule&&g||{"default":g}).WalkontableRowFilter,E=(e=p("tableRenderer"),e&&e.__esModule&&e||{"default":e}).WalkontableTableRenderer,A=function(a,b){var f=this;this.instance=this.wot=a;this.TABLE=b;this.COLGROUP=this.THEAD=this.TBODY=null;this.holderOffset=this.tableOffset=0;u(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.columnFilter=this.rowFilter=null;this.correctHeaderWidth=!1;var e=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return f._modifyRowHeaderWidth(e)}};$traceurRuntime.createClass(A,{fixTableDomTree:function(){this.TBODY=this.TABLE.querySelector("tbody");this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.querySelector("thead");this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.querySelector("colgroup");this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))},createSpreader:function(b){var f=b.parentNode,e;f&&1===f.nodeType&&a(f,"wtHolder")||(e=document.createElement("div"),e.className="wtSpreader",f&&f.insertBefore(e,b),e.appendChild(b));e.style.position="relative";return e},createHider:function(b){var f=b.parentNode,e;f&&1===f.nodeType&&a(f,"wtHolder")||(e=document.createElement("div"),e.className="wtHider",f&&f.insertBefore(e,b),e.appendChild(b));return e},createHolder:function(b){var f=b.parentNode,e;f&&1===f.nodeType&&a(f,"wtHolder")||(e=document.createElement("div"),e.style.position="relative",e.className="wtHolder",f&&f.insertBefore(e,b),this.isWorkingOnClone()||(e.parentNode.className+="ht_master handsontable"),e.appendChild(b));return e},alignOverlaysWithTrimmingContainer:function(){var a=m(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",a===window?this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"):(this.holder.style.width=n(a,"width"),this.holder.style.height=n(a,"height"),this.holder.style.overflow=""))},isWorkingOnClone:function(){return!!this.wot.cloneSource},draw:function(a){var b=this.wot,e=b.wtOverlays,d=b.wtViewport,b=this.instance.getSetting("totalRows"),m=this.wot.getSetting("rowHeaders").length,g=this.wot.getSetting("columnHeaders").length,n=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=f(this.holder),a=d.createRenderCalculators(a),m&&!this.wot.getSetting("fixedColumnsLeft"))){var h=e.leftOverlay.getScrollPosition(),l=this.correctHeaderWidth;this.correctHeaderWidth=0<h;l!==this.correctHeaderWidth&&(a=!1)}this.isWorkingOnClone()||(n=e.prepareOverlays());a?(this.isWorkingOnClone()||d.createVisibleCalculators(),e&&e.refresh(!0)):(this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=f(this.TABLE),h=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?0:WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?Math.max(b-this.wot.getSetting("fixedRowsBottom"),0):d.rowsRenderCalculator.startRow,d=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?0:d.columnsRenderCalculator.startColumn,this.rowFilter=new C(h,b,g),this.columnFilter=new x(d,this.wot.getSetting("totalColumns"),m),this.alignOverlaysWithTrimmingContainer(),this._doDraw());this.refreshSelections(a);this.isWorkingOnClone()||(e.topOverlay.resetFixedPosition(),e.bottomOverlay.clone&&e.bottomOverlay.resetFixedPosition(),e.leftOverlay.resetFixedPosition(),e.topLeftCornerOverlay&&e.topLeftCornerOverlay.resetFixedPosition(),e.bottomLeftCornerOverlay&&e.bottomLeftCornerOverlay.clone&&e.bottomLeftCornerOverlay.resetFixedPosition());n&&e.syncScrollWithMaster();this.wot.drawn=!0;return this},_doDraw:function(){(new E(this)).render()},removeClassFromCells:function(a){for(var b=this.TABLE.querySelectorAll("."+a),f=0,e=b.length;f<e;f++)t(b[f],a)},refreshSelections:function(a){if(this.wot.selections){var b=this.wot.selections.length;if(a)for(var f=0;f<b;f++)this.wot.selections[f].settings.className&&this.removeClassFromCells(this.wot.selections[f].settings.className),this.wot.selections[f].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[f].settings.highlightHeaderClassName),this.wot.selections[f].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[f].settings.highlightRowClassName),this.wot.selections[f].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[f].settings.highlightColumnClassName);for(f=0;f<b;f++)this.wot.selections[f].draw(this.wot,a)}},getCell:function(a){if(this.isRowBeforeRenderedRows(a.row))return-1;if(this.isRowAfterRenderedRows(a.row))return-2;var b=this.TBODY.childNodes[this.rowFilter.sourceToRendered(a.row)];if(b)return b.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(a.col)]},getColumnHeader:function(a,b){var f=this.THEAD.childNodes[void 0!==b?b:0];if(f)return f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(a)]},getRowHeader:function(a){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;if(a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(a)])return a.childNodes[0]},getCoords:function(a){"TD"!==a.nodeName&&"TH"!==a.nodeName&&(a=y(a,["TD","TH"]));var f=a.parentNode,e=f.parentNode,f=b(f),d=a.cellIndex;v(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,a)||v(WalkontableOverlay.CLONE_TOP,a)?"THEAD"===e.nodeName&&(f-=e.childNodes.length):f=e===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(f):this.rowFilter.renderedToSource(f);d=v(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,a)||v(WalkontableOverlay.CLONE_LEFT,a)?this.columnFilter.offsettedTH(d):this.columnFilter.visibleRowHeadedColumnToSourceColumn(d);return new z(f,d)},getTrForRow:function(a){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(a)]},getFirstRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function(a){return this.rowFilter&&0>this.rowFilter.sourceToRendered(a)&&0<=a},isRowAfterViewport:function(a){return this.rowFilter&&this.rowFilter.sourceToRendered(a)>this.getLastVisibleRow()},isRowAfterRenderedRows:function(a){return this.rowFilter&&this.rowFilter.sourceToRendered(a)>this.getLastRenderedRow()},isColumnBeforeViewport:function(a){return this.columnFilter&&0>this.columnFilter.sourceToRendered(a)&&0<=a},isColumnAfterViewport:function(a){return this.columnFilter&&this.columnFilter.sourceToRendered(a)>this.getLastVisibleColumn()},isLastRowFullyVisible:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var a=this.wot.wtViewport.columnsRenderCalculator.count,b=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG))a=b;else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),b);return a},getRenderedRowsCount:function(){var a=this.wot.wtViewport.rowsRenderCalculator.count,b=this.wot.getSetting("totalRows");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG))a=b;else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER))a=Math.min(this.wot.getSetting("fixedRowsTop"),b);else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))a=Math.min(this.wot.getSetting("fixedRowsBottom"),b);return a},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function(a){var b=this.wot.wtSettings.settings.rowHeight(a);a=this.wot.wtViewport.oversizedRows[a];void 0!==a&&(b=void 0===b?a:Math.max(b,a));return b},getColumnHeaderHeight:function(a){var b=this.wot.wtSettings.settings.defaultRowHeight;a=this.wot.wtViewport.oversizedColumnHeaders[a];void 0!==a&&(b=b?Math.max(b,a):a);return b},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function(a){var b=this.wot.wtSettings.settings.columnWidth;"function"===typeof b?b=b(a):"object"===typeof b&&(b=b[a]);return b||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function(a){var b=this.getColumnWidth(a),b=null==b?this.instance.wtSettings.settings.defaultColumnWidth:b,f=this.wot.wtViewport.columnsRenderCalculator;f&&(a=f.getStretchedColumnWidth(a,b))&&(b=a);return b},_modifyRowHeaderWidth:function(a){a=w(a)?a():null;Array.isArray(a)?(a=$traceurRuntime.spread(a),a[a.length-1]=this._correctRowHeaderWidth(a[a.length-1])):a=this._correctRowHeaderWidth(a);return a},_correctRowHeaderWidth:function(a){"number"!==typeof a&&(a=this.wot.getSetting("defaultColumnWidth"));this.correctHeaderWidth&&a++;return a}},{});window.WalkontableTable=A},{"cell/coords":6,"cell/range":7,"filter/column":10,"filter/row":11,"helpers/dom/element":47,"helpers/function":50,tableRenderer:22}],22:[function(p,q,r){Object.defineProperties(r,{WalkontableTableRenderer:{get:function(){return a}},__esModule:{value:!0}});var k;p=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var d=p.addClass,h=p.empty,l=p.getScrollbarWidth,g=p.hasClass,e=p.innerHeight,n=p.outerWidth,m=!1,a=function(a){this.wtTable=a;this.instance=this.wot=a.instance;this.rowFilter=a.rowFilter;this.columnFilter=a.columnFilter;this.TABLE=a.TABLE;this.THEAD=a.THEAD;this.TBODY=a.TBODY;this.COLGROUP=a.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.fixedRowsBottom=this.fixedRowsTop=this.columnHeaderCount=0};$traceurRuntime.createClass(a,{render:function(){if(!this.wtTable.isWorkingOnClone()){var a={};this.wot.getSetting("beforeDraw",!0,a);if(!0===a.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var a=this.wtTable.getRenderedColumnsCount(),f=this.wtTable.getRenderedRowsCount(),e=this.wot.getSetting("totalColumns"),d=this.wot.getSetting("totalRows"),m,g=!1;if(WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))this.columnHeaders=[],this.columnHeaderCount=0;0<=e&&(this.adjustAvailableNodes(),g=!0,this.renderColumnHeaders(),this.renderRows(d,f,a),this.wtTable.isWorkingOnClone()||(m=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(a),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights());g||this.adjustAvailableNodes();this.removeRedundantRows(f);this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.markOversizedRows();if(this.wtTable.isWorkingOnClone())this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(!1);this.wot.wtOverlays.applyToDOM();f=n(this.wtTable.hider);e=n(this.wtTable.TABLE);0!==f&&e!==f&&this.adjustColumnWidths(a);if(m!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;a=this.wtTable.getFirstRenderedColumn();m=this.wtTable.getLastRenderedColumn();f=this.wot.getSetting("defaultColumnWidth");e=this.wot.getSetting("rowHeaderWidth");e=this.instance.getSetting("onModifyRowHeaderWidth",e);if(null!=e)for(d=0;d<this.rowHeaderCount;d++)g=Array.isArray(e)?e[d]:e,g=null==g?f:g,this.COLGROUP.childNodes[d].style.width=g+"px";for(;a<m;a++)f=this.wtTable.getStretchedColumnWidth(a),e=this.columnFilter.sourceToRendered(a),this.COLGROUP.childNodes[e+this.rowHeaderCount].style.width=f+"px"}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(a,f,e){for(var b,d=0,g=this.rowFilter.renderedToSource(d),n=this.wtTable.isWorkingOnClone();g<a&&0<=g;){!m&&1E3<d&&(m=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'));if(void 0!==f&&d===f)break;b=this.getOrCreateTrForRow(d,b);this.renderRowHeaders(g,b);this.adjustColumns(b,e+this.rowHeaderCount);this.renderCells(g,b,e);n&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.resetOversizedRow(g);b.firstChild&&((g=this.wot.wtTable.getRowHeight(g))?(g--,b.firstChild.style.height=g+"px"):b.firstChild.style.height="");d++;g=this.rowFilter.renderedToSource(d)}},resetOversizedRow:function(a){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[a]&&(this.wot.wtViewport.oversizedRows[a]=void 0)},markOversizedRows:function(){if(!this.wot.getSetting("externalRowCalculator")){var a=this.instance.wtTable.TBODY.childNodes.length,f=a*this.instance.wtSettings.settings.defaultRowHeight,d=e(this.instance.wtTable.TBODY)-1,m,g;this.instance.getSetting("totalRows");if(f!==d||this.instance.getSetting("fixedRowsBottom"))for(;a;)if(a--,d=this.instance.wtTable.rowFilter.renderedToSource(a),f=this.instance.wtTable.getRowHeight(d),m=this.instance.wtTable.getTrForRow(d),m=(g=m.querySelector("th"))?e(g):e(m)-1,!f&&this.instance.wtSettings.settings.defaultRowHeight<m||f<m)this.instance.wtViewport.oversizedRows[d]=++m}},markOversizedColumnHeaders:function(){var a=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[a]&&!this.wtTable.isWorkingOnClone()){for(var f=this.wtTable.getRenderedColumnsCount(),e=0;e<this.columnHeaderCount;e++)for(var d=-1*this.rowHeaderCount;d<f;d++)this.markIfOversizedColumnHeader(d);this.wot.wtViewport.hasOversizedColumnHeadersMarked[a]=!0}},adjustColumnHeaderHeights:function(){for(var a=this.wot.getSetting("columnHeaders"),f=this.wot.wtTable.THEAD.childNodes,e=this.wot.wtViewport.oversizedColumnHeaders,d=0,a=a.length;d<a;d++)if(e[d]){if(!f[d]||0===f[d].childNodes.length)break;f[d].childNodes[0].style.height=e[d]+"px"}},markIfOversizedColumnHeader:function(a){a=this.wot.wtTable.columnFilter.renderedToSource(a);for(var b=this.columnHeaderCount,d=this.wot.wtSettings.settings.defaultRowHeight,m,g,n=this.wot.getSetting("columnHeaderHeight")||[];b;)if(b--,m=this.wot.wtTable.getColumnHeaderHeight(b),g=this.wot.wtTable.getColumnHeader(a,b)){g=e(g);if(!m&&d<g||m<g)this.wot.wtViewport.oversizedColumnHeaders[b]=g;Array.isArray(n)?null!=n[b]&&(this.wot.wtViewport.oversizedColumnHeaders[b]=n[b]):isNaN(n)||(this.wot.wtViewport.oversizedColumnHeaders[b]=n);this.wot.wtViewport.oversizedColumnHeaders[b]<(n[b]||n)&&(this.wot.wtViewport.oversizedColumnHeaders[b]=n[b]||n)}},renderCells:function(a,f,e){for(var b,d,m=0;m<e;m++){d=this.columnFilter.renderedToSource(m);b=0===m?f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(d)]:b.nextSibling;if("TH"==b.nodeName){var n=f,h=document.createElement("TD");n.insertBefore(h,b);n.removeChild(b);b=h}g(b,"hide")||(b.className="");b.removeAttribute("style");this.wot.wtSettings.settings.cellRenderer(a,d,b)}return b},adjustColumnWidths:function(a){var b=0,e=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,d=this.wot.getSetting("defaultColumnWidth"),m=this.wot.getSetting("rowHeaderWidth");e.offsetHeight<e.scrollHeight&&(b=l());this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-b);m=this.instance.getSetting("onModifyRowHeaderWidth",m);if(null!=m)for(b=0;b<this.rowHeaderCount;b++)e=Array.isArray(m)?m[b]:m,e=null==e?d:e,this.COLGROUP.childNodes[b].style.width=e+"px";for(d=0;d<a;d++)m=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(d)),this.COLGROUP.childNodes[d+this.rowHeaderCount].style.width=m+"px"},appendToTbody:function(a){this.TBODY.appendChild(a);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(a,f){var b;a>=this.wtTable.tbodyChildrenLength?(b=this.createRow(),this.appendToTbody(b)):b=0===a?this.TBODY.firstChild:f.nextSibling;b.className&&b.removeAttribute("class");return b},createRow:function(){for(var a=document.createElement("TR"),f=0;f<this.rowHeaderCount;f++)a.appendChild(document.createElement("TH"));return a},renderRowHeader:function(a,f,e){e.className="";e.removeAttribute("style");this.rowHeaders[f](a,e,f)},renderRowHeaders:function(a,f){for(var b=f.firstChild,e=0;e<this.rowHeaderCount;e++){if(!b)b=document.createElement("TH"),f.appendChild(b);else if("TD"==b.nodeName){var d=f,m=document.createElement("TH");d.insertBefore(m,b);d.removeChild(b);b=m}this.renderRowHeader(a,e,b);b=b.nextSibling}},adjustAvailableNodes:function(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function(){if(this.columnHeaderCount)for(var a=this.wtTable.getRenderedColumnsCount(),f=0;f<this.columnHeaderCount;f++)for(var e=this.getTrForColumnHeaders(f),d=-1*this.rowHeaderCount;d<a;d++){var m=this.columnFilter.renderedToSource(d);this.renderColumnHeader(f,m,e.childNodes[d+this.rowHeaderCount])}},adjustColGroups:function(){for(var a=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<a+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>a+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&d(this.COLGROUP.childNodes[0],"rowHeader")},adjustThead:function(){var a=this.wtTable.getRenderedColumnsCount(),f=this.THEAD.firstChild;if(this.columnHeaders.length){for(var e=0,d=this.columnHeaders.length;e<d;e++){f=this.THEAD.childNodes[e];f||(f=document.createElement("TR"),this.THEAD.appendChild(f));for(this.theadChildrenLength=f.childNodes.length;this.theadChildrenLength<a+this.rowHeaderCount;)f.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>a+this.rowHeaderCount;)f.removeChild(f.lastChild),this.theadChildrenLength--}a=this.THEAD.childNodes.length;if(a>this.columnHeaders.length)for(f=this.columnHeaders.length;f<a;f++)this.THEAD.removeChild(this.THEAD.lastChild)}else f&&h(f)},getTrForColumnHeaders:function(a){return this.THEAD.childNodes[a]},renderColumnHeader:function(a,f,e){e.className="";e.removeAttribute("style");return this.columnHeaders[a](f,e,a)},adjustColumns:function(a,f){for(var b=a.childNodes.length;b<f;){var e=document.createElement("TD");a.appendChild(e);b++}for(;b>f;)a.removeChild(a.lastChild),b--},removeRedundantColumns:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{});window.WalkontableTableRenderer=a},{"helpers/dom/element":47}],23:[function(p,q,r){Object.defineProperties(r,{WalkontableViewport:{get:function(){return z}},__esModule:{value:!0}});var k,d,h,l,g,e,n=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var m=q.getScrollbarWidth,a=q.getStyle,b=q.offset,f=q.outerHeight,t=q.outerWidth,u=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).objectEach,v=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager,y=(g=p("calculator/viewportColumns"),g&&g.__esModule&&g||{"default":g}).WalkontableViewportColumnsCalculator,w=(e=p("calculator/viewportRows"),e&&e.__esModule&&e||{"default":e}).WalkontableViewportRowsCalculator,z=function(a){var b=this;this.instance=this.wot=a;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.rowHeaderWidth=this.containerWidth=NaN;this.columnsVisibleCalculator=this.rowsVisibleCalculator=null;this.eventManager=new v(this.wot);this.eventManager.addEventListener(window,"resize",function(){b.clientHeight=b.getWorkspaceHeight()})};$traceurRuntime.createClass(z,{getWorkspaceHeight:function(){var a=this.instance.wtOverlays.topOverlay.trimmingContainer,b;a===window?a=document.documentElement.clientHeight:(b=f(a),a=0<b&&0<a.clientHeight?a.clientHeight:Infinity);return a},getWorkspaceWidth:function(){var b,f=this.wot.getSetting("totalColumns"),e=this.instance.wtOverlays.leftOverlay.trimmingContainer,d=this.wot.getSetting("stretchH");b=document.documentElement.offsetWidth;if(this.wot.getSetting("preventOverflow"))return t(this.instance.wtTable.wtRootElement);b=n.freezeOverlays?Math.min(b-this.getWorkspaceOffset().left,b):Math.min(this.getContainerFillWidth(),b-this.getWorkspaceOffset().left,b);return e===window&&0<f&&this.sumColumnWidths(0,f-1)>b?document.documentElement.clientWidth:e!==window&&(f=a(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),"scroll"==f||"hidden"==f||"auto"==f)?Math.max(b,e.clientWidth):"none"!==d&&d?b:Math.max(b,t(this.instance.wtTable.TABLE))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(a,b){for(var f=0;a<b;)f+=this.wot.wtTable.getColumnWidth(a),a++;return f},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var a=this.instance.wtTable.holder,b,f;f=document.createElement("div");f.style.width="100%";f.style.height="1px";a.appendChild(f);this.containerWidth=b=f.offsetWidth;a.removeChild(f);return b},getWorkspaceOffset:function(){return b(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return f(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return t(this.wot.wtTable.TABLE)||t(this.wot.wtTable.TBODY)||t(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=f(this.wot.wtTable.THEAD));return this.columnHeaderHeight},getViewportHeight:function(){var a=this.getWorkspaceHeight(),b;if(Infinity===a)return a;b=this.getColumnHeaderHeight();0<b&&(a-=b);return a},getRowHeaderWidth:function(){var a=this.instance.getSetting("rowHeaderWidth"),b=this.instance.getSetting("rowHeaders");if(a)for(var f=this.rowHeaderWidth=0,e=b.length;f<e;f++)this.rowHeaderWidth+=a[f]||a;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(b.length)for(a=this.instance.wtTable.TABLE.querySelector("TH"),f=this.rowHeaderWidth=0,b=b.length;f<b;f++)a?(this.rowHeaderWidth+=t(a),a=a.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth},getViewportWidth:function(){var a=this.getWorkspaceWidth(),b;if(Infinity===a)return a;b=this.getRowHeaderWidth();return 0<b?a-b:a},createRowsCalculator:function(a){a=void 0!==a?a:!1;var b=this,f,e,d,g,n;this.rowHeaderWidth=NaN;f=this.wot.wtSettings.settings.renderAllRows?Infinity:this.getViewportHeight();e=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();0>e&&(e=0);d=this.wot.getSetting("fixedRowsTop");g=this.wot.getSetting("fixedRowsBottom");n=this.wot.getSetting("totalRows");d&&(d=this.wot.wtOverlays.topOverlay.sumCellSizes(0,d),e+=d,f-=d);g&&this.wot.wtOverlays.bottomOverlay.clone&&(d=this.wot.wtOverlays.bottomOverlay.sumCellSizes(n-g,n),f-=d);g=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:m();return new w(f,e,this.wot.getSetting("totalRows"),function(a){return b.wot.wtTable.getRowHeight(a)},a?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,a,g)},createColumnsCalculator:function(a){a=void 0!==a?a:!1;var b=this,f=this.getViewportWidth(),e,d;this.columnHeaderHeight=NaN;e=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset();0>e&&(e=0);if(d=this.wot.getSetting("fixedColumnsLeft"))d=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,d),e+=d,f-=d;this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(f-=m());return new y(f,e,this.wot.getSetting("totalColumns"),function(a){return b.wot.wtTable.getColumnWidth(a)},a?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,a,this.wot.getSetting("stretchH"),function(a,f){return b.wot.getSetting("onBeforeStretchingColumnWidth",a,f)})},createRenderCalculators:function(a){if(a=void 0!==a?a:!1){var b=this.createRowsCalculator(!0),f=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(b)&&this.areAllProposedVisibleColumnsAlreadyRendered(f)||(a=!1)}a||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator());this.columnsVisibleCalculator=this.rowsVisibleCalculator=null;return a},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(a){return!this.rowsVisibleCalculator||a.startRow<this.rowsRenderCalculator.startRow||a.startRow===this.rowsRenderCalculator.startRow&&0<a.startRow||a.endRow>this.rowsRenderCalculator.endRow||a.endRow===this.rowsRenderCalculator.endRow&&a.endRow<this.wot.getSetting("totalRows")-1?!1:!0},areAllProposedVisibleColumnsAlreadyRendered:function(a){return!this.columnsVisibleCalculator||a.startColumn<this.columnsRenderCalculator.startColumn||a.startColumn===this.columnsRenderCalculator.startColumn&&0<a.startColumn||a.endColumn>this.columnsRenderCalculator.endColumn||a.endColumn===this.columnsRenderCalculator.endColumn&&a.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0},resetHasOversizedColumnHeadersMarked:function(){u(this.hasOversizedColumnHeadersMarked,function(a,b,f){f[b]=void 0})}},{});window.WalkontableViewport=z},{browser:24,"calculator/viewportColumns":4,"calculator/viewportRows":5,eventManager:42,"helpers/dom/element":47,"helpers/object":53}],24:[function(p,q,r){function k(a,b){var f=new k.Core(a,b||{});f.init();return f}var d,h,l,g,e,n,m,a,b,f,t,u,v,y,w,z,x,C;q.exports=k;k.utils={};q=p("shims/runtime");q&&q.__esModule&&q||{"default":q};q=p("es6collections");q&&q.__esModule&&q||{"default":q};q=(d=p("pluginHooks"),d&&d.__esModule&&d||{"default":d}).Hooks;d=(h=p("numbro"),h&&h.__esModule&&h||{"default":h})["default"];h=(l=p("moment"),l&&l.__esModule&&l||{"default":l})["default"];"object"===typeof window&&("undefined"===typeof window.numbro&&(window.numbro=d),"undefined"===typeof window.moment&&(window.moment=h));k.hooks||(k.hooks=new q);k.utils.Hooks=q;l=p("core");l&&l.__esModule&&l||{"default":l};l=p("renderers/_cellDecorator");l&&l.__esModule&&l||{"default":l};l=p("cellTypes");l&&l.__esModule&&l||{"default":l};l=p("plugins/jqueryHandsontable");l&&l.__esModule&&l||{"default":l};var E=(g=p("helpers/array"),g&&g.__esModule&&g||{"default":g});g=(e=p("helpers/browser"),e&&e.__esModule&&e||{"default":e});e=(n=p("helpers/data"),n&&n.__esModule&&n||{"default":n});n=(m=p("helpers/date"),m&&m.__esModule&&m||{"default":m});m=(a=p("helpers/feature"),a&&a.__esModule&&a||{"default":a});a=(b=p("helpers/function"),b&&b.__esModule&&b||{"default":b});b=(f=p("helpers/mixed"),f&&f.__esModule&&f||{"default":f});f=(t=p("helpers/number"),t&&t.__esModule&&t||{"default":t});t=(u=p("helpers/object"),u&&u.__esModule&&u||{"default":u});u=(v=p("helpers/setting"),v&&v.__esModule&&v||{"default":v});v=(y=p("helpers/string"),y&&y.__esModule&&y||{"default":y});y=(w=p("helpers/unicode"),w&&w.__esModule&&w||{"default":w});w=(z=p("helpers/dom/element"),z&&z.__esModule&&z||{"default":z});z=(x=p("helpers/dom/event"),x&&x.__esModule&&x||{"default":x});x=[E,g,e,n,m,a,b,f,t,u,v,y];z=[w,z];k.buildDate="Mon Apr 03 2017 15:02:25 GMT+0200 (CEST)";k.packageName="handsontable-pro";k.version="1.10.2";/^@@/.test("0.31.2")||(k.baseVersion="0.31.2");k.plugins={};p=(C=p("plugins"),C&&C.__esModule&&C||{"default":C}).registerPlugin;k.plugins.registerPlugin=p;k.helper={};k.dom={};k.Dom=k.dom;E.arrayEach(x,function(a){E.arrayEach(Object.getOwnPropertyNames(a),function(b){"_"!==b.charAt(0)&&(k.helper[b]=a[b])})});E.arrayEach(z,function(a){E.arrayEach(Object.getOwnPropertyNames(a),function(b){"_"!==b.charAt(0)&&(k.dom[b]=a[b])})})},{cellTypes:25,core:26,es6collections:"es6collections","helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/date":46,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"helpers/unicode":56,moment:"moment",numbro:"numbro",pluginHooks:61,plugins:62,"plugins/jqueryHandsontable":2,"renderers/_cellDecorator":119,"shims/runtime":126}],25:[function(p,q,r){var k,d,h,l;q=(k=p("helpers/browser"),k&&k.__esModule&&k||{"default":k}).isMobileBrowser;k=(d=p("editors"),d&&d.__esModule&&d||{"default":d}).getEditorConstructor;d=(h=p("renderers"),h&&h.__esModule&&h||{"default":h}).getRenderer;p("editors/autocompleteEditor");p("editors/checkboxEditor");p("editors/dateEditor");p("editors/dropdownEditor");p("editors/handsontableEditor");p("editors/mobileTextEditor");p("editors/numericEditor");p("editors/passwordEditor");p("editors/selectEditor");p("editors/textEditor");p("renderers/autocompleteRenderer");p("renderers/checkboxRenderer");p("renderers/htmlRenderer");p("renderers/numericRenderer");p("renderers/passwordRenderer");p("renderers/textRenderer");p("validators/autocompleteValidator");p("validators/dateValidator");p("validators/timeValidator");p("validators/numericValidator");p=(l=p("browser"),l&&l.__esModule&&l||{"default":l})["default"];p.AutocompleteCell={editor:k("autocomplete"),renderer:d("autocomplete"),validator:p.AutocompleteValidator};p.CheckboxCell={editor:k("checkbox"),renderer:d("checkbox")};p.TextCell={editor:q()?k("mobile"):k("text"),renderer:d("text")};p.NumericCell={editor:k("numeric"),renderer:d("numeric"),validator:p.NumericValidator,dataType:"number"};p.DateCell={editor:k("date"),validator:p.DateValidator,renderer:d("autocomplete")};p.TimeCell={editor:k("text"),validator:p.TimeValidator,renderer:d("text")};p.HandsontableCell={editor:k("handsontable"),renderer:d("autocomplete")};p.PasswordCell={editor:k("password"),renderer:d("password"),copyable:!1};p.DropdownCell={editor:k("dropdown"),renderer:d("autocomplete"),validator:p.AutocompleteValidator};p.cellTypes={text:p.TextCell,date:p.DateCell,time:p.TimeCell,numeric:p.NumericCell,checkbox:p.CheckboxCell,autocomplete:p.AutocompleteCell,handsontable:p.HandsontableCell,password:p.PasswordCell,dropdown:p.DropdownCell};p.cellLookup={validator:{numeric:p.NumericValidator,autocomplete:p.AutocompleteValidator}}},{browser:24,editors:30,"editors/autocompleteEditor":32,"editors/checkboxEditor":33,"editors/dateEditor":34,"editors/dropdownEditor":35,"editors/handsontableEditor":36,"editors/mobileTextEditor":37,"editors/numericEditor":38,"editors/passwordEditor":39,"editors/selectEditor":40,"editors/textEditor":41,"helpers/browser":44,renderers:118,"renderers/autocompleteRenderer":120,"renderers/checkboxRenderer":121,"renderers/htmlRenderer":122,"renderers/numericRenderer":123,"renderers/passwordRenderer":124,"renderers/textRenderer":125,"validators/autocompleteValidator":135,"validators/dateValidator":136,"validators/numericValidator":137,"validators/timeValidator":138}],26:[function(p,q,r){var k,d,h,l,g,e,n,m,a,b,f,t,u,v,y,w,z,x,C,E,A,B,G,D=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"],F=(d=p("numbro"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var H=q.addClass,J=q.empty,K=q.isChildOfWebComponentTable,I=q.removeClass,O=(l=p("helpers/setting"),l&&l.__esModule&&l||{"default":l}).columnFactory,Q=(g=p("helpers/function"),g&&g.__esModule&&g||{"default":g}).isFunction;h=(e=p("helpers/mixed"),e&&e.__esModule&&e||{"default":e});var R=h.isDefined,M=h.isUndefined,S=(n=p("helpers/browser"),n&&n.__esModule&&n||{"default":n}).isMobileBrowser,U=(m=p("dataMap"),m&&m.__esModule&&m||{"default":m}).DataMap,V=(a=p("editorManager"),a&&a.__esModule&&a||{"default":a}).EditorManager,ga=(b=p("eventManager"),b&&b.__esModule&&b||{"default":b}).eventManager;e=(f=p("helpers/object"),f&&f.__esModule&&f||{"default":f});var P=e.deepClone,ua=e.duckSchema,Z=e.extend,oa=e.isObject,W=e.isObjectEquals,T=e.deepObjectSize,wa=e.createObjectPropListener;f=(t=p("helpers/array"),t&&t.__esModule&&t||{"default":t});var ra=f.arrayFlatten,ia=f.arrayMap,la=(u=p("plugins"),u&&u.__esModule&&u||{"default":u}).getPlugin,aa=(v=p("renderers"),v&&v.__esModule&&v||{"default":v}).getRenderer,fa=(y=p("helpers/string"),y&&y.__esModule&&y||{"default":y}).randomString,pa=(w=p("helpers/number"),w&&w.__esModule&&w||{"default":w}).rangeEach,ha=(z=p("tableView"),z&&z.__esModule&&z||{"default":z}).TableView,xa=(x=p("dataSource"),x&&x.__esModule&&x||{"default":x}).DataSource;t=(C=p("helpers/data"),C&&C.__esModule&&C||{"default":C});var sa=t.translateRowsToColumns,ja=t.cellMethodLookupFactory,Aa=t.spreadsheetColumnLabel,ta=(E=p("utils/recordTranslator"),E&&E.__esModule&&E||{"default":E}).getTranslator,X=(A=p("3rdparty/walkontable/src/cell/coords"),A&&A.__esModule&&A||{"default":A}).WalkontableCellCoords,Da=(B=p("3rdparty/walkontable/src/cell/range"),B&&B.__esModule&&B||{"default":B}).WalkontableCellRange,Ea=(G=p("3rdparty/walkontable/src/calculator/viewportColumns"),G&&G.__esModule&&G||{"default":G}).WalkontableViewportColumnsCalculator;D.activeGuid=null;D.Core=function(a,b){function f(){var a=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++;a=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=0>this.validatorsInQueue-1?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(a){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==a&&(a=!0,this.onQueueEmpty(this.valid))}}}function e(a,b,e){var d=new f;d.onQueueEmpty=function(){var f;a.length&&(f=D.hooks.run(k,"beforeChange",a,b),Q(f)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===f&&a.splice(0,a.length));e()};for(var m=a.length-1;0<=m;m--)if(null===a[m])a.splice(m,1);else{var g=a[m][0],n=h.propToCol(a[m][1]),g=k.getCellMeta(g,n);"numeric"===g.type&&"string"===typeof a[m][3]&&0<a[m][3].length&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(a[m][3])||g.format)&&(n=a[m][3].length,M(g.language)?F.culture("en-US"):a[m][3].indexOf(".")===n-3&&-1===a[m][3].indexOf(",")?F.culture("en-US"):F.culture(g.language),F.cultureData(F.culture()),F.validate(a[m][3])&&!isNaN(a[m][3])?a[m][3]=parseFloat(a[m][3]):a[m][3]=F().unformat(a[m][3])||a[m][3]);k.getCellValidator(g)&&(d.addValidatorToQueue(),k.validateCell(a[m][3],g,function(b,f){return function(e){if("boolean"!==typeof e)throw Error("Validation error: result is not boolean");!1===e&&!1===f.allowInvalid&&(a.splice(b,1),f.valid=!0,e=k.getCell(f.row,f.col),I(e,k.getSettings().invalidCellClassName),--b);d.removeValidatorFormQueue()}}(m,g),b))}d.checkIfQueueIsEmpty()}function d(a,b){var f=a.length-1;if(!(0>f)){for(;0<=f;f--){var e=!1;if(null===a[f])a.splice(f,1);else if(null!=a[f][2]||null!=a[f][3]){if(n.settings.allowInsertRow)for(;a[f][0]>k.countRows()-1;)if(0===h.createRow(void 0,void 0,b)){e=!0;break}if(!e){if("array"===k.dataType&&(!n.settings.columns||0===n.settings.columns.length)&&n.settings.allowInsertColumn)for(;h.propToCol(a[f][1])>k.countCols()-1;)h.createCol(void 0,void 0,b);h.set(a[f][0],a[f][1],a[f][3])}}}k.forceFullRender=!0;t.adjustRowsAndCols();D.hooks.run(k,"beforeChangeRender",a,b);u.refreshBorders(null,!0);k.view.wt.wtOverlays.adjustElementsSize();D.hooks.run(k,"afterChange",a,b||"edit");(f=k.getActiveEditor())&&R(f.refreshValue)&&f.refreshValue()}}function m(a){if(a.hasOwnProperty("type")){var b,f={};if("object"===typeof a.type)b=a.type;else if("string"===typeof a.type&&(b=D.cellTypes[a.type],void 0===b))throw Error('You declared cell type "'+a.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var e in b)b.hasOwnProperty(e)&&!a.hasOwnProperty(e)&&(f[e]=b[e]);return f}}function g(){throw Error("This method cannot be called because this Handsontable instance has been destroyed");}var n,h,l,t,u,v,k=this,y=function(){},x=ga(k),z=ta(k);Z(y.prototype,Sa.prototype);Z(y.prototype,b);Z(y.prototype,m(b));this.rootElement=a;this.isHotTableEnv=K(this.rootElement);D.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");this.renderCall=!1;a.insertBefore(this.container,a.firstChild);this.guid="ht_"+fa();l=new xa(k);this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);n={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new y,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};t={alter:function(a,b,f,e,d){function m(a,b,f,e){f=ia(Array(f),function(){var a;"array"===e?a=[]:"object"===e&&(a={});return a});f.unshift(b,0);a.splice.apply(a,f)}f=f||1;switch(a){case "insert_row":a=k.countSourceRows();if(k.getSettings().maxRows===a)return;b=R(b)?b:a;a=h.createRow(b,f,e);m(n.cellSettings,b,f,"array");a&&(u.isSelected()&&n.selRange.from.row>=b?(n.selRange.from.row+=a,u.transformEnd(a,0)):u.refreshBorders());break;case "insert_col":a=h.createCol(b,f,e);e=0;for(var g=k.countSourceRows();e<g;e++)n.cellSettings[e]&&m(n.cellSettings[e],b,f);a&&(Array.isArray(k.getSettings().colHeaders)&&(f=[b,0],f.length+=a,Array.prototype.splice.apply(k.getSettings().colHeaders,f)),u.isSelected()&&n.selRange.from.col>=b?(n.selRange.from.col+=a,u.transformEnd(0,a)):u.refreshBorders());break;case "remove_row":h.removeRow(b,f,e);n.cellSettings.splice(b,f);a=k.countRows();e=k.getSettings().fixedRowsTop;e>=b+1&&(k.getSettings().fixedRowsTop-=Math.min(f,e-b));(e=k.getSettings().fixedRowsBottom)&&b>=a-e&&(k.getSettings().fixedRowsBottom-=Math.min(f,e));t.adjustRowsAndCols();u.refreshBorders();break;case "remove_col":a=z.toPhysicalColumn(b);h.removeCol(b,f,e);e=0;for(g=k.countSourceRows();e<g;e++)n.cellSettings[e]&&n.cellSettings[e].splice(a,f);e=k.getSettings().fixedColumnsLeft;e>=b+1&&(k.getSettings().fixedColumnsLeft-=Math.min(f,e-b));Array.isArray(k.getSettings().colHeaders)&&("undefined"==typeof a&&(a=-1),k.getSettings().colHeaders.splice(a,f));t.adjustRowsAndCols();u.refreshBorders();break;default:throw Error('There is no such action "'+a+'"');}d||t.adjustRowsAndCols()},adjustRowsAndCols:function(){if(n.settings.minRows){var a=k.countRows();if(a<n.settings.minRows)for(var b=0,f=n.settings.minRows;b<f-a;b++)h.createRow(k.countRows(),1,"auto")}if(n.settings.minSpareRows&&(a=k.countEmptyRows(!0),a<n.settings.minSpareRows))for(;a<n.settings.minSpareRows&&k.countSourceRows()<n.settings.maxRows;a++)h.createRow(k.countRows(),1,"auto");var e;if(n.settings.minCols||n.settings.minSpareCols)e=k.countEmptyCols(!0);if(n.settings.minCols&&!n.settings.columns&&k.countCols()<n.settings.minCols)for(;k.countCols()<n.settings.minCols;e++)h.createCol(k.countCols(),1,"auto");if(n.settings.minSpareCols&&!n.settings.columns&&"array"===k.dataType&&e<n.settings.minSpareCols)for(;e<n.settings.minSpareCols&&k.countCols()<n.settings.maxCols;e++)h.createCol(k.countCols(),1,"auto");e=k.countRows();a=k.countCols();0!==e&&0!==a||u.deselect();if(u.isSelected()){var b=!1,f=n.selRange.from.row,d=n.selRange.from.col,m=n.selRange.to.row,g=n.selRange.to.col;f>e-1?(f=e-1,b=!0,m>f&&(m=f)):m>e-1&&(m=e-1,b=!0,f>m&&(f=m));d>a-1?(d=a-1,b=!0,g>d&&(g=d)):g>a-1&&(g=a-1,b=!0,d>g&&(d=g));b&&k.selectCell(f,d,m,g)}k.view&&k.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(a,b,f,e,d,m,g){var h,l,t,u=[],v,y;h=b.length;if(0===h)return!1;switch(d){case "shift_down":e=f?f.col-a.col+1:0;f=f?f.row-a.row+1:0;b=sa(b);l=0;t=b.length;for(e=Math.max(t,e);l<e;l++)if(l<t){d=0;for(h=b[l].length;d<f-h;d++)b[l].push(b[l][d%h]);b[l].unshift(a.col+l,a.row,0);k.spliceCol.apply(k,b[l])}else b[l%t][0]=a.col+l,k.spliceCol.apply(k,b[l%t]);break;case "shift_right":e=f?f.col-a.col+1:0;f=f?f.row-a.row+1:0;d=0;h=b.length;for(f=Math.max(h,f);d<f;d++)if(d<h){l=0;for(t=b[d].length;l<e-t;l++)b[d].push(b[d][l%t]);b[d].unshift(a.row+d,a.col,0);k.spliceRow.apply(k,b[d])}else b[d%h][0]=a.row+d,k.spliceRow.apply(k,b[d%h]);break;default:v=a.row;y=a.col;var x={row:f&&a?f.row-a.row+1:1,col:f&&a?f.col-a.col+1:1},z=0,w=0,p=!0,F,E=function(a,f){var e=void 0!==f?f:null,d=b[a%b.length];return null!==e?d[e%d.length]:d},C=b.length,D=f?f.row-a.row+1:0;h=f?D:Math.max(C,D);for(d=0;d<h&&!(f&&v>f.row&&D>C||!n.settings.allowInsertRow&&v>k.countRows()-1||v>=n.settings.maxRows);d++){var G=d-z,H=E(G).length,A=f?f.col-a.col+1:0;t=f?A:Math.max(H,A);y=a.col;F=k.getCellMeta(v,y);if("CopyPaste.paste"!==e&&"Autofill.autofill"!==e||!F.skipRowOnPaste){for(l=w=0;l<t&&!(f&&y>f.col&&A>H||!n.settings.allowInsertColumn&&y>k.countCols()-1||y>=n.settings.maxCols);l++)if(F=k.getCellMeta(v,y),"CopyPaste.paste"!==e&&"Autofill.fill"!==e||!F.skipColumnOnPaste){if(!F.readOnly){var J=l-w;F=E(G,J);var B=k.getDataAtCell(v,y),J={row:G,col:J};"Autofill.fill"===e&&(J=k.runHooks("beforeAutofillInsidePopulate",J,m,b,g,{},x))&&(F=M(J.value)?F:J.value);null!==F&&"object"===typeof F?null===B||"object"!==typeof B?p=!1:(B=ua(B[0]||B),J=ua(F[0]||F),W(B,J)?F=P(F):p=!1):null!==B&&"object"===typeof B&&(p=!1);p&&u.push([v,y,F]);p=!0}y++}else w++,y++,t++;v++}else z++,v++,h++}k.setDataAtCell(u,null,null,e||"populateFromArray")}}};this.selection=u={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(a,b,f){k.selection.selectedHeader.rows=void 0!==a?a:!1;k.selection.selectedHeader.cols=void 0!==b?b:!1;k.selection.selectedHeader.corner=void 0!==f?f:!1},begin:function(){k.selection.inProgress=!0},finish:function(){var a=k.getSelected();D.hooks.run(k,"afterSelectionEnd",a[0],a[1],a[2],a[3]);D.hooks.run(k,"afterSelectionEndByProp",a[0],k.colToProp(a[1]),a[2],k.colToProp(a[3]));k.selection.inProgress=!1},isInProgress:function(){return k.selection.inProgress},setRangeStart:function(a,b){D.hooks.run(k,"beforeSetRangeStart",a);n.selRange=new Da(a,a,a);u.setRangeEnd(a,null,b)},setRangeStartOnly:function(a){D.hooks.run(k,"beforeSetRangeStartOnly",a);n.selRange=new Da(a,a,a)},setRangeEnd:function(a,b,f){if(null!==n.selRange){var e,d=!1,m=!0;e=k.view.wt.wtTable.getFirstVisibleRow();var g=k.view.wt.wtTable.getFirstVisibleColumn();D.hooks.run(k,"beforeSetRangeEnd",a);k.selection.begin();n.selRange.to=new X(0>a.row?e:a.row,0>a.col?g:a.col);n.settings.multiSelect||(n.selRange.from=a);k.view.wt.selections.current.clear();e=k.getCellMeta(n.selRange.highlight.row,n.selRange.highlight.col).disableVisualSelection;"string"===typeof e&&(e=[e]);(!1===e||Array.isArray(e)&&-1===e.indexOf("current"))&&k.view.wt.selections.current.add(n.selRange.highlight);k.view.wt.selections.area.clear();(!1===e||Array.isArray(e)&&-1===e.indexOf("area"))&&u.isMultiple()&&(k.view.wt.selections.area.add(n.selRange.from),k.view.wt.selections.area.add(n.selRange.to));if(n.settings.currentHeaderClassName||n.settings.currentRowClassName||n.settings.currentColClassName)k.view.wt.selections.highlight.clear(),k.view.wt.selections.highlight.add(n.selRange.from),k.view.wt.selections.highlight.add(n.selRange.to);e=wa("value");D.hooks.run(k,"afterSelection",n.selRange.from.row,n.selRange.from.col,n.selRange.to.row,n.selRange.to.col,e);D.hooks.run(k,"afterSelectionByProp",n.selRange.from.row,h.colToProp(n.selRange.from.col),n.selRange.to.row,h.colToProp(n.selRange.to.col),e);if(0===n.selRange.from.row&&n.selRange.to.row===k.countRows()-1&&1<k.countRows()||0===n.selRange.from.col&&n.selRange.to.col===k.countCols()-1&&1<k.countCols())d=!0;if(0>a.row||0>a.col)m=!1;e.isTouched()&&(b=!e.value);!1!==b&&!d&&m&&(n.selRange.from&&!u.isMultiple()?k.view.scrollViewport(n.selRange.from):k.view.scrollViewport(a));u.selectedHeader.rows&&u.selectedHeader.cols?H(k.rootElement,["ht__selection--rows","ht__selection--columns"]):u.selectedHeader.rows?(I(k.rootElement,"ht__selection--columns"),H(k.rootElement,"ht__selection--rows")):u.selectedHeader.cols?(I(k.rootElement,"ht__selection--rows"),H(k.rootElement,"ht__selection--columns")):I(k.rootElement,["ht__selection--rows","ht__selection--columns"]);u.refreshBorders(null,f)}},refreshBorders:function(a,b){b||v.destroyEditor(a);k.view.render();u.isSelected()&&!b&&v.prepareEditor()},isMultiple:function(){var a=!(n.selRange.to.col===n.selRange.from.col&&n.selRange.to.row===n.selRange.from.row),b=D.hooks.run(k,"afterIsMultipleSelection",a);if(a)return b},transformStart:function(a,b,f,e){var d=new X(a,b),m=b=0,g,h,l;k.runHooks("modifyTransformStart",d);g=k.countRows();h=k.countCols();l=k.getSettings().fixedRowsBottom;n.selRange.highlight.row+a>g-1?f&&0<n.settings.minSpareRows&&!(l&&n.selRange.highlight.row>=g-l-1)?(k.alter("insert_row",g),g=k.countRows()):n.settings.autoWrapCol&&(d.row=1-g,d.col=n.selRange.highlight.col+d.col==h-1?1-h:1):n.settings.autoWrapCol&&0>n.selRange.highlight.row+d.row&&0<=n.selRange.highlight.col+d.col&&(d.row=g-1,d.col=0==n.selRange.highlight.col+d.col?h-1:-1);n.selRange.highlight.col+d.col>h-1?f&&0<n.settings.minSpareCols?(k.alter("insert_col",h),h=k.countCols()):n.settings.autoWrapRow&&(d.row=n.selRange.highlight.row+d.row==g-1?1-g:1,d.col=1-h):n.settings.autoWrapRow&&0>n.selRange.highlight.col+d.col&&0<=n.selRange.highlight.row+d.row&&(d.row=0==n.selRange.highlight.row+d.row?g-1:-1,d.col=h-1);a=new X(n.selRange.highlight.row+d.row,n.selRange.highlight.col+d.col);0>a.row?(b=-1,a.row=0):0<a.row&&a.row>=g&&(b=1,a.row=g-1);0>a.col?(m=-1,a.col=0):0<a.col&&a.col>=h&&(m=1,a.col=h-1);k.runHooks("afterModifyTransformStart",a,b,m);u.setRangeStart(a,e)},transformEnd:function(a,b){var f=new X(a,b),e=0,d=0,m,g;k.runHooks("modifyTransformEnd",f);m=k.countRows();g=k.countCols();f=new X(n.selRange.to.row+f.row,n.selRange.to.col+f.col);0>f.row?(e=-1,f.row=0):0<f.row&&f.row>=m&&(e=1,f.row=m-1);0>f.col?(d=-1,f.col=0):0<f.col&&f.col>=g&&(d=1,f.col=g-1);k.runHooks("afterModifyTransformEnd",f,e,d);u.setRangeEnd(f,!0)},isSelected:function(){return null!==n.selRange},inInSelection:function(a){return u.isSelected()?n.selRange.includes(a):!1},deselect:function(){u.isSelected()&&(k.selection.inProgress=!1,n.selRange=null,k.view.wt.selections.current.clear(),k.view.wt.selections.area.clear(),(n.settings.currentHeaderClassName||n.settings.currentRowClassName||n.settings.currentColClassName)&&k.view.wt.selections.highlight.clear(),v.destroyEditor(),u.refreshBorders(),I(k.rootElement,["ht__selection--rows","ht__selection--columns"]),D.hooks.run(k,"afterDeselect"))},selectAll:function(){n.settings.multiSelect&&(u.setSelectedHeaders(!0,!0,!0),u.setRangeStart(new X(0,0)),u.setRangeEnd(new X(k.countRows()-1,k.countCols()-1),!1))},empty:function(){if(u.isSelected()){var a=n.selRange.getTopLeftCorner(),b=n.selRange.getBottomRightCorner(),f,e,d=[];for(f=a.row;f<=b.row;f++)for(e=a.col;e<=b.col;e++)k.getCellMeta(f,e).readOnly||d.push([f,e,""]);k.setDataAtCell(d)}}};this.init=function(){l.setData(n.settings.data);D.hooks.run(k,"beforeInit");S()&&H(k.rootElement,"mobile");this.updateSettings(n.settings,!0);this.view=new ha(this);v=new V(k,n,u,h);this.forceFullRender=!0;D.hooks.run(k,"init");this.view.render();"object"===typeof n.firstRun&&(D.hooks.run(k,"afterChange",n.firstRun[0],n.firstRun[1]),n.firstRun=!1);D.hooks.run(k,"afterInit")};this.validateCell=function(a,b,f,e){function d(a){var e=b.visualCol,d=b.visualRow,m=k.getCell(d,e,!0);m&&"TH"!=m.nodeName&&k.view.wt.wtSettings.settings.cellRenderer(d,e,m);f(a)}var m=k.getCellValidator(b);"[object RegExp]"===Object.prototype.toString.call(m)&&(m=function(a){return function(b,f){f(a.test(b))}}(m));Q(m)?(a=D.hooks.run(k,"beforeValidate",a,b.visualRow,b.prop,e),k._registerTimeout(setTimeout(function(){m.call(b,a,function(f){f=D.hooks.run(k,"afterValidate",f,a,b.visualRow,b.prop,e);b.valid=f;d(f);D.hooks.run(k,"postAfterValidate",f,a,b.visualRow,b.prop,e)})},0))):k._registerTimeout(setTimeout(function(){b.valid=!0;d(b.valid)},0))};this.setDataAtCell=function(a,b,f,m){f="object"===typeof a?a:[[a,b,f]];var g,n,t=[],u;g=0;for(n=f.length;g<n;g++){if("object"!==typeof f[g])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof f[g][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=h.colToProp(f[g][1]);t.push([f[g][0],u,l.getAtCell(z.toPhysicalRow(f[g][0]),f[g][1]),f[g][2]])}m||"object"!==typeof a||(m=b);k.runHooks("afterSetDataAtCell",t,m);e(t,m,function(){d(t,m)})};this.setDataAtRowProp=function(a,b,f,m){f="object"===typeof a?a:[[a,b,f]];var g,n,h=[];g=0;for(n=f.length;g<n;g++)h.push([f[g][0],f[g][1],l.getAtCell(z.toPhysicalRow(f[g][0]),f[g][1]),f[g][2]]);m||"object"!==typeof a||(m=b);k.runHooks("afterSetDataAtRowProp",h,m);e(h,m,function(){d(h,m)})};this.listen=function(){D.activeGuid=k.guid};this.unlisten=function(){D.activeGuid=null};this.isListening=function(){return D.activeGuid===k.guid};this.destroyEditor=function(a){u.refreshBorders(a)};this.populateFromArray=function(a,b,f,e,d,m,g,n,h){if("object"!==typeof f||"object"!==typeof f[0])throw Error("populateFromArray parameter `input` must be an array of arrays");e="number"===typeof e?new X(e,d):null;return t.populateFromArray(new X(a,b),f,e,m,g,n,h)};this.spliceCol=function(a,b,f){return h.spliceCol.apply(h,arguments)};this.spliceRow=function(a,b,f){return h.spliceRow.apply(h,arguments)};this.getSelected=function(){if(u.isSelected())return[n.selRange.from.row,n.selRange.from.col,n.selRange.to.row,n.selRange.to.col]};this.getSelectedRange=function(){if(u.isSelected())return n.selRange};this.render=function(){k.view&&(k.renderCall=!0,k.forceFullRender=!0,u.refreshBorders(null,!0))};this.loadData=function(a){Array.isArray(n.settings.dataSchema)?k.dataType="array":Q(n.settings.dataSchema)?k.dataType="function":k.dataType="object";h&&h.destroy();h=new U(k,n,y);if("object"===typeof a&&null!==a)a.push&&a.splice||(a=[a]);else if(null===a){a=[];var b,f,e,d=h.getSchema();f=0;for(e=n.settings.startRows;f<e;f++){if("object"!==k.dataType&&"function"!==k.dataType||!n.settings.dataSchema)if("array"===k.dataType)b=P(d[0]);else{b=[];for(var m=0,g=n.settings.startCols;m<g;m++)b.push(null)}else b=P(d);a.push(b)}}else throw Error("loadData only accepts array of objects or array of arrays ("+typeof a+" given)");n.isPopulated=!1;y.prototype.data=a;Array.isArray(a[0])&&(k.dataType="array");h.dataSource=a;l.data=a;l.dataType=k.dataType;l.colToProp=h.colToProp.bind(h);l.propToCol=h.propToCol.bind(h);n.cellSettings.length=0;t.adjustRowsAndCols();D.hooks.run(k,"afterLoadData",n.firstRun);n.firstRun?n.firstRun=[null,"loadData"]:(D.hooks.run(k,"afterChange",null,"loadData"),k.render());n.isPopulated=!0};this.getData=function(a,b,f,e){return M(a)?h.getAll():h.getRange(new X(a,b),new X(f,e),h.DESTINATION_RENDERER)};this.getCopyableText=function(a,b,f,e){return h.getCopyableText(new X(a,b),new X(f,e))};this.getCopyableData=function(a,b){return h.getCopyable(a,h.colToProp(b))};this.getSchema=function(){return h.getSchema()};this.updateSettings=function(a,b){var f=!1,e,d,g;if(R(a.rows))throw Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(R(a.cols))throw Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(e in a)if("data"!==e)if(-1<D.hooks.getRegistered().indexOf(e)){if(Q(a[e])||Array.isArray(a[e]))a[e].initialHook=!0,k.addHook(e,a[e])}else!b&&a.hasOwnProperty(e)&&(y.prototype[e]=a[e]);void 0===a.data&&void 0===n.settings.data?k.loadData(null):void 0!==a.data?k.loadData(a.data):void 0!==a.columns&&h.createMap();g=k.countCols();var l=a.columns||y.prototype.columns;l&&Q(l)&&(g=k.countSourceCols(),f=!0);if(void 0!==a.cell||void 0!==a.cells||void 0!==a.columns)n.cellSettings.length=0;if(0<g){var v,x;for(d=e=0;e<g;e++)if(!f||l(e))n.columnSettings[d]=O(y,n.columnsSettingConflicts),v=n.columnSettings[d].prototype,l&&(x=f?l(e):l[d])&&(Z(v,x),Z(v,m(x))),d++}if(R(a.cell))for(var z in a.cell)a.cell.hasOwnProperty(z)&&(f=a.cell[z],k.setCellMetaObject(f.row,f.col,f));D.hooks.run(k,"afterCellMetaReset");R(a.className)&&(y.prototype.className&&I(k.rootElement,y.prototype.className),a.className&&H(k.rootElement,a.className));z=k.rootElement.style.height;""!==z&&(z=parseInt(k.rootElement.style.height,10));f=a.height;Q(f)&&(f=f());b&&k.rootElement.getAttribute("style")&&k.rootElement.setAttribute("data-initialstyle",k.rootElement.getAttribute("style"));null===f?(e=k.rootElement.getAttribute("data-initialstyle"))&&(-1<e.indexOf("height")||-1<e.indexOf("overflow"))?k.rootElement.setAttribute("style",e):(k.rootElement.style.height="",k.rootElement.style.overflow=""):void 0!==f&&(k.rootElement.style.height=f+"px",k.rootElement.style.overflow="hidden");"undefined"!=typeof a.width&&(e=a.width,Q(e)&&(e=e()),k.rootElement.style.width=e+"px");b||(h.clearLengthCache(),k.view&&k.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),D.hooks.run(k,"afterUpdateSettings"));t.adjustRowsAndCols();k.view&&!n.firstRun&&(k.forceFullRender=!0,u.refreshBorders(null,!0));b||!k.view||""!==z&&""!==f&&void 0!==f||z===f||k.view.wt.wtOverlays.updateMainScrollableElements()};this.getValue=function(){var a=k.getSelected();if(y.prototype.getValue){if(Q(y.prototype.getValue))return y.prototype.getValue.call(k);if(a)return k.getData()[a[0]][y.prototype.getValue]}else if(a)return k.getDataAtCell(a[0],a[1])};this.getSettings=function(){return n.settings};this.clear=function(){u.selectAll();u.empty()};this.alter=function(a,b,f,e,d){t.alter(a,b,f,e,d)};this.getCell=function(a,b,f){return k.view.getCellAtCoords(new X(a,b),f)};this.getCoords=function(a){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,a)};this.colToProp=function(a){return h.colToProp(a)};this.propToCol=function(a){return h.propToCol(a)};this.toVisualRow=function(a){return z.toVisualRow(a)};this.toVisualColumn=function(a){return z.toVisualColumn(a)};this.toPhysicalRow=function(a){return z.toPhysicalRow(a)};this.toPhysicalColumn=function(a){return z.toPhysicalColumn(a)};this.getDataAtCell=function(a,b){return h.get(a,h.colToProp(b))};this.getDataAtRowProp=function(a,b){return h.get(a,b)};this.getDataAtCol=function(a){var b=[];return b.concat.apply(b,h.getRange(new X(0,a),new X(n.settings.data.length-1,a),h.DESTINATION_RENDERER))};this.getDataAtProp=function(a){var b=[];a=h.getRange(new X(0,h.propToCol(a)),new X(n.settings.data.length-1,h.propToCol(a)),h.DESTINATION_RENDERER);return b.concat.apply(b,a)};this.getSourceData=function(a,b,f,e){return void 0===a?l.getData():l.getByRange(new X(a,b),new X(f,e))};this.getSourceDataArray=function(a,b,f,e){return void 0===a?l.getData(!0):l.getByRange(new X(a,b),new X(f,e),!0)};this.getSourceDataAtCol=function(a){return l.getAtColumn(a)};this.getSourceDataAtRow=function(a){return l.getAtRow(a)};this.getSourceDataAtCell=function(a,b){return l.getAtCell(a,b)};this.getDataAtRow=function(a){return h.getRange(new X(a,0),new X(a,this.countCols()-1),h.DESTINATION_RENDERER)[0]};this.getDataType=function(a,b,f,e){var d=this,m=null,g=null;void 0===a&&(a=0,f=this.countRows(),b=0,e=this.countCols());void 0===f&&(f=a);void 0===e&&(e=b);var n="mixed";pa(Math.min(a,f),Math.max(a,f),function(a){var f=!0;pa(Math.min(b,e),Math.max(b,e),function(b){g=d.getCellMeta(a,b).type;m?f=m===g:m=g;return f});n=f?g:"mixed";return f});return n};this.removeCellMeta=function(a,b,f){void 0!=k.getCellMeta(a,b)[f]&&delete n.cellSettings[a][b][f]};this.spliceCellsMeta=function(a,b){for(var f,e=[],d=2;d<arguments.length;d++)e[d-2]=arguments[d];(f=n.cellSettings).splice.apply(f,$traceurRuntime.spread([a,b],e))};this.setCellMetaObject=function(a,b,f){if("object"===typeof f)for(var e in f)f.hasOwnProperty(e)&&this.setCellMeta(a,b,e,f[e])};this.setCellMeta=function(a,b,f,e){var d;d=z.toPhysical(a,b);a=d[0];b=d[1];d;n.cellSettings[a]||(n.cellSettings[a]=[]);n.cellSettings[a][b]||(n.cellSettings[a][b]=new n.columnSettings[b]);n.cellSettings[a][b][f]=e;D.hooks.run(k,"afterSetCellMeta",a,b,f,e)};this.getCellsMeta=function(){return ra(n.cellSettings)};this.getCellMeta=function(a,b){var f,e=h.colToProp(b),d=a,g=b;f=z.toPhysical(a,b);a=f[0];b=f[1];f;n.columnSettings[b]||(n.columnSettings[b]=O(y,n.columnsSettingConflicts));n.cellSettings[a]||(n.cellSettings[a]=[]);n.cellSettings[a][b]||(n.cellSettings[a][b]=new n.columnSettings[b]);f=n.cellSettings[a][b];f.row=a;f.col=b;f.visualRow=d;f.visualCol=g;f.prop=e;f.instance=k;D.hooks.run(k,"beforeGetCellMeta",a,b,f);Z(f,m(f));f.cells&&(e=f.cells.call(f,a,b,e))&&(Z(f,e),Z(f,m(e)));D.hooks.run(k,"afterGetCellMeta",a,b,f);return f};this.getCellMetaAtRow=function(a){return n.cellSettings[a]};this.isColumnModificationAllowed=function(){return!("object"===k.dataType||k.getSettings().columns)};var w=ja("renderer");this.getCellRenderer=function(a,b){var f=w.call(this,a,b);return aa(f)};this.getCellEditor=ja("editor");this.getCellValidator=ja("validator");this.validateCells=function(a){var b=new f;a&&(b.onQueueEmpty=a);for(a=k.countRows()-1;0<=a;){for(var e=k.countCols()-1;0<=e;)b.addValidatorToQueue(),k.validateCell(k.getDataAtCell(a,e),k.getCellMeta(a,e),function(a){if("boolean"!==typeof a)throw Error("Validation error: result is not boolean");!1===a&&(b.valid=!1);b.removeValidatorFormQueue()},"validateCells"),e--;a--}b.checkIfQueueIsEmpty()};this.getRowHeader=function(a){var b=n.settings.rowHeaders;void 0!==a&&(a=D.hooks.run(k,"modifyRowHeader",a));void 0===a?(b=[],pa(k.countRows()-1,function(a){b.push(k.getRowHeader(a))})):Array.isArray(b)&&void 0!==b[a]?b=b[a]:Q(b)?b=b(a):b&&"string"!==typeof b&&"number"!==typeof b&&(b=a+1);return b};this.hasRowHeaders=function(){return!!n.settings.rowHeaders};this.hasColHeaders=function(){if(void 0!==n.settings.colHeaders&&null!==n.settings.colHeaders)return!!n.settings.colHeaders;for(var a=0,b=k.countCols();a<b;a++)if(k.getColHeader(a))return!0;return!1};this.getColHeader=function(a){var b=n.settings.columns&&Q(n.settings.columns),f=n.settings.colHeaders;a=D.hooks.run(k,"modifyColHeader",a);if(void 0===a){a=[];f=b?k.countSourceCols():k.countCols();for(b=0;b<f;b++)a.push(k.getColHeader(b));f=a}else{b=a;a=D.hooks.run(k,"modifyCol",a);var e;e=a;for(var d=[],m=k.countSourceCols(),g=0;g<m;g++)Q(k.getSettings().columns)&&k.getSettings().columns(g)&&d.push(g);e=d[e];n.settings.columns&&Q(n.settings.columns)&&n.settings.columns(e)&&n.settings.columns(e).title?f=n.settings.columns(e).title:n.settings.columns&&n.settings.columns[a]&&n.settings.columns[a].title?f=n.settings.columns[a].title:Array.isArray(n.settings.colHeaders)&&void 0!==n.settings.colHeaders[a]?f=n.settings.colHeaders[a]:Q(n.settings.colHeaders)?f=n.settings.colHeaders(a):n.settings.colHeaders&&"string"!==typeof n.settings.colHeaders&&"number"!==typeof n.settings.colHeaders&&(f=Aa(b))}return f};this._getColWidthFromSettings=function(a){var b=k.getCellMeta(0,a),f=b.width;if(void 0===f||f===n.settings.width)f=b.colWidths;if(void 0!==f&&null!==f){switch(typeof f){case "object":f=f[a];break;case "function":f=f(a)}"string"===typeof f&&(f=parseInt(f,10))}return f};this.getColWidth=function(a){var b=k._getColWidthFromSettings(a),b=D.hooks.run(k,"modifyColWidth",b,a);void 0===b&&(b=Ea.DEFAULT_WIDTH);return b};this._getRowHeightFromSettings=function(a){var b=n.settings.rowHeights;if(void 0!==b&&null!==b){switch(typeof b){case "object":b=b[a];break;case "function":b=b(a)}"string"===typeof b&&(b=parseInt(b,10))}return b};this.getRowHeight=function(a){var b=k._getRowHeightFromSettings(a);return b=D.hooks.run(k,"modifyRowHeight",b,a)};this.countSourceRows=function(){return D.hooks.run(k,"modifySourceLength")||(k.getSourceData()?k.getSourceData().length:0)};this.countSourceCols=function(){var a=k.getSourceData()&&k.getSourceData()[0]?k.getSourceData()[0]:[];return oa(a)?T(a):a.length||0};this.countRows=function(){return h.getLength()};this.countCols=function(){var a=!1,b=0;"array"===k.dataType&&(a=n.settings.data&&n.settings.data[0]&&n.settings.data[0].length);a&&(b=n.settings.data[0].length);if(n.settings.columns)if(Q(n.settings.columns))if("array"===k.dataType){for(var f=a=0;f<b;f++)n.settings.columns(f)&&a++;b=a}else{if("object"===k.dataType||"function"===k.dataType)b=h.colToPropCache.length}else b=n.settings.columns.length;else if("object"===k.dataType||"function"===k.dataType)b=h.colToPropCache.length;return b};this.rowOffset=function(){return k.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return k.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return k.view.wt.drawn?k.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return k.view.wt.drawn?k.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return k.view.wt.drawn?k.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return k.view.wt.drawn?k.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(a){for(var b=k.countRows()-1,f=0,e;0<=b;){e=D.hooks.run(this,"modifyRow",b);if(k.isEmptyRow(e))f++;else if(a)break;b--}return f};this.countEmptyCols=function(a){if(1>k.countRows())return 0;for(var b=k.countCols()-1,f=0;0<=b;){if(k.isEmptyCol(b))f++;else if(a)break;b--}return f};this.isEmptyRow=function(a){return n.settings.isEmptyRow.call(k,a)};this.isEmptyCol=function(a){return n.settings.isEmptyCol.call(k,a)};this.selectCell=function(a,b,f,e,d,m){m=M(m)||!0===m;if("number"!==typeof a||0>a||a>=k.countRows()||"number"!==typeof b||0>b||b>=k.countCols()||R(f)&&("number"!==typeof f||0>f||f>=k.countRows()||"number"!==typeof e||0>e||e>=k.countCols()))return!1;a=new X(a,b);n.selRange=new Da(a,a,a);m&&k.listen();M(f)?u.setRangeEnd(n.selRange.from,d):u.setRangeEnd(new X(f,e),d);k.selection.finish();return!0};this.selectCellByProp=function(a,b,f,e,d){arguments[1]=h.propToCol(arguments[1]);R(arguments[3])&&(arguments[3]=h.propToCol(arguments[3]));return k.selectCell.apply(k,arguments)};this.deselectCell=function(){u.deselect()};this.scrollViewportTo=function(a,b,f,e){f=void 0!==f?f:!1;e=void 0!==e?e:!1;if(void 0!==a&&(0>a||a>=k.countRows())||void 0!==b&&(0>b||b>=k.countCols()))return!1;var d=!1;void 0!==a&&void 0!==b&&(k.view.wt.wtOverlays.topOverlay.scrollTo(a,f),k.view.wt.wtOverlays.leftOverlay.scrollTo(b,e),d=!0);"number"===typeof a&&"number"!==typeof b&&(k.view.wt.wtOverlays.topOverlay.scrollTo(a,f),d=!0);"number"===typeof b&&"number"!==typeof a&&(k.view.wt.wtOverlays.leftOverlay.scrollTo(b,e),d=!0);return d};this.destroy=function(){k._clearTimeouts();k.view&&k.view.destroy();l&&l.destroy();l=null;J(k.rootElement);x.destroy();D.hooks.run(k,"afterDestroy");D.hooks.destroy(k);for(var a in k)k.hasOwnProperty(a)&&(Q(k[a])?k[a]=g:"guid"!==a&&(k[a]=null));h&&h.destroy();y=k=v=u=t=n=h=null};this.getActiveEditor=function(){return v.getActiveEditor()};this.getPlugin=function(a){return la(this,a)};this.getInstance=function(){return k};this.addHook=function(a,b){D.hooks.add(a,b,k)};this.hasHook=function(a){return D.hooks.has(a,k)};this.addHookOnce=function(a,b){D.hooks.once(a,b,k)};this.removeHook=function(a,b){D.hooks.remove(a,b,k)};this.runHooks=function(a,b,f,e,d,m,g){return D.hooks.run(k,a,b,f,e,d,m,g)};this.timeouts=[];this._registerTimeout=function(a){this.timeouts.push(a)};this._clearTimeouts=function(){for(var a=0,b=this.timeouts.length;a<b;a++)clearTimeout(this.timeouts[a])};this.version=D.version;D.hooks.run(k,"construct")};var Sa=function(){};Sa.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1E3,copyColsLimit:1E3,pasteMode:"overwrite",persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(a){var b,f,e;b=0;for(f=this.countCols();b<f;b++)if(e=this.getDataAtCell(a,b),""!==e&&null!==e&&R(e))return"object"===typeof e?(a=this.getCellMeta(a,b),W(this.getSchema()[a.prop],e)):!1;return!0},isEmptyCol:function(a){var b,f,e;b=0;for(f=this.countRows();b<f;b++)if(e=this.getDataAtCell(b,a),""!==e&&null!==e&&R(e))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1};D.DefaultSettings=Sa},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,browser:24,dataMap:27,dataSource:28,editorManager:29,eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/dom/element":47,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,numbro:"numbro",plugins:62,renderers:118,tableView:127,"utils/recordTranslator":132}],27:[function(p,q,r){function k(a,b,f){var e=this;this.instance=a;this.priv=b;this.GridSettings=f;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=!1;this.latestSourceRowsCount=0;this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap();this.interval=B.create(function(){return e.clearLengthCache()},"15fps");this.instance.addHook("skipLengthCache",function(a){return e.onSkipLengthCache(a)});this.onSkipLengthCache(500)}Object.defineProperties(r,{DataMap:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g,e,n,m,a,b,f=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"],t=(h=p("SheetClip"),h&&h.__esModule&&h||{"default":h})["default"];q=(l=p("helpers/data"),l&&l.__esModule&&l||{"default":l}).cellMethodLookupFactory;var u=(g=p("helpers/setting"),g&&g.__esModule&&g||{"default":g}).columnFactory;l=(e=p("helpers/object"),e&&e.__esModule&&e||{"default":e});var v=l.createObjectPropListener,y=l.duckSchema,w=l.deepExtend,z=l.deepClone,x=l.isObject,C=l.deepObjectSize;e=(n=p("helpers/array"),n&&n.__esModule&&n||{"default":n});var E=e.extendArray,A=e.to2dArray,B=(m=p("utils/interval"),m&&m.__esModule&&m||{"default":m}).Interval,G=(a=p("helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach,D=(b=p("multiMap"),b&&b.__esModule&&b||{"default":b}).MultiMap;k.prototype.DESTINATION_RENDERER=1;k.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;k.prototype.recursiveDuckSchema=function(a){return y(a)};k.prototype.recursiveDuckColumns=function(a,b,f){var e,d;"undefined"===typeof b&&(b=0,f="");if("object"===typeof a&&!Array.isArray(a))for(d in a)a.hasOwnProperty(d)&&(null===a[d]?(e=f+d,this.colToPropCache.push(e),this.propToColCache.set(e,b),b++):b=this.recursiveDuckColumns(a[d],b,d+"."));return b};k.prototype.createMap=function(){var a;a=this.getSchema();if("undefined"===typeof a)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[];this.propToColCache=new D;var b=this.instance.getSettings().columns;if(b){var f=b.length,e=0,d=!1;a=C(a);"function"===typeof b&&(f=0<a?a:this.instance.countSourceCols(),d=!0);for(a=0;a<f;a++){var m=d?b(a):b[a];if(x(m)){if("undefined"!==typeof m.data){var g=d?e:a;this.colToPropCache[g]=m.data;this.propToColCache.set(m.data,g)}e++}}}else this.recursiveDuckColumns(a)};k.prototype.colToProp=function(a){a=f.hooks.run(this.instance,"modifyCol",a);return this.colToPropCache&&"undefined"!==typeof this.colToPropCache[a]?this.colToPropCache[a]:a};k.prototype.propToCol=function(a){a="undefined"===typeof this.propToColCache.get(a)?a:this.propToColCache.get(a);return a=f.hooks.run(this.instance,"unmodifyCol",a)};k.prototype.getSchema=function(){var a=this.instance.getSettings().dataSchema;return a?"function"===typeof a?a():a:this.duckSchema};k.prototype.createRow=function(a,b,e){var d,m=this.instance.countCols(),g=0,n;b||(b=1);if("number"!==typeof a||a>=this.instance.countSourceRows())a=this.instance.countSourceRows();f.hooks.run(this.instance,"beforeCreateRow",a,b,e);n=a;for(var h=this.instance.getSettings().maxRows;g<b&&this.instance.countSourceRows()<h;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?d=z(this.getSchema()):(d=[],G(m-1,function(){return d.push(null)})):"function"===this.instance.dataType?d=this.instance.getSettings().dataSchema(a):(d={},w(d,this.getSchema())),a===this.instance.countSourceRows()?this.dataSource.push(d):this.spliceData(a,0,d),g++,n++;f.hooks.run(this.instance,"afterCreateRow",a,g,e);this.instance.forceFullRender=!0;return g};k.prototype.createCol=function(a,b,e){if(!this.instance.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var d=this.instance.countSourceRows(),m=this.dataSource,g,n=0,h;b||(b=1);if("number"!==typeof a||a>=this.instance.countCols())a=this.instance.countCols();f.hooks.run(this.instance,"beforeCreateCol",a,b,e);h=a;for(var l=this.instance.getSettings().maxCols;n<b&&this.instance.countCols()<l;){g=u(this.GridSettings,this.priv.columnsSettingConflicts);if("number"!==typeof a||a>=this.instance.countCols()){if(0<d)for(var t=0;t<d;t++)"undefined"===typeof m[t]&&(m[t]=[]),m[t].push(null);else m.push([null]);this.priv.columnSettings.push(g)}else{for(t=0;t<d;t++)m[t].splice(h,0,null);this.priv.columnSettings.splice(h,0,g)}n++;h++}f.hooks.run(this.instance,"afterCreateCol",a,n,e);this.instance.forceFullRender=!0;return n};k.prototype.removeRow=function(a,b,e){b||(b=1);"number"!==typeof a&&(a=-b);b=f.hooks.run(this.instance,"modifyRemovedAmount",b,a);a=(this.instance.countSourceRows()+a)%this.instance.countSourceRows();var d=this.physicalRowsToLogical(a,b);if(!1!==f.hooks.run(this.instance,"beforeRemoveRow",a,b,d,e)){var m=this.dataSource,g;if(g=this.filterData(a,b))m.length=0,Array.prototype.push.apply(m,g);f.hooks.run(this.instance,"afterRemoveRow",a,b,d,e);this.instance.forceFullRender=!0}};k.prototype.removeCol=function(a,b,e){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw Error("cannot remove column with object data source or columns option specified");b||(b=1);"number"!==typeof a&&(a=-b);a=(this.instance.countCols()+a)%this.instance.countCols();var d=this.physicalColumnsToLogical(a,b),m=d.slice(0).sort(function(a,b){return b-a});if(!1!==f.hooks.run(this.instance,"beforeRemoveCol",a,b,d,e)){for(var g=!0,n=m.length,h=this.dataSource,l=0;l<n;l++)g&&d[0]!==d[l]-l&&(g=!1);if(g)for(n=0,m=this.instance.countSourceRows();n<m;n++)h[n].splice(d[0],b);else{g=0;for(l=this.instance.countSourceRows();g<l;g++)for(var t=0;t<n;t++)h[g].splice(m[t],1);for(h=0;h<n;h++)this.priv.columnSettings.splice(d[h],1)}f.hooks.run(this.instance,"afterRemoveCol",a,b,d,e);this.instance.forceFullRender=!0}};k.prototype.spliceCol=function(a,b,f){var e=4<=arguments.length?[].slice.call(arguments,3):[],d=this.instance.getDataAtCol(a),m=d.slice(b,b+f),d=d.slice(b+f);E(e,d);for(d=0;d<f;)e.push(null),d++;A(e);this.instance.populateFromArray(b,a,e,null,null,"spliceCol");return m};k.prototype.spliceRow=function(a,b,f){var e=4<=arguments.length?[].slice.call(arguments,3):[],d=this.instance.getSourceDataAtRow(a),m=d.slice(b,b+f),d=d.slice(b+f);E(e,d);for(d=0;d<f;)e.push(null),d++;this.instance.populateFromArray(a,b,[e],null,null,"spliceRow");return m};k.prototype.spliceData=function(a,b,e){!1!==f.hooks.run(this.instance,"beforeDataSplice",a,b,e)&&this.dataSource.splice(a,b,e)};k.prototype.filterData=function(a,b){var e=this.physicalRowsToLogical(a,b);if(!1!==f.hooks.run(this.instance,"beforeDataFilter",a,b,e))return this.dataSource.filter(function(a,b){return-1==e.indexOf(b)})};k.prototype.get=function(a,b){a=f.hooks.run(this.instance,"modifyRow",a);var e=this.dataSource[a],d=f.hooks.run(this.instance,"modifyRowData",a),e=isNaN(d)?d:e,d=null;if(e&&e.hasOwnProperty&&e.hasOwnProperty(b))d=e[b];else if("string"===typeof b&&-1<b.indexOf(".")){d=b.split(".");if(!e)return null;for(var m=0,g=d.length;m<g;m++)if(e=e[d[m]],"undefined"===typeof e)return null;d=e}else"function"===typeof b&&(d=b(this.dataSource.slice(a,a+1)[0]));f.hooks.has("modifyData",this.instance)&&(e=v(d),f.hooks.run(this.instance,"modifyData",a,this.propToCol(b),e,"get"),e.isTouched()&&(d=e.value));return d};var F=q("copyable",!1);k.prototype.getCopyable=function(a,b){return F.call(this.instance,a,this.propToCol(b))?this.get(a,b):""};k.prototype.set=function(a,b,e,d){a=f.hooks.run(this.instance,"modifyRow",a,d||"datamapGet");d=this.dataSource[a];var m=f.hooks.run(this.instance,"modifyRowData",a);d=isNaN(m)?m:d;f.hooks.has("modifyData",this.instance)&&(m=v(e),f.hooks.run(this.instance,"modifyData",a,this.propToCol(b),m,"set"),m.isTouched()&&(e=m.value));if(d&&d.hasOwnProperty&&d.hasOwnProperty(b))d[b]=e;else if("string"===typeof b&&-1<b.indexOf(".")){a=b.split(".");b=d;d=0;for(m=a.length-1;d<m;d++)"undefined"===typeof b[a[d]]&&(b[a[d]]={}),b=b[a[d]];b[a[d]]=e}else"function"===typeof b?b(this.dataSource.slice(a,a+1)[0],e):d[b]=e};k.prototype.physicalRowsToLogical=function(a,b){for(var e=this.instance.countSourceRows(),d=(e+a)%e,m=[],g=b,n;d<e&&g;)n=f.hooks.run(this.instance,"modifyRow",d),m.push(n),g--,d++;return m};k.prototype.physicalColumnsToLogical=function(a,b){for(var e=this.instance.countCols(),d=(e+a)%e,m=[],g=b;d<e&&g;){var n=f.hooks.run(this.instance,"modifyCol",d);m.push(n);g--;d++}return m};k.prototype.clear=function(){for(var a=0;a<this.instance.countSourceRows();a++)for(var b=0;b<this.instance.countCols();b++)this.set(a,this.colToProp(b),"")};k.prototype.clearLengthCache=function(){this.cachedLength=null};k.prototype.getLength=function(){var a=this,b;b=this.instance.getSettings().maxRows;b=0>b||0===b?0:b||Infinity;var e=this.instance.countSourceRows();if(f.hooks.has("modifyRow",this.instance)){var d=this.skipCache;this.interval.start();e!==this.latestSourceRowsCount&&(d=!0);this.latestSourceRowsCount=e;null===this.cachedLength||d?(G(e-1,function(b){b=f.hooks.run(a.instance,"modifyRow",b);null===b&&--e}),this.cachedLength=e):e=this.cachedLength}else this.interval.stop();return Math.min(e,b)};k.prototype.getAll=function(){var a={row:0,col:0},b=this.instance.getSettings().maxRows;if(0===b)return[];b={row:Math.min(Math.max(b-1,0),Math.max(this.instance.countSourceRows()-1,0)),col:Math.max(this.instance.countCols()-1,0)};return 0!==a.row-b.row||this.instance.countSourceRows()?this.getRange(a,b,k.prototype.DESTINATION_RENDERER):[]};k.prototype.getRange=function(a,b,e){var d,m,g,n=[],h,l=e===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;d=Math.max(a.row,b.row);g=Math.max(a.col,b.col);for(e=Math.min(a.row,b.row);e<=d;e++){h=[];var t=f.hooks.run(this.instance,"modifyRow",e);for(m=Math.min(a.col,b.col);m<=g&&null!==t;m++)h.push(l.call(this,e,this.colToProp(m)));null!==t&&n.push(h)}return n};k.prototype.getText=function(a,b){return t.stringify(this.getRange(a,b,this.DESTINATION_RENDERER))};k.prototype.getCopyableText=function(a,b){return t.stringify(this.getRange(a,b,this.DESTINATION_CLIPBOARD_GENERATOR))};k.prototype.onSkipLengthCache=function(a){var b=this;this.skipCache=!0;setTimeout(function(){b.skipCache=!1},a)};k.prototype.destroy=function(){this.interval.stop();this.duckSchema=this.cachedLength=this.dataSource=this.GridSettings=this.priv=this.instance=this.interval=null}},{SheetClip:"SheetClip",browser:24,"helpers/array":43,"helpers/data":45,"helpers/number":52,"helpers/object":53,"helpers/setting":54,multiMap:60,"utils/interval":131}],28:[function(p,q,r){Object.defineProperties(r,{DataSource:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l=(k=p("helpers/object"),k&&k.__esModule&&k||{"default":k}).getProperty,g=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,e=(h=p("helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,n=function(e,a){var b=void 0!==a?a:[];this.hot=e;this.data=b;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}};$traceurRuntime.createClass(n,{getData:function(e){var a=this.data;void 0!==e&&e&&(a=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0));return a},setData:function(e){this.data=e},getAtColumn:function(e){var a=this,b=[];g(this.data,function(f){var d=a.colToProp(e);f="string"===typeof d?l(f,d):f[d];b.push(f)});return b},getAtRow:function(e){return this.data[e]},getAtCell:function(e,a){var b=null,f=this.hot.runHooks("modifyRowData",e);if(f=isNaN(f)?f:this.data[e])b=this.colToProp(a),b="string"===typeof b?l(f,b):"function"===typeof b?b(this.data.slice(e,e+1)[0]):f[b];return b},getByRange:function(d,a,b){var f=void 0!==b?b:!1,m=this,g=Math.min(d.col,a.col),n=Math.max(d.col,a.col),h=[];e(Math.min(d.row,a.row),Math.max(d.row,a.row),function(a){var b=m.getAtRow(a),d;"array"===m.dataType?d=b.slice(g,n+1):"object"===m.dataType&&(d=f?[]:{},e(g,n,function(a){a=m.colToProp(a);f?d.push(b[a]):d[a]=b[a]}));h.push(d)});return h},countRows:function(){return Array.isArray(this.data)?this.data.length:0},countColumns:function(){var e=0;Array.isArray(this.data)&&("array"===this.dataType?e=this.data[0].length:"object"===this.dataType&&(e=Object.keys(this.data[0]).length));return e},destroy:function(){this.hot=this.data=null}},{})},{"helpers/array":43,"helpers/number":52,"helpers/object":53}],29:[function(p,q,r){function k(e,d,g){function h(a){g.setSelectedHeaders(!1,!1,!1);var b="function"===typeof d.settings.enterMoves?d.settings.enterMoves(event):d.settings.enterMoves;a?g.transformStart(-b.row,-b.col):g.transformStart(b.row,b.col,!0)}function l(l){var y,z;if(e.isListening()&&(n.hooks.run(e,"beforeKeyDown",l),!x&&!v(l)&&(d.lastKeyCode=l.keyCode,g.isSelected())))if(y=(l.ctrlKey||l.metaKey)&&!l.altKey,!w||w.isWaiting()||b(l.keyCode)||f(l.keyCode)||y||k.isEditorOpened())switch(z=l.shiftKey?g.setRangeEnd:g.setRangeStart,l.keyCode){case a.A:!k.isEditorOpened()&&y&&(g.selectAll(),l.preventDefault(),t(l));break;case a.ARROW_UP:k.isEditorOpened()&&!w.isWaiting()&&k.closeEditorAndSaveChanges(y);l.shiftKey?(g.selectedHeader.cols&&g.setSelectedHeaders(g.selectedHeader.rows,!1,!1),g.transformEnd(-1,0)):(g.setSelectedHeaders(!1,!1,!1),g.transformStart(-1,0));l.preventDefault();t(l);break;case a.ARROW_DOWN:k.isEditorOpened()&&!w.isWaiting()&&k.closeEditorAndSaveChanges(y);l.shiftKey?g.transformEnd(1,0):(g.setSelectedHeaders(!1,!1,!1),g.transformStart(1,0));l.preventDefault();t(l);break;case a.ARROW_RIGHT:k.isEditorOpened()&&!w.isWaiting()&&k.closeEditorAndSaveChanges(y);l.shiftKey?g.transformEnd(0,1):(g.setSelectedHeaders(!1,!1,!1),g.transformStart(0,1));l.preventDefault();t(l);break;case a.ARROW_LEFT:k.isEditorOpened()&&!w.isWaiting()&&k.closeEditorAndSaveChanges(y);l.shiftKey?(g.selectedHeader.rows&&g.setSelectedHeaders(!1,g.selectedHeader.cols,!1),g.transformEnd(0,-1)):(g.setSelectedHeaders(!1,!1,!1),g.transformStart(0,-1));l.preventDefault();t(l);break;case a.TAB:g.setSelectedHeaders(!1,!1,!1);y="function"===typeof d.settings.tabMoves?d.settings.tabMoves(l):d.settings.tabMoves;l.shiftKey?g.transformStart(-y.row,-y.col):g.transformStart(y.row,y.col,!0);l.preventDefault();t(l);break;case a.BACKSPACE:case a.DELETE:g.empty(l);k.prepareEditor();l.preventDefault();break;case a.F2:k.openEditor(null,l);w&&w.enableFullEditMode();l.preventDefault();break;case a.ENTER:k.isEditorOpened()?(w&&w.state!==n.EditorState.WAITING&&k.closeEditorAndSaveChanges(y),h(l.shiftKey)):e.getSettings().enterBeginsEditing?(k.openEditor(null,l),w&&w.enableFullEditMode()):h(l.shiftKey);l.preventDefault();u(l);break;case a.ESCAPE:k.isEditorOpened()&&k.closeEditorAndRestoreOriginalValue(y);l.preventDefault();break;case a.HOME:g.setSelectedHeaders(!1,!1,!1);l.ctrlKey||l.metaKey?z(new m(0,d.selRange.from.col)):z(new m(d.selRange.from.row,0));l.preventDefault();t(l);break;case a.END:g.setSelectedHeaders(!1,!1,!1);l.ctrlKey||l.metaKey?z(new m(e.countRows()-1,d.selRange.from.col)):z(new m(d.selRange.from.row,e.countCols()-1));l.preventDefault();t(l);break;case a.PAGE_UP:g.setSelectedHeaders(!1,!1,!1);g.transformStart(-e.countVisibleRows(),0);l.preventDefault();t(l);break;case a.PAGE_DOWN:g.setSelectedHeaders(!1,!1,!1),g.transformStart(e.countVisibleRows(),0),l.preventDefault(),t(l)}else k.openEditor("",l)}var k=this,x=!1,z,w;z=y(e);this.destroyEditor=function(a){this.closeEditor(a)};this.getActiveEditor=function(){return w};this.prepareEditor=function(){var a,b,f,g,m,h,l;w&&w.isWaiting()?this.closeEditor(!1,!1,function(a){a&&k.prepareEditor()}):(a=d.selRange.highlight.row,b=d.selRange.highlight.col,f=e.colToProp(b),g=e.getCell(a,b),m=e.getSourceDataAtCell(e.runHooks("modifyRow",a),b),h=e.getCellMeta(a,b),(l=e.getCellEditor(h))?(w=n.editors.getEditor(l,e),w.prepare(a,b,f,g,m,h)):w=void 0)};this.isEditorOpened=function(){return w&&w.isOpened()};this.openEditor=function(b,f){w&&!w.cellProperties.readOnly?w.beginEditing(b,f):w&&w.cellProperties.readOnly&&f&&f.keyCode===a.ENTER&&h()};this.closeEditor=function(a,b,f){w?w.finishEditing(a,b,f):f&&f(!1)};this.closeEditorAndSaveChanges=function(a){return this.closeEditor(!1,a)};this.closeEditorAndRestoreOriginalValue=function(a){return this.closeEditor(!0,a)};(function(){e.addHook("afterDocumentKeyDown",l);z.addEventListener(document.documentElement,"keydown",function(a){x||e.runHooks("afterDocumentKeyDown",a)});e.view.wt.update("onCellDblClick",function(a,b,f){"TD"==f.nodeName&&(k.openEditor(),w&&w.enableFullEditMode())});e.addHook("afterDestroy",function(){x=!0})})()}Object.defineProperties(r,{EditorManager:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g,e,n=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"],m=(h=p("3rdparty/walkontable/src/cell/coords"),h&&h.__esModule&&h||{"default":h}).WalkontableCellCoords;q=(l=p("helpers/unicode"),l&&l.__esModule&&l||{"default":l});var a=q.KEY_CODES,b=q.isMetaKey,f=q.isCtrlKey;l=(g=p("helpers/dom/event"),g&&g.__esModule&&g||{"default":g});var t=l.stopPropagation,u=l.stopImmediatePropagation,v=l.isImmediatePropagationStopped;p("editors");var y=(e=p("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager;n.EditorManager=k},{"3rdparty/walkontable/src/cell/coords":6,browser:24,editors:30,eventManager:42,"helpers/dom/event":48,"helpers/unicode":56}],30:[function(p,q,r){function k(a){var b;b={};this.getConstructor=function(){return a};this.getInstance=function(f){f.guid in b||(b[f.guid]=new a(f));return b[f.guid]};m.hooks.add("afterDestroy",function(){b={}})}function d(e,d){var g=new k(d);"string"===typeof e&&(b[e]=g,m.editors[a(e)+"Editor"]=d);f.set(d,g)}function h(a,e){var g;if("function"==typeof a)f.get(a)||d(null,a),g=f.get(a);else if("string"==typeof a)g=b[a];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!g)throw Error('No editor registered under name "'+a+'"');return g.getInstance(e)}function l(a){var f;if("string"==typeof a)f=b[a];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!f)throw Error('No editor registered under name "'+a+'"');return f.getConstructor()}function g(a){return b[a]?!0:!1}Object.defineProperties(r,{registerEditor:{get:function(){return d}},getEditor:{get:function(){return h}},hasEditor:{get:function(){return g}},getEditorConstructor:{get:function(){return l}},__esModule:{value:!0}});var e,n,m=(e=p("browser"),e&&e.__esModule&&e||{"default":e})["default"],a=(n=p("helpers/string"),n&&n.__esModule&&n||{"default":n}).toUpperCaseFirst,b={},f=new WeakMap;m.editors=m.editors||{};m.editors.registerEditor=d;m.editors.getEditor=h},{browser:24,"helpers/string":55}],31:[function(p,q,r){function k(e){this.instance=e;this.state=g.EditorState.VIRGIN;this._fullEditMode=this._opened=!1;this._closeCallback=null;this.init()}Object.defineProperties(r,{BaseEditor:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"],e=(h=p("helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,n=(l=p("3rdparty/walkontable/src/cell/coords"),l&&l.__esModule&&l||{"default":l}).WalkontableCellCoords;g.editors=g.editors||{};g.editors.BaseEditor=k;g.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};k.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)};k.prototype.init=function(){};k.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};k.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented");};k.prototype.open=function(){throw Error("Editor open() method unimplemented");};k.prototype.close=function(){throw Error("Editor close() method unimplemented");};k.prototype.prepare=function(e,a,b,f,d,n){this.TD=f;this.row=e;this.col=a;this.prop=b;this.originalValue=d;this.cellProperties=n;e=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body&&!e?document.activeElement.blur():e&&document.body.focus();this.state=g.EditorState.VIRGIN};k.prototype.extend=function(){var e=this.constructor;return function(a,b){function f(){}f.prototype=b.prototype;a.prototype=new f;return a.prototype.constructor=a}(function(){e.apply(this,arguments)},e)};k.prototype.saveValue=function(e,a){var b,f;a?(b=this.instance.getSelected(),b[0]>b[2]&&(f=b[0],b[0]=b[2],b[2]=f),b[1]>b[3]&&(f=b[1],b[1]=b[3],b[3]=f)):b=[this.row,this.col,null,null];this.instance.populateFromArray(b[0],b[1],e,b[2],b[3],"edit")};k.prototype.beginEditing=function(d,a){this.state==g.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new n(this.row,this.col)),this.instance.view.render(),this.state=g.EditorState.EDITING,d="string"==typeof d?d:this.originalValue,this.setValue(e(d)),this.open(a),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))};k.prototype.finishEditing=function(e,a,b){var f=this;if(b){var d=this._closeCallback;this._closeCallback=function(a){d&&d(a);b(a);f.instance.view.render()}}this.isWaiting()||(this.state==g.EditorState.VIRGIN?this.instance._registerTimeout(setTimeout(function(){f._fireCallbacks(!0)},0)):this.state==g.EditorState.EDITING&&(e?(this.cancelChanges(),this.instance.view.render()):(e=this.getValue(),e=this.instance.getSettings().trimWhitespace?[["string"===typeof e?String.prototype.trim.call(e||""):e]]:[[e]],this.state=g.EditorState.WAITING,this.saveValue(e,a),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(a){f.state=g.EditorState.FINISHED;f.discardEditor(a)}):(this.state=g.EditorState.FINISHED,this.discardEditor(!0)))))};k.prototype.cancelChanges=function(){this.state=g.EditorState.FINISHED;this.discardEditor()};k.prototype.discardEditor=function(e){this.state===g.EditorState.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=g.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._fullEditMode=this._opened=!1,this.state=g.EditorState.VIRGIN,this._fireCallbacks(!0)))};k.prototype.enableFullEditMode=function(){this._fullEditMode=!0};k.prototype.isInFullEditMode=function(){return this._fullEditMode};k.prototype.isOpened=function(){return this._opened};k.prototype.isWaiting=function(){return this.state===g.EditorState.WAITING};k.prototype.checkEditorSection=function(){var e=this.instance.countRows(),a="";this.row<this.instance.getSettings().fixedRowsTop?a=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom?a=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(a="left");return a}},{"3rdparty/walkontable/src/cell/coords":6,browser:24,"helpers/mixed":51}],32:[function(p,q,r){function k(f){H=!1;var e=this.getActiveEditor();if(b(f.keyCode)||f.keyCode===a.BACKSPACE||f.keyCode===a.DELETE||f.keyCode===a.INSERT){var d=0;if(f.keyCode!==a.C||!f.ctrlKey&&!f.metaKey)e.isOpened()||(d+=10),e.htEditor&&e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value);H=!0},d))}}Object.defineProperties(r,{AutocompleteEditor:{get:function(){return F}},__esModule:{value:!0}});var d,h,l,g,e,n,m;q=(d=p("helpers/unicode"),d&&d.__esModule&&d||{"default":d});var a=q.KEY_CODES,b=q.isPrintableChar,f=(h=p("helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,t=(l=p("helpers/string"),l&&l.__esModule&&l||{"default":l}).stripTags;d=(g=p("helpers/array"),g&&g.__esModule&&g||{"default":g});var u=d.pivot,v=d.arrayMap;g=(e=p("helpers/dom/element"),e&&e.__esModule&&e||{"default":e});var y=g.addClass,w=g.getCaretPosition,z=g.getScrollbarWidth,x=g.getSelectionEndPosition,C=g.outerWidth,E=g.outerHeight,A=g.offset,B=g.getTrimmingContainer,G=g.setCaretPosition;e=(n=p("editors"),n&&n.__esModule&&n||{"default":n}).registerEditor;var D=(m=p("handsontableEditor"),m&&m.__esModule&&m||{"default":m}).HandsontableEditor,F=D.prototype.extend();F.prototype.init=function(){D.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};F.prototype.createElements=function(){D.prototype.createElements.apply(this,arguments);y(this.htContainer,"autocompleteEditor");y(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var H=!1;F.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",k);D.prototype.prepare.apply(this,arguments)};F.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto";D.prototype.open.apply(this,arguments);this.TEXTAREA_PARENT.style.overflow="";var a=this.htEditor.getInstance(),b=this,e=void 0===this.cellProperties.trimDropdown?!0:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible";this.focus();a.updateSettings({colWidths:e?[C(this.TEXTAREA)-2]:void 0,width:e?C(this.TEXTAREA)+z()+2:void 0,afterRenderer:function(a,e,d,g,m,n){d=b.cellProperties;e=d.filteringCaseSensitive;d=d.allowHtml;(m=f(m))&&!d&&(e=!0===e?m.indexOf(this.query):m.toLowerCase().indexOf(b.query.toLowerCase()),-1!==e&&(e=m.substr(e,b.query.length),m=m.replace(e,"\x3cstrong\x3e"+e+"\x3c/strong\x3e")));a.innerHTML=m},autoColumnSize:!0,modifyColWidth:function(a,b){var f=this.getPlugin("autoColumnSize").widths;f[b]&&(a=f[b]);return e?a:a+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=z()+2+"px";H&&(H=!1);b.instance._registerTimeout(setTimeout(function(){b.queryChoices(b.TEXTAREA.value)},0))};F.prototype.close=function(){D.prototype.close.apply(this,arguments)};F.prototype.queryChoices=function(a){var b=this;this.query=a;var f=this.cellProperties,e=f.source,d=f.allowHtml,g=function(a){return v(a,function(a){return t(a)})};"function"==typeof e?e.call(this.cellProperties,a,function(a){b.updateChoicesList(d?a:g(a))}):Array.isArray(e)?this.updateChoicesList(d?e:g(e)):this.updateChoicesList([])};F.prototype.updateChoicesList=function(a){var b=w(this.TEXTAREA),f=x(this.TEXTAREA),e=this.cellProperties.sortByRelevance,d=this.cellProperties.filter,g=null,m=null;e&&(g=F.sortByRelevance(this.getValue(),a,this.cellProperties.filteringCaseSensitive));var n=Array.isArray(g)?g.length:0;if(!1===d)n&&(m=g[0]);else{for(var d=[],m=0,h=a.length;m<h&&!(e&&n<=m);m++)n?d.push(a[g[m]]):d.push(a[m]);m=0;a=d}this.choices=a;this.htEditor.loadData(u([a]));this.updateDropdownHeight();this.flipDropdownIfNeeded();!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(m);this.instance.listen();this.TEXTAREA.focus();G(this.TEXTAREA,b,b===f?void 0:f)};F.prototype.flipDropdownIfNeeded=function(){var a=A(this.TEXTAREA),b=E(this.TEXTAREA),f=this.getDropdownHeight(),e=B(this.instance.view.wt.wtTable.TABLE),d=e.scrollTop,g=E(this.instance.view.wt.wtTable.THEAD),m={row:0,col:0};e!==window&&(m=A(e));a=a.top-m.top-g+d;b=e.scrollHeight-a-g-b;(e=f>b&&a>b)?this.flipDropdown(f):this.unflipDropdown();this.limitDropdownIfNeeded(e?a:b,f);return e};F.prototype.limitDropdownIfNeeded=function(a,b){if(b>a){var f=0,e=0,d;do d=this.htEditor.getRowHeight(e)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,f+=d,e++;while(f<a);e=f-d;this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+b-e+"px");this.setDropdownHeight(f-d)}};F.prototype.flipDropdown=function(a){var b=this.htEditor.rootElement.style;b.position="absolute";b.top=-a+"px";this.htEditor.flipped=!0};F.prototype.unflipDropdown=function(){var a=this.htEditor.rootElement.style;"absolute"===a.position&&(a.position="",a.top="");this.htEditor.flipped=void 0};F.prototype.updateDropdownHeight=function(){var a=this.htEditor.getColWidth(0)+z()+2,b=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:b?void 0:a});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};F.prototype.setDropdownHeight=function(a){this.htEditor.updateSettings({height:a})};F.prototype.finishEditing=function(a){a||this.instance.removeHook("beforeKeyDown",k);D.prototype.finishEditing.apply(this,arguments)};F.prototype.highlightBestMatchingChoice=function(a){"number"===typeof a?this.htEditor.selectCell(a,0):this.htEditor.deselectCell()};F.sortByRelevance=function(a,b,e){var d=[],g,m=a.length,n,h,l=[],k,u=b.length;if(0===m){for(k=0;k<u;k++)l.push(k);return l}for(k=0;k<u;k++)g=t(f(b[k])),n=e?g.indexOf(a):g.toLowerCase().indexOf(a.toLowerCase()),-1!=n&&(h=g.length-n-m,d.push({baseIndex:k,index:n,charsLeft:h,value:g}));d.sort(function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index)return a.charsLeft<b.charsLeft?-1:a.charsLeft>b.charsLeft?1:0});k=0;for(u=d.length;k<u;k++)l.push(d[k].baseIndex);return l};F.prototype.getDropdownHeight=function(){var a=this.htEditor.getInstance().getRowHeight(0)||23,b=this.cellProperties.visibleRows;return this.choices.length>=b?b*a:this.choices.length*a+8};F.prototype.allowKeyEventPropagation=function(b){var f=this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1,e=!1;b===a.ARROW_DOWN&&0<f&&f<this.htEditor.countRows()-1&&(e=!0);b===a.ARROW_UP&&-1<f&&(e=!0);return e};F.prototype.discardEditor=function(a){D.prototype.discardEditor.apply(this,arguments);this.instance.view.render()};e("autocomplete",F)},{editors:30,handsontableEditor:36,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/string":55,"helpers/unicode":56}],33:[function(p,q,r){Object.defineProperties(r,{CheckboxEditor:{get:function(){return g}},__esModule:{value:!0}});var k,d,h;q=(k=p("editors"),k&&k.__esModule&&k||{"default":k}).registerEditor;k=(d=p("_baseEditor"),d&&d.__esModule&&d||{"default":d}).BaseEditor;var l=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).hasClass,g=function(){$traceurRuntime.superConstructor(e).apply(this,arguments)},e=g;$traceurRuntime.createClass(g,{beginEditing:function(e,d){if(void 0===d){var a=this.TD.querySelector('input[type\x3d"checkbox"]');l(a,"htBadValue")||a.click()}},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},k);q("checkbox",g)},{_baseEditor:31,editors:30,"helpers/dom/element":47}],34:[function(p,q,r){Object.defineProperties(r,{DateEditor:{get:function(){return C}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var f=k.addClass,t=k.outerHeight,u=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).deepExtend,v=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;d=(g=p("editors"),g&&g.__esModule&&g||{"default":g}).registerEditor;var y=(e=p("helpers/unicode"),e&&e.__esModule&&e||{"default":e}).isMetaKey,w=(n=p("helpers/dom/event"),n&&n.__esModule&&n||{"default":n}).stopPropagation;g=(m=p("textEditor"),m&&m.__esModule&&m||{"default":m}).TextEditor;var z=(a=p("moment"),a&&a.__esModule&&a||{"default":a})["default"],x=(b=p("pikaday"),b&&b.__esModule&&b||{"default":b})["default"],C=function(a){this.datePickerStyle=this.datePicker=this.$datePicker=null;this.defaultDateFormat="DD/MM/YYYY";this.parentDestroyed=this.isCellEdited=!1;$traceurRuntime.superConstructor(E).call(this,a)},E=C;$traceurRuntime.createClass(C,{init:function(){var a=this;if("function"!==typeof z)throw Error("You need to include moment.js to your project.");if("function"!==typeof x)throw Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,E.prototype,"init").call(this);this.instance.addHook("afterDestroy",function(){a.parentDestroyed=!0;a.destroyElements()})},createElements:function(){$traceurRuntime.superGet(this,E.prototype,"createElements").call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;f(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);this.$datePicker=new x(this.getDatePickerConfig());(new v(this)).addEventListener(this.datePicker,"mousedown",function(a){return w(a)});this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(a,b,f,e,d,g){this._opened=!1;$traceurRuntime.superGet(this,E.prototype,"prepare").call(this,a,b,f,e,d,g)},open:function(a){a=void 0!==a?a:null;$traceurRuntime.superGet(this,E.prototype,"open").call(this);this.showDatepicker(a)},close:function(){var a=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){a.instance.selection.refreshBorders()},0));$traceurRuntime.superGet(this,E.prototype,"close").call(this)},finishEditing:function(a,b){var f=void 0!==a?a:!1,e=void 0!==b?b:!1;if(f){var d=this.originalValue;void 0!==d&&this.setValue(d)}this.hideDatepicker();$traceurRuntime.superGet(this,E.prototype,"finishEditing").call(this,f,e)},showDatepicker:function(a){this.$datePicker.config(this.getDatePickerConfig());var b=this.TD.getBoundingClientRect(),f=this.cellProperties.dateFormat||this.defaultDateFormat,e=this.$datePicker.config(),d=this.instance.view.isMouseDown();a=a?y(a.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+b.top+t(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+b.left+"px";this.$datePicker._onInputFocus=function(){};e.format=f;this.originalValue?(b=this.originalValue,z(b,f,!0).isValid()&&this.$datePicker.setMoment(z(b,f),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||d||this.setValue("")):this.cellProperties.defaultDate?(b=this.cellProperties.defaultDate,e.defaultDate=b,z(b,f,!0).isValid()&&this.$datePicker.setMoment(z(b,f),!0),a||d||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none";this.$datePicker.hide()},getDatePickerConfig:function(){var a=this,b=this.TEXTAREA,f={};this.cellProperties&&this.cellProperties.datePickerConfig&&u(f,this.cellProperties.datePickerConfig);var e=f.onSelect,d=f.onClose;f.field=b;f.trigger=b;f.container=this.datePicker;f.bound=!1;f.format=f.format||this.defaultDateFormat;f.reposition=f.reposition||!1;f.onSelect=function(b){isNaN(b.getTime())||(b=z(b).format(a.cellProperties.dateFormat||a.defaultDateFormat));a.setValue(b);a.hideDatepicker();e&&e()};f.onClose=function(){a.parentDestroyed||a.finishEditing(!1);d&&d()};return f}},{},g);q.editors=q.editors||{};q.editors.DateEditor=C;d("date",C)},{browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,moment:"moment",pikaday:"pikaday",textEditor:41}],35:[function(p,q,r){Object.defineProperties(r,{DropdownEditor:{get:function(){return g}},__esModule:{value:!0}});var k,d,h,l=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("editors"),d&&d.__esModule&&d||{"default":d}).registerEditor;p=(h=p("autocompleteEditor"),h&&h.__esModule&&h||{"default":h}).AutocompleteEditor;var g=function(){$traceurRuntime.superConstructor(e).apply(this,arguments)},e=g;$traceurRuntime.createClass(g,{prepare:function(d,g,a,b,f,h){$traceurRuntime.superGet(this,e.prototype,"prepare").call(this,d,g,a,b,f,h);this.cellProperties.filter=!1;this.cellProperties.strict=!0}},{},p);l.hooks.add("beforeValidate",function(e,d,a,b){e=this.getCellMeta(d,this.propToCol(a));e.editor===l.editors.DropdownEditor&&void 0===e.strict&&(e.filter=!1,e.strict=!0)});q("dropdown",g)},{autocompleteEditor:32,browser:24,editors:30}],36:[function(p,q,r){Object.defineProperties(r,{HandsontableEditor:{get:function(){return y}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"],a=(d=p("helpers/unicode"),d&&d.__esModule&&d||{"default":d}).KEY_CODES,b=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).extend,f=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).setCaretPosition;q=(g=p("helpers/dom/event"),g&&g.__esModule&&g||{"default":g});var t=q.stopImmediatePropagation,u=q.isImmediatePropagationStopped;g=(e=p("editors"),e&&e.__esModule&&e||{"default":e}).registerEditor;var v=(n=p("textEditor"),n&&n.__esModule&&n||{"default":n}).TextEditor,y=v.prototype.extend();y.prototype.createElements=function(){v.prototype.createElements.apply(this,arguments);var a=document.createElement("DIV");a.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(a);this.htContainer=a;this.assignHooks()};y.prototype.prepare=function(a,f,e,d,g,m){v.prototype.prepare.apply(this,arguments);var n=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(){var a=this.getValue();void 0!==a&&n.setValue(a);n.instance.destroyEditor()}};this.cellProperties.handsontable&&b(h,m.handsontable);this.htOptions=h};var w=function(b){if(!u(b)){var f=this.getActiveEditor(),e=f.htEditor.getInstance(),d;if(b.keyCode==a.ARROW_DOWN)if(!e.getSelected()&&!e.flipped)d=0;else{if(e.getSelected())if(e.flipped)d=e.getSelected()[0]+1;else if(!e.flipped){d=e.getSelected()[0];var g=e.countRows()-1;d=Math.min(g,d+1)}}else b.keyCode==a.ARROW_UP&&(!e.getSelected()&&e.flipped?d=e.countRows()-1:e.getSelected()&&(e.flipped?(d=e.getSelected()[0],d=Math.max(0,d-1)):(d=e.getSelected()[0],--d)));void 0!==d&&(0>d||e.flipped&&d>e.countRows()-1?e.deselectCell():e.selectCell(d,0),e.getData().length&&(b.preventDefault(),t(b),f.instance.listen(),f.TEXTAREA.focus()))}};y.prototype.open=function(){this.instance.addHook("beforeKeyDown",w);v.prototype.open.apply(this,arguments);this.htEditor&&this.htEditor.destroy();this.htEditor=new m(this.htContainer,this.htOptions);this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");f(this.TEXTAREA,0,this.TEXTAREA.value.length)};y.prototype.close=function(){this.instance.removeHook("beforeKeyDown",w);this.instance.listen();v.prototype.close.apply(this,arguments)};y.prototype.focus=function(){this.instance.listen();v.prototype.focus.apply(this,arguments)};y.prototype.beginEditing=function(a){var b=this.instance.getSettings().onBeginEditing;b&&!1===b()||v.prototype.beginEditing.apply(this,arguments)};y.prototype.finishEditing=function(a,b){this.htEditor&&this.htEditor.isListening()&&this.instance.listen();if(this.htEditor&&this.htEditor.getSelected()){var f=this.htEditor.getInstance().getValue();void 0!==f&&this.setValue(f)}return v.prototype.finishEditing.apply(this,arguments)};y.prototype.assignHooks=function(){var a=this;this.instance.addHook("afterDestroy",function(){a.htEditor&&a.htEditor.destroy()})};g("handsontable",y)},{browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,textEditor:41}],37:[function(p,q,r){Object.defineProperties(r,{MobileTextEditor:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e;p("browser");var n=(k=p("helpers/unicode"),k&&k.__esModule&&k||{"default":k}).KEY_CODES;q=(d=p("helpers/dom/event"),d&&d.__esModule&&d||{"default":d});var m=q.stopImmediatePropagation,a=q.isImmediatePropagationStopped;d=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var b=d.addClass,f=d.getScrollLeft,t=d.getScrollTop,u=d.hasClass,v=d.isChildOf,y=d.offset,w=d.outerHeight,z=d.outerWidth,x=d.removeClass,C=d.setCaretPosition;h=(l=p("editors"),l&&l.__esModule&&l||{"default":l}).registerEditor;l=(g=p("_baseEditor"),g&&g.__esModule&&g||{"default":g}).BaseEditor;var E=(e=p("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager,A=l.prototype.extend(),B={};A.prototype.valueChanged=function(){return this.initValue!=this.getValue()};A.prototype.init=function(){var a=this;this.eventManager=E(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){a.destroy()})};A.prototype.getValue=function(){return this.TEXTAREA.value};A.prototype.setValue=function(a){this.initValue=a;this.TEXTAREA.value=a};A.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className="positionControls";this.TEXTAREA=document.createElement("TEXTAREA");b(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var a in this.controls)this.controls.hasOwnProperty(a)&&this.positionControls.appendChild(this.controls[a]);document.body.appendChild(this.editorContainer)};A.prototype.onBeforeKeyDown=function(b){var f=this.getActiveEditor();if(b.target===f.TEXTAREA&&!a(b))switch(b.keyCode){case n.ENTER:f.close();b.preventDefault();break;case n.BACKSPACE:m(b)}};A.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);b(this.editorContainer,"active");x(this.cellPointer,"hidden");this.updateEditorPosition()};A.prototype.focus=function(){this.TEXTAREA.focus();C(this.TEXTAREA,this.TEXTAREA.value.length)};A.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);x(this.editorContainer,"active")};A.prototype.scrollToView=function(){var a=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(a)};A.prototype.hideCellPointer=function(){u(this.cellPointer,"hidden")||b(this.cellPointer,"hidden")};A.prototype.updateEditorPosition=function(a,b){if(a&&b)a=parseInt(a,10),b=parseInt(b,10),this.editorContainer.style.top=b+"px",this.editorContainer.style.left=a+"px";else{var e=this.instance.getSelected(),e=this.instance.getCell(e[0],e[1]);B.cellPointer||(B.cellPointer={height:w(this.cellPointer),width:z(this.cellPointer)});B.editorContainer||(B.editorContainer={width:z(this.editorContainer)});if(void 0!==e){var d=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:f(this.instance.view.wt.wtOverlays.leftOverlay.holder),g=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:t(this.instance.view.wt.wtOverlays.topOverlay.holder),m=y(e),n=z(e);this.editorContainer.style.top=parseInt(m.top+w(e)-g+B.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-B.editorContainer.width/2,10)+"px";m.left+n/2>parseInt(this.editorContainer.style.left,10)+B.editorContainer.width?this.editorContainer.style.left=window.innerWidth-B.editorContainer.width+"px":m.left+n/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px");this.cellPointer.style.left=parseInt(m.left-B.cellPointer.width/2-y(this.editorContainer).left+n/2-d,10)+"px"}}};A.prototype.updateEditorData=function(){var a=this.instance.getSelected(),b=this.instance.getDataAtCell(a[0],a[1]);this.row=a[0];this.col=a[1];this.setValue(b);this.updateEditorPosition()};A.prototype.prepareAndSave=function(){var a;if(!this.valueChanged())return!0;a=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]];this.saveValue(a)};A.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(0,-1,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(0,1,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.controls.upButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(-1,0,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(1,0,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(b){if(1==b.touches.length){b=b.touches[0];var f=b.pageX-a.editorContainer.offsetLeft,e=b.pageY-a.editorContainer.offsetTop;a.eventManager.addEventListener(this,"touchmove",function(b){var d=b.touches[0];a.updateEditorPosition(d.pageX-f,d.pageY-e);a.hideCellPointer();b.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(b){v(b.target,a.editorContainer)||v(b.target,a.instance.rootElement)||a.close()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(b){a.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&a.hideCellPointer()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(b){a.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&a.hideCellPointer()})};A.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};h("mobile",A)},{_baseEditor:31,browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],38:[function(p,q,r){Object.defineProperties(r,{NumericEditor:{get:function(){return g}},__esModule:{value:!0}});var k,d,h,l=(k=p("numbro"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("editors"),d&&d.__esModule&&d||{"default":d}).registerEditor;p=(h=p("textEditor"),h&&h.__esModule&&h||{"default":h}).TextEditor;var g=function(){$traceurRuntime.superConstructor(e).apply(this,arguments)},e=g;$traceurRuntime.createClass(g,{beginEditing:function(d){"undefined"===typeof d&&this.originalValue&&("undefined"!==typeof this.cellProperties.language&&l.culture(this.cellProperties.language),d=l.cultureData().delimiters.decimal,d=(""+this.originalValue).replace(".",d));$traceurRuntime.superGet(this,e.prototype,"beginEditing").call(this,d)}},{},p);q("numeric",g)},{editors:30,numbro:"numbro",textEditor:41}],39:[function(p,q,r){Object.defineProperties(r,{PasswordEditor:{get:function(){return g}},__esModule:{value:!0}});var k,d,h;p("browser");var l=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).empty;q=(d=p("editors"),d&&d.__esModule&&d||{"default":d}).registerEditor;p=(h=p("textEditor"),h&&h.__esModule&&h||{"default":h}).TextEditor;var g=function(){$traceurRuntime.superConstructor(e).apply(this,arguments)},e=g;$traceurRuntime.createClass(g,{createElements:function(){$traceurRuntime.superGet(this,e.prototype,"createElements").call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;l(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},p);q("password",g)},{browser:24,editors:30,"helpers/dom/element":47,textEditor:41}],40:[function(p,q,r){Object.defineProperties(r,{SelectEditor:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e,n=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var m=q.addClass,a=q.empty,b=q.fastInnerHTML,f=q.getComputedStyle,t=q.getCssTransform,u=q.getScrollableElement,v=q.offset,y=q.outerHeight,w=q.outerWidth,z=q.resetCssTransform,x=(h=p("helpers/dom/event"),h&&h.__esModule&&h||{"default":h}).stopImmediatePropagation,C=(l=p("helpers/unicode"),l&&l.__esModule&&l||{"default":l}).KEY_CODES;d=(g=p("editors"),g&&g.__esModule&&g||{"default":g}).registerEditor;var E=(e=p("_baseEditor"),e&&e.__esModule&&e||{"default":e}).BaseEditor,A=E.prototype.extend();A.prototype.init=function(){this.select=document.createElement("SELECT");m(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select);this.registerHooks()};A.prototype.registerHooks=function(){var a=this;this.instance.addHook("afterScrollHorizontally",function(){return a.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){return a.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){return a.refreshDimensions()});this.instance.addHook("afterRowResize",function(){return a.refreshDimensions()})};A.prototype.prepare=function(){E.prototype.prepare.apply(this,arguments);var f=this.cellProperties.selectOptions,f="function"==typeof f?this.prepareOptions(f(this.row,this.col,this.prop)):this.prepareOptions(f);a(this.select);for(var e in f)if(f.hasOwnProperty(e)){var d=document.createElement("OPTION");d.value=e;b(d,f[e]);this.select.appendChild(d)}};A.prototype.prepareOptions=function(a){var b={};if(Array.isArray(a))for(var f=0,e=a.length;f<e;f++)b[a[f]]=a[f];else"object"==typeof a&&(b=a);return b};A.prototype.getValue=function(){return this.select.value};A.prototype.setValue=function(a){this.select.value=a};var B=function(a){var b=this.getActiveEditor();switch(a.keyCode){case C.ARROW_UP:var f=b.select.selectedIndex-1;0<=f&&(b.select[f].selected=!0);x(a);a.preventDefault();break;case C.ARROW_DOWN:f=b.select.selectedIndex+1,f<=b.select.length-1&&(b.select[f].selected=!0),x(a),a.preventDefault()}};A.prototype.open=function(){this._opened=!0;this.refreshDimensions();this.select.style.display="";this.instance.addHook("beforeKeyDown",B)};A.prototype.close=function(){this._opened=!1;this.select.style.display="none";this.instance.removeHook("beforeKeyDown",B)};A.prototype.focus=function(){this.select.focus()};A.prototype.refreshValue=function(){var a=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=a;this.setValue(a);this.refreshDimensions()};A.prototype.refreshDimensions=function(){if(this.state===n.EditorState.EDITING)if(this.TD=this.getEditedCell()){var a=w(this.TD)+1,b=y(this.TD)+1,e=v(this.TD),d=v(this.instance.rootElement),g=u(this.TD),m=e.top-d.top-1-(g.scrollTop||0),e=e.left-d.left-1-(g.scrollLeft||0),d=this.checkEditorSection(),h;this.instance.getSettings();switch(d){case "top":h=t(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case "left":h=t(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case "top-left-corner":h=t(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case "bottom-left-corner":h=t(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case "bottom":h=t(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(m+=1);0===this.instance.getSelected()[1]&&(e+=1);d=this.select.style;h&&-1!=h?d[h[0]]=h[1]:z(this.select);h=f(this.TD);0<parseInt(h.borderTopWidth,10)&&--b;0<parseInt(h.borderLeftWidth,10)&&--a;d.height=b+"px";d.minWidth=a+"px";d.top=m+"px";d.left=e+"px";d.margin="0px"}else this.close()};A.prototype.getEditedCell=function(){var a;switch(this.checkEditorSection()){case "top":a=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case "corner":a=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case "left":a=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:a=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=a&&-2!=a?a:void 0};d("select",A)},{_baseEditor:31,browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],41:[function(p,q,r){Object.defineProperties(r,{TextEditor:{get:function(){return K}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var b=q.addClass,f=q.getCaretPosition,t=q.getComputedStyle,u=q.getCssTransform,v=q.getScrollableElement,y=q.getScrollbarWidth,w=q.innerWidth,z=q.offset,x=q.resetCssTransform,C=q.setCaretPosition,E=q.hasVerticalScrollbar,A=q.hasHorizontalScrollbar,B=(h=p("autoResize"),h&&h.__esModule&&h||{"default":h})["default"];d=(l=p("_baseEditor"),l&&l.__esModule&&l||{"default":l}).BaseEditor;var G=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).eventManager;l=(e=p("editors"),e&&e.__esModule&&e||{"default":e}).registerEditor;var D=(n=p("helpers/unicode"),n&&n.__esModule&&n||{"default":n}).KEY_CODES;p=(m=p("helpers/dom/event"),m&&m.__esModule&&m||{"default":m});var F=p.stopPropagation,H=p.stopImmediatePropagation,J=p.isImmediatePropagationStopped,K=d.prototype.extend();K.prototype.init=function(){var a=this;this.createElements();this.eventManager=G(this);this.bindEvents();this.autoResize=B();this.instance.addHook("afterDestroy",function(){a.destroy()})};K.prototype.getValue=function(){return this.TEXTAREA.value};K.prototype.setValue=function(a){this.TEXTAREA.value=a};var I=function(a){var b=this.getActiveEditor(),e;e=(a.ctrlKey||a.metaKey)&&!a.altKey;if(a.target===b.TEXTAREA&&!J(a))if(17===a.keyCode||224===a.keyCode||91===a.keyCode||93===a.keyCode)H(a);else{switch(a.keyCode){case D.ARROW_RIGHT:b.isInFullEditMode()&&(!b.isWaiting()&&!b.allowKeyEventPropagation||!b.isWaiting()&&b.allowKeyEventPropagation&&!b.allowKeyEventPropagation(a.keyCode))&&H(a);break;case D.ARROW_LEFT:b.isInFullEditMode()&&(!b.isWaiting()&&!b.allowKeyEventPropagation||!b.isWaiting()&&b.allowKeyEventPropagation&&!b.allowKeyEventPropagation(a.keyCode))&&H(a);break;case D.ARROW_UP:case D.ARROW_DOWN:b.isInFullEditMode()&&(!b.isWaiting()&&!b.allowKeyEventPropagation||!b.isWaiting()&&b.allowKeyEventPropagation&&!b.allowKeyEventPropagation(a.keyCode))&&H(a);break;case D.ENTER:var d=b.instance.getSelected(),d=!(d[0]===d[2]&&d[1]===d[3]);if(e&&!d||a.altKey)b.isOpened()?(e=f(b.TEXTAREA),d=b.getValue(),d=d.slice(0,e)+"\n"+d.slice(e),b.setValue(d),C(b.TEXTAREA,e+1)):b.beginEditing(b.originalValue+"\n"),H(a);a.preventDefault();break;case D.A:case D.X:case D.C:case D.V:e&&H(a);break;case D.BACKSPACE:case D.DELETE:case D.HOME:case D.END:H(a)}-1===[D.ARROW_UP,D.ARROW_RIGHT,D.ARROW_DOWN,D.ARROW_LEFT].indexOf(a.keyCode)&&b.autoResize.resize(String.fromCharCode(a.keyCode))}};K.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",I)};K.prototype.close=function(a){this.textareaParentStyle.display="none";this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",I)};K.prototype.focus=function(){this.TEXTAREA.focus();C(this.TEXTAREA,this.TEXTAREA.value.length)};K.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");b(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");b(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var a=this;this.instance._registerTimeout(setTimeout(function(){a.refreshDimensions()},0))};K.prototype.getEditedCell=function(){var a;switch(this.checkEditorSection()){case "top":a=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case "top-left-corner":a=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case "bottom-left-corner":a=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case "left":a=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;case "bottom":a=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:a=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=a&&-2!=a?a:void 0};K.prototype.refreshValue=function(){var a=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=a;this.setValue(a);this.refreshDimensions()};K.prototype.refreshDimensions=function(){if(this.state===a.EditorState.EDITING)if(this.TD=this.getEditedCell()){var b=z(this.TD),f=z(this.instance.rootElement),e=v(this.TD),d=this.instance.countRows(),g=b.top-f.top-(b.top===f.top?0:1)-(e.scrollTop||0),f=b.left-f.left-1-(e.scrollLeft||0),m=this.instance.getSettings();this.instance.hasRowHeaders();var n=this.instance.hasColHeaders(),h=this.checkEditorSection(),b=this.TD.style.backgroundColor,l;switch(h){case "top":l=u(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case "left":l=u(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case "top-left-corner":l=u(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case "bottom-left-corner":l=u(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case "bottom":l=u(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}if(n&&0===this.instance.getSelected()[0]||m.fixedRowsBottom&&this.instance.getSelected()[0]===d-m.fixedRowsBottom)g+=1;0===this.instance.getSelected()[1]&&(f+=1);l&&-1!=l?this.textareaParentStyle[l[0]]=l[1]:x(this.TEXTAREA_PARENT);this.textareaParentStyle.top=g+"px";this.textareaParentStyle.left=f+"px";d=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition;g=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition;f=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();m=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition();l=y();d=this.TD.offsetTop+d-m;f=this.TD.offsetLeft+g-f;g=w(this.TD)-8;m=E(e)?l:0;e=A(e)?l:0;l=this.instance.view.maximumVisibleElementWidth(f)-9-m;f=this.TD.scrollHeight+1;e=Math.max(this.instance.view.maximumVisibleElementHeight(d)-e,23);d=t(this.TD);this.TEXTAREA.style.fontSize=d.fontSize;this.TEXTAREA.style.fontFamily=d.fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=b?b:t(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(f,e),maxHeight:e,minWidth:Math.min(g,l),maxWidth:l},!0);this.textareaParentStyle.display="block"}else this.close(!0)};K.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){F(a)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){F(a)});this.instance.addHook("afterScrollHorizontally",function(){a.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){a.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){a.refreshDimensions();a.focus()});this.instance.addHook("afterRowResize",function(){a.refreshDimensions();a.focus()});this.instance.addHook("afterDestroy",function(){a.eventManager.destroy()})};K.prototype.destroy=function(){this.eventManager.destroy()};l("text",K)},{_baseEditor:31,autoResize:"autoResize",browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],42:[function(p,q,r){function k(e,d){var g,h,l,k,t;d.isTargetWebComponent=!1;d.realTarget=d.target;t=d.stopImmediatePropagation;d.stopImmediatePropagation=function(){t.apply(this);f(this)};if(!n.eventManager.isHotTableEnv)return d;d=m(d);for(k=d.path?d.path.length:0;k--;){if("HOT-TABLE"===d.path[k].nodeName)g=!0;else if(g&&d.path[k].shadowRoot){l=d.path[k];break}0!==k||l||(l=d.path[k])}l||(l=d.target);d.isTargetWebComponent=!0;if(b())d.realTarget=d.srcElement||d.toElement;else if(e instanceof n.Core||e instanceof Walkontable)e instanceof n.Core?h=e.view?e.view.wt.wtTable.TABLE:null:e instanceof Walkontable&&(h=e.wtTable.TABLE.parentNode.parentNode),g=a(d.target,["HOT-TABLE"],h),d.realTarget=g?h.querySelector("HOT-TABLE")||d.target:d.target;Object.defineProperty(d,"target",{get:function(){return m(l)},enumerable:!0,configurable:!0});return d}function d(a){return new t(a)}Object.defineProperties(r,{EventManager:{get:function(){return t}},eventManager:{get:function(){return d}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"];q=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l});var m=q.polymerWrap,a=q.closest,b=(g=p("helpers/feature"),g&&g.__esModule&&g||{"default":g}).isWebComponentSupportedNatively,f=(e=p("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}).stopImmediatePropagation,t=function(a){this.context=(void 0!==a?a:null)||this;this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(t,{addEventListener:function(a,b,f){function e(a){a=k(g,a);f.call(this,a)}var d=this,g=this.context;this.context.eventListeners.push({element:a,event:b,callback:f,callbackProxy:e});window.addEventListener?a.addEventListener(b,e,!1):a.attachEvent("on"+b,e);n.countEventManagerListeners++;return function(){d.removeEventListener(a,b,f)}},removeEventListener:function(a,b,f){for(var e=this.context.eventListeners.length,d;e--;)d=this.context.eventListeners[e],d.event!=b||d.element!=a||f&&f!=d.callback||(this.context.eventListeners.splice(e,1),d.element.removeEventListener?d.element.removeEventListener(d.event,d.callbackProxy,!1):d.element.detachEvent("on"+d.event,d.callbackProxy),n.countEventManagerListeners--)},clearEvents:function(){if(this.context)for(var a=this.context.eventListeners.length;a--;){var b=this.context.eventListeners[a];b&&this.removeEventListener(b.element,b.event,b.callback)}},clear:function(){this.clearEvents()},destroy:function(){this.clearEvents();this.context=null},fireEvent:function(a,b){var f="mousemove"!==b,e=window,d;document.createEvent?(d=document.createEvent("MouseEvents"),d.initMouseEvent(b,!0,f,e,0,0,0,1,1,!1,!1,!1,!1,0,document.body.parentNode)):d=document.createEventObject();a.dispatchEvent?a.dispatchEvent(d):a.fireEvent("on"+b,d)}},{});n.countEventManagerListeners=0;n.eventManager=d},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49}],43:[function(p,q,r){function k(a){for(var b=0,f=a.length;b<f;)a[b]=[a[b]],b++}function d(a,b){for(var f=0,e=b.length;f<e;)a.push(b[f]),f++}function h(a){var b=[];if(!a||0===a.length||!a[0]||0===a[0].length)return b;for(var f=a.length,e=a[0].length,d=0;d<f;d++)for(var g=0;g<e;g++)b[g]||(b[g]=[]),b[g][d]=a[d][g];return b}function l(a,b,f,e){var d=-1,g=a.length;for(e&&g&&(f=a[++d]);++d<g;)f=b(f,a[d],d,a);return f}function g(a,b){for(var f=-1,e=a.length,d=-1,g=[];++f<e;){var m=a[f];b(m,f,a)&&(g[++d]=m)}return g}function e(a,b){for(var f=-1,e=a.length,d=-1,g=[];++f<e;){var m=a[f];g[++d]=b(m,f,a)}return g}function n(a,b){for(var f=-1,e=a.length;++f<e&&!1!==b(a[f],f,a););return a}function m(a){return l(a,function(a,b){return a+b},0)}function a(a){return l(a,function(a,b){return a>b?a:b},Array.isArray(a)?a[0]:void 0)}function b(a){return l(a,function(a,b){return a<b?a:b},Array.isArray(a)?a[0]:void 0)}function f(a){return a.length?m(a)/a.length:0}function t(a){return l(a,function(a,b){return a.concat(Array.isArray(b)?t(b):b)},[])}function u(a){var b=[];n(a,function(a){-1===b.indexOf(a)&&b.push(a)});return b}function v(a,b,f){if(null==a)throw new TypeError('"array" is null or not defined');a=Object(a);var e=a.length>>>0;if(0===e)return!1;f|=0;for(f=Math.max(0<=f?f:e-Math.abs(f),0);f<e;){if(a[f]===b)return!0;f++}return!1}Object.defineProperties(r,{to2dArray:{get:function(){return k}},extendArray:{get:function(){return d}},pivot:{get:function(){return h}},arrayReduce:{get:function(){return l}},arrayFilter:{get:function(){return g}},arrayMap:{get:function(){return e}},arrayEach:{get:function(){return n}},arraySum:{get:function(){return m}},arrayMax:{get:function(){return a}},arrayMin:{get:function(){return b}},arrayAvg:{get:function(){return f}},arrayFlatten:{get:function(){return t}},arrayUnique:{get:function(){return u}},arrayIncludes:{get:function(){return v}},__esModule:{value:!0}})},{}],44:[function(p,q,r){function k(){return e}function d(){return n}function h(){return m}function l(){return a}function g(a){a||(a=navigator.userAgent);return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)}Object.defineProperties(r,{isIE8:{get:function(){return k}},isIE9:{get:function(){return d}},isSafari:{get:function(){return h}},isChrome:{get:function(){return l}},isMobileBrowser:{get:function(){return g}},__esModule:{value:!0}});var e=!document.createTextNode("test").textContent,n=!!document.documentMode,m=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),a=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},{}],45:[function(p,q,r){function k(a){a+=1;for(var b="",f;0<a;)f=(a-1)%u,b=String.fromCharCode(65+f)+b,a=parseInt((a-f)/u,10);return b}function d(a){var b=0;if(a)for(var f=0,e=a.length-1;f<a.length;f+=1,--e)b+=Math.pow(u,e)*(t.indexOf(a[f])+1);--b;return b}function h(a,b){var f=void 0!==a?a:100,e=void 0!==b?b:4,d=[],g,m;for(g=0;g<f;g++){var n=[];for(m=0;m<e;m++)n.push(k(m)+(g+1));d.push(n)}return d}function l(a,b){var f=void 0!==a?a:100,e=void 0!==b?b:4,d=[],g,m;for(g=0;g<f;g++){var n={};for(m=0;m<e;m++)n["prop"+m]=k(m)+(g+1);d.push(n)}return d}function g(a,b){for(var f=[],e,d=0;d<a;d++){e=[];for(var g=0;g<b;g++)e.push("");f.push(e)}return f}function e(a){var b,f,e,d,g=[],m=0;b=0;for(f=a.length;b<f;b++)for(e=0,d=a[b].length;e<d;e++)e==m&&(g.push([]),m++),g[e].push(a[b][e]);return g}function n(a,e){e="undefined"==typeof e?!0:e;return function(d,g){return function C(d){if(d){if(d.hasOwnProperty(a)&&void 0!==d[a])return d[a];if(d.hasOwnProperty("type")&&d.type){if("string"!=typeof d.type)throw Error("Cell type must be a string ");var g=d.type,m=b.cellTypes[g];if("undefined"==typeof m)throw Error('You declared cell type "'+g+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');if(m.hasOwnProperty(a))return m[a];if(e)return}return C(f(d))}}("number"==typeof d?this.getCellMeta(d,g):d)}}Object.defineProperties(r,{spreadsheetColumnLabel:{get:function(){return k}},spreadsheetColumnIndex:{get:function(){return d}},createSpreadsheetData:{get:function(){return h}},createSpreadsheetObjectData:{get:function(){return l}},createEmptySpreadsheetData:{get:function(){return g}},translateRowsToColumns:{get:function(){return e}},cellMethodLookupFactory:{get:function(){return n}},__esModule:{value:!0}});var m,a,b=(m=p("browser"),m&&m.__esModule&&m||{"default":m})["default"],f=(a=p("object"),a&&a.__esModule&&a||{"default":a}).getPrototypeOf,t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u=t.length},{browser:24,object:53}],46:[function(p,q,r){function k(d){var h=new Date(d);return isNaN((new Date(d+"T00:00")).getDate())?h:new Date(h.getTime()+6E4*h.getTimezoneOffset())}Object.defineProperties(r,{getNormalizedDate:{get:function(){return k}},__esModule:{value:!0}})},{}],47:[function(p,q,r){function k(a,b){for(var f=void 0!==b?b:0,e=-1,d=null;null!=a;){if(e===f){d=a;break}a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a=a.host:(e++,a=a.parentNode)}return d}function d(a,b,f){for(;null!=a&&a!==f;){if(a.nodeType===Node.ELEMENT_NODE&&(-1<b.indexOf(a.nodeName)||-1<b.indexOf(a)))return a;a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode}return null}function h(a,b,f){for(var e=[];a;){a=d(a,b,f);if(!a||f&&!f.contains(a))break;e.push(a);a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode}return(a=e.length)?e[a-1]:null}function l(a,b){var f=a.parentNode,e=[];for("string"===typeof b?e=Array.prototype.slice.call(document.querySelectorAll(b),0):e.push(b);null!=f;){if(-1<e.indexOf(f))return!0;f=f.parentNode}return!1}function g(a){function b(a){return a.nodeType===Node.ELEMENT_NODE&&"HOT-TABLE"===a.nodeName}var f=!1;for(a=e(a);null!=a;){if(b(a)){f=!0;break}else if(a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(f=b(a.host))break;a=a.host}a=a.parentNode}return f}function e(a){return"undefined"!==typeof Polymer&&"function"===typeof wrap?wrap(a):a}function n(a){return"undefined"!==typeof Polymer&&"function"===typeof unwrap?unwrap(a):a}function m(a){var b=0;if(a.previousSibling)for(;a=a.previousSibling;)++b;return b}function a(a,b){var f=document.querySelector(".ht_clone_"+a);return f?f.contains(b):null}function b(a){var b=0,f=[];if(!a||!a.length)return f;for(;a[b];)f.push(a[b]),b++;return f}function f(a,b){return xa(a,b)}function t(a,b){return sa(a,b)}function u(a,b){return ja(a,b)}function v(a,b){if(3===a.nodeType)b.removeChild(a);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName))for(var f=a.childNodes,e=f.length-1;0<=e;e--)v(f[e],a)}function y(a){for(var b;b=a.lastChild;)a.removeChild(b)}function w(a,b){X.test(b)?a.innerHTML=b:z(a,b)}function z(a,b){var f=a.firstChild;f&&3===f.nodeType&&null===f.nextSibling?Da?f.textContent=b:f.data=b:(y(a),a.appendChild(document.createTextNode(b)))}function x(a){for(;n(a)!==document.documentElement;){if(null===a)return!1;if(a.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(a.host){if(a.host.impl)return x(a.host.impl);if(a.host)return x(a.host);throw Error("Lost in Web Components world");}return!1}if("none"===a.style.display)return!1;a=a.parentNode}return!0}function C(a){var b,f,e,d;d=document.documentElement;if(ha()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName)return a=a.getBoundingClientRect(),{top:a.top+(window.pageYOffset||d.scrollTop)-(d.clientTop||0),left:a.left+(window.pageXOffset||d.scrollLeft)-(d.clientLeft||0)};b=a.offsetLeft;f=a.offsetTop;for(e=a;(a=a.offsetParent)&&a!==document.body;)b+=a.offsetLeft,f+=a.offsetTop,e=a;e&&"fixed"===e.style.position&&(b+=window.pageXOffset||d.scrollLeft,f+=window.pageYOffset||d.scrollTop);return{left:b,top:f}}function E(){var a=window.scrollY;void 0===a&&(a=document.documentElement.scrollTop);return a}function A(){var a=window.scrollX;void 0===a&&(a=document.documentElement.scrollLeft);return a}function B(a){return a===window?E():a.scrollTop}function G(a){return a===window?A():a.scrollLeft}function D(a){a=a.parentNode;var b=["auto","scroll"],f,e,d,g,m="",n="";for(g="";a&&a.style&&document.body!==a;){f=a.style.overflow;e=a.style.overflowX;d=a.style.overflowY;if("scroll"==f||"scroll"==e||"scroll"==d||window.getComputedStyle&&(g=window.getComputedStyle(a),m=g.getPropertyValue("overflow"),n=g.getPropertyValue("overflow-y"),g=g.getPropertyValue("overflow-x"),"scroll"===m||"scroll"===g||"scroll"===n)||a.clientHeight<=a.scrollHeight&&(-1!==b.indexOf(d)||-1!==b.indexOf(f)||-1!==b.indexOf(m)||-1!==b.indexOf(n))||a.clientWidth<=a.scrollWidth&&(-1!==b.indexOf(e)||-1!==b.indexOf(f)||-1!==b.indexOf(m)||-1!==b.indexOf(g)))return a;a=a.parentNode}return window}function F(a){for(a=a.parentNode;a&&a.style&&document.body!==a;){if("visible"!==a.style.overflow&&""!==a.style.overflow)return a;if(window.getComputedStyle){var b=window.getComputedStyle(a);if("visible"!==b.getPropertyValue("overflow")&&""!==b.getPropertyValue("overflow"))return a}a=a.parentNode}return window}function H(a,b){if(a)if(a===window){if("width"===b)return window.innerWidth+"px";if("height"===b)return window.innerHeight+"px"}else{var f=a.style[b];if(""!==f&&void 0!==f)return f;f=J(a);if(""!==f[b]&&void 0!==f[b])return f[b]}}function J(a){return a.currentStyle||document.defaultView.getComputedStyle(a)}function K(a){return a.offsetWidth}function I(a){return ha()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName?a.offsetHeight+a.firstChild.offsetHeight:a.offsetHeight}function O(a){return a.clientHeight||a.innerHeight}function Q(a){return a.clientWidth||a.innerWidth}function R(a,b,f){window.addEventListener?a.addEventListener(b,f,!1):a.attachEvent("on"+b,f)}function M(a,b,f){window.removeEventListener?a.removeEventListener(b,f,!1):a.detachEvent("on"+b,f)}function S(a){if(a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();if(null==b)return 0;a=a.createTextRange();var f=a.duplicate();a.moveToBookmark(b.getBookmark());f.setEndPoint("EndToStart",a);return f.text.length}return 0}function U(a){if(a.selectionEnd)return a.selectionEnd;if(document.selection){var b=document.selection.createRange();return null==b?0:a.createTextRange().text.indexOf(b.text)+b.text.length}}function V(){var a="";window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(a=document.selection.createRange().text);return a}function ga(a,b,f){void 0===f&&(f=b);if(a.setSelectionRange){a.focus();try{a.setSelectionRange(b,f)}catch(ya){var e=a.parentNode,d=e.style.display;e.style.display="block";a.setSelectionRange(b,f);e.style.display=d}}else a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveEnd("character",f),a.moveStart("character",b),a.select())}function P(){if(void 0===Ea){var a=document.createElement("div");a.style.height="200px";a.style.width="100%";var b=document.createElement("div");b.style.boxSizing="content-box";b.style.height="150px";b.style.left="0px";b.style.overflow="hidden";b.style.position="absolute";b.style.top="0px";b.style.width="200px";b.style.visibility="hidden";b.appendChild(a);(document.body||document.documentElement).appendChild(b);var f=a.offsetWidth;b.style.overflow="scroll";a=a.offsetWidth;f==a&&(a=b.clientWidth);(document.body||document.documentElement).removeChild(b);Ea=f-a}return Ea}function ua(a){return a.offsetWidth!==a.clientWidth}function Z(a){return a.offsetHeight!==a.clientHeight}function oa(a,b,f){aa()||fa()?(a.style.top=f,a.style.left=b):pa()?a.style["-webkit-transform"]="translate3d("+b+","+f+",0)":a.style.transform="translate3d("+b+","+f+",0)"}function W(a){var b;return a.style.transform&&""!==(b=a.style.transform)?["transform",b]:a.style["-webkit-transform"]&&""!==(b=a.style["-webkit-transform"])?["-webkit-transform",b]:-1}function T(a){a.style.transform&&""!==a.style.transform?a.style.transform="":a.style["-webkit-transform"]&&""!==a.style["-webkit-transform"]&&(a.style["-webkit-transform"]="")}function wa(a){var b=["INPUT","SELECT","TEXTAREA"];return a&&(-1<b.indexOf(a.nodeName)||"true"===a.contentEditable)}function ra(a){return wa(a)&&-1==a.className.indexOf("handsontableInput")&&-1==a.className.indexOf("copyPaste")}Object.defineProperties(r,{getParent:{get:function(){return k}},closest:{get:function(){return d}},closestDown:{get:function(){return h}},isChildOf:{get:function(){return l}},isChildOfWebComponentTable:{get:function(){return g}},polymerWrap:{get:function(){return e}},polymerUnwrap:{get:function(){return n}},index:{get:function(){return m}},overlayContainsElement:{get:function(){return a}},hasClass:{get:function(){return f}},addClass:{get:function(){return t}},removeClass:{get:function(){return u}},removeTextNodes:{get:function(){return v}},empty:{get:function(){return y}},HTML_CHARACTERS:{get:function(){return X}},fastInnerHTML:{get:function(){return w}},fastInnerText:{get:function(){return z}},isVisible:{get:function(){return x}},offset:{get:function(){return C}},getWindowScrollTop:{get:function(){return E}},getWindowScrollLeft:{get:function(){return A}},getScrollTop:{get:function(){return B}},getScrollLeft:{get:function(){return G}},getScrollableElement:{get:function(){return D}},getTrimmingContainer:{get:function(){return F}},getStyle:{get:function(){return H}},getComputedStyle:{get:function(){return J}},outerWidth:{get:function(){return K}},outerHeight:{get:function(){return I}},innerHeight:{get:function(){return O}},innerWidth:{get:function(){return Q}},addEvent:{get:function(){return R}},removeEvent:{get:function(){return M}},getCaretPosition:{get:function(){return S}},getSelectionEndPosition:{get:function(){return U}},getSelectionText:{get:function(){return V}},setCaretPosition:{get:function(){return ga}},getScrollbarWidth:{get:function(){return P}},hasVerticalScrollbar:{get:function(){return ua}},hasHorizontalScrollbar:{get:function(){return Z}},setOverlayPosition:{get:function(){return oa}},getCssTransform:{get:function(){return W}},resetCssTransform:{get:function(){return T}},isInput:{get:function(){return wa}},isOutsideInput:{get:function(){return ra}},__esModule:{value:!0}});var ia,la;q=(ia=p("../browser"),ia&&ia.__esModule&&ia||{"default":ia});var aa=q.isIE8,fa=q.isIE9,pa=q.isSafari,ha=(la=p("../feature"),la&&la.__esModule&&la||{"default":la}).hasCaptionProblem,xa,sa,ja;if(document.documentElement.classList){var Aa=function(){var a=document.createElement("div");a.classList.add("test","test2");return a.classList.contains("test2")}();xa=function(a,b){return""===b?!1:a.classList.contains(b)};sa=function(a,f){var e=0;"string"===typeof f&&(f=f.split(" "));f=b(f);if(Aa)a.classList.add.apply(a.classList,f);else for(;f&&f[e];)a.classList.add(f[e]),e++};ja=function(a,f){var e=0;"string"===typeof f&&(f=f.split(" "));f=b(f);if(Aa)a.classList.remove.apply(a.classList,f);else for(;f&&f[e];)a.classList.remove(f[e]),e++}}else{var ta=function(a){return new RegExp("(\\s|^)"+a+"(\\s|$)")};xa=function(a,b){return a.className.match(ta(b))?!0:!1};sa=function(a,b){var f=0,e=a.className;"string"===typeof b&&(b=b.split(" "));if(""===e)e=b.join(" ");else for(;b&&b[f];)ta(b[f]).test(e)||(e+=" "+b[f]),f++;a.className=e};ja=function(a,b){var f=0,e=a.className;for("string"===typeof b&&(b=b.split(" "));b&&b[f];)e=e.replace(ta(b[f])," ").trim(),f++;a.className!==e&&(a.className=e)}}var X=/(<(.*)>|&(.*);)/,Da=document.createTextNode("test").textContent?!0:!1,Ea},{"../browser":44,"../feature":49}],48:[function(p,q,r){function k(a){a.isImmediatePropagationEnabled=!1;a.cancelBubble=!0}function d(a){return!1===a.isImmediatePropagationEnabled}function h(a){"function"===typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function l(a){return a.pageX?a.pageX:a.clientX+b()}function g(b){return b.pageY?b.pageY:b.clientY+a()}function e(a){return 2===a.button}function n(a){return 0===a.button}Object.defineProperties(r,{stopImmediatePropagation:{get:function(){return k}},isImmediatePropagationStopped:{get:function(){return d}},stopPropagation:{get:function(){return h}},pageX:{get:function(){return l}},pageY:{get:function(){return g}},isRightClick:{get:function(){return e}},isLeftClick:{get:function(){return n}},__esModule:{value:!0}});var m;p=(m=p("element"),m&&m.__esModule&&m||{"default":m});var a=p.getWindowScrollTop,b=p.getWindowScrollLeft},{element:47}],49:[function(p,q,r){function k(a){return m.call(window,a)}function d(b){a.call(window,b)}function h(){return"ontouchstart"in window}function l(){var a=document.createElement("div");return a.createShadowRoot&&a.createShadowRoot.toString().match(/\[native code\]/)?!0:!1}function g(){if(void 0===b){var a=document.createElement("TABLE");a.style.borderSpacing=0;a.style.borderWidth=0;a.style.padding=0;var f=document.createElement("TBODY");a.appendChild(f);f.appendChild(document.createElement("TR"));f.firstChild.appendChild(document.createElement("TD"));f.firstChild.firstChild.innerHTML="\x3ctr\x3e\x3ctd\x3et\x3cbr\x3et\x3c/td\x3e\x3c/tr\x3e";var e=document.createElement("CAPTION");e.innerHTML="c\x3cbr\x3ec\x3cbr\x3ec\x3cbr\x3ec";e.style.padding=0;e.style.margin=0;a.insertBefore(e,f);document.body.appendChild(a);b=a.offsetHeight<2*a.lastChild.offsetHeight;document.body.removeChild(a)}return b}function e(a,b){var e=void 0!==b?b:{};return f?f:f="object"===typeof Intl?(new Intl.Collator(a,e)).compare:"function"===typeof String.prototype.localeCompare?function(a,b){return(a+"").localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1}}Object.defineProperties(r,{requestAnimationFrame:{get:function(){return k}},cancelAnimationFrame:{get:function(){return d}},isTouchSupported:{get:function(){return h}},isWebComponentSupportedNatively:{get:function(){return l}},hasCaptionProblem:{get:function(){return g}},getComparisonFunction:{get:function(){return e}},__esModule:{value:!0}});var n=0;p=["ms","moz","webkit","o"];var m=window.requestAnimationFrame,a=window.cancelAnimationFrame;for(q=0;q<p.length&&!m;++q)m=window[p[q]+"RequestAnimationFrame"],a=window[p[q]+"CancelAnimationFrame"]||window[p[q]+"CancelRequestAnimationFrame"];m||(m=function(a){var b=(new Date).getTime(),f=Math.max(0,16-(b-n)),e=window.setTimeout(function(){a(b+f)},f);n=b+f;return e});a||(a=function(a){clearTimeout(a)});var b,f},{}],50:[function(p,q,r){function k(a){return"function"===typeof a}function d(a,b){return function(){return a.apply(b,arguments)}}function h(a,b){var f=void 0!==b?b:200,e=0,d={lastCallThrottled:!0},g=null;return function(){var b=this,m=arguments,n=Date.now(),h=!1;d.lastCallThrottled=!0;e||(e=n,h=!0);n=f-(n-e);h?(d.lastCallThrottled=!1,a.apply(this,m)):(g&&clearTimeout(g),g=setTimeout(function(){d.lastCallThrottled=!1;a.apply(b,m);e=0;g=void 0},n));return d}}function l(a,b,f){function e(){return m?(m--,a.apply(this,arguments)):g.apply(this,arguments)}var d=void 0!==f?f:10,g=h(a,void 0!==b?b:200),m=d;e.clearHits=function(){m=d};return e}function g(a,b){var f=void 0!==b?b:200,e=null,d;return function(){var b=this,g=arguments;e&&clearTimeout(e);e=setTimeout(function(){d=a.apply(b,g)},f);return d}}function e(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var e=a[0],d=Array.prototype.slice.call(a,1);return function(){return f(d,function(a,b){return b(a)},e.apply(this,arguments))}}function n(a){for(var b=[],f=1;f<arguments.length;f++)b[f-1]=arguments[f];return function(){for(var f=[],e=0;e<arguments.length;e++)f[e]=arguments[e];return a.apply(this,b.concat(f))}}function m(a){function b(e){return function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];d=e.concat(d);return d.length>=f?a.apply(this,d):b(d)}}var f=a.length;return b([])}function a(a){function b(e){return function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];d=e.concat(d.reverse());return d.length>=f?a.apply(this,d):b(d)}}var f=a.length;return b([])}Object.defineProperties(r,{isFunction:{get:function(){return k}},proxy:{get:function(){return d}},throttle:{get:function(){return h}},throttleAfterHits:{get:function(){return l}},debounce:{get:function(){return g}},pipe:{get:function(){return e}},partial:{get:function(){return n}},curry:{get:function(){return m}},curryRight:{get:function(){return a}},__esModule:{value:!0}});var b,f=(b=p("array"),b&&b.__esModule&&b||{"default":b}).arrayReduce},{array:43}],51:[function(p,q,r){function k(d){switch(typeof d){case "string":case "number":return d+"";case "object":return null===d?"":d.toString();case "undefined":return"";default:return d.toString()}}function d(d){return"undefined"!==typeof d}function h(d){return"undefined"===typeof d}function l(d){return null===d||""===d||h(d)}Object.defineProperties(r,{stringify:{get:function(){return k}},isDefined:{get:function(){return d}},isUndefined:{get:function(){return h}},isEmpty:{get:function(){return l}},__esModule:{value:!0}})},{}],52:[function(p,q,r){function k(d){var e=typeof d;return"number"==e?!isNaN(d)&&isFinite(d):"string"==e?d.length?1==d.length?/\d/.test(d):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(d):!1:"object"==e?!!d&&"number"==typeof d.valueOf()&&!(d instanceof Date):!1}function d(d,e,n){var g=-1;"function"===typeof e?(n=e,e=d):g=d-1;for(;++g<=e&&!1!==n(g););}function h(d,e,n){d+=1;"function"===typeof e&&(n=e,e=0);for(;--d>=e&&!1!==n(d););}function l(d,e){e=parseInt(e.toString().replace("%",""),10);return e=parseInt(d*e/100)}Object.defineProperties(r,{isNumeric:{get:function(){return k}},rangeEach:{get:function(){return d}},rangeEachReverse:{get:function(){return h}},valueAccordingPercent:{get:function(){return l}},__esModule:{value:!0}})},{}],53:[function(p,q,r){function k(a){var b;Array.isArray(a)?b=[]:(b={},t(a,function(a,f){"__children"!==f&&(a&&"object"===typeof a&&!Array.isArray(a)?b[f]=k(a):Array.isArray(a)?a.length&&"object"===typeof a[0]&&!Array.isArray(a[0])?b[f]=[k(a[0])]:b[f]=[]:b[f]=null)}));return b}function d(a,b){b.prototype.constructor=b;a.prototype=new b;return a.prototype.constructor=a}function h(a,b){t(b,function(b,f){a[f]=b});return a}function l(a,b){t(b,function(f,e){b[e]&&"object"===typeof b[e]?(a[e]||(Array.isArray(b[e])?a[e]=[]:"[object Date]"===Object.prototype.toString.call(b[e])?a[e]=b[e]:a[e]={}),l(a[e],b[e])):a[e]=b[e]})}function g(a){return"object"===typeof a?JSON.parse(JSON.stringify(a)):a}function e(a){var b={};t(a,function(a,f){b[f]=a});return b}function n(b){for(var f=[],e=1;e<arguments.length;e++)f[e-1]=arguments[e];b.MIXINS||(b.MIXINS=[]);z(f,function(f){b.MIXINS.push(f.MIXIN_NAME);t(f,function(f,e){if(void 0!==b.prototype[e])throw Error("Mixin conflict. Property '"+e+"' already exist and cannot be overwritten.");"function"===typeof f?b.prototype[e]=f:Object.defineProperty(b.prototype,e,{get:function(b,f){b="_"+b;return function(){if(void 0===this[b]){var e=b,d=f;if(Array.isArray(d)||a(d))d=g(d);this[e]=d}return this[b]}}(e,f),set:function(a){a="_"+a;return function(b){this[a]=b}}(e),configurable:!0})})});return b}function m(a,b){return JSON.stringify(a)===JSON.stringify(b)}function a(a){return"[object Object]"==Object.prototype.toString.call(a)}function b(a){if("object"==typeof a.__proto__)a=a.__proto__;else{var b,f=a.constructor;"function"==typeof a.constructor&&(b=f,delete a.constructor&&(f=a.constructor,a.constructor=b));a=f?f.prototype:null}return a}function f(a,b,f,e){e.value=f;e.writable=!1!==e.writable;e.enumerable=!1!==e.enumerable;e.configurable=!1!==e.configurable;Object.defineProperty(a,b,e)}function t(a,b){for(var f in a)if((!a.hasOwnProperty||a.hasOwnProperty&&a.hasOwnProperty(f))&&!1===b(a[f],f,a))break;return a}function u(a,b){var f=b.split("."),e=a;t(f,function(a){e=e[a];if(void 0===e)return e=void 0,!1});return e}function v(b){if(!a(b))return 0;var f=function(b){var e=0;a(b)?t(b,function(a){e+=f(a)}):e++;return e};return f(b)}function y(a,b){var f=void 0!==b?b:"value",e,d="_"+f,g=(e={},Object.defineProperty(e,"_touched",{value:!1,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(e,d,{value:a,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(e,"isTouched",{value:function(){return this._touched},configurable:!0,enumerable:!0,writable:!0}),e);Object.defineProperty(g,f,{get:function(){return this[d]},set:function(a){this._touched=!0;this[d]=a},enumerable:!0,configurable:!0});return g}Object.defineProperties(r,{duckSchema:{get:function(){return k}},inherit:{get:function(){return d}},extend:{get:function(){return h}},deepExtend:{get:function(){return l}},deepClone:{get:function(){return g}},clone:{get:function(){return e}},mixin:{get:function(){return n}},isObjectEquals:{get:function(){return m}},isObject:{get:function(){return a}},getPrototypeOf:{get:function(){return b}},defineGetter:{get:function(){return f}},objectEach:{get:function(){return t}},getProperty:{get:function(){return u}},deepObjectSize:{get:function(){return v}},createObjectPropListener:{get:function(){return y}},__esModule:{value:!0}});var w,z=(w=p("array"),w&&w.__esModule&&w||{"default":w}).arrayEach},{array:43}],54:[function(p,q,r){function k(d,g){function e(){}h(e,d);for(var n=0,m=g.length;n<m;n++)e.prototype[g[n]]=void 0;return e}Object.defineProperties(r,{columnFactory:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("object"),d&&d.__esModule&&d||{"default":d}).inherit},{object:53}],55:[function(p,q,r){function k(a){return a[0].toUpperCase()+a.substr(1)}function d(a,b){var f=!0;u(b.length-1,function(e){if(a.charAt(e)!==b.charAt(e))return f=!1});return f}function h(a,b){var f=!0,e=b.length-1,d=a.length-1;u(e,function(g){var m=e-g;if(a.charAt(d-g)!==b.charAt(m))return f=!1});return f}function l(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var b=[],f=a.length;f--;){var e=t(a[f]).toLowerCase();-1===b.indexOf(e)&&b.push(e)}return 1===b.length}function g(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()}function e(a){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(a)}function n(a,b){var f=void 0!==b?b:{};return(a+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(a,b){return"\\"===a.charAt(0)?a.substr(1,a.length-1):void 0===f[b]?"":f[b]})}function m(a,b,f){var e=void 0!==f?f:" ";a+="";if(a.length>=b)return a;e=String(e);e.length||(e=" ");b-=a.length;var d="";u(Math.ceil(b/e.length),function(a){d+=e});d=d.slice(0,b);return d+a}function a(a){return(a+"").replace(v,"")}Object.defineProperties(r,{toUpperCaseFirst:{get:function(){return k}},startsWith:{get:function(){return d}},endsWith:{get:function(){return h}},equalsIgnoreCase:{get:function(){return l}},randomString:{get:function(){return g}},isPercentValue:{get:function(){return e}},substitute:{get:function(){return n}},padStart:{get:function(){return m}},stripTags:{get:function(){return a}},__esModule:{value:!0}});var b,f,t=(b=p("mixed"),b&&b.__esModule&&b||{"default":b}).stringify,u=(f=p("number"),f&&f.__esModule&&f||{"default":f}).rangeEach,v=/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi},{mixed:51,number:52}],56:[function(p,q,r){function k(e){return 32==e||48<=e&&57>=e||96<=e&&111>=e||186<=e&&192>=e||219<=e&&222>=e||226<=e||65<=e&&90>=e}function d(e){return-1!==[n.ARROW_DOWN,n.ARROW_UP,n.ARROW_LEFT,n.ARROW_RIGHT,n.HOME,n.END,n.DELETE,n.BACKSPACE,n.F1,n.F2,n.F3,n.F4,n.F5,n.F6,n.F7,n.F8,n.F9,n.F10,n.F11,n.F12,n.TAB,n.PAGE_DOWN,n.PAGE_UP,n.ENTER,n.ESCAPE,n.SHIFT,n.CAPS_LOCK,n.ALT].indexOf(e)}function h(e){return-1!==[n.CONTROL_LEFT,224,n.COMMAND_LEFT,n.COMMAND_RIGHT].indexOf(e)}function l(d,a){var b=a.split("|"),f=!1;e(b,function(a){if(d===n[a])return f=!0,!1});return f}Object.defineProperties(r,{KEY_CODES:{get:function(){return n}},isPrintableChar:{get:function(){return k}},isMetaKey:{get:function(){return d}},isCtrlKey:{get:function(){return h}},isKey:{get:function(){return l}},__esModule:{value:!0}});var g,e=(g=p("array"),g&&g.__esModule&&g||{"default":g}).arrayEach,n={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},{array:43}],57:[function(p,q,r){Object.defineProperties(r,{arrayMapper:{get:function(){return a}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d});var g=k.arrayReduce,e=k.arrayMap,n=k.arrayMax;d=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).defineGetter;var m=(l=p("helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,a={_arrayMap:[],getValueByIndex:function(a){var b;return void 0===(b=this._arrayMap[a])?null:b},getIndexByValue:function(a){var b;return-1===(b=this._arrayMap.indexOf(a))?null:b},insertItems:function(a,f){var b=void 0!==f?f:1,e=this,d=n(this._arrayMap)+1,g=[];m(b-1,function(b){g.push(e._arrayMap.splice(a+b,0,d+b))});return g},removeItems:function(a,f){var b=void 0!==f?f:1,e=this,d=[];if(Array.isArray(a)){var m=[].concat(this._arrayMap);a.sort(function(a,b){return b-a});d=g(a,function(a,b){e._arrayMap.splice(b,1);return a.concat(m.slice(b,b+1))},[])}else d=this._arrayMap.splice(a,b);return d},unshiftItems:function(a,f){function b(a){return g(d,function(b,f){a>f&&b++;return b},0)}var d=this.removeItems(a,void 0!==f?f:1);this._arrayMap=e(this._arrayMap,function(a,f){var e=b(a);e&&(a-=e);return a})},shiftItems:function(a,f){var b=void 0!==f?f:1,d=this;this._arrayMap=e(this._arrayMap,function(f){f>=a&&(f+=b);return f});m(b-1,function(b){d._arrayMap.splice(a+b,0,a+b)})},clearMap:function(){this._arrayMap.length=0}};d(a,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1});q.utils.arrayMapper=a},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53}],58:[function(p,q,r){Object.defineProperties(r,{localHooks:{get:function(){return g}},__esModule:{value:!0}});var k,d,h;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];var l=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach;p=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).defineGetter;var g={_localHooks:Object.create(null),addLocalHook:function(e,d){this._localHooks[e]||(this._localHooks[e]=[]);this._localHooks[e].push(d)},runLocalHooks:function(e){for(var d=[],g=1;g<arguments.length;g++)d[g-1]=arguments[g];var a=this;this._localHooks[e]&&l(this._localHooks[e],function(b){return b.apply(a,d)})},clearLocalHooks:function(){this._localHooks={}}};p(g,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});q.utils.localHooks=g},{browser:24,"helpers/array":43,"helpers/object":53}],59:[function(p,q,r){var k;Object.defineProperties(r,{stateSaver:{get:function(){return l}},__esModule:{value:!0}});var d,h;q=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];p("helpers/array");p=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).defineGetter;var l=(k={},Object.defineProperty(k,"_states",{value:{},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"getCachedState",{value:function(d){return this._states["state_"+d]},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setCachedState",{value:function(d,e){this._states["state_"+d]=e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"saveState",{value:function(d){var e=this.getState();this._states["state_"+d]=e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"restoreState",{value:function(d){this.setState(this._states["state_"+d])},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"hasSavedState",{value:function(d){return void 0!==this._states["state_"+d]},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"clearState",{value:function(d){this._states["state_"+d]=void 0},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"clearStates",{value:function(){this._states={}},configurable:!0,enumerable:!0,writable:!0}),k);p(l,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1});q.utils.stateSaver=l},{browser:24,"helpers/array":43,"helpers/object":53}],60:[function(p,q,r){function k(){function d(e){return null!==e&&e===e&&("string"==typeof e||"number"==typeof e)}function h(e){return null!==e&&("object"==typeof e||"function"==typeof e)}var l=[],g=new WeakMap;return{get:function(e){if(d(e))return l[e];if(h(e))return g.get(e)},set:function(e,n){if(d(e))l[e]=n;else if(h(e))g.set(e,n);else throw Error("Invalid key type");},"delete":function(e){d(e)?delete l[e]:h(e)&&g["delete"](e)}}}Object.defineProperties(r,{MultiMap:{get:function(){return k}},__esModule:{value:!0}});window.MultiMap=k},{}],61:[function(p,q,r){Object.defineProperties(r,{Hooks:{get:function(){return e}},__esModule:{value:!0}});var k,d,h="afterCellMetaReset afterChange afterChangesObserved afterContextMenuDefaultOptions beforeContextMenuSetItems afterDropdownMenuDefaultOptions beforeDropdownMenuSetItems afterContextMenuHide afterContextMenuShow afterCopyLimit beforeCreateCol afterCreateCol beforeCreateRow afterCreateRow afterDeselect afterDestroy afterDocumentKeyDown afterGetCellMeta afterGetColHeader afterGetRowHeader afterInit afterLoadData afterMomentumScroll afterOnCellCornerMouseDown afterOnCellCornerDblClick afterOnCellMouseDown afterOnCellMouseOver afterOnCellMouseOut afterRemoveCol afterRemoveRow afterRender beforeRenderer afterRenderer afterScrollHorizontally afterScrollVertically afterSelection afterSelectionByProp afterSelectionEnd afterSelectionEndByProp afterSetCellMeta afterSetDataAtCell afterSetDataAtRowProp afterUpdateSettings afterValidate beforeAutofill beforeCellAlignment beforeChange beforeChangeRender beforeDrawBorders beforeGetCellMeta beforeInit beforeInitWalkontable beforeKeyDown beforeOnCellMouseDown beforeOnCellMouseOver beforeOnCellMouseOut beforeRemoveCol beforeRemoveRow beforeRender beforeSetRangeStart beforeSetRangeEnd beforeTouchScroll beforeValidate beforeValueRender construct init modifyCol unmodifyCol unmodifyRow modifyColHeader modifyColWidth modifyRow modifyRowHeader modifyRowHeight modifyData modifyRowData persistentStateLoad persistentStateReset persistentStateSave beforeColumnSort afterColumnSort modifyAutofillRange modifyCopyableRange beforeCut afterCut beforeCopy afterCopy beforePaste afterPaste beforeColumnMove afterColumnMove beforeRowMove afterRowMove beforeColumnResize afterColumnResize beforeRowResize afterRowResize afterGetColumnHeaderRenderers afterGetRowHeaderRenderers beforeStretchingColumnWidth beforeFilter afterFilter modifyColumnHeaderHeight beforeUndo afterUndo beforeRedo afterRedo modifyRowHeaderWidth beforeAutofillInsidePopulate modifyTransformStart modifyTransformEnd afterModifyTransformStart afterModifyTransformEnd beforeValueRender afterViewportRowCalculatorOverride afterViewportColumnCalculatorOverride afterPluginsInitialized manualRowHeights skipLengthCache afterTrimRow afterUntrimRow afterDropdownMenuShow afterDropdownMenuHide hiddenRow hiddenColumn beforeAddChild afterAddChild beforeDetachChild afterDetachChild afterBeginEditing".split(" "),l=(k=p("helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach,g=(d=p("helpers/object"),d&&d.__esModule&&d||{"default":d}).objectEach,e=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(e,{createEmptyBucket:function(){var e=Object.create(null);l(h,function(d){return e[d]=[]});return e},getBucket:function(e){return(e=void 0!==e?e:null)?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket},add:function(e,d,a){var b=void 0!==a?a:null,f=this;if(Array.isArray(d))l(d,function(a){return f.add(e,a,b)});else{var g=this.getBucket(b);"undefined"===typeof g[e]&&(this.register(e),g[e]=[]);d.skip=!1;if(-1===g[e].indexOf(d)){var m=!1;d.initialHook&&l(g[e],function(a,b){if(a.initialHook)return g[e][b]=d,m=!0,!1});m||g[e].push(d)}}return this},once:function(e,d,a){var b=void 0!==a?a:null,f=this;Array.isArray(d)?l(d,function(a){return f.once(e,a,b)}):(d.runOnce=!0,this.add(e,d,b))},remove:function(e,d,a){a=this.getBucket(void 0!==a?a:null);return"undefined"!==typeof a[e]&&0<=a[e].indexOf(d)?d.skip=!0:!1},has:function(e,d){var a=this.getBucket(void 0!==d?d:null);return void 0!==a[e]&&a[e].length?!0:!1},run:function(e,d,a,b,f,g,h,l){var m=this.globalBucket[d],n=-1,k=m?m.length:0;if(k)for(;++n<k;)if(m[n]&&!m[n].skip){var t=m[n].call(e,a,b,f,g,h,l);void 0!==t&&(a=t);m[n]&&m[n].runOnce&&this.remove(d,m[n])}m=this.getBucket(e)[d];n=-1;if(k=m?m.length:0)for(;++n<k;)m[n]&&!m[n].skip&&(t=m[n].call(e,a,b,f,g,h,l),void 0!==t&&(a=t),m[n]&&m[n].runOnce&&this.remove(d,m[n],e));return a},destroy:function(e){g(this.getBucket(void 0!==e?e:null),function(e,a,b){return b[a].length=0})},register:function(e){this.isRegistered(e)||h.push(e)},deregister:function(e){this.isRegistered(e)&&h.splice(h.indexOf(e),1)},isRegistered:function(e){return 0<=h.indexOf(e)},getRegistered:function(){return h}},{})},{"helpers/array":43,"helpers/object":53}],62:[function(p,q,r){function k(e,d){e=b(e);m.plugins[e]=d;m.hooks.add("construct",function(){var a;f.has(this)||f.set(this,{});a=f.get(this);a[e]||(a[e]=new d(this))});m.hooks.add("afterDestroy",function(){if(f.has(this)){var b=f.get(this);a(b,function(a){return a.destroy()});f["delete"](this)}})}function d(a,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var d=b(e);if(f.has(a)&&f.get(a)[d])return f.get(a)[d]}function h(a){return f.has(a)?Object.keys(f.get(a)):[]}function l(b,e){var d=null;f.has(b)&&a(f.get(b),function(a,b){a===e&&(d=b)});return d}Object.defineProperties(r,{registerPlugin:{get:function(){return k}},getPlugin:{get:function(){return d}},getRegistredPluginNames:{get:function(){return h}},getPluginName:{get:function(){return l}},__esModule:{value:!0}});var g,e,n,m=(g=p("browser"),g&&g.__esModule&&g||{"default":g})["default"],a=(e=p("helpers/object"),e&&e.__esModule&&e||{"default":e}).objectEach,b=(n=p("helpers/string"),n&&n.__esModule&&n||{"default":n}).toUpperCaseFirst,f=new WeakMap},{browser:24,"helpers/object":53,"helpers/string":55}],63:[function(p,q,r){Object.defineProperties(r,{"default":{get:function(){return v}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/object"),d&&d.__esModule&&d||{"default":d});var e=k.defineGetter,n=k.objectEach,m=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,a=(l=p("utils/recordTranslator"),l&&l.__esModule&&l||{"default":l}).getTranslator;p=(g=p("plugins"),g&&g.__esModule&&g||{"default":g});var b=p.getRegistredPluginNames,f=p.getPluginName,t=new WeakMap,u=null;g=function(b){var f=this;e(this,"hot",b,{writable:!1});e(this,"t",a(b),{writable:!1});t.set(this,{hooks:{}});this.pluginName=u=null;this.pluginsInitializedCallbacks=[];this.initialized=this.enabled=this.isPluginsReady=!1;this.hot.addHook("afterPluginsInitialized",function(){return f.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(){return f.onUpdateSettings()});this.hot.addHook("beforeInit",function(){return f.init()})};$traceurRuntime.createClass(g,{init:function(){this.pluginName=f(this.hot,this);this.isEnabled&&this.isEnabled()&&this.enablePlugin();u||(u=b(this.hot));0<=u.indexOf(this.pluginName)&&u.splice(u.indexOf(this.pluginName),1);u.length||this.hot.runHooks("afterPluginsInitialized");this.initialized=!0},enablePlugin:function(){this.enabled=!0},disablePlugin:function(){this.eventManager&&this.eventManager.clear();this.clearHooks();this.enabled=!1},addHook:function(a,b){var f=t.get(this).hooks[a]=t.get(this).hooks[a]||[];this.hot.addHook(a,b);f.push(b);t.get(this).hooks[a]=f},removeHooks:function(a){var b=this;m(t.get(this).hooks[a]||[],function(f){b.hot.removeHook(a,f)})},clearHooks:function(){var a=this,b=t.get(this).hooks;n(b,function(b,f){return a.removeHooks(f)});b.length=0},callOnPluginsReady:function(a){this.isPluginsReady?a():this.pluginsInitializedCallbacks.push(a)},onAfterPluginsInitialized:function(){m(this.pluginsInitializedCallbacks,function(a){return a()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=!0},onUpdateSettings:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())},updatePlugin:function(){},destroy:function(){var a=this;this.eventManager&&this.eventManager.destroy();this.clearHooks();n(this,function(b,f){"hot"!==f&&"t"!==f&&(a[f]=null)});delete this.t;delete this.hot}},{});var v=g;q.plugins.BasePlugin=g},{browser:24,"helpers/array":43,"helpers/object":53,plugins:62,"utils/recordTranslator":132}],64:[function(p,q,r){Object.defineProperties(r,{AutoColumnSize:{get:function(){return J}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d});var t=k.arrayEach,u=k.arrayFilter,v=k.arrayReduce,y=k.arrayMap;d=(h=p("helpers/feature"),h&&h.__esModule&&h||{"default":h});var w=d.cancelAnimationFrame,z=d.requestAnimationFrame,x=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).isVisible,C=(g=p("utils/ghostTable"),g&&g.__esModule&&g||{"default":g}).GhostTable,E=(e=p("helpers/object"),e&&e.__esModule&&e||{"default":e}).isObject;h=(n=p("helpers/number"),n&&n.__esModule&&n||{"default":n});var A=h.valueAccordingPercent,B=h.rangeEach;n=(m=p("plugins"),m&&m.__esModule&&m||{"default":m}).registerPlugin;var G=(a=p("utils/samplesGenerator"),a&&a.__esModule&&a||{"default":a}).SamplesGenerator,D=(b=p("helpers/string"),b&&b.__esModule&&b||{"default":b}).isPercentValue,F=(f=p("3rdparty/walkontable/src/calculator/viewportColumns"),f&&f.__esModule&&f||{"default":f}).WalkontableViewportColumnsCalculator,H=new WeakMap,J=function(a){var b=this;$traceurRuntime.superConstructor(K).call(this,a);H.set(this,{cachedColumnHeaders:[]});this.widths=[];this.ghostTable=new C(this.hot);this.samplesGenerator=new G(function(a,f){return b.hot.getDataAtCell(a,f)});this.firstCalculation=!0;this.inProgress=!1;this.addHook("beforeColumnResize",function(a,f,e){return b.onBeforeColumnResize(a,f,e)})},K=J;$traceurRuntime.createClass(J,{isEnabled:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().autoColumnSize;b&&null!=b.useHeaders&&this.ghostTable.setSetting("useHeaders",b.useHeaders);this.addHook("afterLoadData",function(){return a.onAfterLoadData()});this.addHook("beforeChange",function(b){return a.onBeforeChange(b)});this.addHook("beforeRender",function(b){return a.onBeforeRender(b)});this.addHook("modifyColWidth",function(b,f){return a.getColumnWidth(f,b)});this.addHook("afterInit",function(){return a.onAfterInit()});$traceurRuntime.superGet(this,K.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.findColumnsWhereHeaderWasChanged();a.length&&this.clearCache(a);$traceurRuntime.superGet(this,K.prototype,"updatePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,K.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function(a,b,f){a=void 0!==a?a:{from:0,to:this.hot.countCols()-1};var e=void 0!==b?b:{from:0,to:this.hot.countRows()-1},d=void 0!==f?f:!1,g=this;"number"===typeof a&&(a={from:a,to:a});"number"===typeof e&&(e={from:e,to:e});B(a.from,a.to,function(a){(d||void 0===g.widths[a]&&!g.hot._getColWidthFromSettings(a))&&g.samplesGenerator.generateColumnSamples(a,e).forEach(function(a,b){return g.ghostTable.addColumn(b,a)})});this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(a,b){return g.widths[a]=b}),this.ghostTable.clean())},calculateAllColumnsWidth:function(a){var b=void 0!==a?a:{from:0,to:this.hot.countRows()-1},f=this,e=0,d=this.hot.countCols()-1,g=null;this.inProgress=!0;var m=function(){f.hot?(f.calculateColumnsWidth({from:e,to:Math.min(e+K.CALCULATION_STEP,d)},b),e=e+K.CALCULATION_STEP+1,e<d?g=z(m):(w(g),f.inProgress=!1,f.hot.view.wt.wtOverlays.adjustElementsSize(!0),f.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&f.hot.view.wt.wtOverlays.leftOverlay.clone.draw())):(w(g),f.inProgress=!1)};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},b),this.firstCalculation=!1,e=this.getSyncCalculationLimit()+1);e<d?m():this.inProgress=!1},setSamplingOptions:function(){var a=this.hot.getSettings().autoColumnSize,b=a&&a.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,a=a&&a.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;b&&!isNaN(b)&&this.samplesGenerator.setSampleCount(parseInt(b,10));a&&this.samplesGenerator.setAllowDuplicates(a)},recalculateAllColumnsWidth:function(){this.hot.view&&x(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())},getSyncCalculationLimit:function(){var a=K.SYNC_CALCULATION_LIMIT,b=this.hot.countCols()-1;E(this.hot.getSettings().autoColumnSize)&&(a=this.hot.getSettings().autoColumnSize.syncLimit,a=D(a)?A(b,a):a>>0);return Math.min(a,b)},getColumnWidth:function(a,b,f){void 0===b&&(b=this.widths[a],(void 0!==f?f:1)&&"number"===typeof b&&(b=Math.max(b,F.DEFAULT_WIDTH)));return b},getFirstVisibleColumn:function(){var a=this.hot.view.wt;return a.wtViewport.columnsVisibleCalculator?a.wtTable.getFirstVisibleColumn():a.wtViewport.columnsRenderCalculator?a.wtTable.getFirstRenderedColumn():-1},getLastVisibleColumn:function(){var a=this.hot.view.wt;return a.wtViewport.columnsVisibleCalculator?a.wtTable.getLastVisibleColumn():a.wtViewport.columnsRenderCalculator?a.wtTable.getLastRenderedColumn():-1},findColumnsWhereHeaderWasChanged:function(){var a=this.hot.getColHeader(),b=H.get(this).cachedColumnHeaders;return v(a,function(a,f,e){var d=b.length;(d-1<e||b[e]!==f)&&a.push(e);d-1<e?b.push(f):b[e]=f;return a},[])},clearCache:function(a){a=void 0!==a?a:[];var b=this;a.length?t(a,function(a){return b.widths[a]=void 0}):this.widths.length=0},isNeedRecalculate:function(){return u(this.widths,function(a){return void 0===a}).length?!0:!1},onBeforeRender:function(){var a=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,a),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())},onAfterLoadData:function(){var a=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){a.hot&&a.recalculateAllColumnsWidth()},0)},onBeforeChange:function(a){var b=this;a=y(a,function(a){return b.hot.propToCol(a[1])});this.clearCache(a)},onBeforeColumnResize:function(a,b,f){f&&(this.calculateColumnsWidth(a,void 0,!0),b=this.getColumnWidth(a,void 0,!1));return b},onAfterInit:function(){H.get(this).cachedColumnHeaders=this.hot.getColHeader()},destroy:function(){this.ghostTable.clean();$traceurRuntime.superGet(this,K.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},q);n("autoColumnSize",J)},{"3rdparty/walkontable/src/calculator/viewportColumns":4,_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],65:[function(p,q,r){Object.defineProperties(r,{AutoRowSize:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k})["default"];var f=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayFilter;k=(h=p("helpers/feature"),h&&h.__esModule&&h||{"default":h});var t=k.cancelAnimationFrame,u=k.requestAnimationFrame,v=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).isVisible,y=(g=p("utils/ghostTable"),g&&g.__esModule&&g||{"default":g}).GhostTable,w=(e=p("helpers/object"),e&&e.__esModule&&e||{"default":e}).isObject;h=(n=p("helpers/number"),n&&n.__esModule&&n||{"default":n});var z=h.valueAccordingPercent,x=h.rangeEach;n=(m=p("plugins"),m&&m.__esModule&&m||{"default":m}).registerPlugin;var C=(a=p("utils/samplesGenerator"),a&&a.__esModule&&a||{"default":a}).SamplesGenerator,E=(b=p("helpers/string"),b&&b.__esModule&&b||{"default":b}).isPercentValue,A=function(a){var b=this;$traceurRuntime.superConstructor(B).call(this,a);this.heights=[];this.ghostTable=new y(this.hot);this.samplesGenerator=new C(function(a,f){return 0<=a?b.hot.getDataAtCell(a,f):-1===a?b.hot.getColHeader(f):null});this.firstCalculation=!0;this.inProgress=!1;this.addHook("beforeRowResize",function(a,f,e){return b.onBeforeRowResize(a,f,e)})},B=A;$traceurRuntime.createClass(A,{isEnabled:function(){return!0===this.hot.getSettings().autoRowSize||w(this.hot.getSettings().autoRowSize)},enablePlugin:function(){var a=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return a.onAfterLoadData()}),this.addHook("beforeChange",function(b){return a.onBeforeChange(b)}),this.addHook("beforeColumnMove",function(){return a.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return a.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return a.clearCache()}),this.addHook("beforeRender",function(b){return a.onBeforeRender(b)}),this.addHook("beforeRowMove",function(b,f){return a.onBeforeRowMove(b,f)}),this.addHook("modifyRowHeight",function(b,f){return a.getRowHeight(f,b)}),this.addHook("modifyColumnHeaderHeight",function(){return a.getColumnHeaderHeight()}),$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},calculateRowsHeight:function(a,b,f){a=void 0!==a?a:{from:0,to:this.hot.countRows()-1};var e=void 0!==b?b:{from:0,to:this.hot.countCols()-1},d=void 0!==f?f:!1,g=this;"number"===typeof a&&(a={from:a,to:a});"number"===typeof e&&(e={from:e,to:e});null!==this.hot.getColHeader(0)&&(b=this.samplesGenerator.generateRowSamples(-1,e),this.ghostTable.addColumnHeadersRow(b.get(-1)));x(a.from,a.to,function(a){(d||void 0===g.heights[a])&&g.samplesGenerator.generateRowSamples(a,e).forEach(function(a,b){return g.ghostTable.addRow(b,a)})});this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(a,b){return g.heights[a]=b}),this.ghostTable.clean())},calculateAllRowsHeight:function(a){var b=void 0!==a?a:{from:0,to:this.hot.countCols()-1},f=this,e=0,d=this.hot.countRows()-1,g=null;this.inProgress=!0;var m=function(){f.hot?(f.calculateRowsHeight({from:e,to:Math.min(e+B.CALCULATION_STEP,d)},b),e=e+B.CALCULATION_STEP+1,e<d?g=u(m):(t(g),f.inProgress=!1,f.hot.view.wt.wtOverlays.adjustElementsSize(!0),f.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&f.hot.view.wt.wtOverlays.leftOverlay.clone.draw())):(t(g),f.inProgress=!1)};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},b),this.firstCalculation=!1,e=this.getSyncCalculationLimit()+1);e<d?m():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))},setSamplingOptions:function(){var a=this.hot.getSettings().autoRowSize,b=a&&a.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,a=a&&a.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;b&&!isNaN(b)&&this.samplesGenerator.setSampleCount(parseInt(b,10));a&&this.samplesGenerator.setAllowDuplicates(a)},recalculateAllRowsHeight:function(){v(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())},getSyncCalculationLimit:function(){var a=B.SYNC_CALCULATION_LIMIT,b=this.hot.countRows()-1;w(this.hot.getSettings().autoRowSize)&&(a=this.hot.getSettings().autoRowSize.syncLimit,a=E(a)?z(b,a):a>>0);return Math.min(a,b)},getRowHeight:function(a,b){var f=b;void 0!==this.heights[a]&&this.heights[a]>(b||0)&&(f=this.heights[a]);return f},getColumnHeaderHeight:function(){return this.heights[-1]},getFirstVisibleRow:function(){var a=this.hot.view.wt;return a.wtViewport.rowsVisibleCalculator?a.wtTable.getFirstVisibleRow():a.wtViewport.rowsRenderCalculator?a.wtTable.getFirstRenderedRow():-1},getLastVisibleRow:function(){var a=this.hot.view.wt;return a.wtViewport.rowsVisibleCalculator?a.wtTable.getLastVisibleRow():a.wtViewport.rowsRenderCalculator?a.wtTable.getLastRenderedRow():-1},clearCache:function(){this.heights.length=0;this.heights[-1]=void 0},clearCacheByRange:function(a){var b=this;"number"===typeof a&&(a={from:a,to:a});x(Math.min(a.from,a.to),Math.max(a.from,a.to),function(a){return b.heights[a]=void 0})},isNeedRecalculate:function(){return f(this.heights,function(a){return void 0===a}).length?!0:!1},onBeforeRender:function(){var a=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,a);if(a=this.hot.getSettings().fixedRowsBottom){var b=this.hot.countRows()-1;this.calculateRowsHeight({from:b-a,to:b})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()},onBeforeRowMove:function(a,b){this.clearCacheByRange({from:a,to:b});this.calculateAllRowsHeight()},onBeforeRowResize:function(a,b,f){f&&(this.calculateRowsHeight(a,void 0,!0),b=this.getRowHeight(a));return b},onAfterLoadData:function(){var a=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){a.hot&&a.recalculateAllRowsHeight()},0)},onBeforeChange:function(a){var b=null;1===a.length?b=a[0][0]:1<a.length&&(b={from:a[0][0],to:a[a.length-1][0]});null!==b&&this.clearCacheByRange(b)},destroy:function(){this.ghostTable.clean();$traceurRuntime.superGet(this,B.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},q);n("autoRowSize",A)},{_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],66:[function(p,q,r){Object.defineProperties(r,{Autofill:{get:function(){return C}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];var a=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayIncludes;d=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l});var b=d.offset,f=d.outerHeight,t=d.outerWidth,u=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).eventManager;l=(e=p("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin;var v=(n=p("3rdparty/walkontable/src/cell/coords"),n&&n.__esModule&&n||{"default":n}).WalkontableCellCoords;p=(m=p("utils"),m&&m.__esModule&&m||{"default":m});var y=p.getDeltas,w=p.getDragDirectionAndRange,z=p.DIRECTIONS,x=p.getMappedFillHandleSetting,C=function(a){$traceurRuntime.superConstructor(E).call(this,a);this.eventManager=u(this);this.mouseDragOutside=this.mouseDownOnCellCorner=this.addingStarted=!1;this.handleDraggedCells=0;this.directions=[];this.autoInsertRow=!1},E=C;$traceurRuntime.createClass(C,{isEnabled:function(){return this.hot.getSettings().fillHandle},enablePlugin:function(){var a=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(b){return a.onAfterCellCornerMouseDown(b)}),this.addHook("afterOnCellCornerDblClick",function(b){return a.onCellCornerDblClick(b)}),this.addHook("beforeOnCellMouseOver",function(b,f,e){return a.onBeforeCellMouseOver(f)}),$traceurRuntime.superGet(this,E.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,E.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.clearMappedSettings();$traceurRuntime.superGet(this,E.prototype,"disablePlugin").call(this)},getSelectionData:function(){var a=this.hot.getSelectedRange().from,b=this.hot.getSelectedRange().to;return this.hot.getData(a.row,a.col,b.row,b.col)},fillIn:function(){if(this.hot.view.wt.selections.fill.isEmpty())return!1;var a=this.hot.view.wt.selections.fill.getCorners();this.resetSelectionOfDraggedArea();var b=this.getCornersOfSelectedCells(),f=w(b,a),e=f.directionOfDrag,d=f.startOfDragCoords,f=f.endOfDragCoords;this.hot.runHooks("modifyAutofillRange",b,a);if(d&&-1<d.row&&-1<d.col){var b=this.getSelectionData(),g=y(d,f,b,e);this.hot.runHooks("beforeAutofill",d,f,b);this.hot.populateFromArray(d.row,d.col,b,f.row,f.col,this.pluginName+".fill",null,e,g);this.setSelection(a)}else this.hot.selection.refreshBorders();return!0},reduceSelectionAreaIfNeeded:function(a){0>a.row&&(a.row=0);0>a.col&&(a.col=0);return a},getCoordsOfDragAndDropBorders:function(b){var f=this.hot.getSelectedRange().getTopLeftCorner(),e=this.hot.getSelectedRange().getBottomRightCorner();if(a(this.directions,z.vertical)&&(e.row<b.row||f.row>b.row))b=new v(b.row,e.col);else if(a(this.directions,z.horizontal))b=new v(e.row,b.col);else return;return this.reduceSelectionAreaIfNeeded(b)},showBorder:function(a){(a=this.getCoordsOfDragAndDropBorders(a))&&this.redrawBorders(a)},addRow:function(){var a=this;this.hot._registerTimeout(setTimeout(function(){a.hot.alter("insert_row",void 0,1,a.pluginName+".fill");a.addingStarted=!1},200))},addNewRowIfNeeded:function(){if(this.hot.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&this.autoInsertRow){var a=this.hot.getSelected(),b=this.hot.view.wt.selections.fill.getCorners(),f=this.hot.countRows();a[2]<f-1&&b[2]===f-1&&(this.addingStarted=!0,this.addRow())}},getCornersOfSelectedCells:function(){return this.hot.selection.isMultiple()?this.hot.view.wt.selections.area.getCorners():this.hot.view.wt.selections.current.getCorners()},getIndexOfLastAdjacentFilledInRow:function(a){for(var b=this.hot.getData(),f=this.hot.countRows(),e,d=a[2]+1;d<f;d++){for(var g=a[1];g<=a[3];g++)if(b[d][g])return-1;g=b[d][a[3]+1];if(b[d][a[1]-1]||g)e=d}return e},addSelectionFromStartAreaToSpecificRowIndex:function(a,b){this.hot.view.wt.selections.fill.clear();this.hot.view.wt.selections.fill.add(new v(a[0],a[1]));this.hot.view.wt.selections.fill.add(new v(b,a[3]))},setSelection:function(a){this.hot.selection.setRangeStart(new v(a[0],a[1]));this.hot.selection.setRangeEnd(new v(a[2],a[3]))},selectAdjacent:function(){var a=this.getCornersOfSelectedCells(),b=this.getIndexOfLastAdjacentFilledInRow(a);if(-1===b)return!1;this.addSelectionFromStartAreaToSpecificRowIndex(a,b);return!0},resetSelectionOfDraggedArea:function(){this.handleDraggedCells=0;this.hot.view.wt.selections.fill.clear()},redrawBorders:function(a){this.hot.view.wt.selections.fill.clear();this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from);this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to);this.hot.view.wt.selections.fill.add(a);this.hot.view.render()},getIfMouseWasDraggedOutside:function(a){var e=b(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+f(this.hot.table),d=b(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+t(this.hot.table);return a.clientY>e&&a.clientX<=d},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()});this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)})},onCellCornerDblClick:function(){this.selectAdjacent()&&this.fillIn()},onAfterCellCornerMouseDown:function(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=!0},onBeforeCellMouseOver:function(a){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(a),this.addNewRowIfNeeded())},onMouseUp:function(){this.handleDraggedCells&&(1<this.handleDraggedCells&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)},onMouseMove:function(a){a=this.getIfMouseWasDraggedOutside(a);!1===this.addingStarted&&0<this.handleDraggedCells&&a?this.addingStarted=this.mouseDragOutside=!0:this.mouseDragOutside=!1;this.mouseDragOutside&&this.autoInsertRow&&this.addRow()},clearMappedSettings:function(){this.directions.length=0;this.autoInsertRow=!1},mapSettings:function(){var a=x(this.hot.getSettings().fillHandle);this.directions=a.directions;this.autoInsertRow=a.autoInsertRow},destroy:function(){$traceurRuntime.superGet(this,E.prototype,"destroy").call(this)}},{},q);l("autofill",C);k.hooks.register("modifyAutofillRange");k.hooks.register("beforeAutofill")},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,utils:67}],67:[function(p,q,r){function k(a,b,f,e){var d=f.length,g=f?f[0].length:0,m=[],n=b.row-a.row;a=b.col-a.col;if(-1!==["down","up"].indexOf(e)){b=[];for(var h=0;h<=a;h++){var l=parseInt(f[0][h],10),k=parseInt(f[d-1][h],10);b.push(("down"===e?k-l:l-k)/(d-1)||0)}m.push(b)}if(-1!==["right","left"].indexOf(e))for(d=0;d<=n;d++)a=parseInt(f[d][0],10),b=parseInt(f[d][g-1],10),m.push([("right"===e?b-a:a-b)/(g-1)||0]);return m}function d(a,b){var f,e,d;b[0]===a[0]&&b[1]<a[1]?(d="left",f=new WalkontableCellCoords(b[0],b[1]),e=new WalkontableCellCoords(b[2],a[1]-1)):b[0]===a[0]&&b[3]>a[3]?(d="right",f=new WalkontableCellCoords(b[0],a[3]+1),e=new WalkontableCellCoords(b[2],b[3])):b[0]<a[0]&&b[1]===a[1]?(d="up",f=new WalkontableCellCoords(b[0],b[1]),e=new WalkontableCellCoords(a[0]-1,b[3])):b[2]>a[2]&&b[1]===a[1]&&(d="down",f=new WalkontableCellCoords(a[2]+1,b[1]),e=new WalkontableCellCoords(b[2],b[3]));return{directionOfDrag:d,startOfDragCoords:f,endOfDragCoords:e}}function h(a){var b={};!0===a?(b.directions=Object.keys(m),b.autoInsertRow=!0):e(a)?(n(a.autoInsertRow)?b.autoInsertRow=a.direction===m.horizontal?!1:a.autoInsertRow:b.autoInsertRow=!1,n(a.direction)?b.directions=[a.direction]:b.directions=Object.keys(m)):"string"===typeof a?(b.directions=[a],b.autoInsertRow=!0):(b.directions=[],b.autoInsertRow=!1);return b}Object.defineProperties(r,{DIRECTIONS:{get:function(){return m}},getDeltas:{get:function(){return k}},getDragDirectionAndRange:{get:function(){return d}},getMappedFillHandleSetting:{get:function(){return h}},__esModule:{value:!0}});var l,g,e=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l}).isObject,n=(g=p("helpers/mixed"),g&&g.__esModule&&g||{"default":g}).isDefined,m={horizontal:"horizontal",vertical:"vertical"}},{"helpers/mixed":51,"helpers/object":53}],68:[function(p,q,r){Object.defineProperties(r,{ColumnSorting:{get:function(){return x}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"],b=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var f=q.addClass,t=q.hasClass,u=q.removeClass;h=(l=p("helpers/array"),l&&l.__esModule&&l||{"default":l});var v=h.arrayMap,y=h.arrayReduce,w=(g=p("helpers/mixed"),g&&g.__esModule&&g||{"default":g}).isEmpty;l=(e=p("_base"),e&&e.__esModule&&e||{"default":e})["default"];e=(n=p("plugins"),n&&n.__esModule&&n||{"default":n}).registerPlugin;var z=(m=p("utils/sortingAlgorithms/mergeSort"),m&&m.__esModule&&m||{"default":m}).mergeSort;a.hooks.register("beforeColumnSort");a.hooks.register("afterColumnSort");var x=function(a){$traceurRuntime.superConstructor(C).call(this,a);this.sortIndicators=[];this.lastSortedColumn=null;this.sortEmptyCells=!1},C=x;$traceurRuntime.createClass(x,{isEnabled:function(){return!!this.hot.getSettings().columnSorting},enablePlugin:function(){var a=this;if(!this.enabled){this.setPluginOptions();var b=this;this.hot.sortIndex=[];this.hot.sort=function(){var a=Array.prototype.slice.call(arguments);return b.sortByColumn.apply(b,a)};"undefined"===typeof this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin();this.addHook("afterTrimRow",function(b){return a.sort()});this.addHook("afterUntrimRow",function(b){return a.sort()});this.addHook("modifyRow",function(b){return a.translateRow(b)});this.addHook("unmodifyRow",function(b){return a.untranslateRow(b)});this.addHook("afterUpdateSettings",function(){return a.onAfterUpdateSettings()});this.addHook("afterGetColHeader",function(b,f){return a.getColHeader(b,f)});this.addHook("afterOnCellMouseDown",function(b,f){return a.onAfterOnCellMouseDown(b,f)});this.addHook("afterCreateRow",function(){b.afterCreateRow.apply(b,arguments)});this.addHook("afterRemoveRow",function(){b.afterRemoveRow.apply(b,arguments)});this.addHook("afterInit",function(){return a.sortBySettings()});this.addHook("afterLoadData",function(){a.hot.sortIndex=[];a.hot.view&&a.sortBySettings()});this.hot.view&&this.sortBySettings();$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)}},disablePlugin:function(){this.hot.sort=void 0;$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function(){this.sortBySettings()},sortBySettings:function(){var a=this.hot.getSettings().columnSorting,b=this.loadSortingState(),f;"undefined"===typeof b?(f=a.column,a=a.sortOrder):(f=b.sortColumn,a=b.sortOrder);"number"===typeof f&&(this.lastSortedColumn=f,this.sortByColumn(f,a))},setSortingColumn:function(a,b){"undefined"==typeof a?(this.hot.sortColumn=void 0,this.hot.sortOrder=void 0):(this.hot.sortOrder=this.hot.sortColumn===a&&"undefined"==typeof b?!1===this.hot.sortOrder?void 0:!this.hot.sortOrder:"undefined"===typeof b?!0:b,this.hot.sortColumn=a)},sortByColumn:function(b,f){this.setSortingColumn(b,f);"undefined"!=typeof this.hot.sortColumn&&(!1!==a.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder)&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),a.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState())},saveSortingState:function(){var b={};"undefined"!=typeof this.hot.sortColumn&&(b.sortColumn=this.hot.sortColumn);"undefined"!=typeof this.hot.sortOrder&&(b.sortOrder=this.hot.sortOrder);(b.hasOwnProperty("sortColumn")||b.hasOwnProperty("sortOrder"))&&a.hooks.run(this.hot,"persistentStateSave","columnSorting",b)},loadSortingState:function(){var b={};a.hooks.run(this.hot,"persistentStateLoad","columnSorting",b);return b.value},updateOrderClass:function(){var a;!0===this.hot.sortOrder?a="ascending":!1===this.hot.sortOrder&&(a="descending");this.sortOrderClass=a},enableObserveChangesPlugin:function(){var a=this;this.hot._registerTimeout(setTimeout(function(){a.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(a,b){return function(f,e){"string"==typeof f[1]&&(f[1]=f[1].toLowerCase());"string"==typeof e[1]&&(e[1]=e[1].toLowerCase());if(f[1]===e[1])return 0;if(w(f[1]))return w(e[1])?0:b.columnSorting.sortEmptyCells?a?-1:1:1;if(w(e[1]))return w(f[1])?0:b.columnSorting.sortEmptyCells?a?1:-1:-1;if(isNaN(f[1])&&!isNaN(e[1]))return a?1:-1;if(!isNaN(f[1])&&isNaN(e[1]))return a?-1:1;isNaN(f[1])||isNaN(e[1])||(f[1]=parseFloat(f[1]),e[1]=parseFloat(e[1]));return f[1]<e[1]?a?-1:1:f[1]>e[1]?a?1:-1:0}},dateSort:function(a,f){return function(e,d){if(e[1]===d[1])return 0;if(w(e[1]))return w(d[1])?0:f.columnSorting.sortEmptyCells?a?-1:1:1;if(w(d[1]))return w(e[1])?0:f.columnSorting.sortEmptyCells?a?1:-1:-1;var g=b(e[1],f.dateFormat),m=b(d[1],f.dateFormat);return g.isValid()?m.isValid()?m.isAfter(g)?a?-1:1:m.isBefore(g)?a?1:-1:0:-1:1}},numericSort:function(a,b){return function(f,e){var d=parseFloat(f[1]),g=parseFloat(e[1]);if(d===g||isNaN(d)&&isNaN(g))return 0;if(b.columnSorting.sortEmptyCells){if(w(f[1]))return a?-1:1;if(w(e[1]))return a?1:-1}return isNaN(d)?1:isNaN(g)?-1:d<g?a?-1:1:d>g?a?1:-1:0}},sort:function(){if("undefined"==typeof this.hot.sortOrder)this.hot.sortIndex.length=0;else{var a=this.hot.getCellMeta(0,this.hot.sortColumn),b=this.hot.countEmptyRows(),f;this.hot.sortingEnabled=!1;this.hot.sortIndex.length=0;"undefined"===typeof a.columnSorting.sortEmptyCells&&(a.columnSorting={sortEmptyCells:this.sortEmptyCells});f=0;for(b=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-b;f<b;f++)this.hot.sortIndex.push([f,this.hot.getDataAtCell(f,this.hot.sortColumn)]);if(a.sortFunction)f=a.sortFunction;else switch(a.type){case "date":f=this.dateSort;break;case "numeric":f=this.numericSort;break;default:f=this.defaultSort}z(this.hot.sortIndex,f(this.hot.sortOrder,a));for(a=this.hot.sortIndex.length;a<this.hot.countRows();a++)this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}},updateSortIndicator:function(){if("undefined"!=typeof this.hot.sortOrder){var a=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=a.sortIndicator}},translateRow:function(a){return this.hot.sortingEnabled&&"undefined"!==typeof this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[a]?this.hot.sortIndex[a][0]:a},untranslateRow:function(a){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var b=0;b<this.hot.sortIndex.length;b++)if(this.hot.sortIndex[b][0]==a)return b},getColHeader:function(a,b){if(0>a||!b.parentNode)return!1;var e=b.querySelector(".colHeader");b.getAttribute("colspan");var d=b.parentNode.parentNode.childNodes,g=Array.prototype.indexOf.call(d,b.parentNode),g=g-d.length;e&&(this.hot.getSettings().columnSorting&&0<=a&&-1===g&&f(e,"columnSorting"),u(e,"descending"),u(e,"ascending"),this.sortIndicators[a]&&a===this.hot.sortColumn&&("ascending"===this.sortOrderClass?f(e,"ascending"):"descending"===this.sortOrderClass&&f(e,"descending")))},isSorted:function(){return"undefined"!=typeof this.hot.sortColumn},afterCreateRow:function(a,b){if(this.isSorted()){for(var f=0;f<this.hot.sortIndex.length;f++)this.hot.sortIndex[f][0]>=a&&(this.hot.sortIndex[f][0]+=b);for(f=0;f<b;f++)this.hot.sortIndex.splice(a+f,0,[a+f,this.hot.getSourceData()[a+f][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(a,b){function f(a){return y(e,function(b,f){a>f&&b++;return b},0)}if(this.isSorted()){var e=this.hot.sortIndex.splice(a,b),e=v(e,function(a){return a[0]});this.hot.sortIndex=v(this.hot.sortIndex,function(a,b){var e=f(a[0]);e&&(a[0]-=e);return a});this.saveSortingState()}},setPluginOptions:function(){var a=this.hot.getSettings().columnSorting;this.sortEmptyCells="object"===typeof a?a.sortEmptyCells||!1:!1},onAfterOnCellMouseDown:function(a,b){-1<b.row||!t(a.realTarget,"columnSorting")||(b.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=b.col,this.sortByColumn(b.col))}},{},l);e("columnSorting",x)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,moment:"moment",plugins:62,"utils/sortingAlgorithms/mergeSort":134}],69:[function(p,q,r){Object.defineProperties(r,{CommentEditor:{get:function(){return h}},__esModule:{value:!0}});var k,d=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,h=function(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=!0;this.hide()},l=h;$traceurRuntime.createClass(h,{setPosition:function(d,e){this.editorStyle.left=d+"px";this.editorStyle.top=e+"px"},setSize:function(d,e){if(d&&e){var g=this.getInputElement();g.style.width=d+"px";g.style.height=e+"px"}},resetSize:function(){var d=this.getInputElement();d.style.width="";d.style.height=""},setReadOnlyState:function(d){this.getInputElement().readOnly=d},show:function(){this.editorStyle.display="block";this.hidden=!1},hide:function(){this.editorStyle.display="none";this.hidden=!0},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(d){d=(void 0!==d?d:"")||"";this.getInputElement().value=d},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var g=document.querySelector("."+l.CLASS_EDITOR_CONTAINER),e,n;g||(g=document.createElement("div"),d(g,l.CLASS_EDITOR_CONTAINER),document.body.appendChild(g));e=document.createElement("div");d(e,l.CLASS_EDITOR);n=document.createElement("textarea");d(n,l.CLASS_INPUT);e.appendChild(n);g.appendChild(e);return e},getInputElement:function(){return this.editor.querySelector("."+l.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor);this.editorStyle=this.editor=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":47}],70:[function(p,q,r){var k;Object.defineProperties(r,{Comments:{get:function(){return O}},__esModule:{value:!0}});var d,h,l,g,e,n,m,a,b,f,t=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var u=q.addClass,v=q.closest,y=q.isChildOf,w=q.hasClass,z=q.offset,x=q.outerWidth,C=q.outerHeight,E=q.getScrollableElement;h=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l});var A=h.deepClone,B=h.deepExtend,G=(g=p("helpers/function"),g&&g.__esModule&&g||{"default":g}).debounce,D=(e=p("eventManager"),e&&e.__esModule&&e||{"default":e}).EventManager,F=(n=p("3rdparty/walkontable/src/cell/coords"),n&&n.__esModule&&n||{"default":n}).WalkontableCellCoords;l=(m=p("plugins"),m&&m.__esModule&&m||{"default":m}).registerPlugin;m=(a=p("_base"),a&&a.__esModule&&a||{"default":a})["default"];var H=(b=p("commentEditor"),b&&b.__esModule&&b||{"default":b}).CommentEditor;p=(f=p("contextMenu/utils"),f&&f.__esModule&&f||{"default":f});var J=p.checkSelectionConsistency,K=p.markLabelAsSelected,I=new WeakMap,O=function(a){$traceurRuntime.superConstructor(Q).call(this,a);this.eventManager=this.editor=null;this.range={};this.contextMenuEvent=this.mouseDown=!1;this.timer=null;this.displayDelay=250;I.set(this,{tempEditorDimensions:{},cellBelowCursor:null})},Q=O;$traceurRuntime.createClass(O,(k={},Object.defineProperty(k,"isEnabled",{value:function(){return!!this.hot.getSettings().comments},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"enablePlugin",{value:function(){var a=this;this.enabled||(this.editor||(this.editor=new H),this.eventManager||(this.eventManager=new D(this)),this.addHook("afterContextMenuDefaultOptions",function(b){return a.addToContextMenu(b)}),this.addHook("afterRenderer",function(b,f,e,d,g,m){return a.onAfterRenderer(b,m)}),this.addHook("afterScrollHorizontally",function(){return a.hide()}),this.addHook("afterScrollVertically",function(){return a.hide()}),this.addHook("afterBeginEditing",function(b){return a.onAfterBeginEditing(b)}),this.registerListeners(),$traceurRuntime.superGet(this,Q.prototype,"enablePlugin").call(this))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"disablePlugin",{value:function(){$traceurRuntime.superGet(this,Q.prototype,"disablePlugin").call(this)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"registerListeners",{value:function(){var a=this;this.eventManager.addEventListener(document,"mouseover",function(b){return a.onMouseOver(b)});this.eventManager.addEventListener(document,"mousedown",function(b){return a.onMouseDown(b)});this.eventManager.addEventListener(document,"mouseup",function(b){return a.onMouseUp(b)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(b){return a.onEditorBlur(b)});this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(b){return a.onEditorMouseDown(b)});this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(b){return a.onEditorMouseUp(b)})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setRange",{value:function(a){this.range=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"clearRange",{value:function(){this.range={}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"targetIsCellWithComment",{value:function(a){return(a=v(a.target,"TD","TBODY"))&&w(a,"htCommentCell")&&v(a,[this.hot.rootElement])?!0:!1},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"targetIsCommentTextArea",{value:function(a){return this.editor.getInputElement()===a.target},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setComment",{value:function(a){var b;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var f=this.editor.getValue(),e="";null!=a?e=a:null!=f&&(e=f);this.updateCommentMeta(this.range.from.row,this.range.from.col,(b={},Object.defineProperty(b,"value",{value:e,configurable:!0,enumerable:!0,writable:!0}),b));this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setCommentAtCell",{value:function(a,b,f){this.setRange({from:new F(a,b)});this.setComment(f)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"removeComment",{value:function(a){a=void 0!==a?a:!0;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0);a&&this.hot.render();this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"removeCommentAtCell",{value:function(a,b,f){f=void 0!==f?f:!0;this.setRange({from:new F(a,b)});this.removeComment(f)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"getComment",{value:function(){return this.getCommentMeta(this.range.from.row,this.range.from.col,"value")},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"getCommentAtCell",{value:function(a,b){return this.getCommentMeta(a,b,"value")},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"show",{value:function(){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditor(!0);this.editor.setValue(a.comment?a.comment.value:"");this.editor.hidden&&this.editor.show();return!0},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"showAtCell",{value:function(a,b){this.setRange({from:new F(a,b)});return this.show()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"hide",{value:function(){this.editor.hidden||this.editor.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"refreshEditor",{value:function(a){if(void 0!==a&&a||this.range.from&&this.editor.isVisible()){var b=E(this.hot.view.wt.wtTable.TABLE),f=this.hot.view.wt.wtTable.getCell(this.range.from);a=this.range.from.row;var e=this.range.from.col,d=z(f),g=this.hot.view.wt.wtTable.getStretchedColumnWidth(e),f=0>d.top?0:d.top,d=d.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&b!==window&&(f-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition());this.hot.view.wt.wtViewport.hasHorizontalScroll()&&b!==window&&(d-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());b=d+g;g=this.getCommentMeta(a,e,"style");a=this.getCommentMeta(a,e,"readOnly");g?this.editor.setSize(g.width,g.height):this.editor.resetSize();this.editor.setReadOnlyState(a);this.editor.setPosition(b,f)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"checkSelectionCommentsConsistency",{value:function(){var a=this.hot.getSelectedRange();if(!a)return!1;var b=!1,a=a.from;this.getCommentMeta(a.row,a.col,"value")&&(b=!0);return b},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"updateCommentMeta",{value:function(a,b,f){var e=this.hot.getCellMeta(a,b).comment;e?(e=A(e),B(e,f)):e=f;this.hot.setCellMeta(a,b,"comment",e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"getCommentMeta",{value:function(a,b,f){a=this.hot.getCellMeta(a,b);if(a.comment)return a.comment[f]},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onMouseDown",{value:function(a){this.mouseDown=!0;if(this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(a)){a=v(a.target,"TD","TBODY");var b=null;a&&(b=this.hot.view.wt.wtTable.getCoords(a));(!a||this.range.from&&b&&(this.range.from.row!==b.row||this.range.from.col!==b.col))&&this.hide()}this.contextMenuEvent=!1}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onMouseOver",{value:function(a){var b=this;if(!this.mouseDown&&!this.editor.isFocused()){var f=I.get(this);f.cellBelowCursor=document.elementFromPoint(a.clientX,a.clientY);G(function(){if(!w(a.target,"wtBorder")&&f.cellBelowCursor===a.target&&b.editor)if(b.targetIsCellWithComment(a)){var e=b.hot.view.wt.wtTable.getCoords(a.target),e={from:new F(e.row,e.col)};b.setRange(e);b.show()}else!y(a.target,document)||b.targetIsCommentTextArea(a)||b.editor.isFocused()||b.hide()},this.displayDelay)()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onMouseUp",{value:function(a){this.mouseDown=!1},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onAfterRenderer",{value:function(a,b){b.comment&&b.comment.value&&u(a,b.commentedCellClassName)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onEditorBlur",{value:function(a){this.setComment()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onEditorMouseDown",{value:function(a){I.get(this).tempEditorDimensions={width:x(a.target),height:C(a.target)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onEditorMouseUp",{value:function(a){var b,f=I.get(this),e=x(a.target);a=C(a.target);e===f.tempEditorDimensions.width+1&&a===f.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,(b={},Object.defineProperty(b,"style",{value:{width:e,height:a},configurable:!0,enumerable:!0,writable:!0}),b))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onContextMenuAddComment",{value:function(){var a=this,b=this.hot.getSelectedRange();this.contextMenuEvent=!0;this.setRange({from:b.from});this.show();setTimeout(function(){a.hot&&(a.hot.deselectCell(),a.editor.focus())},10)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onContextMenuRemoveComment",{value:function(a){this.contextMenuEvent=!0;for(var b=a.start.row;b<=a.end.row;b++)for(var f=a.start.col;f<=a.end.col;f++)this.removeCommentAtCell(b,f,!1);this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onContextMenuMakeReadOnly",{value:function(a){var b;this.contextMenuEvent=!0;for(var f=a.start.row;f<=a.end.row;f++)for(var e=a.start.col;e<=a.end.col;e++){var d=!!this.getCommentMeta(f,e,"readOnly");this.updateCommentMeta(f,e,(b={},Object.defineProperty(b,"readOnly",{value:!d,configurable:!0,enumerable:!0,writable:!0}),b))}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"addToContextMenu",{value:function(a){var b=this;a.items.push(t.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return b.checkSelectionCommentsConsistency()?"Edit comment":"Add comment"},callback:function(){return b.onContextMenuAddComment()},disabled:function(){return this.getSelected()&&!this.selection.selectedHeader.corner?!1:!0}},{key:"commentsRemove",name:function(){return"Delete comment"},callback:function(a,f){return b.onContextMenuRemoveComment(f)},disabled:function(){return b.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var a=this,b="Read only comment";J(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).comment;e&&(e=e.readOnly);if(e)return!0})&&(b=K(b));return b},callback:function(a,f){return b.onContextMenuMakeReadOnly(f)},disabled:function(){return b.hot.selection.selectedHeader.corner||!b.checkSelectionCommentsConsistency()}})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"onAfterBeginEditing",{value:function(a,b){this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"destroy",{value:function(){this.editor&&this.editor.destroy();$traceurRuntime.superGet(this,Q.prototype,"destroy").call(this)},configurable:!0,enumerable:!0,writable:!0}),k),{},m);l("comments",O)},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,commentEditor:69,"contextMenu/utils":89,eventManager:42,"helpers/dom/element":47,"helpers/function":50,"helpers/object":53,plugins:62}],71:[function(p,q,r){function k(d,e){var g;h(e,function(e){var a=e.key?e.key.split(":"):null;if(Array.isArray(a)&&a[1]===d)return g=e,!1});return g}Object.defineProperties(r,{CommandExecutor:{get:function(){return l}},__esModule:{value:!0}});var d,h=(d=p("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,l=function(d){this.hot=d;this.commands={};this.commonCallback=null};$traceurRuntime.createClass(l,{registerCommand:function(d,e){this.commands[d]=e},setCommonCallback:function(d){this.commonCallback=d},execute:function(d){for(var e=[],g=1;g<arguments.length;g++)e[g-1]=arguments[g];var m=this,g=d.split(":");d=g[0];var a=2===g.length?g[1]:null,b=this.commands[d];if(!b)throw Error("Menu command '"+d+"' not exists.");a&&b.submenu&&(b=k(a,b.submenu.items));!0===b.disabled||"function"==typeof b.disabled&&!0===b.disabled.call(this.hot)||b.hasOwnProperty("submenu")||(a=[],"function"===typeof b.callback&&a.push(b.callback),"function"===typeof this.commonCallback&&a.push(this.commonCallback),e.unshift(g.join(":")),h(a,function(a){return a.apply(m.hot,e)}))}},{})},{"helpers/array":43}],72:[function(p,q,r){Object.defineProperties(r,{ContextMenu:{get:function(){return U}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f,t=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("_base"),d&&d.__esModule&&d||{"default":d})["default"];var u=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,v=(l=p("commandExecutor"),l&&l.__esModule&&l||{"default":l}).CommandExecutor,y=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).EventManager,w=(e=p("helpers/dom/element"),e&&e.__esModule&&e||{"default":e}).hasClass,z=(n=p("itemsFactory"),n&&n.__esModule&&n||{"default":n}).ItemsFactory,x=(m=p("menu"),m&&m.__esModule&&m||{"default":m}).Menu;d=(a=p("plugins"),a&&a.__esModule&&a||{"default":a}).registerPlugin;a=(b=p("helpers/dom/event"),b&&b.__esModule&&b||{"default":b});var C=a.stopPropagation,E=a.pageX,A=a.pageY;b=(e=p("helpers/dom/element"),e&&e.__esModule&&e||{"default":e});var B=b.getWindowScrollLeft,G=b.getWindowScrollTop;p=(f=p("predefinedItems"),f&&f.__esModule&&f||{"default":f});var D=p.ROW_ABOVE,F=p.ROW_BELOW,H=p.COLUMN_LEFT,J=p.COLUMN_RIGHT,K=p.REMOVE_ROW,I=p.REMOVE_COLUMN,O=p.UNDO,Q=p.REDO,R=p.READ_ONLY,M=p.ALIGNMENT,S=p.SEPARATOR,U=function(a){$traceurRuntime.superConstructor(V).call(this,a);this.eventManager=new y(this);this.commandExecutor=new v(this.hot);this.menu=this.itemsFactory=null},V=U;$traceurRuntime.createClass(U,{isEnabled:function(){return this.hot.getSettings().contextMenu},enablePlugin:function(){var a=this;if(!this.enabled){this.itemsFactory=new z(this.hot,V.DEFAULT_ITEMS);var b=this.hot.getSettings().contextMenu,f={items:this.itemsFactory.getItems(b)};this.registerEvents();"function"===typeof b.callback&&this.commandExecutor.setCommonCallback(b.callback);$traceurRuntime.superGet(this,V.prototype,"enablePlugin").call(this);this.callOnPluginsReady(function(){a.hot.runHooks("afterContextMenuDefaultOptions",f);a.itemsFactory.setPredefinedItems(f.items);var e=a.itemsFactory.getItems(b);a.menu=new x(a.hot,{className:"htContextMenu",keepInViewport:!0});a.hot.runHooks("beforeContextMenuSetItems",e);a.menu.setMenuItems(e);a.menu.addLocalHook("afterOpen",function(){return a.onMenuAfterOpen()});a.menu.addLocalHook("afterClose",function(){return a.onMenuAfterClose()});a.menu.addLocalHook("executeCommand",function(){for(var b=[],f=0;f<arguments.length;f++)b[f]=arguments[f];return a.executeCommand.apply(a,b)});u(e,function(b){return a.commandExecutor.registerCommand(b.key,b)})})}},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,V.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close();this.menu&&(this.menu.destroy(),this.menu=null);$traceurRuntime.superGet(this,V.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(b){return a.onContextMenu(b)})},open:function(a){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(A(a),10)-G(),left:parseInt(E(a),10)-B()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,t.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.commandExecutor.execute.apply(this.commandExecutor,a)},onContextMenu:function(a){var b=this.hot.getSettings(),f=b.rowHeaders,b=b.colHeaders,e=a.realTarget;this.close();w(e,"handsontableInput")||(a.preventDefault(),C(a),(f||b||"TD"===e.nodeName||"TD"===e.parentNode.nodeName||w(e,"current")&&w(e,"wtBorder"))&&this.open(a))},onMenuAfterOpen:function(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)},destroy:function(){this.close();this.menu&&this.menu.destroy();$traceurRuntime.superGet(this,V.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[D,F,S,H,J,S,K,I,S,O,Q,S,R,S,M]}},q);U.SEPARATOR={name:S};t.hooks.register("afterContextMenuDefaultOptions");t.hooks.register("afterContextMenuShow");t.hooks.register("afterContextMenuHide");t.hooks.register("afterContextMenuExecute");d("contextMenu",U)},{_base:63,browser:24,commandExecutor:71,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,itemsFactory:74,menu:75,plugins:62,predefinedItems:76}],73:[function(p,q,r){Object.defineProperties(r,{Cursor:{get:function(){return m}},__esModule:{value:!0}});var k,d,h;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var l=k.getWindowScrollLeft,g=k.getWindowScrollTop;p=(h=p("helpers/dom/event"),h&&h.__esModule&&h||{"default":h});var e=p.pageX,n=p.pageY,m=function(a){var b=g(),f=l(),d,m,h,k,p,z;this.type=this.getSourceType(a);"literal"===this.type?(d=parseInt(a.top,10),h=parseInt(a.left,10),p=a.height||0,z=a.width||0,m=d,k=h,d+=b,h+=f):"event"===this.type&&(d=parseInt(n(a),10),h=parseInt(e(a),10),p=a.target.clientHeight,z=a.target.clientWidth,m=d-b,k=h-f);this.top=d;this.topRelative=m;this.left=h;this.leftRelative=k;this.scrollTop=b;this.scrollLeft=f;this.cellHeight=p;this.cellWidth=z};$traceurRuntime.createClass(m,{getSourceType:function(a){var b="literal";a instanceof Event&&(b="event");return b},fitsAbove:function(a){return this.topRelative>=a.offsetHeight},fitsBelow:function(a,b){return this.topRelative+a.offsetHeight<=(void 0!==b?b:window.innerHeight)},fitsOnRight:function(a,b){return this.leftRelative+this.cellWidth+a.offsetWidth<=(void 0!==b?b:window.innerWidth)},fitsOnLeft:function(a){return this.leftRelative>=a.offsetWidth}},{});q.plugins.utils=q.plugins.utils||{};q.plugins.utils.Cursor=m},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48}],74:[function(p,q,r){function k(a,f,d){a=void 0!==a?a:null;f=void 0!==f?f:[];var h=void 0!==d?d:{},l=[];a&&a.items?a=a.items:Array.isArray(a)||(a=f);e(a)?g(a,function(a,b){var f=h["string"===typeof a?a:b];f||(f=a);e(a)?n(f,a):"string"===typeof f&&(f={name:f});void 0===f.key&&(f.key=b);l.push(f)}):m(a,function(a,f){var d=h[a];!d&&0<=b.indexOf(a)||(d||(d={name:a,key:f+""}),e(a)&&n(d,a),void 0===d.key&&(d.key=f),l.push(d))});return l}Object.defineProperties(r,{ItemsFactory:{get:function(){return t}},__esModule:{value:!0}});var d,h,l;q=(d=p("helpers/object"),d&&d.__esModule&&d||{"default":d});var g=q.objectEach,e=q.isObject,n=q.extend,m=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;p=(l=p("predefinedItems"),l&&l.__esModule&&l||{"default":l});var a=p.SEPARATOR,b=p.ITEMS,f=p.predefinedItems,t=function(a,b){var e=void 0!==b?b:null;this.hot=a;this.predefinedItems=f();this.defaultOrderPattern=e};$traceurRuntime.createClass(t,{setPredefinedItems:function(b){var f=this,e={};this.defaultOrderPattern.length=0;g(b,function(b,d){var g;b.name===a?(e[a]=b,g=a):(isNaN(parseInt(d,10))?(b.key=void 0===b.key?d:b.key,e[d]=b):e[b.key]=b,g=b.key);f.defaultOrderPattern.push(g)});this.predefinedItems=e},getItems:function(a){return k(void 0!==a?a:null,this.defaultOrderPattern,this.predefinedItems)}},{})},{"helpers/array":43,"helpers/object":53,predefinedItems:76}],75:[function(p,q,r){Object.defineProperties(r,{Menu:{get:function(){return V}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f,t,u=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var v=q.addClass,y=q.empty,w=q.fastInnerHTML,z=q.getScrollbarWidth,x=q.isChildOf,C=q.removeClass;d=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h});var E=d.arrayEach,A=d.arrayFilter,B=d.arrayReduce,G=(l=p("cursor"),l&&l.__esModule&&l||{"default":l}).Cursor,D=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).EventManager;h=(e=p("helpers/object"),e&&e.__esModule&&e||{"default":e}).mixin;var F=(n=p("helpers/function"),n&&n.__esModule&&n||{"default":n}).debounce;e=(m=p("utils"),m&&m.__esModule&&m||{"default":m});var H=e.filterSeparators,J=e.hasSubMenu,K=e.isDisabled,I=e.isItemHidden,O=e.isSeparator,Q=e.isSelectionDisabled,R=e.normalizeSelection,M=(a=p("helpers/unicode"),a&&a.__esModule&&a||{"default":a}).KEY_CODES;m=(b=p("mixins/localHooks"),b&&b.__esModule&&b||{"default":b}).localHooks;var S=(f=p("predefinedItems"),f&&f.__esModule&&f||{"default":f}).SEPARATOR,U=(t=p("helpers/dom/event"),t&&t.__esModule&&t||{"default":t}).stopImmediatePropagation,V=function(a,b){this.hot=a;this.options=b||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1};this.eventManager=new D(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.origOutsideClickDeselects=this.menuItems=null;this.keyEvent=!1;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;this.registerEvents()},ga=V;$traceurRuntime.createClass(V,{registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(b){return a.onDocumentMouseDown(b)})},setMenuItems:function(a){this.menuItems=a},setOffset:function(a,b){this.offset[a]=void 0!==b?b:0},isSubMenu:function(){return null!==this.parentMenu},open:function(){var a=this;this.container.removeAttribute("style");this.container.style.display="block";var b=F(function(b){return a.openSubMenu(b)},300),f=A(this.menuItems,function(b){return I(b,a.hot)}),f=H(f,S),e={data:f,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(b,f,e,d,g,m){return a.menuItemRenderer(b,f,e,d,g,m)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(b){return a.onBeforeKeyDown(b)},afterOnCellMouseOver:function(f,e,d){a.isAllSubMenusClosed()?b(e.row):a.openSubMenu(e.row)},rowHeights:function(a){return f[a].name===S?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1;this.hotMenu=new u.Core(this.container,e);this.hotMenu.addHook("afterInit",function(){return a.onAfterInit()});this.hotMenu.addHook("afterSelection",function(b,f,e,d,g){return a.onAfterSelection(b,f,e,d,g)});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")},close:function(a){a=void 0!==a?a:!1;this.isOpened()&&(a&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))},openSubMenu:function(a){if(!this.hotMenu)return!1;var b=this.hotMenu.getCell(a,0);this.closeAllSubMenus();if(!b||!J(b))return!1;a=this.hotMenu.getSourceDataAtRow(a);var f=new ga(this.hot,{parent:this,name:a.name,className:this.options.className,keepInViewport:!0});f.setMenuItems(a.submenu.items);f.open();f.setPosition(b.getBoundingClientRect());return this.hotSubMenus[a.key]=f},closeSubMenu:function(a){a=this.hotMenu.getSourceDataAtRow(a);var b=this.hotSubMenus[a.key];b&&(b.destroy(),delete this.hotSubMenus[a.key])},closeAllSubMenus:function(){var a=this;E(this.hotMenu.getData(),function(b,f){return a.closeSubMenu(f)})},isAllSubMenusClosed:function(){return 0===Object.keys(this.hotSubMenus).length},destroy:function(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy()},isOpened:function(){return null!==this.hotMenu},executeCommand:function(a){if(this.isOpened()&&this.hotMenu.getSelected()){var b=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);this.runLocalHooks("select",b,a);if(!1!==b.isCommand&&b.name!==S){var f=this.hot.getSelectedRange(),f=f?R(f):{},e=!0;if(!0===b.disabled||"function"===typeof b.disabled&&!0===b.disabled.call(this.hot)||b.submenu)e=!1;this.runLocalHooks("executeCommand",b.key,f,a);this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",b.key,f,a);e&&this.close(!0)}}},setPosition:function(a){a=new G(a);this.options.keepInViewport?(a.fitsBelow(this.container)?this.setPositionBelowCursor(a):a.fitsAbove(this.container)?this.setPositionAboveCursor(a):this.setPositionBelowCursor(a),a.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(a):this.setPositionOnLeftOfCursor(a)):(this.setPositionBelowCursor(a),this.setPositionOnRightOfCursor(a))},setPositionAboveCursor:function(a){var b=this.offset.above+a.top-this.container.offsetHeight;this.isSubMenu()&&(b=a.top+a.cellHeight-this.container.offsetHeight+3);this.container.style.top=b+"px"},setPositionBelowCursor:function(a){var b=this.offset.below+a.top;this.isSubMenu()&&(b=a.top-1);this.container.style.top=b+"px"},setPositionOnRightOfCursor:function(a){a=this.isSubMenu()?1+a.left+a.cellWidth:this.offset.right+1+a.left;this.container.style.left=a+"px"},setPositionOnLeftOfCursor:function(a){a=this.offset.left+a.left-this.container.offsetWidth+z()+4;this.container.style.left=a+"px"},selectFirstCell:function(){var a=this.hotMenu.getCell(0,0);O(a)||K(a)||Q(a)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)},selectLastCell:function(){var a=this.hotMenu.countRows()-1,b=this.hotMenu.getCell(a,0);O(b)||K(b)||Q(b)?this.selectPrevCell(a,0):this.hotMenu.selectCell(a,0)},selectNextCell:function(a,b){var f=a+1,e=f<this.hotMenu.countRows()?this.hotMenu.getCell(f,b):null;e&&(O(e)||K(e)||Q(e)?this.selectNextCell(f,b):this.hotMenu.selectCell(f,b))},selectPrevCell:function(a,b){var f=a-1,e=0<=f?this.hotMenu.getCell(f,b):null;e&&(O(e)||K(e)||Q(e)?this.selectPrevCell(f,b):this.hotMenu.selectCell(f,b))},menuItemRenderer:function(a,b,f,e,d,g){var m=a.getSourceDataAtRow(f),n=document.createElement("div");"function"===typeof g&&(g=g.call(this.hot));y(b);v(n,"htItemWrapper");b.appendChild(n);(new RegExp(S,"i")).test(m.name)?v(b,"htSeparator"):"function"===typeof m.renderer?(v(b,"htCustomMenuRenderer"),b.appendChild(m.renderer(a,n,f,e,d,g))):w(n,g);!0===m.disabled||"function"==typeof m.disabled&&!0===m.disabled.call(this.hot)?(v(b,"htDisabled"),this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()})):m.disableSelection?(v(b,"htSelectionDisabled"),this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()})):(m.hasOwnProperty("submenu")?v(b,"htSubmenu"):(C(b,"htSubmenu"),C(b,"htDisabled")),m.disableSelection?this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()}):this.eventManager.addEventListener(b,"mouseenter",function(){return a.selectCell(f,e,void 0,void 0,!1,!1)}))},createContainer:function(a){if(a=void 0!==a?a:null)a=a.replace(/[^A-z0-9]/g,"_"),a=this.options.className+"Sub_"+a;var b;b=a?document.querySelector("."+this.options.className+"."+a):document.querySelector("."+this.options.className);b||(b=document.createElement("div"),v(b,"htMenu "+this.options.className),a&&v(b,a),document.getElementsByTagName("body")[0].appendChild(b));return b},blockMainTableCallbacks:function(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},onBeforeKeyDown:function(a){var b=this.hotMenu.getSelected(),f=!1;this.keyEvent=!0;switch(a.keyCode){case M.ESCAPE:this.close();f=!0;break;case M.ENTER:b&&(this.hotMenu.getSourceDataAtRow(b[0]).submenu?f=!0:(this.executeCommand(a),this.close(!0)));break;case M.ARROW_DOWN:b?this.selectNextCell(b[0],b[1]):this.selectFirstCell();f=!0;break;case M.ARROW_UP:b?this.selectPrevCell(b[0],b[1]):this.selectLastCell();f=!0;break;case M.ARROW_RIGHT:b&&(b=this.openSubMenu(b[0]))&&b.selectFirstCell();f=!0;break;case M.ARROW_LEFT:b&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),f=!0)}f&&(a.preventDefault(),U(a));this.keyEvent=!1},onAfterInit:function(){var a=this.hotMenu.getSettings().data,b=this.hotMenu.view.wt.wtTable.hider.style,f=this.hotMenu.view.wt.wtTable.holder.style,e=parseInt(b.width,10),a=B(a,function(a,b){return a+(b.name===S?1:26)},0);f.width=e+22+"px";f.height=a+4+"px";b.height=f.height},onAfterSelection:function(a,b,f,e,d){!1===this.keyEvent&&(d.value=!0)},onDocumentMouseDown:function(a){this.isOpened()&&(this.container&&x(a.target,this.container)&&this.executeCommand(a),this.options.standalone&&this.hotMenu&&!x(a.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!x(a.target,".htMenu")&&x(a.target,document)&&this.close(!0))}},{});h(V,m)},{browser:24,cursor:73,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/object":53,"helpers/unicode":56,"mixins/localHooks":58,predefinedItems:76,utils:89}],76:[function(p,q,r){function k(){var a={};z(Z,function(b,f){return a[f]=b()});return a}function d(a,b){-1===ua.indexOf(a)&&(Z[a]=b)}var h;Object.defineProperties(r,{ALIGNMENT:{get:function(){return g.KEY}},CLEAR_COLUMN:{get:function(){return e.KEY}},COLUMN_LEFT:{get:function(){return n.KEY}},COLUMN_RIGHT:{get:function(){return m.KEY}},READ_ONLY:{get:function(){return a.KEY}},REDO:{get:function(){return b.KEY}},REMOVE_COLUMN:{get:function(){return f.KEY}},REMOVE_ROW:{get:function(){return t.KEY}},ROW_ABOVE:{get:function(){return u.KEY}},ROW_BELOW:{get:function(){return v.KEY}},SEPARATOR:{get:function(){return y.KEY}},UNDO:{get:function(){return w.KEY}},ITEMS:{get:function(){return ua}},predefinedItems:{get:function(){return k}},addItem:{get:function(){return d}},__esModule:{value:!0}});var l,g,e,n,m,a,b,f,t,u,v,y,w,z=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l}).objectEach;r=(g=p("predefinedItems/alignment"),g&&g.__esModule&&g||{"default":g});q=r.alignmentItem;r=r.KEY;var x=(e=p("predefinedItems/clearColumn"),e&&e.__esModule&&e||{"default":e});l=x.clearColumnItem;var x=x.KEY,C=(n=p("predefinedItems/columnLeft"),n&&n.__esModule&&n||{"default":n}),E=C.columnLeftItem,C=C.KEY,A=(m=p("predefinedItems/columnRight"),m&&m.__esModule&&m||{"default":m}),B=A.columnRightItem,A=A.KEY,G=(a=p("predefinedItems/readOnly"),a&&a.__esModule&&a||{"default":a}),D=G.readOnlyItem,G=G.KEY,F=(b=p("predefinedItems/redo"),b&&b.__esModule&&b||{"default":b}),H=F.redoItem,F=F.KEY,J=(f=p("predefinedItems/removeColumn"),f&&f.__esModule&&f||{"default":f}),K=J.removeColumnItem,J=J.KEY,I=(t=p("predefinedItems/removeRow"),t&&t.__esModule&&t||{"default":t}),O=I.removeRowItem,I=I.KEY,Q=(u=p("predefinedItems/rowAbove"),u&&u.__esModule&&u||{"default":u}),R=Q.rowAboveItem,Q=Q.KEY,M=(v=p("predefinedItems/rowBelow"),v&&v.__esModule&&v||{"default":v}),S=M.rowBelowItem,M=M.KEY,U=(y=p("predefinedItems/separator"),y&&y.__esModule&&y||{"default":y}),V=U.separatorItem,U=U.KEY,ga=(w=p("predefinedItems/undo"),w&&w.__esModule&&w||{"default":w}),P=ga.undoItem,ga=ga.KEY;g=(g=p("predefinedItems/alignment"),g&&g.__esModule&&g||{"default":g});e=(e=p("predefinedItems/clearColumn"),e&&e.__esModule&&e||{"default":e});n=(n=p("predefinedItems/columnLeft"),n&&n.__esModule&&n||{"default":n});m=(m=p("predefinedItems/columnRight"),m&&m.__esModule&&m||{"default":m});a=(a=p("predefinedItems/readOnly"),a&&a.__esModule&&a||{"default":a});b=(b=p("predefinedItems/redo"),b&&b.__esModule&&b||{"default":b});f=(f=p("predefinedItems/removeColumn"),f&&f.__esModule&&f||{"default":f});t=(t=p("predefinedItems/removeRow"),t&&t.__esModule&&t||{"default":t});u=(u=p("predefinedItems/rowAbove"),u&&u.__esModule&&u||{"default":u});v=(v=p("predefinedItems/rowBelow"),v&&v.__esModule&&v||{"default":v});y=(y=p("predefinedItems/separator"),y&&y.__esModule&&y||{"default":y});w=(w=p("predefinedItems/undo"),w&&w.__esModule&&w||{"default":w});var ua=[Q,M,C,A,x,I,J,ga,F,G,r,U],Z=(h={},Object.defineProperty(h,U,{value:V,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,Q,{value:R,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,M,{value:S,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,C,{value:E,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,A,{value:B,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,x,{value:l,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,I,{value:O,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,J,{value:K,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,ga,{value:P,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,F,{value:H,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,G,{value:D,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,r,{value:q,configurable:!0,enumerable:!0,writable:!0}),h)},{"helpers/object":53,"predefinedItems/alignment":77,"predefinedItems/clearColumn":78,"predefinedItems/columnLeft":79,"predefinedItems/columnRight":80,"predefinedItems/readOnly":81,"predefinedItems/redo":82,"predefinedItems/removeColumn":83,"predefinedItems/removeRow":84,"predefinedItems/rowAbove":85,"predefinedItems/rowBelow":86,"predefinedItems/separator":87,"predefinedItems/undo":88}],77:[function(p,q,r){function k(){return{key:a,name:"Alignment",disabled:function(){return this.getSelectedRange()&&!this.selection.selectedHeader.corner?!1:!0},submenu:{items:[{key:a+":left",name:function(){var a=this,f="Left";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htLeft"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"horizontal","htLeft");l(f,"horizontal","htLeft",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{key:a+":center",name:function(){var a=this,f="Center";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htCenter"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"horizontal","htCenter");l(f,"horizontal","htCenter",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{key:a+":right",name:function(){var a=this,f="Right";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htRight"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"horizontal","htRight");l(f,"horizontal","htRight",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{key:a+":justify",name:function(){var a=this,f="Justify";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htJustify"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"horizontal","htJustify");l(f,"horizontal","htJustify",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{name:m},{key:a+":top",name:function(){var a=this,f="Top";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htTop"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"vertical","htTop");l(f,"vertical","htTop",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{key:a+":middle",name:function(){var a=this,f="Middle";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htMiddle"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"vertical","htMiddle");l(f,"vertical","htMiddle",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1},{key:a+":bottom",name:function(){var a=this,f="Bottom";e(this.getSelectedRange(),function(b,f){var e=a.getCellMeta(b,f).className;if(e&&-1!==e.indexOf("htBottom"))return!0})&&(f=n(f));return f},callback:function(){var a=this,f=this.getSelectedRange(),e=g(f,function(b,f){return a.getCellMeta(b,f).className});this.runHooks("beforeCellAlignment",e,f,"vertical","htBottom");l(f,"vertical","htBottom",function(b,f){return a.getCellMeta(b,f)},function(b,f,e,d){return a.setCellMeta(b,f,e,d)});this.render()},disabled:!1}]}}}Object.defineProperties(r,{KEY:{get:function(){return a}},alignmentItem:{get:function(){return k}},__esModule:{value:!0}});var d,h;q=(d=p("utils"),d&&d.__esModule&&d||{"default":d});var l=q.align,g=q.getAlignmentClasses,e=q.checkSelectionConsistency,n=q.markLabelAsSelected,m=(h=p("separator"),h&&h.__esModule&&h||{"default":h}).KEY,a="alignment"},{separator:87,utils:89}],78:[function(p,q,r){function k(){return{key:l,name:"Clear column",callback:function(d,e){var g=e.start.col;this.countRows()&&this.populateFromArray(0,g,[[null]],Math.max(e.start.row,e.end.row),g,"ContextMenu.clearColumn")},disabled:function(){var d=h(this);if(!d)return!0;var e=[d[0],0,d[0],this.countCols()-1].join()==d.join(",");return 0>d[1]||this.countCols()>=this.getSettings().maxCols||e}}}Object.defineProperties(r,{KEY:{get:function(){return l}},clearColumnItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="clear_column"},{utils:89}],79:[function(p,q,r){function k(){return{key:l,name:"Insert column on the left",callback:function(d,e){this.alter("insert_col",e.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var d=h(this);if(!d||!this.isColumnModificationAllowed())return!0;var e=[d[0],0,d[0],this.countCols()-1].join()==d.join(","),n=1===this.countCols();return 0>d[1]||this.countCols()>=this.getSettings().maxCols||!n&&e},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(r,{KEY:{get:function(){return l}},columnLeftItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="col_left"},{utils:89}],80:[function(p,q,r){function k(){return{key:l,name:"Insert column on the right",callback:function(d,e){this.alter("insert_col",e.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var d=h(this);if(!d||!this.isColumnModificationAllowed())return!0;var e=[d[0],0,d[0],this.countCols()-1].join()==d.join(","),n=1===this.countCols();return 0>d[1]||this.countCols()>=this.getSettings().maxCols||!n&&e},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(r,{KEY:{get:function(){return l}},columnRightItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="col_right"},{utils:89}],81:[function(p,q,r){function k(){return{key:g,name:function(){var e=this,d="Read only";h(this.getSelectedRange(),function(d,a){return e.getCellMeta(d,a).readOnly})&&(d=l(d));return d},callback:function(){var e=this,d=this.getSelectedRange(),g=h(d,function(a,b){return e.getCellMeta(a,b).readOnly});d.forAll(function(a,b){e.setCellMeta(a,b,"readOnly",g?!1:!0)});this.render()},disabled:function(){return this.getSelectedRange()&&!this.selection.selectedHeader.corner?!1:!0}}}Object.defineProperties(r,{KEY:{get:function(){return g}},readOnlyItem:{get:function(){return k}},__esModule:{value:!0}});var d;p=(d=p("utils"),d&&d.__esModule&&d||{"default":d});var h=p.checkSelectionConsistency,l=p.markLabelAsSelected,g="make_read_only"},{utils:89}],82:[function(p,q,r){function k(){return{key:d,name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}Object.defineProperties(r,{KEY:{get:function(){return d}},redoItem:{get:function(){return k}},__esModule:{value:!0}});var d="redo"},{}],83:[function(p,q,r){function k(){return{key:l,name:"Remove column",callback:function(d,e){this.alter("remove_col",e.start.col,e.end.col-e.start.col+1,"ContextMenu.removeColumn")},disabled:function(){var d=h(this),e=this.countCols();return!d||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}Object.defineProperties(r,{KEY:{get:function(){return l}},removeColumnItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="remove_col"},{utils:89}],84:[function(p,q,r){function k(){return{key:l,name:"Remove row",callback:function(d,e){this.alter("remove_row",e.start.row,e.end.row-e.start.row+1,"ContextMenu.removeRow")},disabled:function(){var d=h(this),e=this.countRows();return!d||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!e},hidden:function(){return!this.getSettings().allowRemoveRow}}}Object.defineProperties(r,{KEY:{get:function(){return l}},removeRowItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="remove_row"},{utils:89}],85:[function(p,q,r){function k(){return{key:l,name:"Insert row above",callback:function(d,e){this.alter("insert_row",e.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!h(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(r,{KEY:{get:function(){return l}},rowAboveItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="row_above"},{utils:89}],86:[function(p,q,r){function k(){return{key:l,name:"Insert row below",callback:function(d,e){this.alter("insert_row",e.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!h(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(r,{KEY:{get:function(){return l}},rowBelowItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).getValidSelection,l="row_below"},{utils:89}],87:[function(p,q,r){function k(){return{name:d}}Object.defineProperties(r,{KEY:{get:function(){return d}},separatorItem:{get:function(){return k}},__esModule:{value:!0}});var d="---------"},{}],88:[function(p,q,r){function k(){return{key:d,name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}Object.defineProperties(r,{KEY:{get:function(){return d}},undoItem:{get:function(){return k}},__esModule:{value:!0}});var d="undo"},{}],89:[function(p,q,r){function k(a){return{start:a.getTopLeftCorner(),end:a.getBottomRightCorner()}}function d(a){return B(a,"htSeparator")}function h(a){return B(a,"htSubmenu")}function l(a){return B(a,"htDisabled")}function g(a){return B(a,"htSelectionDisabled")}function e(a){a=a.getSelected();return!a||0>a[0]?null:a}function n(a,b){if(-1!=a.indexOf(b))return a;a=a.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return a+(" "+b)}function m(a,b){if(-1!=a.indexOf(b))return a;a=a.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return a+(" "+b)}function a(a,b){for(var f={},e=a.from.row;e<=a.to.row;e++)for(var d=a.from.col;d<=a.to.col;d++)f[e]||(f[e]=[]),f[e][d]=b(e,d);return f}function b(a,b,e,d,g){if(a.from.row==a.to.row&&a.from.col==a.to.col)f(a.from.row,a.from.col,b,e,d,g);else for(var m=a.from.row;m<=a.to.row;m++)for(var n=a.from.col;n<=a.to.col;n++)f(m,n,b,e,d,g)}function f(a,b,f,e,d,g){d=d(a,b);var h=e;d.className&&(h="vertical"===f?n(d.className,e):m(d.className,e));g(a,b,"className",h)}function t(a,b){var f=!1;a&&a.forAll(function(a,e){if(b(a,e))return f=!0,!1});return f}function u(a){return'\x3cspan class\x3d"selected"\x3e'+String.fromCharCode(10003)+"\x3c/span\x3e"+a}function v(a,b){return!a.hidden||!("function"==typeof a.hidden&&a.hidden.call(b))}function y(a,b){for(var f=a.slice(0);0<f.length;)if(f[0].name===b)f.shift();else break;return f}function w(a){var b=[];A(a,function(a,f){0<f?b[b.length-1].name!==a.name&&b.push(a):b.push(a)});return b}function z(a,b){var f=void 0!==b?b:G,e=a.slice(0),e=y(e,f),e=e.slice(0);e.reverse();e=y(e,f);e.reverse();return e=w(e)}Object.defineProperties(r,{normalizeSelection:{get:function(){return k}},isSeparator:{get:function(){return d}},hasSubMenu:{get:function(){return h}},isDisabled:{get:function(){return l}},isSelectionDisabled:{get:function(){return g}},getValidSelection:{get:function(){return e}},prepareVerticalAlignClass:{get:function(){return n}},prepareHorizontalAlignClass:{get:function(){return m}},getAlignmentClasses:{get:function(){return a}},align:{get:function(){return b}},checkSelectionConsistency:{get:function(){return t}},markLabelAsSelected:{get:function(){return u}},isItemHidden:{get:function(){return v}},filterSeparators:{get:function(){return z}},__esModule:{value:!0}});var x,C,E,A=(x=p("helpers/array"),x&&x.__esModule&&x||{"default":x}).arrayEach,B=(C=p("helpers/dom/element"),C&&C.__esModule&&C||{"default":C}).hasClass,G=(E=p("predefinedItems/separator"),E&&E.__esModule&&E||{"default":E}).KEY},{"helpers/array":43,"helpers/dom/element":47,"predefinedItems/separator":87}],90:[function(p,q,r){Object.defineProperties(r,{ContextMenuCopyPaste:{get:function(){return u}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k})["default"];var m=(d=p("zeroclipboard"),d&&d.__esModule&&d||{"default":d})["default"],a=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).removeClass,b=(l=p("helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach,f=(g=p("eventManager"),g&&g.__esModule&&g||{"default":g}).EventManager;k=(e=p("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin;var t=(n=p("contextMenu/predefinedItems"),n&&n.__esModule&&n||{"default":n}).SEPARATOR,u=function(a){$traceurRuntime.superConstructor(v).call(this,a);this.eventManager=new f(this);this.outsideClickDeselectsCache=this.swfPath=null},v=u;$traceurRuntime.createClass(u,{isEnabled:function(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function(){var a=this;if(!this.enabled){"object"===typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath);"undefined"===typeof m&&console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(w){"undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"]&&console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.swfPath&&m.config({swfPath:this.swfPath});this.hot.addHook("afterContextMenuShow",function(){return a.onAfterContextMenuShow()});this.hot.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)});this.registerEvents();$traceurRuntime.superGet(this,v.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,v.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(document,"mouseenter",function(){return a.removeCurrentClass()});this.eventManager.addEventListener(document,"mouseleave",function(){return a.removeZeroClipboardClass()})},getCopyValue:function(){this.hot.copyPaste.setCopyableText();this.hot.copyPaste.copyPasteInstance.triggerCopy();return this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function(a){a.items.unshift({key:"copy",name:"Copy",disabled:function(){return this.selection.selectedHeader.corner}},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()},disabled:function(){return this.selection.selectedHeader.corner}},{name:t})},onAfterContextMenuShow:function(){var a=this,f=this.hot.getPlugin("contextMenu"),e=f.menu.hotMenu.getSourceData();b(e,function(b,e){if("copy"===b.key){var d=new m(f.menu.hotMenu.getCell(e,0));d.off();d.on("copy",function(b){b.clipboardData.setData("text/plain",a.getCopyValue());a.hot.getSettings().outsideClickDeselects=a.outsideClickDeselectsCache});return!1}})},removeCurrentClass:function(){var b=this.hot.getPlugin("contextMenu");b.enabled&&(b.menu.isOpened()&&(b=b.menu.hotMenu.rootElement.querySelector("td.current"))&&a(b,"current"),this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1)},removeZeroClipboardClass:function(){var b=this.hot.getPlugin("contextMenu");b.enabled&&(b.menu.isOpened()&&(b=b.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover"))&&a(b,"zeroclipboard-is-hover"),this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache)}},{},q);k("contextMenuCopyPaste",u)},{_base:63,"contextMenu/predefinedItems":76,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,zeroclipboard:"zeroclipboard"}],91:[function(p,q,r){function k(a){function b(){a.isListening()}function f(){if(a.isListening()){var b=g.getRangedData(g.copyableRanges);a.getSettings().fragmentSelection&&w.stringify(b)!=G()||(a.runHooks("beforeCopy",b,g.copyableRanges)?(a.copyPaste.copyPasteInstance.copyable(w.stringify(b)),a.runHooks("afterCopy",b,g.copyableRanges)):a.copyPaste.copyPasteInstance.copyable(""))}}function e(b){var f,e,d,m,n;if(a.isListening()&&a.selection.isSelected()){b=w.parse(b);f=a.getSelected();e=new F(f[0],f[1]);f=new F(f[2],f[3]);d=new H(e,e,f);m=d.getTopLeftCorner();d=d.getBottomRightCorner();n=new F(Math.max(d.row,b.length-1+m.row),Math.max(d.col,b[0].length-1+m.col));var h=f.row-e.row>=b.length-1,l=f.col-e.col>=b[0].length-1;a.addHookOnce("afterChange",function(b,f){var e=b?b.length:0;if(e){var d=0,g=0,k=-1;C(b,function(a,f){var m=e>f+1?b[f+1]:null;m&&(h||(d+=Math.max(m[0]-a[0]-1,0)),!l&&a[1]>k&&(k=a[1],g+=Math.max(m[1]-a[1]-1,0)))});a.selectCell(m.row,m.col,n.row+d,n.col+g)}});a.runHooks("beforePaste",b,g.copyableRanges)&&(a.populateFromArray(m.row,m.col,b,n.row,n.col,"CopyPaste.paste",a.getSettings().pasteMode),a.runHooks("afterPaste",b,g.copyableRanges))}}function d(b){if(a.getSelected()&&!(a.getActiveEditor()&&a.getActiveEditor().isOpened()||B(b)))if(x(b.keyCode))a.getSettings().fragmentSelection&&G()||(g.setCopyableText(),A(b));else if((b.ctrlKey||b.metaKey)&&!b.altKey){b.keyCode==z.A&&a._registerTimeout(setTimeout(D(g.setCopyableText,g),0));if(b.keyCode==z.X){var e=g.getRangedData(g.copyableRanges);a.getSettings().fragmentSelection&&w.stringify(e)!=G()||(a.runHooks("beforeCut",e,g.copyableRanges)?(a.copyPaste.copyPasteInstance.copyable(w.stringify(e)),a.selection.empty(),a.runHooks("afterCut",e,g.copyableRanges)):a.copyPaste.copyPasteInstance.copyable(""))}b.keyCode==z.C&&f()}}var g=this;this.copyPasteInstance=y();this.copyPasteInstance.onCut(b);this.copyPasteInstance.triggerCopy=f;this.copyPasteInstance.onPaste(e);this.onPaste=e;this.copyableRanges=[];a.addHook("beforeKeyDown",d);this.destroy=function(){this.copyPasteInstance&&(this.copyPasteInstance.removeCallback(b),this.copyPasteInstance.removeCallback(e),this.copyPasteInstance.destroy(),this.copyPasteInstance=null);a.removeHook("beforeKeyDown",d)};a.addHook("afterDestroy",D(this.destroy,this));this.triggerPaste=D(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=D(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var b=a.getSettings(),f=b.copyRowsLimit,b=b.copyColsLimit,e=a.getSelectedRange(),d=e.getTopLeftCorner(),g=e.getBottomRightCorner(),e=d.row,d=d.col,m=g.row,g=g.col,n=Math.min(m,e+f-1),h=Math.min(g,d+b-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:e,startCol:d,endRow:n,endCol:h});this.copyableRanges=a.runHooks("modifyCopyableRange",this.copyableRanges);var l=this.getRangedCopyableData(this.copyableRanges);a.copyPaste.copyPasteInstance.copyable(l);m===n&&g===h||v.hooks.run(a,"afterCopyLimit",m-e+1,g-d+1,f,b)};this.getRangedCopyableData=function(b){var f=[],e=[],d=[];C(b,function(a){E(a.startRow,a.endRow,function(a){-1===e.indexOf(a)&&e.push(a)});E(a.startCol,a.endCol,function(a){-1===d.indexOf(a)&&d.push(a)})});C(e,function(b){var e=[];C(d,function(f){e.push(a.getCopyableData(b,f))});f.push(e)});return w.stringify(f)};this.getRangedData=function(b){var f=[],e=[],d=[];C(b,function(a){E(a.startRow,a.endRow,function(a){-1===e.indexOf(a)&&e.push(a)});E(a.startCol,a.endCol,function(a){-1===d.indexOf(a)&&d.push(a)})});C(e,function(b){var e=[];C(d,function(f){e.push(a.getCopyableData(b,f))});f.push(e)});return f}}function d(){var a=!1!==this.getSettings().copyPaste;a&&!this.copyPaste?this.copyPaste=new k(this):!a&&this.copyPaste&&(this.copyPaste.destroy(),this.copyPaste=null)}Object.defineProperties(r,{CopyPastePlugin:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n,m,a,b,f,t,u,v=(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"],y=(l=p("copyPaste"),l&&l.__esModule&&l||{"default":l})["default"],w=(g=p("SheetClip"),g&&g.__esModule&&g||{"default":g})["default"];q=(e=p("helpers/unicode"),e&&e.__esModule&&e||{"default":e});var z=q.KEY_CODES,x=q.isCtrlKey,C=(n=p("helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach,E=(m=p("helpers/number"),m&&m.__esModule&&m||{"default":m}).rangeEach;e=(a=p("helpers/dom/event"),a&&a.__esModule&&a||{"default":a});var A=e.stopImmediatePropagation,B=e.isImmediatePropagationStopped,G=(b=p("helpers/dom/element"),b&&b.__esModule&&b||{"default":b}).getSelectionText,D=(f=p("helpers/function"),f&&f.__esModule&&f||{"default":f}).proxy,F=(t=p("3rdparty/walkontable/src/cell/coords"),t&&t.__esModule&&t||{"default":t}).WalkontableCellCoords,H=(u=p("3rdparty/walkontable/src/cell/range"),u&&u.__esModule&&u||{"default":u}).WalkontableCellRange;v.hooks.add("afterInit",d);v.hooks.add("afterUpdateSettings",d);v.hooks.register("afterCopyLimit");v.hooks.register("modifyCopyableRange");v.hooks.register("beforeCut");v.hooks.register("afterCut");v.hooks.register("beforePaste");v.hooks.register("afterPaste");v.hooks.register("beforeCopy");v.hooks.register("afterCopy")},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,SheetClip:"SheetClip",browser:24,copyPaste:"copyPaste","helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/number":52,"helpers/unicode":56}],92:[function(p,q,r){function k(){}var d,h,l,g=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];p("plugins");var e=(h=p("3rdparty/walkontable/src/cell/range"),h&&h.__esModule&&h||{"default":h}).WalkontableCellRange,n=(l=p("3rdparty/walkontable/src/selection"),l&&l.__esModule&&l||{"default":l}).WalkontableSelection,m,a=function(a){var b={row:a.row,col:a.col},b=new n(a,new e(b,b,b));a:{for(var f=0;f<m.view.wt.selections.length;f++)if(m.view.wt.selections[f].settings.className==a.className){a=f;break a}a=-1}0<=a?m.view.wt.selections[a]=b:m.view.wt.selections.push(b)},b=function(a,b){return"border_row"+a+"col"+b},f=function(a,f){return{className:b(a,f),border:{width:1,color:"#000",cornerVisible:!1},row:a,col:f,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},t=function(a){a=document.querySelectorAll("."+a);for(var b=0;b<a.length;b++)if(a[b]&&"TD"!=a[b].nodeName){var f=a[b].parentNode;f.parentNode&&f.parentNode.removeChild(f)}},u=function(e,d,g,m){var n=this.getCellMeta(e,d).borders;n&&void 0!=n.border||(n=f(e,d));n[g]=m?{hide:!0}:{width:1,color:"#000"};this.setCellMeta(e,d,"borders",n);e=b(e,d);t(e);a(n);this.render()},v=function(a,f,e){if(a.from.row==a.to.row&&a.from.col==a.to.col)"noBorders"==f?(f=a.from.row,a=a.from.col,e=b(f,a),t(e),this.removeCellMeta(f,a,"borders")):u.call(this,a.from.row,a.from.col,f,e);else switch(f){case "noBorders":for(f=a.from.col;f<=a.to.col;f++)for(e=a.from.row;e<=a.to.row;e++){var d=e,g=f,m=b(d,g);t(m);this.removeCellMeta(d,g,"borders")}break;case "top":for(d=a.from.col;d<=a.to.col;d++)u.call(this,a.from.row,d,f,e);break;case "right":for(e=a.from.row;e<=a.to.row;e++)u.call(this,e,a.to.col,f);break;case "bottom":for(e=a.from.col;e<=a.to.col;e++)u.call(this,a.to.row,e,f);break;case "left":for(e=a.from.row;e<=a.to.row;e++)u.call(this,e,a.from.col,f)}},y=function(a,b){var f=!1;a.getSelectedRange().forAll(function(e,d){var g=a.getCellMeta(e,d).borders;if(g)if(b){if(!g[b].hasOwnProperty("hide"))return f=!0,!1}else return f=!0,!1});return f},w=function(a){return'\x3cspan class\x3d"selected"\x3e'+String.fromCharCode(10003)+"\x3c/span\x3e"+a};g.hooks.add("beforeInit",function(){var a;a=this.getSettings().customBorders;a="boolean"===typeof a&&!0===a?!0:"object"===typeof a&&0<a.length?!0:!1;a&&!this.customBorders&&(m=this,this.customBorders=new k)});g.hooks.add("afterContextMenuDefaultOptions",function(a){this.getSettings().customBorders&&(a.items.push(g.plugins.ContextMenu.SEPARATOR),a.items.push({key:"borders",name:"Borders",disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var a="Top";y(this,"top")&&(a=w(a));return a},callback:function(){var a=y(this,"top");v.call(this,this.getSelectedRange(),"top",a)}},{key:"borders:right",name:function(){var a="Right";y(this,"right")&&(a=w(a));return a},callback:function(){var a=y(this,"right");v.call(this,this.getSelectedRange(),"right",a)}},{key:"borders:bottom",name:function(){var a="Bottom";y(this,"bottom")&&(a=w(a));return a},callback:function(){var a=y(this,"bottom");v.call(this,this.getSelectedRange(),"bottom",a)}},{key:"borders:left",name:function(){var a="Left";y(this,"left")&&(a=w(a));return a},callback:function(){var a=y(this,"left");v.call(this,this.getSelectedRange(),"left",a)}},{key:"borders:no_borders",name:"Remove border(s)",callback:function(){v.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!y(this)}}]}}))});g.hooks.add("afterInit",function(){var b=this.getSettings().customBorders;if(b){for(var e=0;e<b.length;e++)if(b[e].range)for(var d=b[e],g=d.range,m=g.from.row;m<=g.to.row;m++)for(var n=g.from.col;n<=g.to.col;n++){var h=f(m,n),l=0;m==g.from.row&&(l++,d.hasOwnProperty("top")&&(h.top=d.top));m==g.to.row&&(l++,d.hasOwnProperty("bottom")&&(h.bottom=d.bottom));n==g.from.col&&(l++,d.hasOwnProperty("left")&&(h.left=d.left));n==g.to.col&&(l++,d.hasOwnProperty("right")&&(h.right=d.right));0<l&&(this.setCellMeta(m,n,"borders",h),a(h))}else d=b[e].row,g=b[e].col,m=b[e],n=f(d,g),m.hasOwnProperty("border")&&(n.border=m.border),m.hasOwnProperty("top")&&(n.top=m.top),m.hasOwnProperty("right")&&(n.right=m.right),m.hasOwnProperty("bottom")&&(n.bottom=m.bottom),m.hasOwnProperty("left")&&(n.left=m.left),this.setCellMeta(d,g,"borders",n),a(n);this.render();this.view.wt.draw(!0)}});g.CustomBorders=k},{"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/selection":19,browser:24,plugins:62}],93:[function(p,q,r){function k(){this.callback=this.boundaries=null}Object.defineProperties(r,{DragToScroll:{get:function(){return k}},__esModule:{value:!0}});var d,h;q=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];var l=(h=p("eventManager"),h&&h.__esModule&&h||{"default":h}).eventManager;p("plugins");q.plugins.DragToScroll=k;k.prototype.setBoundaries=function(e){this.boundaries=e};k.prototype.setCallback=function(e){this.callback=e};k.prototype.check=function(e,d){var a=0,b=0;d<this.boundaries.top?b=d-this.boundaries.top:d>this.boundaries.bottom&&(b=d-this.boundaries.bottom);e<this.boundaries.left?a=e-this.boundaries.left:e>this.boundaries.right&&(a=e-this.boundaries.right);this.callback(a,b)};var g,e=function(e){e.dragToScrollListening=!1;var d=e.view.wt.wtTable.holder;g=new k;d!==window&&(g.setBoundaries(d.getBoundingClientRect()),g.setCallback(function(a,b){0>a?d.scrollLeft-=50:0<a&&(d.scrollLeft+=50);0>b?d.scrollTop-=20:0<b&&(d.scrollTop+=20)}),e.dragToScrollListening=!0)};q.hooks.add("afterInit",function(){var e=this,d=l(this);d.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1});d.addEventListener(document,"mousemove",function(a){e.dragToScrollListening&&g.check(a.clientX,a.clientY)})});q.hooks.add("afterDestroy",function(){l(this).clear()});q.hooks.add("afterOnCellMouseDown",function(){e(this)});q.hooks.add("afterOnCellCornerMouseDown",function(){e(this)});q.plugins.DragToScroll=k},{browser:24,eventManager:42,plugins:62}],94:[function(p,q,r){function k(d){return{key:"freeze_column",name:"Freeze this column",callback:function(){var h=this.getSelectedRange().from.col;d.freezeColumn(h);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var d=this.getSelectedRange(),l=!1;if(void 0===d)l=!0;else if(d.from.col!==d.to.col||d.from.col<=this.getSettings().fixedColumnsLeft-1)l=!0;return l}}}Object.defineProperties(r,{freezeColumnItem:{get:function(){return k}},__esModule:{value:!0}})},{}],95:[function(p,q,r){function k(d){return{key:"unfreeze_column",name:"Unfreeze this column",callback:function(){var h=this.getSelectedRange().from.col;d.unfreezeColumn(h);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var d=this.getSelectedRange(),l=!1;if(void 0===d)l=!0;else if(d.from.col!==d.to.col||d.from.col>=this.getSettings().fixedColumnsLeft)l=!0;return l}}}Object.defineProperties(r,{unfreezeColumnItem:{get:function(){return k}},__esModule:{value:!0}})},{}],96:[function(p,q,r){Object.defineProperties(r,{ManualColumnFreeze:{get:function(){return t}},__esModule:{value:!0}});var k,d,h,l,g,e,n=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("_base"),d&&d.__esModule&&d||{"default":d})["default"];d=(h=p("plugins"),h&&h.__esModule&&h||{"default":h}).registerPlugin;var m=(l=p("helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach,a=(g=p("contextMenuItem/freezeColumn"),g&&g.__esModule&&g||{"default":g}).freezeColumnItem,b=(e=p("contextMenuItem/unfreezeColumn"),e&&e.__esModule&&e||{"default":e}).unfreezeColumnItem,f=new WeakMap,t=function(a){$traceurRuntime.superConstructor(u).call(this,a);f.set(this,{moveByFreeze:!1,afterFirstUse:!1});this.frozenColumnsBasePositions=[];this.manualColumnMovePlugin=void 0},u=t;$traceurRuntime.createClass(t,{isEnabled:function(){return!!this.hot.getSettings().manualColumnFreeze},enablePlugin:function(){var a=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(b){return a.addContextMenuEntry(b)}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("beforeColumnMove",function(b,f){return a.onBeforeColumnMove(b,f)}),$traceurRuntime.superGet(this,u.prototype,"enablePlugin").call(this))},disablePlugin:function(){var a=f.get(this);a.afterFirstUse=!1;a.moveByFreeze=!1;$traceurRuntime.superGet(this,u.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,u.prototype,"updatePlugin").call(this)},freezeColumn:function(a){var b=f.get(this),e=this.hot.getSettings();b.afterFirstUse||(b.afterFirstUse=!0);e.fixedColumnsLeft===this.hot.countCols()||a<=e.fixedColumnsLeft-1||(b.moveByFreeze=!0,a!==this.getMovePlugin().columnsMapper.getValueByIndex(a)&&(this.frozenColumnsBasePositions[e.fixedColumnsLeft]=a),this.getMovePlugin().moveColumn(a,e.fixedColumnsLeft++))},unfreezeColumn:function(a){var b=f.get(this),e=this.hot.getSettings();b.afterFirstUse||(b.afterFirstUse=!0);if(!(0>=e.fixedColumnsLeft||a>e.fixedColumnsLeft-1)){var d=this.getBestColumnReturnPosition(a);b.moveByFreeze=!0;e.fixedColumnsLeft--;this.getMovePlugin().moveColumn(a,d+1)}},getMovePlugin:function(){this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove"));return this.manualColumnMovePlugin},getBestColumnReturnPosition:function(a){var b=this.getMovePlugin(),f=this.hot.getSettings().fixedColumnsLeft,e=b.columnsMapper.getValueByIndex(f),d;if(null==this.frozenColumnsBasePositions[a])for(d=b.columnsMapper.getValueByIndex(a);e<d;)f++,e=b.columnsMapper.getValueByIndex(f);else{d=this.frozenColumnsBasePositions[a];for(this.frozenColumnsBasePositions[a]=void 0;e<=d;)f++,e=b.columnsMapper.getValueByIndex(f);f=e}return f-1},addContextMenuEntry:function(f){f.items.push(n.plugins.ContextMenu.SEPARATOR,a(this),b(this))},onAfterInit:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()},onBeforeColumnMove:function(a,b){var e=f.get(this);if(e.afterFirstUse&&!e.moveByFreeze){var d=this.hot.getSettings().fixedColumnsLeft,g=b<d;g||m(a,function(a,b,f){if(a<d)return g=!0,!1});if(g)return!1}e.moveByFreeze&&(e.moveByFreeze=!1)},destroy:function(){$traceurRuntime.superGet(this,u.prototype,"destroy").call(this)}},{},q);d("manualColumnFreeze",t)},{_base:63,browser:24,"contextMenuItem/freezeColumn":94,"contextMenuItem/unfreezeColumn":95,"helpers/array":43,plugins:62}],97:[function(p,q,r){Object.defineProperties(r,{ColumnsMapper:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("mixins/arrayMapper"),d&&d.__esModule&&d||{"default":d}).arrayMapper;var e=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayFilter;d=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l}).mixin;var n=(g=p("helpers/number"),g&&g.__esModule&&g||{"default":g}).rangeEach,m=function(a){this.manualColumnMove=a};$traceurRuntime.createClass(m,{createMap:function(a){var b=this;a=void 0===a?this._arrayMap.length:a;this._arrayMap.length=0;n(a-1,function(a){b._arrayMap[a]=a})},destroy:function(){this._arrayMap=null},moveColumn:function(a,b){var f=this._arrayMap[a];this._arrayMap[a]=null;this._arrayMap.splice(b,0,f)},clearNull:function(){this._arrayMap=e(this._arrayMap,function(a){return null!==a})}},{});d(m,k);q.utils.ManualColumnMoveColumnsMapper=m},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],98:[function(p,q,r){Object.defineProperties(r,{ManualColumnMove:{get:function(){return B}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b;q=(k=p("_base.js"),k&&k.__esModule&&k||{"default":k})["default"];var f=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"],t=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;k=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l});var u=k.addClass,v=k.removeClass,y=k.offset,w=(g=p("helpers/number"),g&&g.__esModule&&g||{"default":g}).rangeEach,z=(e=p("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager;l=(n=p("plugins"),n&&n.__esModule&&n||{"default":n}).registerPlugin;var x=(m=p("columnsMapper"),m&&m.__esModule&&m||{"default":m}).ColumnsMapper,C=(a=p("ui/backlight"),a&&a.__esModule&&a||{"default":a}).BacklightUI,E=(b=p("ui/guideline"),b&&b.__esModule&&b||{"default":b}).GuidelineUI,A=new WeakMap,B=function(a){$traceurRuntime.superConstructor(G).call(this,a);A.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}});this.removedColumns=[];this.columnsMapper=new x(this);this.eventManager=z(this);this.backlight=new C(a);this.guideline=new E(a)},G=B;$traceurRuntime.createClass(B,{isEnabled:function(){return!!this.hot.getSettings().manualColumnMove},enablePlugin:function(){var a=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(b,f,e,d){return a.onBeforeOnCellMouseDown(b,f,e,d)}),this.addHook("beforeOnCellMouseOver",function(b,f,e,d){return a.onBeforeOnCellMouseOver(b,f,e,d)}),this.addHook("afterScrollVertically",function(){return a.onAfterScrollVertically()}),this.addHook("modifyCol",function(b,f){return a.onModifyCol(b,f)}),this.addHook("beforeRemoveCol",function(b,f){return a.onBeforeRemoveCol(b,f)}),this.addHook("afterRemoveCol",function(b,f){return a.onAfterRemoveCol(b,f)}),this.addHook("afterCreateCol",function(b,f){return a.onAfterCreateCol(b,f)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),this.addHook("unmodifyCol",function(b){return a.onUnmodifyCol(b)}),this.registerEvents(),u(this.hot.rootElement,"ht__manualColumnMove"),$traceurRuntime.superGet(this,G.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,G.prototype,"updatePlugin").call(this)},disablePlugin:function(){var a=this.hot.getSettings().manualColumnMove;Array.isArray(a)&&this.columnsMapper.clearMap();v(this.hot.rootElement,"ht__manualColumnMove");this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,G.prototype,"disablePlugin").call(this)},moveColumn:function(a,b){this.moveColumns([a],b)},moveColumns:function(a,b){var f=this,e=A.get(this),d=this.hot.runHooks("beforeColumnMove",a,b);e.disallowMoving=!d;!1!==d&&(t(a,function(a,b,e){e[b]=f.columnsMapper.getValueByIndex(a)}),t(a,function(a,e){var d=f.columnsMapper.getIndexByValue(a);d!==b&&f.columnsMapper.moveColumn(d,b+e)}),this.columnsMapper.clearNull());this.hot.runHooks("afterColumnMove",a,b)},changeSelection:function(a,b){var f=this.hot.selection,e=this.hot.countRows()-1;f.setRangeStartOnly(new WalkontableCellCoords(0,a));f.setRangeEnd(new WalkontableCellCoords(e,b),!1)},getColumnsWidth:function(a,b){for(var f=0,e=a;e<b;e++){var d;d=0>e?this.hot.view.wt.wtTable.getColumnWidth(e)||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(e)||0;f+=d}return f},initialSettings:function(){var a=this.hot.getSettings().manualColumnMove;Array.isArray(a)?this.moveColumns(a,0):void 0!==a&&this.persistentStateLoad()},isFixedColumnsLeft:function(a){return a<this.hot.getSettings().fixedColumnsLeft},persistentStateSave:function(){f.hooks.run(this.hot,"persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)},persistentStateLoad:function(){var a={};f.hooks.run(this.hot,"persistentStateLoad","manualColumnMove",a);a.value&&(this.columnsMapper._arrayMap=a.value)},prepareColumnsToMoving:function(a,b){var f=[];w(a,b,function(a){f.push(a)});return f},refreshPositions:function(){var a=A.get(this),b=this.hot.view.wt.wtTable.getFirstVisibleColumn(),f=this.hot.view.wt.wtTable.getLastVisibleColumn(),e=this.hot.view.wt.wtTable,d=this.hot.view.wt.wtOverlays.scrollableElement,g="number"===typeof d.scrollX?d.scrollX:d.scrollLeft,m=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,a.coordsColumn),n=a.target.eventPageX-(a.rootElementOffset-(void 0===d.scrollX?g:0)),h=e.hider.offsetWidth,l=e.TBODY.offsetLeft,k=this.backlight.getOffset().left,t=this.backlight.getSize().width,u=0;a.rootElementOffset+e.holder.offsetWidth+g<a.target.eventPageX&&a.coordsColumn<a.countCols&&a.coordsColumn++;a.hasRowHeaders&&(u=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth);this.isFixedColumnsLeft(a.coordsColumn)&&(m+=g);m+=u;0>a.coordsColumn?a.target.col=0<a.fixedColumns?0:0<b?b-1:b:a.target.TD.offsetWidth/2+m<=n?(a.target.col=(a.coordsColumn>=a.countCols?a.countCols-1:a.coordsColumn)+1,m+=a.target.TD.offsetWidth,a.target.col>f&&this.hot.scrollViewportTo(void 0,f+1,void 0,!0)):(a.target.col=a.coordsColumn,a.target.col<=b&&a.target.col>=a.fixedColumns&&this.hot.scrollViewportTo(void 0,b-1));a.target.col<=b&&a.target.col>=a.fixedColumns&&this.hot.scrollViewportTo(void 0,b-1);b=n;f=m;n+t+k>=h?b=h-t-k:n+k<l+u&&(b=l+u+Math.abs(k));m>=h-1?f=h-1:0===f?f=1:void 0!==d.scrollX&&a.coordsColumn<a.fixedColumns&&(f-=a.rootElementOffset<=d.scrollX?a.rootElementOffset:0);this.backlight.setPosition(null,b);this.guideline.setPosition(null,f)},updateColumnsMapper:function(){var a=this.hot.countSourceCols(),b=this.columnsMapper._arrayMap.length;if(0===b)this.columnsMapper.createMap(a||this.hot.getSettings().startCols);else if(b<a)this.columnsMapper.insertItems(b,a-b);else if(b>a){var f=a-1,e=[];t(this.columnsMapper._arrayMap,function(a,b,d){a>f&&e.push(b)});this.columnsMapper.removeItems(e)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeOnCellMouseDown:function(a,b,f,e){var d=this.hot.view.wt.wtTable,g=this.hot.selection.selectedHeader.cols,m=this.hot.getSelectedRange(),n=A.get(this),h=-1<a.realTarget.className.indexOf("columnSorting");!m||!g||n.pressed||0!==a.button||h?(n.pressed=!1,n.columnsToMove.length=0,v(this.hot.rootElement,["on-moving--columns","show-ui"])):(g=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended(),g&&h&&(this.guideline.appendTo(d.hider),this.backlight.appendTo(d.hider)),g=m.from,h=m.to,m=Math.min(g.col,h.col),g=Math.max(g.col,h.col),0>b.row&&b.col>=m&&b.col<=g?(e.column=!0,n.pressed=!0,n.target.eventPageX=a.pageX,n.coordsColumn=b.col,n.target.TD=f,n.target.col=b.col,n.columnsToMove=this.prepareColumnsToMoving(m,g),n.hasRowHeaders=!!this.hot.getSettings().rowHeaders,n.countCols=this.hot.countCols(),n.fixedColumns=this.hot.getSettings().fixedColumnsLeft,n.rootElementOffset=y(this.hot.rootElement).left,f=n.hasRowHeaders?-1:0,e=d.holder.scrollTop+d.getColumnHeaderHeight(0)+1,h=this.hot.view.wt.wtOverlays.scrollableElement,h=h.scrollX?h.scrollX-n.rootElementOffset:0,a=a.layerX-(b.col<n.fixedColumns?h:0),b=Math.abs(this.getColumnsWidth(m,b.col)+a),this.backlight.setPosition(e,this.getColumnsWidth(f,m)+b),this.backlight.setSize(this.getColumnsWidth(m,g+1),d.hider.offsetHeight-e),this.backlight.setOffset(null,-1*b),u(this.hot.rootElement,"on-moving--columns")):(v(this.hot.rootElement,"after-selection--columns"),n.pressed=!1,n.columnsToMove.length=0))},onMouseMove:function(a){var b=A.get(this);if(b.pressed){if(a.realTarget===this.backlight.element){var f=this.backlight.getSize().width;this.backlight.setSize(0);setTimeout(function(){this.backlight.setPosition(f)})}b.target.eventPageX=a.pageX;this.refreshPositions()}},onBeforeOnCellMouseOver:function(a,b,f,e){a=this.hot.getSelectedRange();var d=A.get(this);a&&d.pressed&&(-1<d.columnsToMove.indexOf(b.col)?v(this.hot.rootElement,"show-ui"):u(this.hot.rootElement,"show-ui"),e.row=!0,e.column=!0,e.cell=!0,d.coordsColumn=b.col,d.target.TD=f)},onMouseUp:function(){var a=A.get(this);a.coordsColumn=void 0;a.pressed=!1;a.backlightWidth=0;v(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]);this.hot.selection.selectedHeader.cols&&u(this.hot.rootElement,"after-selection--columns");if(!(1>a.columnsToMove.length||void 0===a.target.col||-1<a.columnsToMove.indexOf(a.target.col))){this.moveColumns(a.columnsToMove,a.target.col);this.persistentStateSave();this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize(!0);if(!a.disallowMoving){var b=this.columnsMapper.getIndexByValue(a.columnsToMove[0]),f=this.columnsMapper.getIndexByValue(a.columnsToMove[a.columnsToMove.length-1]);this.changeSelection(b,f)}a.columnsToMove.length=0}},onAfterScrollVertically:function(){var a=this.hot.view.wt.wtTable,b=a.getColumnHeaderHeight(0)+1+a.holder.scrollTop;this.backlight.setPosition(b);this.backlight.setSize(null,a.hider.offsetHeight-b)},onAfterCreateCol:function(a,b){this.columnsMapper.shiftItems(a,b)},onBeforeRemoveCol:function(a,b){var f=this;this.removedColumns.length=0;!1!==a&&w(a,a+b-1,function(a){f.removedColumns.push(f.hot.runHooks("modifyCol",a,f.pluginName))})},onAfterRemoveCol:function(a,b){this.columnsMapper.unshiftItems(this.removedColumns)},onAfterLoadData:function(a){this.updateColumnsMapper()},onModifyCol:function(a,b){if(b!==this.pluginName){var f=this.columnsMapper.getValueByIndex(a);a=null===f?a:f}return a},onUnmodifyCol:function(a){var b=this.columnsMapper.getIndexByValue(a);return null===b?a:b},onAfterPluginsInitialized:function(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build()},destroy:function(){this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,G.prototype,"destroy").call(this)}},{},q);l("ManualColumnMove",B);f.hooks.register("beforeColumnMove");f.hooks.register("afterColumnMove");f.hooks.register("unmodifyCol")},{"_base.js":63,browser:24,columnsMapper:97,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,"ui/backlight":100,"ui/guideline":101}],99:[function(p,q,r){Object.defineProperties(r,{BaseUI:{get:function(){return h}},__esModule:{value:!0}});var k,d=(k=p("helpers/number"),k&&k.__esModule&&k||{"default":k}).isNumeric,h=function(d){this.hot=d;this._element=null;this.state=0};$traceurRuntime.createClass(h,{appendTo:function(d){d.appendChild(this._element);this.state=2},build:function(){this._element=document.createElement("div");this.state=1},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=0},isAppended:function(){return 2===this.state},isBuilt:function(){return 1<=this.state},setPosition:function(h,g){d(h)&&(this._element.style.top=h+"px");d(g)&&(this._element.style.left=g+"px")},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(h,g){d(h)&&(this._element.style.width=h+"px");d(g)&&(this._element.style.height=g+"px")},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(h,g){d(h)&&(this._element.style.marginTop=h+"px");d(g)&&(this._element.style.marginLeft=g+"px")},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{"helpers/number":52}],100:[function(p,q,r){Object.defineProperties(r,{BacklightUI:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var h=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass,l=function(e){$traceurRuntime.superConstructor(g).call(this,e)},g=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,g.prototype,"build").call(this);h(this._element,"ht__manualColumnMove--backlight")}},{},q)},{_base:99,"helpers/dom/element":47}],101:[function(p,q,r){Object.defineProperties(r,{GuidelineUI:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var h=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass,l=function(e){$traceurRuntime.superConstructor(g).call(this,e)},g=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,g.prototype,"build").call(this);h(this._element,"ht__manualColumnMove--guideline")}},{},q)},{_base:99,"helpers/dom/element":47}],102:[function(p,q,r){Object.defineProperties(r,{ManualColumnResize:{get:function(){return x}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("_base.js"),d&&d.__esModule&&d||{"default":d})["default"];d=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var b=d.addClass,f=d.hasClass,t=d.removeClass,u=d.outerHeight,v=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager,y=(g=p("helpers/dom/event"),g&&g.__esModule&&g||{"default":g}).pageX,w=(e=p("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayEach,z=(n=p("helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;p=(m=p("plugins"),m&&m.__esModule&&m||{"default":m}).registerPlugin;var x=function(a){$traceurRuntime.superConstructor(C).call(this,a);this.currentCol=this.currentTH=null;this.selectedCols=[];this.startOffset=this.startWidth=this.startY=this.newSize=this.currentWidth=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=v(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualColumnWidths=[];b(this.handle,"manualColumnResizer");b(this.guide,"manualColumnResizerGuide")},C=x;$traceurRuntime.createClass(x,{isEnabled:function(){return this.hot.getSettings().manualColumnResize},enablePlugin:function(){var b=this;if(!this.enabled){this.manualColumnWidths=[];var f=this.hot.getSettings().manualColumnResize,e=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(a,f){return b.onModifyColWidth(a,f)});this.addHook("beforeStretchingColumnWidth",function(a,f){return b.onBeforeStretchingColumnWidth(a,f)});this.addHook("beforeColumnResize",function(a,f,e){return b.onBeforeColumnResize(a,f,e)});"undefined"!=typeof e?this.manualColumnWidths=e:Array.isArray(f)?this.manualColumnWidths=f:this.manualColumnWidths=[];a.hooks.register("beforeColumnResize");a.hooks.register("afterColumnResize");this.bindEvents();$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().manualColumnResize;Array.isArray(a)?this.manualColumnWidths=a:a||(this.manualColumnWidths=[])},disablePlugin:function(){$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function(){var a={};this.hot.runHooks("persistentStateLoad","manualColumnWidths",a);return a.value},setupHandlePosition:function(a){var b=this;if(!a.parentNode)return!1;this.currentTH=a;var f=this.hot.view.wt.wtTable.getCoords(a).col;a=u(this.currentTH);if(0<=f){var e=this.currentTH.getBoundingClientRect();this.currentCol=f;this.selectedCols=[];if(this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var d=this.hot.getSelectedRange(),f=d.from,d=d.to,g=f.col,m=d.col;g>=m&&(g=d.col,m=f.col);this.currentCol>=g&&this.currentCol<=m?z(g,m,function(a){return b.selectedCols.push(a)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=e.left-6;this.startWidth=parseInt(e.width,10);this.handle.style.top=e.top+"px";this.handle.style.left=this.startOffset+this.startWidth+"px";this.handle.style.height=a+"px";this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function(){var a=parseInt(u(this.handle),10),f=parseInt(this.handle.style.top,10)+a,e=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);b(this.handle,"active");b(this.guide,"active");this.guide.style.top=f+"px";this.guide.style.left=this.handle.style.left;this.guide.style.height=e-a+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function(){t(this.handle,"active");t(this.guide,"active")},checkIfColumnHeader:function(a){return a!=this.hot.rootElement?(a=a.parentNode,"THEAD"===a.tagName?!0:this.checkIfColumnHeader(a)):!1},getTHFromTargetElement:function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:this.getTHFromTargetElement(a.parentNode):null},onMouseOver:function(a){if(this.checkIfColumnHeader(a.target)&&(a=this.getTHFromTargetElement(a.target))){var b=a.getAttribute("colspan");!a||null!==b&&1!==b||this.pressed||this.setupHandlePosition(a)}},afterMouseDownTimeout:function(){var a=this,b=function(){a.hot.forceFullRender=!0;a.hot.view.render();a.hot.view.wt.wtOverlays.adjustElementsSize(!0)},f=function(f,e){var d=a.hot.runHooks("beforeColumnResize",f,a.newSize,!0);void 0!==d&&(a.newSize=d);"all"===a.hot.getSettings().stretchH?a.clearManualSize(f):a.setManualSize(f,a.newSize);e&&b();a.saveManualColumnWidths();a.hot.runHooks("afterColumnResize",f,a.newSize,!0)};2<=this.dblclick&&(1<this.selectedCols.length?(w(this.selectedCols,function(a){f(a)}),b()):w(this.selectedCols,function(a){f(a,!0)}));this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function(a){var b=this;f(a.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return b.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=y(a),this.newSize=this.startWidth)},onMouseMove:function(a){var b=this;this.pressed&&(this.currentWidth=this.startWidth+(y(a)-this.startX),w(this.selectedCols,function(a){b.newSize=b.setManualSize(a,b.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(a){var b=this,f=function(){b.hot.forceFullRender=!0;b.hot.view.render();b.hot.view.wt.wtOverlays.adjustElementsSize(!0)},e=function(a,e){b.hot.runHooks("beforeColumnResize",a,b.newSize);e&&f();b.saveManualColumnWidths();b.hot.runHooks("afterColumnResize",a,b.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(1<this.selectedCols.length?(w(this.selectedCols,function(a){e(a)}),f()):w(this.selectedCols,function(a){e(a,!0)})),this.setupHandlePosition(this.currentTH))},bindEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(b){return a.onMouseOver(b)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(b){return a.onMouseDown(b)});this.eventManager.addEventListener(window,"mousemove",function(b){return a.onMouseMove(b)});this.eventManager.addEventListener(window,"mouseup",function(b){return a.onMouseUp(b)})},setManualSize:function(a,b){b=Math.max(b,20);a=this.hot.runHooks("modifyCol",a);return this.manualColumnWidths[a]=b},clearManualSize:function(a){a=this.hot.runHooks("modifyCol",a);this.manualColumnWidths[a]=void 0},onModifyColWidth:function(a,b){return this.enabled&&(b=this.hot.runHooks("modifyCol",b),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[b])?this.manualColumnWidths[b]:a},onBeforeStretchingColumnWidth:function(a,b){var f=this.manualColumnWidths[b];void 0===f&&(f=a);return f},onBeforeColumnResize:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}},{},q);p("manualColumnResize",x)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],103:[function(p,q,r){Object.defineProperties(r,{ManualRowMove:{get:function(){return B}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b;q=(k=p("_base.js"),k&&k.__esModule&&k||{"default":k})["default"];var f=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"],t=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;k=(l=p("helpers/dom/element"),l&&l.__esModule&&l||{"default":l});var u=k.addClass,v=k.removeClass,y=k.offset,w=(g=p("helpers/number"),g&&g.__esModule&&g||{"default":g}).rangeEach,z=(e=p("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager;l=(n=p("plugins"),n&&n.__esModule&&n||{"default":n}).registerPlugin;var x=(m=p("rowsMapper"),m&&m.__esModule&&m||{"default":m}).RowsMapper,C=(a=p("ui/backlight"),a&&a.__esModule&&a||{"default":a}).BacklightUI,E=(b=p("ui/guideline"),b&&b.__esModule&&b||{"default":b}).GuidelineUI,A=new WeakMap,B=function(a){$traceurRuntime.superConstructor(G).call(this,a);A.set(this,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}});this.removedRows=[];this.rowsMapper=new x(this);this.eventManager=z(this);this.backlight=new C(a);this.guideline=new E(a)},G=B;$traceurRuntime.createClass(B,{isEnabled:function(){return!!this.hot.getSettings().manualRowMove},enablePlugin:function(){var a=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(b,f,e,d){return a.onBeforeOnCellMouseDown(b,f,e,d)}),this.addHook("beforeOnCellMouseOver",function(b,f,e,d){return a.onBeforeOnCellMouseOver(b,f,e,d)}),this.addHook("afterScrollHorizontally",function(){return a.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(b,f){return a.onModifyRow(b,f)}),this.addHook("beforeRemoveRow",function(b,f){return a.onBeforeRemoveRow(b,f)}),this.addHook("afterRemoveRow",function(b,f){return a.onAfterRemoveRow(b,f)}),this.addHook("afterCreateRow",function(b,f){return a.onAfterCreateRow(b,f)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),this.addHook("beforeColumnSort",function(b,f){return a.onBeforeColumnSort(b,f)}),this.addHook("unmodifyRow",function(b){return a.onUnmodifyRow(b)}),this.registerEvents(),u(this.hot.rootElement,"ht__manualRowMove"),$traceurRuntime.superGet(this,G.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,G.prototype,"updatePlugin").call(this)},disablePlugin:function(){var a=this.hot.getSettings().manualRowMove;Array.isArray(a)&&this.rowsMapper.clearMap();v(this.hot.rootElement,"ht__manualRowMove");this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,G.prototype,"disablePlugin").call(this)},moveRow:function(a,b){this.moveRows([a],b)},moveRows:function(a,b){var f=this,e=A.get(this),d=this.hot.runHooks("beforeRowMove",a,b);e.disallowMoving=!1===d;e.disallowMoving||(t(a,function(a,b,e){e[b]=f.rowsMapper.getValueByIndex(a)}),t(a,function(a,e){var d=f.rowsMapper.getIndexByValue(a);d!==b&&f.rowsMapper.moveRow(d,b+e)}),this.rowsMapper.clearNull());this.hot.runHooks("afterRowMove",a,b)},changeSelection:function(a,b){var f=this.hot.selection,e=this.hot.countCols()-1;f.setRangeStartOnly(new WalkontableCellCoords(a,0));f.setRangeEnd(new WalkontableCellCoords(b,e),!1)},getRowsHeight:function(a,b){for(var f=0,e=a;e<b;e++)var d=this.hot.view.wt.wtTable.getRowHeight(e)||23,f=f+d;return f},initialSettings:function(){var a=this.hot.getSettings().manualRowMove;Array.isArray(a)?this.moveRows(a,0):void 0!==a&&(a=this.persistentStateLoad(),a.length&&this.moveRows(a,0))},isFixedRowTop:function(a){return a<this.hot.getSettings().fixedRowsTop},isFixedRowBottom:function(a){return a>this.hot.getSettings().fixedRowsBottom},persistentStateSave:function(){f.hooks.run(this.hot,"persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)},persistentStateLoad:function(){var a={};f.hooks.run(this.hot,"persistentStateLoad","manualRowMove",a);return a.value?a.value:[]},prepareRowsToMoving:function(){var a=this.hot.getSelectedRange(),b=[];if(!a)return b;var f=a.from,a=a.to;w(Math.min(f.row,a.row),Math.max(f.row,a.row),function(a){b.push(a)});return b},refreshPositions:function(){var a=A.get(this),b=a.target.coords,f=this.hot.view.wt.wtTable.getFirstVisibleRow(),e=this.hot.view.wt.wtTable.getLastVisibleRow(),d=this.hot.getSettings().fixedRowsTop,g=this.hot.countRows();b.row<d&&0<f&&this.hot.scrollViewportTo(f-1);b.row>=e&&e<g&&this.hot.scrollViewportTo(e+1,void 0,!0);var e=this.hot.view.wt.wtTable,m=a.target.TD,n=y(this.hot.rootElement),g=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,b.row),h=a.target.eventPageY-n.top+e.holder.scrollTop,l=e.hider.offsetHeight,k=e.TBODY.offsetTop,t=this.backlight.getOffset().top,u=this.backlight.getSize().height;n.top+e.holder.offsetHeight<a.target.eventPageY&&a.target.coords.row++;this.isFixedRowTop(b.row)&&(g+=e.holder.scrollTop);0>b.row?a.target.row=0<f?f-1:f:m.offsetHeight/2+g<=h?(a.target.row=b.row+1,g+=0===b.row?m.offsetHeight-1:m.offsetHeight):a.target.row=b.row;a=h;f=g;h+u+t>=l?a=l-u-t:h+t<k&&(a=k+Math.abs(t));g>=l-1&&(f=l-1);g=0;this.hot.view.wt.wtOverlays.topOverlay&&(g=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight);b.row>=d&&f-e.holder.scrollTop<g&&this.hot.scrollViewportTo(b.row);this.backlight.setPosition(a);this.guideline.setPosition(f)},updateRowsMapper:function(){var a=this.hot.countSourceRows(),b=this.rowsMapper._arrayMap.length;if(0===b)this.rowsMapper.createMap(a||this.hot.getSettings().startRows);else if(b<a)this.rowsMapper.insertItems(b,a-b);else if(b>a){var f=a-1,e=[];t(this.rowsMapper._arrayMap,function(a,b,d){a>f&&e.push(b)});this.rowsMapper.removeItems(e)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeColumnSort:function(a,b){A.get(this).disallowMoving=void 0!==b},onBeforeOnCellMouseDown:function(a,b,f,e){var d=this.hot.view.wt.wtTable,g=this.hot.selection.selectedHeader.rows,m=this.hot.getSelectedRange(),n=A.get(this);if(m&&g&&!n.pressed&&0===a.button){var g=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();g&&h&&(this.guideline.appendTo(d.hider),this.backlight.appendTo(d.hider));g=m.from;h=m.to;m=Math.min(g.row,h.row);g=Math.max(g.row,h.row);0>b.col&&b.row>=m&&b.row<=g?(e.row=!0,n.pressed=!0,n.target.eventPageY=a.pageY,n.target.coords=b,n.target.TD=f,n.rowsToMove=this.prepareRowsToMoving(),f=d.holder.scrollLeft+d.getColumnWidth(-1),this.backlight.setPosition(null,f),this.backlight.setSize(d.hider.offsetWidth-f,this.getRowsHeight(m,g+1)),this.backlight.setOffset(-1*(this.getRowsHeight(m,b.row)+a.layerY),null),u(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()):(v(this.hot.rootElement,"after-selection--rows"),n.pressed=!1,n.rowsToMove.length=0)}else n.pressed=!1,n.rowsToMove.length=0,v(this.hot.rootElement,["on-moving--rows","show-ui"])},onMouseMove:function(a){var b=A.get(this);if(b.pressed){if(a.realTarget===this.backlight.element){var f=this.backlight.getSize().height;this.backlight.setSize(null,0);setTimeout(function(){this.backlight.setPosition(null,f)})}b.target.eventPageY=a.pageY;this.refreshPositions()}},onBeforeOnCellMouseOver:function(a,b,f,e){a=this.hot.getSelectedRange();var d=A.get(this);a&&d.pressed&&(-1<d.rowsToMove.indexOf(b.row)?v(this.hot.rootElement,"show-ui"):u(this.hot.rootElement,"show-ui"),e.row=!0,e.column=!0,e.cell=!0,d.target.coords=b,d.target.TD=f)},onMouseUp:function(){var a=A.get(this),b=a.target.row,f=a.rowsToMove.length;a.pressed=!1;a.backlightHeight=0;v(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]);this.hot.selection.selectedHeader.rows&&u(this.hot.rootElement,"after-selection--rows");1>f||void 0===b||-1<a.rowsToMove.indexOf(b)||a.rowsToMove[f-1]===b-1||(this.moveRows(a.rowsToMove,b),this.persistentStateSave(),this.hot.render(),a.disallowMoving||(b=this.rowsMapper.getIndexByValue(a.rowsToMove[0]),f=this.rowsMapper.getIndexByValue(a.rowsToMove[f-1]),this.changeSelection(b,f)),a.rowsToMove.length=0)},onAfterScrollHorizontally:function(){var a=this.hot.view.wt.wtTable,b=a.getColumnWidth(-1)+a.holder.scrollLeft;this.backlight.setPosition(null,b);this.backlight.setSize(a.hider.offsetWidth-b)},onAfterCreateRow:function(a,b){this.rowsMapper.shiftItems(a,b)},onBeforeRemoveRow:function(a,b){var f=this;this.removedRows.length=0;!1!==a&&w(a,a+b-1,function(a){f.removedRows.push(f.hot.runHooks("modifyRow",a,f.pluginName))})},onAfterRemoveRow:function(a,b){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function(a){this.updateRowsMapper()},onModifyRow:function(a,b){if(b!==this.pluginName){var f=this.rowsMapper.getValueByIndex(a);a=null===f?a:f}return a},onUnmodifyRow:function(a){var b=this.rowsMapper.getIndexByValue(a);return null===b?a:b},onAfterPluginsInitialized:function(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build()},destroy:function(){this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,G.prototype,"destroy").call(this)}},{},q);l("ManualRowMove",B);f.hooks.register("beforeRowMove");f.hooks.register("afterRowMove");f.hooks.register("unmodifyRow")},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,rowsMapper:104,"ui/backlight":106,"ui/guideline":107}],104:[function(p,q,r){Object.defineProperties(r,{RowsMapper:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("mixins/arrayMapper"),d&&d.__esModule&&d||{"default":d}).arrayMapper;var e=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayFilter;d=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l}).mixin;var n=(g=p("helpers/number"),g&&g.__esModule&&g||{"default":g}).rangeEach,m=function(a){this.manualRowMove=a};$traceurRuntime.createClass(m,{createMap:function(a){var b=this;a=void 0===a?this._arrayMap.length:a;this._arrayMap.length=0;n(a-1,function(a){b._arrayMap[a]=a})},destroy:function(){this._arrayMap=null},moveRow:function(a,b){var f=this._arrayMap[a];this._arrayMap[a]=null;this._arrayMap.splice(b,0,f)},clearNull:function(){this._arrayMap=e(this._arrayMap,function(a){return null!==a})}},{});d(m,k);q.utils.ManualRowMoveRowsMapper=m},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],105:[function(p,q,r){Object.defineProperties(r,{BaseUI:{get:function(){return k}},__esModule:{value:!0}});var k=function(d){this.hot=d;this._element=null;this.state=0};$traceurRuntime.createClass(k,{appendTo:function(d){d.appendChild(this._element);this.state=2},build:function(){this._element=document.createElement("div");this.state=1},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=0},isAppended:function(){return 2===this.state},isBuilt:function(){return 1<=this.state},setPosition:function(d,h){d&&(this._element.style.top=d+"px");h&&(this._element.style.left=h+"px")},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(d,h){d&&(this._element.style.width=d+"px");h&&(this._element.style.height=h+"px")},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(d,h){d&&(this._element.style.marginTop=d+"px");h&&(this._element.style.marginLeft=h+"px")},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{}],106:[function(p,q,r){Object.defineProperties(r,{BacklightUI:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var h=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass,l=function(e){$traceurRuntime.superConstructor(g).call(this,e)},g=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,g.prototype,"build").call(this);h(this._element,"ht__manualRowMove--backlight")}},{},q)},{_base:105,"helpers/dom/element":47}],107:[function(p,q,r){Object.defineProperties(r,{GuidelineUI:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var h=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass,l=function(e){$traceurRuntime.superConstructor(g).call(this,e)},g=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,g.prototype,"build").call(this);h(this._element,"ht__manualRowMove--guideline")}},{},q)},{_base:105,"helpers/dom/element":47}],108:[function(p,q,r){Object.defineProperties(r,{ManualRowResize:{get:function(){return x}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("_base.js"),d&&d.__esModule&&d||{"default":d})["default"];d=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var b=d.addClass,f=d.hasClass,t=d.removeClass,u=d.outerWidth,v=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager,y=(g=p("helpers/dom/event"),g&&g.__esModule&&g||{"default":g}).pageY,w=(e=p("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayEach,z=(n=p("helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;p=(m=p("plugins"),m&&m.__esModule&&m||{"default":m}).registerPlugin;var x=function(a){$traceurRuntime.superConstructor(C).call(this,a);this.currentRow=this.currentTH=null;this.selectedRows=[];this.startOffset=this.startHeight=this.startY=this.newSize=this.currentHeight=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=v(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualRowHeights=[];b(this.handle,"manualRowResizer");b(this.guide,"manualRowResizerGuide")},C=x;$traceurRuntime.createClass(x,{isEnabled:function(){return this.hot.getSettings().manualRowResize},enablePlugin:function(){var b=this;if(!this.enabled){this.manualRowHeights=[];var f=this.hot.getSettings().manualRowResize,e=this.loadManualRowHeights();"undefined"!=typeof e?this.manualRowHeights=e:Array.isArray(f)?this.manualRowHeights=f:this.manualRowHeights=[];this.addHook("modifyRowHeight",function(a,f){return b.onModifyRowHeight(a,f)});a.hooks.register("beforeRowResize");a.hooks.register("afterRowResize");this.bindEvents();$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().manualRowResize;Array.isArray(a)?this.manualRowHeights=a:a||(this.manualRowHeights=[])},disablePlugin:function(){$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},saveManualRowHeights:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function(){var a={};this.hot.runHooks("persistentStateLoad","manualRowHeights",a);return a.value},setupHandlePosition:function(a){var b=this;this.currentTH=a;var f=this.hot.view.wt.wtTable.getCoords(a).row;a=u(this.currentTH);if(0<=f){var e=this.currentTH.getBoundingClientRect();this.currentRow=f;this.selectedRows=[];if(this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var d=this.hot.getSelectedRange(),f=d.from,d=d.to,g=f.row,m=d.row;g>=m&&(g=d.row,m=f.row);this.currentRow>=g&&this.currentRow<=m?z(g,m,function(a){return b.selectedRows.push(a)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=e.top-6;this.startHeight=parseInt(e.height,10);this.handle.style.left=e.left+"px";this.handle.style.top=this.startOffset+this.startHeight+"px";this.handle.style.width=a+"px";this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function(){var a=parseInt(u(this.handle),10),f=parseInt(this.handle.style.left,10)+a,e=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);b(this.handle,"active");b(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=f+"px";this.guide.style.width=e-a+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function(){t(this.handle,"active");t(this.guide,"active")},checkIfRowHeader:function(a){return a!=this.hot.rootElement?(a=a.parentNode,"TBODY"===a.tagName?!0:this.checkIfRowHeader(a)):!1},getTHFromTargetElement:function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:this.getTHFromTargetElement(a.parentNode):null},onMouseOver:function(a){this.checkIfRowHeader(a.target)&&(a=this.getTHFromTargetElement(a.target))&&(this.pressed||this.setupHandlePosition(a))},afterMouseDownTimeout:function(){var a=this,b=function(){a.hot.forceFullRender=!0;a.hot.view.render();a.hot.view.wt.wtOverlays.adjustElementsSize(!0)},f=function(f,e){var d=a.hot.runHooks("beforeRowResize",f,a.newSize,!0);void 0!==d&&(a.newSize=d);a.setManualSize(f,a.newSize);e&&b();a.hot.runHooks("afterRowResize",f,a.newSize,!0)};2<=this.dblclick&&(1<this.selectedRows.length?(w(this.selectedRows,function(a){f(a)}),b()):w(this.selectedRows,function(a){f(a,!0)}));this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function(a){var b=this;f(a.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return b.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=y(a),this.newSize=this.startHeight)},onMouseMove:function(a){var b=this;this.pressed&&(this.currentHeight=this.startHeight+(y(a)-this.startY),w(this.selectedRows,function(a){b.newSize=b.setManualSize(a,b.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(a){var b=this,f=function(){b.hot.forceFullRender=!0;b.hot.view.render();b.hot.view.wt.wtOverlays.adjustElementsSize(!0)},e=function(a,e){b.hot.runHooks("beforeRowResize",a,b.newSize);e&&f();b.saveManualRowHeights();b.hot.runHooks("afterRowResize",a,b.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(1<this.selectedRows.length?(w(this.selectedRows,function(a){e(a)}),f()):w(this.selectedRows,function(a){e(a,!0)})),this.setupHandlePosition(this.currentTH))},bindEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(b){return a.onMouseOver(b)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(b){return a.onMouseDown(b)});this.eventManager.addEventListener(window,"mousemove",function(b){return a.onMouseMove(b)});this.eventManager.addEventListener(window,"mouseup",function(b){return a.onMouseUp(b)})},setManualSize:function(a,b){a=this.hot.runHooks("modifyRow",a);return this.manualRowHeights[a]=b},onModifyRowHeight:function(a,b){if(this.enabled){var f=this.hot.getPlugin("autoRowSize"),f=f?f.heights[b]:null;b=this.hot.runHooks("modifyRow",b);var e=this.manualRowHeights[b];if(void 0!==e&&(e===f||e>(a||0)))return e}return a}},{},q);p("manualRowResize",x)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],109:[function(p,q,r){function k(){var a=[];a.getInfo=function(a,b){for(var f=0,e=this.length;f<e;f++)if(this[f].row<=a&&this[f].row+this[f].rowspan-1>=a&&this[f].col<=b&&this[f].col+this[f].colspan-1>=b)return this[f]};a.setInfo=function(a){for(var b=0,f=this.length;b<f;b++)if(this[b].row===a.row&&this[b].col===a.col){this[b]=a;return}this.push(a)};a.removeInfo=function(a,b){for(var f=0,e=this.length;f<e;f++)if(this[f].row===a&&this[f].col===b){this.splice(f,1);break}};return a}function d(a){this.mergedCellInfoCollection=new k;if(Array.isArray(a))for(var b=0,f=a.length;b<f;b++)this.mergedCellInfoCollection.setInfo(a[b])}Object.defineProperties(r,{MergeCells:{get:function(){return d}},__esModule:{value:!0}});var h,l,g,e,n,m=(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"];p("plugins");var a=(l=p("helpers/dom/event"),l&&l.__esModule&&l||{"default":l}).stopImmediatePropagation,b=(g=p("3rdparty/walkontable/src/cell/coords"),g&&g.__esModule&&g||{"default":g}).WalkontableCellCoords,f=(e=p("3rdparty/walkontable/src/cell/range"),e&&e.__esModule&&e||{"default":e}).WalkontableCellRange,t=(n=p("3rdparty/walkontable/src/table"),n&&n.__esModule&&n||{"default":n}).WalkontableTable;d.prototype.canMergeRange=function(a){return!a.isSingle()};d.prototype.mergeRange=function(a){if(this.canMergeRange(a)){var b=a.getTopLeftCorner();a=a.getBottomRightCorner();var f={};f.row=b.row;f.col=b.col;f.rowspan=a.row-b.row+1;f.colspan=a.col-b.col+1;this.mergedCellInfoCollection.setInfo(f)}};d.prototype.mergeOrUnmergeSelection=function(a){this.mergedCellInfoCollection.getInfo(a.from.row,a.from.col)?this.unmergeSelection(a.from):this.mergeSelection(a)};d.prototype.mergeSelection=function(a){this.mergeRange(a)};d.prototype.unmergeSelection=function(a){a=this.mergedCellInfoCollection.getInfo(a.row,a.col);this.mergedCellInfoCollection.removeInfo(a.row,a.col)};d.prototype.applySpanProperties=function(a,b,f){var e=this.mergedCellInfoCollection.getInfo(b,f);e?e.row===b&&e.col===f?(a.setAttribute("rowspan",e.rowspan),a.setAttribute("colspan",e.colspan)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none"):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"))};d.prototype.modifyTransform=function(a,e,d){var g=d.row,m=d.col;if("modifyTransformStart"==a){this.lastDesiredCoords||(this.lastDesiredCoords=new b(null,null));var n=new b(e.highlight.row,e.highlight.col),h=this.mergedCellInfoCollection.getInfo(n.row,n.col);a=0;for(var l=this.mergedCellInfoCollection.length;a<l;a++){var k=this.mergedCellInfoCollection[a],k=new b(k.row+k.rowspan-1,k.col+k.colspan-1);if(e.includes(k))break}if(h){var k=new b(h.row,h.col),t=new b(h.row+h.rowspan-1,h.col+h.colspan-1);(new f(k,k,t)).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new b(null,null));g=this.lastDesiredCoords.row?this.lastDesiredCoords.row-n.row:g;m=this.lastDesiredCoords.col?this.lastDesiredCoords.col-n.col:m;0<d.row?g=h.row+h.rowspan-1-n.row+d.row:0>d.row&&(g=n.row-h.row+d.row);0<d.col?m=h.col+h.colspan-1-n.col+d.col:0>d.col&&(m=n.col-h.col+d.col)}h=new b(e.highlight.row+g,e.highlight.col+m);if(e=this.mergedCellInfoCollection.getInfo(h.row,h.col))this.lastDesiredCoords=h,g=e.row-n.row,m=e.col-n.col}else if("modifyTransformEnd"==a)for(a=0,l=this.mergedCellInfoCollection.length;a<l;a++){n=this.mergedCellInfoCollection[a];k=new b(n.row,n.col);t=new b(n.row+n.rowspan-1,n.col+n.colspan-1);k=new f(k,k,t);h=e.getBordersSharedWith(k);k.isEqual(e)?e.setDirection("NW-SE"):0<h.length&&(t=e.highlight.isEqual(k.from),-1<h.indexOf("top")?e.to.isSouthEastOf(k.from)&&t?e.setDirection("NW-SE"):e.to.isSouthWestOf(k.from)&&t&&e.setDirection("NE-SW"):-1<h.indexOf("bottom")&&(e.to.isNorthEastOf(k.from)&&t?e.setDirection("SW-NE"):e.to.isNorthWestOf(k.from)&&t&&e.setDirection("SE-NW")));h=new b(e.to.row+g,e.to.col+m);t=h.row>=n.row&&h.row<=n.row+n.rowspan-1?!0:!1;var u;u=h.col>=n.col&&h.col<=n.col+n.colspan-1?!0:!1;e.includesRange(k)&&(k.includes(h)||t||u)&&(t&&(0>g?g-=n.rowspan-1:0<g&&(g+=n.rowspan-1)),u&&(0>m?m-=n.colspan-1:0<m&&(m+=n.colspan-1)))}0!==g&&(d.row=g);0!==m&&(d.col=m)};d.prototype.shiftCollection=function(a,b,f){f=[0,0];switch(a){case "right":f[0]+=1;break;case "left":--f[0];break;case "down":f[1]+=1;break;case "up":--f[1]}for(var e=0;e<this.mergedCellInfoCollection.length;e++){var d=this.mergedCellInfoCollection[e];"right"===a||"left"===a?b<=d.col&&(d.col+=f[0]):b<=d.row&&(d.row+=f[1])}};p=function(a){return function(b){if(this.getSettings().mergeCells){var f=this.getSelectedRange();this.mergeCells.modifyTransform(a,f,b);if("modifyTransformEnd"===a){b=this.countRows();var e=this.countCols();0>f.from.row?f.from.row=0:0<f.from.row&&f.from.row>=b&&(f.from.row=f.from-1);0>f.from.col?f.from.col=0:0<f.from.col&&f.from.col>=e&&(f.from.col=e-1)}}}};var u=function(a){if(this.getSettings().mergeCells)for(var b=this.countCols(),f,e=0;e<b;e++){if((f=this.mergeCells.mergedCellInfoCollection.getInfo(a.startRow,e))&&f.row<a.startRow)return a.startRow=f.row,u.call(this,a);if(f=this.mergeCells.mergedCellInfoCollection.getInfo(a.endRow,e))if(f=f.row+f.rowspan-1,f>a.endRow)return a.endRow=f,u.call(this,a)}},v=function(a){if(this.getSettings().mergeCells)for(var b=this.countRows(),f,e=0;e<b;e++){if((f=this.mergeCells.mergedCellInfoCollection.getInfo(e,a.startColumn))&&f.col<a.startColumn)return a.startColumn=f.col,v.call(this,a);if(f=this.mergeCells.mergedCellInfoCollection.getInfo(e,a.endColumn))if(f=f.col+f.colspan-1,f>a.endColumn)return a.endColumn=f,v.call(this,a)}};m.hooks.add("beforeInit",function(){var a=this.getSettings().mergeCells;a&&!this.mergeCells&&(this.mergeCells=new d(a))});m.hooks.add("afterInit",function(){var a=this;a.mergeCells&&(a.view.wt.wtTable.getCell=function(b){if(a.getSettings().mergeCells){var f=a.mergeCells.mergedCellInfoCollection.getInfo(b.row,b.col);f&&(b=f)}return t.prototype.getCell.call(this,b)})});m.hooks.add("afterUpdateSettings",function(){var a=this.getSettings().mergeCells;if(a)if(this.mergeCells){if(this.mergeCells.mergedCellInfoCollection=new k,Array.isArray(a))for(var b=0,f=a.length;b<f;b++)this.mergeCells.mergedCellInfoCollection.setInfo(a[b])}else this.mergeCells=new d(a);else this.mergeCells&&(this.mergeCells.mergedCellInfoCollection=new k)});m.hooks.add("beforeKeyDown",function(b){this.mergeCells&&(b.ctrlKey||b.metaKey)&&!b.altKey&&77===b.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),a(b))});m.hooks.add("modifyTransformStart",p("modifyTransformStart"));m.hooks.add("modifyTransformEnd",p("modifyTransformEnd"));m.hooks.add("beforeSetRangeEnd",function(a){this.lastDesiredCoords=null;if(this.getSettings().mergeCells){var e=this.getSelectedRange();e.highlight=new b(e.highlight.row,e.highlight.col);e.to=a;var d;do{d=!1;for(var g=0,m=this.mergeCells.mergedCellInfoCollection.length;g<m;g++){var n=this.mergeCells.mergedCellInfoCollection[g],h=new b(n.row,n.col),n=new b(n.row+n.rowspan-1,n.col+n.colspan-1),h=new f(h,h,n);e.expandByRange(h)&&(a.row=e.to.row,a.col=e.to.col,d=!0)}}while(d)}});m.hooks.add("beforeDrawBorders",function(a,e){if(e&&"area"==e&&this.getSettings().mergeCells)for(var d=this.getSelectedRange(),g=new f(d.from,d.from,d.from),d=new f(d.to,d.to,d.to),m=0,n=this.mergeCells.mergedCellInfoCollection.length;m<n;m++){var h=this.mergeCells.mergedCellInfoCollection[m],l=new b(h.row,h.col),h=new b(h.row+h.rowspan-1,h.col+h.colspan-1),l=new f(l,l,h);g.expandByRange(l)&&(a[0]=g.from.row,a[1]=g.from.col);d.expandByRange(l)&&(a[2]=d.from.row,a[3]=d.from.col)}});m.hooks.add("afterIsMultipleSelection",function(a){if(a&&this.mergeCells){var b=this.mergeCells.mergedCellInfoCollection,f=this.getSelectedRange(),e;for(e in b)if(f.highlight.row==b[e].row&&f.highlight.col==b[e].col&&f.to.row==b[e].row+b[e].rowspan-1&&f.to.col==b[e].col+b[e].colspan-1)return!1}return a});m.hooks.add("afterRenderer",function(a,b,f,e,d,g){this.mergeCells&&this.mergeCells.applySpanProperties(a,b,f)});m.hooks.add("afterContextMenuDefaultOptions",function(a){this.getSettings().mergeCells&&(a.items.push(m.plugins.ContextMenu.SEPARATOR),a.items.push({key:"mergeCells",name:function(){var a=this.getSelected();return this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return this.selection.selectedHeader.corner}}))});m.hooks.add("afterGetCellMeta",function(a,b,f){if(this.getSettings().mergeCells){var e=this.mergeCells.mergedCellInfoCollection.getInfo(a,b);!e||e.row==a&&e.col==b||(f.copyable=!1)}});m.hooks.add("afterViewportRowCalculatorOverride",u);m.hooks.add("afterViewportColumnCalculatorOverride",v);m.hooks.add("modifyAutofillRange",function(a,b){if(this.getSettings().mergeCells&&!this.selection.isMultiple()){var f=this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1]);f&&(a[0]=f.row,a[1]=f.col,a[2]=f.row+f.rowspan-1,a[3]=f.col+f.colspan-1)}});m.hooks.add("afterCreateCol",function(a,b){this.mergeCells&&this.mergeCells.shiftCollection("right",a,b)});m.hooks.add("afterRemoveCol",function(a,b){this.mergeCells&&this.mergeCells.shiftCollection("left",a,b)});m.hooks.add("afterCreateRow",function(a,b){this.mergeCells&&this.mergeCells.shiftCollection("down",a,b)});m.hooks.add("afterRemoveRow",function(a,b){this.mergeCells&&this.mergeCells.shiftCollection("up",a,b)});m.MergeCells=d},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/table":21,browser:24,"helpers/dom/event":48,plugins:62}],110:[function(p,q,r){Object.defineProperties(r,{MultipleSelectionHandles:{get:function(){return f}},__esModule:{value:!0}});var k,d,h,l,g;p("browser");q=(k=p("helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var e=q.getWindowScrollTop,n=q.hasClass,m=q.getWindowScrollLeft,a=(d=p("helpers/browser"),d&&d.__esModule&&d||{"default":d}).isMobileBrowser;k=(h=p("_base"),h&&h.__esModule&&h||{"default":h})["default"];var b=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;p=(g=p("plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;var f=function(a){$traceurRuntime.superConstructor(t).call(this,a);this.dragged=[];this.lastSetCell=this.eventManager=null},t=f;$traceurRuntime.createClass(f,{isEnabled:function(){return a()},enablePlugin:function(){this.enabled||(this.eventManager||(this.eventManager=new b(this)),this.registerListeners(),$traceurRuntime.superGet(this,t.prototype,"enablePlugin").call(this))},registerListeners:function(){function a(a){if(1===b.dragged.length)return b.dragged.splice(0,b.dragged.length),!0;a=b.dragged.indexOf(a);if(-1==a)return!1;0===a?b.dragged=b.dragged.slice(0,1):1==a&&(b.dragged=b.dragged.slice(-1))}var b=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(a){var f;if(n(a.target,"topLeftSelectionHandle-HitArea"))return f=b.hot.getSelectedRange(),b.dragged.push("topLeft"),b.touchStartRange={width:f.getWidth(),height:f.getHeight(),direction:f.getDirection()},a.preventDefault(),!1;if(n(a.target,"bottomRightSelectionHandle-HitArea"))return f=b.hot.getSelectedRange(),b.dragged.push("bottomRight"),b.touchStartRange={width:f.getWidth(),height:f.getHeight(),direction:f.getDirection()},a.preventDefault(),!1});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(f){if(n(f.target,"topLeftSelectionHandle-HitArea"))return a.call(b,"topLeft"),b.touchStartRange=void 0,f.preventDefault(),!1;if(n(f.target,"bottomRightSelectionHandle-HitArea"))return a.call(b,"bottomRight"),b.touchStartRange=void 0,f.preventDefault(),!1});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(a){var f=e(),d=m(),g,n,h,l;if(0!==b.dragged.length&&(f=document.elementFromPoint(a.touches[0].screenX-d,a.touches[0].screenY-f))&&f!==b.lastSetCell){if("TD"==f.nodeName||"TH"==f.nodeName)d=b.hot.getCoords(f),-1==d.col&&(d.col=0),g=b.hot.getSelectedRange(),n=g.getWidth(),h=g.getHeight(),l=g.getDirection(),1==n&&1==h&&b.hot.selection.setRangeEnd(d),d=b.getCurrentRangeCoords(g,d,b.touchStartRange.direction,l,b.dragged[0]),null!==d.start&&b.hot.selection.setRangeStart(d.start),b.hot.selection.setRangeEnd(d.end),b.lastSetCell=f;a.preventDefault()}})},getCurrentRangeCoords:function(a,b,f,e,d){var g=a.getTopLeftCorner(),m=a.getBottomRightCorner(),n=a.getBottomLeftCorner(),h=a.getTopRightCorner(),l={start:null,end:null};switch(f){case "NE-SW":switch(e){case "NE-SW":case "NW-SE":l="topLeft"==d?{start:new WalkontableCellCoords(b.row,a.highlight.col),end:new WalkontableCellCoords(n.row,b.col)}:{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,g.col)};break;case "SE-NW":"bottomRight"==d&&(l={start:new WalkontableCellCoords(m.row,b.col),end:new WalkontableCellCoords(b.row,g.col)})}break;case "NW-SE":switch(e){case "NE-SW":"topLeft"==d?l={start:b,end:n}:l.end=b;break;case "NW-SE":"topLeft"==d?l={start:b,end:m}:l.end=b;break;case "SE-NW":"topLeft"==d?l={start:b,end:g}:l.end=b;break;case "SW-NE":"topLeft"==d?l={start:b,end:h}:l.end=b}break;case "SW-NE":switch(e){case "NW-SE":l="bottomRight"==d?{start:new WalkontableCellCoords(b.row,g.col),end:new WalkontableCellCoords(n.row,b.col)}:{start:new WalkontableCellCoords(g.row,b.col),end:new WalkontableCellCoords(b.row,m.col)};break;case "SW-NE":l="topLeft"==d?{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,m.col)}:{start:new WalkontableCellCoords(b.row,g.col),end:new WalkontableCellCoords(g.row,b.col)};break;case "SE-NW":"bottomRight"==d?l={start:new WalkontableCellCoords(b.row,h.col),end:new WalkontableCellCoords(g.row,b.col)}:"topLeft"==d&&(l={start:n,end:b})}break;case "SE-NW":switch(e){case "NW-SE":case "NE-SW":case "SW-NE":"topLeft"==d&&(l.end=b);break;case "SE-NW":"topLeft"==d?l.end=b:l={start:b,end:g}}}return l},isDragged:function(){return 0<this.dragged.length}},{},k);p("multipleSelectionHandles",f)},{_base:63,browser:24,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,plugins:62}],111:[function(p,q,r){Object.defineProperties(r,{DataObserver:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("jsonpatch"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("../../mixins/localHooks"),d&&d.__esModule&&d||{"default":d}).localHooks;d=(h=p("../../helpers/object"),h&&h.__esModule&&h||{"default":h}).mixin;var e=(l=p("utils"),l&&l.__esModule&&l||{"default":l}).cleanPatches,n=function(e){this.observer=this.observedData=null;this.paused=!1;this.setObservedData(e)};$traceurRuntime.createClass(n,{setObservedData:function(e){var a=this;this.observer&&g.unobserve(this.observedData,this.observer);this.observedData=e;this.observer=g.observe(this.observedData,function(b){return a.onChange(b)})},isPaused:function(){return this.paused},pause:function(){this.paused=!0},resume:function(){this.paused=!1},onChange:function(d){this.runLocalHooks("change",e(d))},destroy:function(){g.unobserve(this.observedData,this.observer);this.observer=this.observedData=null}},{});d(n,q)},{"../../helpers/object":53,"../../mixins/localHooks":58,jsonpatch:"jsonpatch",utils:113}],112:[function(p,q,r){Object.defineProperties(r,{ObserveChanges:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("_base"),d&&d.__esModule&&d||{"default":d})["default"];p("jsonpatch");var e=(h=p("dataObserver"),h&&h.__esModule&&h||{"default":h}).DataObserver,n=(l=p("helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach;p=(g=p("plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;q.hooks.register("afterChangesObserved");var m=function(b){$traceurRuntime.superConstructor(a).call(this,b);this.observer=null},a=m;$traceurRuntime.createClass(m,{isEnabled:function(){return this.hot.getSettings().observeChanges},enablePlugin:function(){var b=this;this.enabled||(this.observer||(this.observer=new e(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(a){return b.onDataChange(a)}),this.addHook("afterCreateRow",function(){return b.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return b.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return b.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return b.onAfterTableAlter()}),this.addHook("afterChange",function(a,e){return b.onAfterTableAlter(e)}),this.addHook("afterLoadData",function(a){return b.onAfterLoadData(a)}),$traceurRuntime.superGet(this,a.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi());$traceurRuntime.superGet(this,a.prototype,"disablePlugin").call(this)},onDataChange:function(a){var b=this;if(!this.observer.isPaused()){var e=this.pluginName+".change",d={add:function(a){isNaN(a.col)?b.hot.runHooks("afterCreateRow",a.row,1,e):b.hot.runHooks("afterCreateCol",a.col,1,e)},remove:function(a){isNaN(a.col)?b.hot.runHooks("afterRemoveRow",a.row,1,e):b.hot.runHooks("afterRemoveCol",a.col,1,e)},replace:function(a){b.hot.runHooks("afterChange",[a.row,a.col,null,a.value],e)}};n(a,function(a){if(d[a.op])d[a.op](a)});this.hot.render()}this.hot.runHooks("afterChangesObserved")},onAfterTableAlter:function(a){var b=this;"loadData"!==a&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return b.observer.resume()}))},onAfterLoadData:function(a){a||this.observer.setObservedData(this.hot.getSourceData())},destroy:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi());$traceurRuntime.superGet(this,a.prototype,"destroy").call(this)},_exposePublicApi:function(){var a=this,f=this.hot;f.pauseObservingChanges=function(){return a.observer.pause()};f.resumeObservingChanges=function(){return a.observer.resume()};f.isPausedObservingChanges=function(){return a.observer.isPaused()}},_deletePublicApi:function(){var a=this.hot;delete a.pauseObservingChanges;delete a.resumeObservingChanges;delete a.isPausedObservingChanges}},{},k);p("observeChanges",m)},{_base:63,browser:24,dataObserver:111,"helpers/array":43,jsonpatch:"jsonpatch",plugins:62}],113:[function(p,q,r){function k(e){var n=[];e=l(e,function(e){return/[/]length/ig.test(e.path)||!d(e.path)?!1:!0});e=g(e,function(e){var a=d(e.path);e.row=a.row;e.col=a.col;return e});e=l(e,function(e){if(-1!==["add","remove"].indexOf(e.op)&&!isNaN(e.col)){if(-1!==n.indexOf(e.col))return!1;n.push(e.col)}return!0});n.length=0;return e}function d(e){e=e.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var d=e[2];return{row:parseInt(e[1],10),col:/^\d*$/.test(d)?parseInt(d,10):d}}Object.defineProperties(r,{cleanPatches:{get:function(){return k}},parsePath:{get:function(){return d}},__esModule:{value:!0}});var h;p=(h=p("../../helpers/array"),h&&h.__esModule&&h||{"default":h});var l=p.arrayFilter,g=p.arrayMap},{"../../helpers/array":43}],114:[function(p,q,r){function k(d){var e,g=function(){window.localStorage[d+"__persistentStateKeys"]=JSON.stringify(e)};(function(){var g=window.localStorage[d+"__persistentStateKeys"];e=(g="string"==typeof g?JSON.parse(g):void 0)?g:[]})();this.saveValue=function(m,a){window.localStorage[d+"_"+m]=JSON.stringify(a);-1==e.indexOf(m)&&(e.push(m),g())};this.loadValue=function(e,a){var b=window.localStorage[d+"_"+("undefined"===typeof e?a:e)];return"undefined"==typeof b?void 0:JSON.parse(b)};this.reset=function(e){window.localStorage.removeItem(d+"_"+e)};this.resetAll=function(){for(var m=0;m<e.length;m++)window.localStorage.removeItem(d+"_"+e[m]);e=[];g()}}function d(){var d=this;this.init=function(){var g=this.getSettings().persistentState;d.enabled=!!g;if(d.enabled){this.storage||(this.storage=new k(this.rootElement.id));this.resetState=d.resetValue;for(var a in e)e.hasOwnProperty(a)&&this.addHook(a,e[a])}else for(var b in e)e.hasOwnProperty(b)&&this.removeHook(b,e[b])};this.saveValue=function(e,a){this.storage.saveValue(e,a)};this.loadValue=function(e,a){a.value=this.storage.loadValue(e)};this.resetValue=function(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)};var e={persistentStateSave:d.saveValue,persistentStateLoad:d.loadValue,persistentStateReset:d.resetValue},n;for(n in e)e.hasOwnProperty(n)&&l.hooks.register(n)}Object.defineProperties(r,{HandsontablePersistentState:{get:function(){return d}},__esModule:{value:!0}});var h,l=(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"];p("plugins");p=new d;l.hooks.add("beforeInit",p.init);l.hooks.add("afterUpdateSettings",p.init)},{browser:24,plugins:62}],115:[function(p,q,r){function k(){this.getSettings().search?this.search=new g.Search(this):delete this.search}var d,h,l,g=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var e=q.addClass,n=q.removeClass;p=(l=p("renderers"),l&&l.__esModule&&l||{"default":l});l=p.registerRenderer;p=p.getRenderer;g.Search=function(a){this.query=function(b,f,e){var d=a.countRows(),m=a.countCols(),n=[];f||(f=g.Search.global.getDefaultCallback());e||(e=g.Search.global.getDefaultQueryMethod());for(var h=0;h<d;h++)for(var l=0;l<m;l++){var k=a.getDataAtCell(h,l),t=a.getCellMeta(h,l),p=t.search.callback||f;(t=(t.search.queryMethod||e)(b,k))&&n.push({row:h,col:l,data:k});p&&p(a,h,l,k,t)}return n}};g.Search.DEFAULT_CALLBACK=function(a,b,f,e,d){a.getCellMeta(b,f).isSearchResult=d};g.Search.DEFAULT_QUERY_METHOD=function(a,b){return"undefined"!=typeof a&&null!=a&&a.toLowerCase&&0!==a.length&&"undefined"!=typeof b&&null!=b?-1!=b.toString().toLowerCase().indexOf(a.toLowerCase()):!1};g.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";g.Search.global=function(){var a=g.Search.DEFAULT_CALLBACK,b=g.Search.DEFAULT_QUERY_METHOD,f=g.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return a},setDefaultCallback:function(b){a=b},getDefaultQueryMethod:function(){return b},setDefaultQueryMethod:function(a){b=a},getDefaultSearchResultClass:function(){return f},setDefaultSearchResultClass:function(a){f=a}}}();g.SearchCellDecorator=function(a,b,f,d,m,h,l){a=null!==l.search&&"object"==typeof l.search&&l.search.searchResultClass||g.Search.global.getDefaultSearchResultClass();l.isSearchResult?e(b,a):n(b,a)};var m=p("base");l("base",function(a,b,f,e,d,n,h){m.apply(this,arguments);g.SearchCellDecorator.apply(this,arguments)});g.hooks.add("afterInit",k);g.hooks.add("afterUpdateSettings",k)},{browser:24,"helpers/dom/element":47,renderers:118}],116:[function(p,q,r){Object.defineProperties(r,{TouchScroll:{get:function(){return t}},__esModule:{value:!0}});var k,d,h,l,g,e,n=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var m=q.addClass,a=q.removeClass,b=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;d=(l=p("_base"),l&&l.__esModule&&l||{"default":l})["default"];l=(g=p("plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;var f=(e=p("helpers/feature"),e&&e.__esModule&&e||{"default":e}).isTouchSupported,t=function(a){$traceurRuntime.superConstructor(u).call(this,a);this.scrollbars=[];this.clones=[];this.lockedCollection=!1},u=t;$traceurRuntime.createClass(t,{isEnabled:function(){return f()},enablePlugin:function(){var a=this;this.enabled||(this.addHook("afterRender",function(){return a.onAfterRender()}),this.registerEvents(),$traceurRuntime.superGet(this,u.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.lockedCollection=!1;$traceurRuntime.superGet(this,u.prototype,"updatePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,u.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.addHook("beforeTouchScroll",function(){return a.onBeforeTouchScroll()});this.addHook("afterMomentumScroll",function(){return a.onAfterMomentumScroll()})},onAfterRender:function(){if(!this.lockedCollection){var a=this.hot.view.wt.wtOverlays,b=a.topOverlay,f=a.bottomOverlay,e=a.leftOverlay,d=a.topLeftCornerOverlay,a=a.bottomLeftCornerOverlay;this.lockedCollection=!0;this.scrollbars.length=0;this.scrollbars.push(b);f.clone&&this.scrollbars.push(f);this.scrollbars.push(e);d&&this.scrollbars.push(d);a&&a.clone&&this.scrollbars.push(a);this.clones.length=0;b.needFullRender&&this.clones.push(b.clone.wtTable.holder.parentNode);f.needFullRender&&this.clones.push(f.clone.wtTable.holder.parentNode);e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode);d&&this.clones.push(d.clone.wtTable.holder.parentNode);a&&a.clone&&this.clones.push(a.clone.wtTable.holder.parentNode)}},onBeforeTouchScroll:function(){n.freezeOverlays=!0;b(this.clones,function(a){m(a,"hide-tween")})},onAfterMomentumScroll:function(){var f=this;n.freezeOverlays=!1;b(this.clones,function(b){a(b,"hide-tween");m(b,"show-tween")});setTimeout(function(){b(f.clones,function(b){a(b,"show-tween")})},400);b(this.scrollbars,function(a){a.refresh();a.resetFixedPosition()});this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},d);l("touchScroll",t)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,plugins:62}],117:[function(p,q,r){function k(){"undefined"==typeof this.getSettings().undo||this.getSettings().undo?this.undoRedo||(this.undoRedo=new b.UndoRedo(this),l(this),this.addHook("beforeKeyDown",d),this.addHook("afterChange",h)):this.undoRedo&&(delete this.undoRedo,delete this.undo,delete this.redo,delete this.isUndoAvailable,delete this.isRedoAvailable,delete this.clearUndo,this.removeHook("beforeKeyDown",d),this.removeHook("afterChange",h))}function d(a){!a.ctrlKey&&!a.metaKey||a.altKey||(89===a.keyCode||a.shiftKey&&90===a.keyCode?(this.undoRedo.redo(),v(a)):90===a.keyCode&&(this.undoRedo.undo(),v(a)))}function h(a,b){if("loadData"===b)return this.undoRedo.clear()}function l(a){a.undo=function(){return a.undoRedo.undo()};a.redo=function(){return a.undoRedo.redo()};a.isUndoAvailable=function(){return a.undoRedo.isUndoAvailable()};a.isRedoAvailable=function(){return a.undoRedo.isRedoAvailable()};a.clearUndo=function(){return a.undoRedo.clear()}}var g,e,n,m,a,b=(g=p("browser"),g&&g.__esModule&&g||{"default":g})["default"],f=(e=p("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayMap,t=(n=p("helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;q=(m=p("helpers/object"),m&&m.__esModule&&m||{"default":m});m=q.inherit;var u=q.deepClone,v=(a=p("helpers/dom/event"),a&&a.__esModule&&a||{"default":a}).stopImmediatePropagation;b.UndoRedo=function(a){var f=this;this.instance=a;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;a.addHook("afterChange",function(a,e){a&&"UndoRedo.undo"!==e&&"UndoRedo.redo"!==e&&f.done(new b.UndoRedo.ChangeAction(a))});a.addHook("afterCreateRow",function(a,e,d){"UndoRedo.undo"!==d&&"UndoRedo.undo"!==d&&"auto"!==d&&(a=new b.UndoRedo.CreateRowAction(a,e),f.done(a))});a.addHook("beforeRemoveRow",function(a,e,d,g){"UndoRedo.undo"!==g&&"UndoRedo.redo"!==g&&"auto"!==g&&(d=f.instance.getSourceDataArray(),a=(d.length+a)%d.length,e=u(d.slice(a,a+e)),f.done(new b.UndoRedo.RemoveRowAction(a,e)))});a.addHook("afterCreateCol",function(a,e,d){"UndoRedo.undo"!==d&&"UndoRedo.redo"!==d&&"auto"!==d&&f.done(new b.UndoRedo.CreateColumnAction(a,e))});a.addHook("beforeRemoveCol",function(e,d,g,m){if("UndoRedo.undo"!==m&&"UndoRedo.redo"!==m&&"auto"!==m){var n=f.instance.getSourceDataArray();e=(f.instance.countCols()+e)%f.instance.countCols();var h=[],l=[],k=[];t(n.length-1,function(b){var f=[],g=n[b];t(e,e+(d-1),function(b){f.push(g[a.runHooks("modifyCol",b)])});h.push(f)});t(d-1,function(b){k.push(a.runHooks("modifyCol",e+b))});Array.isArray(a.getSettings().colHeaders)&&t(d-1,function(b){l.push(a.getSettings().colHeaders[a.runHooks("modifyCol",e+b)]||null)});g=f.instance.getPlugin("manualColumnMove");g=g.isEnabled()?g.columnsMapper.__arrayMap:[];g=new b.UndoRedo.RemoveColumnAction(e,k,h,l,g);f.done(g)}});a.addHook("beforeCellAlignment",function(a,e,d,g){a=new b.UndoRedo.CellAlignmentAction(a,e,d,g);f.done(a)});a.addHook("beforeFilter",function(a){f.done(new b.UndoRedo.FiltersAction(a))});a.addHook("beforeRowMove",function(a,e){!1!==a&&f.done(new b.UndoRedo.RowMoveAction(a,e))})};b.UndoRedo.prototype.done=function(a){this.ignoreNewActions||(this.doneActions.push(a),this.undoneActions.length=0)};b.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var a=this.doneActions.pop(),b=u(a),f=this.instance;if(!1!==f.runHooks("beforeUndo",b)){this.ignoreNewActions=!0;var e=this;a.undo(this.instance,function(){e.ignoreNewActions=!1;e.undoneActions.push(a)});f.runHooks("afterUndo",b)}}};b.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var a=this.undoneActions.pop(),b=u(a),f=this.instance;if(!1!==f.runHooks("beforeRedo",b)){this.ignoreNewActions=!0;var e=this;a.redo(this.instance,function(){e.ignoreNewActions=!1;e.doneActions.push(a)});f.runHooks("afterRedo",b)}}};b.UndoRedo.prototype.isUndoAvailable=function(){return 0<this.doneActions.length};b.UndoRedo.prototype.isRedoAvailable=function(){return 0<this.undoneActions.length};b.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};b.UndoRedo.Action=function(){};b.UndoRedo.Action.prototype.undo=function(){};b.UndoRedo.Action.prototype.redo=function(){};b.UndoRedo.ChangeAction=function(a){this.changes=a;this.actionType="change"};m(b.UndoRedo.ChangeAction,b.UndoRedo.Action);b.UndoRedo.ChangeAction.prototype.undo=function(a,b){for(var f=u(this.changes),e=a.countEmptyRows(!0),d=a.countEmptyCols(!0),g=0,m=f.length;g<m;g++)f[g].splice(3,1);a.addHookOnce("afterChange",b);a.setDataAtRowProp(f,null,null,"UndoRedo.undo");g=0;for(m=f.length;g<m;g++)a.getSettings().minSpareRows&&f[g][0]+1+a.getSettings().minSpareRows===a.countRows()&&e==a.getSettings().minSpareRows&&(a.alter("remove_row",parseInt(f[g][0]+1,10),a.getSettings().minSpareRows),a.undoRedo.doneActions.pop()),a.getSettings().minSpareCols&&f[g][1]+1+a.getSettings().minSpareCols===a.countCols()&&d==a.getSettings().minSpareCols&&(a.alter("remove_col",parseInt(f[g][1]+1,10),a.getSettings().minSpareCols),a.undoRedo.doneActions.pop())};b.UndoRedo.ChangeAction.prototype.redo=function(a,b){for(var f=u(this.changes),e=0,d=f.length;e<d;e++)f[e].splice(2,1);a.addHookOnce("afterChange",b);a.setDataAtRowProp(f,null,null,"UndoRedo.redo")};b.UndoRedo.CreateRowAction=function(a,b){this.index=a;this.amount=b;this.actionType="insert_row"};m(b.UndoRedo.CreateRowAction,b.UndoRedo.Action);b.UndoRedo.CreateRowAction.prototype.undo=function(a,b){var f=a.countRows(),e=a.getSettings().minSpareRows;this.index>=f&&this.index-e<f&&(this.index-=e);a.addHookOnce("afterRemoveRow",b);a.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};b.UndoRedo.CreateRowAction.prototype.redo=function(a,b){a.addHookOnce("afterCreateRow",b);a.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};b.UndoRedo.RemoveRowAction=function(a,b){this.index=a;this.data=b;this.actionType="remove_row"};m(b.UndoRedo.RemoveRowAction,b.UndoRedo.Action);b.UndoRedo.RemoveRowAction.prototype.undo=function(a,b){a.alter("insert_row",this.index,this.data.length,"UndoRedo.undo");a.addHookOnce("afterRender",b);a.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};b.UndoRedo.RemoveRowAction.prototype.redo=function(a,b){a.addHookOnce("afterRemoveRow",b);a.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};b.UndoRedo.CreateColumnAction=function(a,b){this.index=a;this.amount=b;this.actionType="insert_col"};m(b.UndoRedo.CreateColumnAction,b.UndoRedo.Action);b.UndoRedo.CreateColumnAction.prototype.undo=function(a,b){a.addHookOnce("afterRemoveCol",b);a.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};b.UndoRedo.CreateColumnAction.prototype.redo=function(a,b){a.addHookOnce("afterCreateCol",b);a.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};b.UndoRedo.RemoveColumnAction=function(a,b,f,e,d){this.index=a;this.indexes=b;this.data=f;this.amount=this.data[0].length;this.headers=e;this.columnPositions=d.slice(0);this.actionType="remove_col"};m(b.UndoRedo.RemoveColumnAction,b.UndoRedo.Action);b.UndoRedo.RemoveColumnAction.prototype.undo=function(a,e){var d=this,g,m=this.indexes.slice(0).sort(),n=function(a,b,f){return f[d.indexes.indexOf(m[b])]},h=[];t(this.data.length-1,function(a){h[a]=f(d.data[a],n)});var l=[],l=f(this.headers,n),k=[];b.hooks.run(a,"beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo");t(this.data.length-1,function(b){g=a.getSourceDataAtRow(b);t(m.length-1,function(a){g.splice(m[a],0,h[b][a]);k.push([b,m[a],null,h[b][a]])})});if(a.getPlugin("formulas"))a.getPlugin("formulas").onAfterSetDataAtCell(k);"undefined"!==typeof this.headers&&t(l.length-1,function(b){a.getSettings().colHeaders.splice(m[b],0,l[b])});a.getPlugin("manualColumnMove")&&(a.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions);a.addHookOnce("afterRender",e);b.hooks.run(a,"afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo");a.getPlugin("formulas")&&a.getPlugin("formulas").recalculateFull();a.render()};b.UndoRedo.RemoveColumnAction.prototype.redo=function(a,b){a.addHookOnce("afterRemoveCol",b);a.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};b.UndoRedo.CellAlignmentAction=function(a,b,f,e){this.stateBefore=a;this.range=b;this.type=f;this.alignment=e};b.UndoRedo.CellAlignmentAction.prototype.undo=function(a,b){if(a.getPlugin("contextMenu").isEnabled()){for(var f=this.range.from.row;f<=this.range.to.row;f++)for(var e=this.range.from.col;e<=this.range.to.col;e++)a.setCellMeta(f,e,"className",this.stateBefore[f][e]||" htLeft");a.addHookOnce("afterRender",b);a.render()}};b.UndoRedo.CellAlignmentAction.prototype.redo=function(a,b){a.getPlugin("contextMenu").isEnabled()&&(a.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),a.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),a.addHookOnce("afterRender",b),a.render())};b.UndoRedo.FiltersAction=function(a){this.formulaStacks=a;this.actionType="filter"};m(b.UndoRedo.FiltersAction,b.UndoRedo.Action);b.UndoRedo.FiltersAction.prototype.undo=function(a,b){var f=a.getPlugin("filters");a.addHookOnce("afterRender",b);f.formulaCollection.importAllFormulas(this.formulaStacks.slice(0,this.formulaStacks.length-1));f.filter()};b.UndoRedo.FiltersAction.prototype.redo=function(a,b){var f=a.getPlugin("filters");a.addHookOnce("afterRender",b);f.formulaCollection.importAllFormulas(this.formulaStacks);f.filter()};b.UndoRedo.RowMoveAction=function(a,b){this.rows=a.slice();this.target=b};m(b.UndoRedo.RowMoveAction,b.UndoRedo.Action);b.UndoRedo.RowMoveAction.prototype.undo=function(a,b){var f=a.getPlugin("manualRowMove");a.addHookOnce("afterRender",b);for(var e=this.rows[0]<this.target?-1*this.rows.length:0,d=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],g=[],m=this.rows.length+e;e<m;e++)g.push(this.target+e);f.moveRows(g.slice(),d);a.render();a.selection.setRangeStartOnly(new WalkontableCellCoords(this.rows[0],0));a.selection.setRangeEnd(new WalkontableCellCoords(this.rows[this.rows.length-1],a.countCols()-1))};b.UndoRedo.RowMoveAction.prototype.redo=function(a,b){var f=a.getPlugin("manualRowMove");a.addHookOnce("afterRender",b);f.moveRows(this.rows.slice(),this.target);a.render();f=this.rows[0]<this.target?this.target-this.rows.length:this.target;a.selection.setRangeStartOnly(new WalkontableCellCoords(f,0));a.selection.setRangeEnd(new WalkontableCellCoords(f+this.rows.length-1,a.countCols()-1))};b.hooks.add("afterInit",k);b.hooks.add("afterUpdateSettings",k);b.hooks.register("beforeUndo");b.hooks.register("afterUndo");b.hooks.register("beforeRedo");b.hooks.register("afterRedo")},{browser:24,"helpers/array":43,"helpers/dom/event":48,"helpers/number":52,"helpers/object":53}],118:[function(p,q,r){function k(a,b){var f;m[a]=b;f=n(a)+"Renderer";e.renderers[f]=b;e[f]=b;"base"===a&&(e.renderers.cellDecorator=b)}function d(a){if("function"==typeof a)return a;if("string"!=typeof a)throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(a in m))throw Error('No editor registered under name "'+a+'"');return m[a]}function h(a){return a in m}Object.defineProperties(r,{registerRenderer:{get:function(){return k}},getRenderer:{get:function(){return d}},hasRenderer:{get:function(){return h}},__esModule:{value:!0}});var l,g,e=(l=p("browser"),l&&l.__esModule&&l||{"default":l})["default"],n=(g=p("helpers/string"),g&&g.__esModule&&g||{"default":g}).toUpperCaseFirst,m={};e.renderers=e.renderers||{};e.renderers.registerRenderer=k;e.renderers.getRenderer=d},{browser:24,"helpers/string":55}],119:[function(p,q,r){function k(e,d,m,a,b,f,h){h.className&&(d.className=d.className?d.className+" "+h.className:h.className);h.readOnly&&l(d,h.readOnlyCellClassName);!1===h.valid&&h.invalidCellClassName?l(d,h.invalidCellClassName):g(d,h.invalidCellClassName);!1===h.wordWrap&&h.noWordWrapClassName&&l(d,h.noWordWrapClassName);!f&&h.placeholder&&l(d,h.placeholderCellClassName)}Object.defineProperties(r,{cellDecorator:{get:function(){return k}},__esModule:{value:!0}});var d,h;q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var l=q.addClass,g=q.removeClass;p=(h=p("renderers"),h&&h.__esModule&&h||{"default":h}).registerRenderer;p("base",k)},{"helpers/dom/element":47,renderers:118}],120:[function(p,q,r){function k(d,g,h,l,k,p,C){f.cloneNode(!0);var u=t.cloneNode(!0);C.allowHtml?a("html").apply(this,arguments):a("text").apply(this,arguments);g.appendChild(u);e(g,"htAutocomplete");g.firstChild||g.appendChild(document.createTextNode(String.fromCharCode(160)));if(!d.acArrowListener){var v=m(d);d.acArrowListener=function(a){n(a.target,"htAutocompleteArrow")&&d.view.wt.getSetting("onCellDblClick",null,new b(h,l),g)};v.addEventListener(d.rootElement,"mousedown",d.acArrowListener);d.addHookOnce("afterDestroy",function(){v.destroy()})}}Object.defineProperties(r,{autocompleteRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g;q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var e=q.addClass,n=q.hasClass,m=(h=p("eventManager"),h&&h.__esModule&&h||{"default":h}).eventManager;d=(l=p("renderers"),l&&l.__esModule&&l||{"default":l});var a=d.getRenderer;l=d.registerRenderer;var b=(g=p("3rdparty/walkontable/src/cell/coords"),g&&g.__esModule&&g||{"default":g}).WalkontableCellCoords,f=document.createElement("DIV");f.className="htAutocompleteWrapper";var t=document.createElement("DIV");t.className="htAutocompleteArrow";t.appendChild(document.createTextNode(String.fromCharCode(9660)));l("autocomplete",k)},{"3rdparty/walkontable/src/cell/coords":6,eventManager:42,"helpers/dom/element":47,renderers:118}],121:[function(p,q,r){function k(a,b,f,e,g,m,n){function k(a){var b=C(x,a.keyCode);b("SPACE|ENTER|DELETE|BACKSPACE")&&!A(a)&&p(function(){E(a);a.preventDefault()});b("SPACE|ENTER")&&t();b("DELETE|BACKSPACE")&&t(!0)}function t(b){b=void 0!==b?b:!1;var f=a.getSelectedRange();if(f){for(var e=f.getTopLeftCorner(),f=f.getBottomRightCorner(),d=[],g=e.row;g<=f.row;g+=1)for(var m=e.col;m<=f.col;m+=1){var n=a.getCellMeta(g,m);if("checkbox"!==n.type)return;if(!0!==n.readOnly){"undefined"===typeof n.checkedTemplate&&(n.checkedTemplate=!0);"undefined"===typeof n.uncheckedTemplate&&(n.uncheckedTemplate=!1);var h=a.getDataAtCell(g,m);!1===b?h===n.checkedTemplate?d.push([g,m,n.uncheckedTemplate]):-1!==[n.uncheckedTemplate,null,void 0].indexOf(h)&&d.push([g,m,n.checkedTemplate]):d.push([g,m,n.uncheckedTemplate])}}0<d.length&&a.setDataAtCell(d)}}function p(b){var f=a.getSelectedRange();if(f)for(var e=f.getTopLeftCorner(),f=f.getBottomRightCorner(),d=e.row;d<=f.row;d++)for(var g=e.col;g<=f.col;g++){var m=a.getCellMeta(d,g);if("checkbox"!==m.type)return;var n=a.getCell(d,g);null==n?b(d,g,m):(n=n.querySelectorAll("input[type\x3dcheckbox]"),0<n.length&&!m.readOnly&&b(n))}}z("base").apply(this,arguments);d(a);var w=h(),F=n.label,G=!1;"undefined"===typeof n.checkedTemplate&&(n.checkedTemplate=!0);"undefined"===typeof n.uncheckedTemplate&&(n.uncheckedTemplate=!1);u(b);m===n.checkedTemplate||y(m,n.checkedTemplate)?w.checked=!0:m===n.uncheckedTemplate||y(m,n.uncheckedTemplate)?w.checked=!1:null===m?v(w,"noValue"):(w.style.display="none",v(w,D),G=!0);w.setAttribute("data-row",f);w.setAttribute("data-col",e);if(!G&&F){var q="";F.value?q="function"===typeof F.value?F.value.call(this,f,e,g,m):F.value:F.property&&(q=a.getDataAtRowProp(f,F.property));isNaN(q)&&(q=q.replace(/<[^>]*href[^>]*>|<\/a>/g,""));q=l(q);"before"===F.position?q.appendChild(w):q.insertBefore(w,q.firstChild);w=q}b.appendChild(w);G&&b.appendChild(document.createTextNode("#bad-value#"));B.has(a)||(B.set(a,!0),a.addHook("beforeKeyDown",k))}function d(a){var b=G.get(a);b||(b=new w(a),b.addEventListener(a.rootElement,"click",function(b){if(g(b.target)){var f=parseInt(b.target.getAttribute("data-row"),10),e=parseInt(b.target.getAttribute("data-col"),10);a.getCellMeta(f,e).readOnly&&b.preventDefault();b=void 0}else b=!1;return b}),b.addEventListener(a.rootElement,"mouseup",function(b){g(b.target)&&setTimeout(a.listen,10)}),b.addEventListener(a.rootElement,"change",function(b){if(g(b.target)){var f=parseInt(b.target.getAttribute("data-row"),10),e=parseInt(b.target.getAttribute("data-col"),10),d=a.getCellMeta(f,e);d.readOnly||a.setDataAtCell(f,e,b.target.checked?void 0===d.checkedTemplate?!0:d.checkedTemplate:void 0===d.uncheckedTemplate?!1:d.uncheckedTemplate);b=void 0}else b=!1;return b}),G.set(a,b));return b}function h(){var a=document.createElement("input");a.className="htCheckboxRendererInput";a.type="checkbox";a.setAttribute("autocomplete","off");a.setAttribute("tabindex","-1");return a.cloneNode(!1)}function l(a){var b=document.createElement("label");b.className="htCheckboxRendererLabel";b.appendChild(document.createTextNode(a));return b.cloneNode(!0)}function g(a){return"INPUT"===a.tagName&&"checkbox"===a.getAttribute("type")}Object.defineProperties(r,{checkboxRenderer:{get:function(){return k}},__esModule:{value:!0}});var e,n,m,a,b,f,t;q=(e=p("helpers/dom/element"),e&&e.__esModule&&e||{"default":e});var u=q.empty,v=q.addClass,y=(n=p("helpers/string"),n&&n.__esModule&&n||{"default":n}).equalsIgnoreCase,w=(m=p("eventManager"),m&&m.__esModule&&m||{"default":m}).EventManager;e=(a=p("renderers"),a&&a.__esModule&&a||{"default":a});var z=e.getRenderer;a=e.registerRenderer;var x=(b=p("helpers/unicode"),b&&b.__esModule&&b||{"default":b}).isKey,C=(f=p("helpers/function"),f&&f.__esModule&&f||{"default":f}).partial;p=(t=p("helpers/dom/event"),t&&t.__esModule&&t||{"default":t});var E=p.stopImmediatePropagation,A=p.isImmediatePropagationStopped,B=new WeakMap,G=new WeakMap,D="htBadValue";a("checkbox",k)},{eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/string":55,"helpers/unicode":56,renderers:118}],122:[function(p,q,r){function k(e,d,m,a,b,f,h){g("base").apply(this,arguments);if(null===f||void 0===f)f="";l(d,f)}Object.defineProperties(r,{htmlRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,h,l=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).fastInnerHTML;p=(h=p("renderers"),h&&h.__esModule&&h||{"default":h});var g=p.getRenderer;h=p.registerRenderer;h("html",k)},{"helpers/dom/element":47,renderers:118}],123:[function(p,q,r){function k(d,a,b,f,h,l,k){if(n(l)){"undefined"!==typeof k.language&&g.culture(k.language);l=g(l).format(k.format||"0");var m=k.className||"",m=m.length?m.split(" "):[];0>m.indexOf("htLeft")&&0>m.indexOf("htCenter")&&0>m.indexOf("htRight")&&0>m.indexOf("htJustify")&&m.push("htRight");0>m.indexOf("htNumeric")&&m.push("htNumeric");k.className=m.join(" ")}e("text")(d,a,b,f,h,l,k)}Object.defineProperties(r,{numericRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g=(d=p("numbro"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("renderers"),h&&h.__esModule&&h||{"default":h});var e=q.getRenderer;h=q.registerRenderer;var n=(l=p("helpers/number"),l&&l.__esModule&&l||{"default":l}).isNumeric;h("numeric",k)},{"helpers/number":52,numbro:"numbro",renderers:118}],124:[function(p,q,r){function k(e,d,m,a,b,f,h){g("text").apply(this,arguments);f=d.innerHTML;var n,k=h.hashLength||f.length,t=h.hashSymbol||"*";for(n="";n.split(t).length-1<k;n+=t);l(d,n)}Object.defineProperties(r,{passwordRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,h,l=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).fastInnerHTML;p=(h=p("renderers"),h&&h.__esModule&&h||{"default":h});var g=p.getRenderer;h=p.registerRenderer;h("password",k)},{"helpers/dom/element":47,renderers:118}],125:[function(p,q,r){function k(a,b,f,d,h,l,k){m("base").apply(this,arguments);!l&&k.placeholder&&(l=k.placeholder);var t=n(l);a.getSettings().trimWhitespace||(t=t.replace(/ /g,String.fromCharCode(160)));k.rendererTemplate?(g(b),t=document.createElement("TEMPLATE"),t.setAttribute("bind","{{}}"),t.innerHTML=k.rendererTemplate,HTMLTemplateElement.decorate(t),t.model=a.getSourceDataAtRow(f),b.appendChild(t)):e(b,t)}Object.defineProperties(r,{textRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,h,l;q=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var g=q.empty,e=q.fastInnerText,n=(h=p("helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify;p=(l=p("renderers"),l&&l.__esModule&&l||{"default":l});var m=p.getRenderer;l=p.registerRenderer;l("text",k)},{"helpers/dom/element":47,"helpers/mixed":51,renderers:118}],126:[function(p,q,r){(function(k){function d(a){return{configurable:!0,enumerable:!1,value:a,writable:!0}}function h(){return"__$"+Math.floor(1E9*Math.random())+"$"+ ++G+"$__"}function l(){var a=h();r[a]=!0;return a}function g(a){return"object"===typeof a&&a instanceof n}function e(a){a=new n(a);if(!(this instanceof e))return a;throw new TypeError("Symbol cannot be new'ed");}function n(b){var f=h();z(this,H,{value:this});z(this,D,{value:f});z(this,F,{value:b});a(this);J[f]=this}function m(a){var b=a[I];if(b&&b.self===a)return b;if(B(a))return Q.hash.value=R++,Q.self.value=a,O.value=p(null,Q),z(a,I,O),O.value}function a(a){m(a);return x.apply(this,arguments)}function b(a){return J[a]||r[a]}function f(a){var b=[];a=E(a);for(var f=0;f<a.length;f++){var e=J[a[f]];e&&b.push(e)}return b}function t(a){a.Symbol||(a.Symbol=e,Object.getOwnPropertySymbols=f);a.Symbol.iterator||(a.Symbol.iterator=e("Symbol.iterator"));a.Reflect=a.Reflect||{};a.Reflect.global=a.Reflect.global||a}if(!k.$traceurRuntime){var u=Object,v=TypeError,p=u.create,w=u.defineProperties,z=u.defineProperty,x=u.freeze,C=u.getOwnPropertyDescriptor,E=u.getOwnPropertyNames,q=u.keys,B=Object.isExtensible,G=0,D=h(),F=h(),H=h(),J=p(null),r=p(null);z(e.prototype,"constructor",d(e));z(e.prototype,"toString",d(function(){var a=this[H];if(!k.traceur||!k.traceur.options.symbols)return a[D];if(!a)throw TypeError("Conversion from symbol to string");a=a[F];void 0===a&&(a="");return"Symbol("+a+")"}));z(e.prototype,"valueOf",d(function(){var a=this[H];if(!a)throw TypeError("Conversion from symbol to string");return k.traceur&&k.traceur.options.symbols?a:a[D]}));z(n.prototype,"constructor",d(e));z(n.prototype,"toString",{value:e.prototype.toString,enumerable:!1});z(n.prototype,"valueOf",{value:e.prototype.valueOf,enumerable:!1});var I=l(),O={value:void 0},Q={hash:{value:void 0},self:{value:void 0}},R=0;a(n.prototype);t(k);k.$traceurRuntime={checkObjectCoercible:function(a){if(null==a)throw new TypeError("Value cannot be converted to an Object");return a},createPrivateName:l,defineProperties:w,defineProperty:z,exportStar:function(a){for(var f=1;f<arguments.length;f++)for(var e=E(arguments[f]),d=0;d<e.length;d++)b(e[d])||function(b,f){z(a,f,{get:function(){return b[f]},enumerable:!0})}(arguments[f],e[d]);return a},getOwnHashObject:m,getOwnPropertyDescriptor:C,getOwnPropertyNames:E,isObject:function(a){return null!=a&&("object"===typeof a||"function"===typeof a)},isPrivateName:function(a){return r[a]},isSymbolString:b,keys:q,setupGlobals:t,toObject:function(a){if(null==a)throw v();return u(a)},toProperty:function(a){return g(a)?a[D]:a},"typeof":function(a){return g(a)?"symbol":typeof a}}}})(window);(function(){var k=$traceurRuntime.toProperty;$traceurRuntime.spread=function(){for(var d=[],h=0,l,g=0;g<arguments.length;g++){l=$traceurRuntime.checkObjectCoercible(arguments[g]);"function"!==typeof l[k(Symbol.iterator)]&&(l[k(Symbol.iterator)]=function(){var e=this,d=e.length,a=0;return{next:function(){var b={done:!0};a<d&&(b.done=!1,b.value=e[a],++a);return b}}});for(var e=l[k(Symbol.iterator)]();!(l=e.next()).done;)d[h++]=l.value}return d}})();(function(){function k(a,e){var d=f(a);do{var g=b(d,e);if(g)return g;d=f(d)}while(d)}function d(a,b,f,e){return h(a,b,f).apply(a,e)}function h(a,b,f){if(b=k(b,f))return b.get?b.get.call(a):b.value}function l(a){for(var f={},e=v(a),d=0;d<e.length;d++){var g=e[d];f[g]=b(a,g)}e=p(a);for(d=0;d<e.length;d++)g=e[d],f[t(g)]=b(a,t(g));return f}var g=Object,e=TypeError,n=g.create,m=$traceurRuntime.defineProperties,a=$traceurRuntime.defineProperty,b=$traceurRuntime.getOwnPropertyDescriptor,f=Object.getPrototypeOf,t=$traceurRuntime.toProperty,u=Object,v=u.getOwnPropertyNames,p=u.getOwnPropertySymbols;$traceurRuntime.createClass=function(b,f,d,h){a(f,"constructor",{value:b,configurable:!0,enumerable:!1,writable:!0});if(3<arguments.length){"function"===typeof h&&(b.__proto__=h);var k;a:{if("function"===typeof h){k=h.prototype;if(g(k)===k||null===k){k=h.prototype;break a}throw new e("super prototype must be an Object or null");}if(null===h)k=null;else throw new e("Super expression must either be null or a function, not "+typeof h+".");}b.prototype=n(k,l(f))}else b.prototype=f;a(b,"prototype",{configurable:!1,writable:!1});return m(b,l(d))};$traceurRuntime.defaultSuperCall=function(a,b,e){null!==f(b)&&d(a,b,"constructor",e)};$traceurRuntime.superCall=d;$traceurRuntime.superConstructor=function(a){return a.__proto__};$traceurRuntime.superGet=h;$traceurRuntime.superSet=function(a,b,f,d){if((b=k(b,f))&&b.set)return b.set.call(a,d),d;throw e("super has no setter '"+f+"'.");}})()},{}],127:[function(p,q,r){function k(f){var e=this,d=this;this.eventManager=C(f);this.instance=f;this.settings=f.getSettings();this.selectionMouseDown=!1;var g=f.rootElement.getAttribute("style");g&&f.rootElement.setAttribute("data-originalstyle",g);b(f.rootElement,"handsontable");g=document.createElement("TABLE");b(g,"htCore");f.getSettings().tableClassName&&b(g,f.getSettings().tableClassName);this.THEAD=document.createElement("THEAD");g.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");g.appendChild(this.TBODY);f.table=g;f.container.insertBefore(g,f.container.firstChild);this.eventManager.addEventListener(f.rootElement,"mousedown",function(a){this.selectionMouseDown=!0;d.isTextSelectionAllowed(a.target)||(n(),a.preventDefault(),window.focus())});this.eventManager.addEventListener(f.rootElement,"mouseup",function(a){this.selectionMouseDown=!1});this.eventManager.addEventListener(f.rootElement,"mousemove",function(a){this.selectionMouseDown&&!d.isTextSelectionAllowed(a.target)&&(n(),a.preventDefault())});this.eventManager.addEventListener(document.documentElement,"keyup",function(a){f.selection.isInProgress()&&!a.shiftKey&&f.selection.finish()});var m;this.isMouseDown=function(){return m};this.eventManager.addEventListener(document.documentElement,"mouseup",function(a){f.selection.isInProgress()&&1===a.which&&f.selection.finish();m=!1;x(document.activeElement)&&f.unlisten()});this.eventManager.addEventListener(document.documentElement,"mousedown",function(a){var b=a.target,e=a.target,g=a.x||a.clientX,n=a.y||a.clientY;if(!m&&f.rootElement){if(e===f.view.wt.wtTable.holder){if(a=v(),document.elementFromPoint(g+a,n)!==f.view.wt.wtTable.holder||document.elementFromPoint(g,n+a)!==f.view.wt.wtTable.holder)return}else for(;e!==document.documentElement;){if(null===e){if(a.isTargetWebComponent)break;return}if(e===f.rootElement)return;e=e.parentNode}("function"===typeof d.settings.outsideClickDeselects?d.settings.outsideClickDeselects(b):d.settings.outsideClickDeselects)?f.deselectCell():f.destroyEditor()}});this.eventManager.addEventListener(g,"selectstart",function(a){d.settings.fragmentSelection||z(a.target)||a.preventDefault()});var n=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},h=[new F({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return d.settings.fillHandle&&!d.isCellEdited()&&!f.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!d.isCellEdited()&&!f.selection.isMultiple()}}}),new F({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return d.settings.fillHandle&&!d.isCellEdited()&&f.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!d.isCellEdited()&&f.selection.isMultiple()}}}),new F({className:"highlight",highlightHeaderClassName:d.settings.currentHeaderClassName,highlightRowClassName:d.settings.currentRowClassName,highlightColumnClassName:d.settings.currentColClassName}),new F({className:"fill",border:{width:1,color:"red"}})];h.current=h[0];h.area=h[1];h.highlight=h[2];h.fill=h[3];g={debug:function(){return d.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:g,preventOverflow:function(){return e.settings.preventOverflow},stretchH:function(){return d.settings.stretchH},data:f.getDataAtCell,totalRows:function(){return f.countRows()},totalColumns:function(){return f.countCols()},fixedColumnsLeft:function(){return d.settings.fixedColumnsLeft},fixedRowsTop:function(){return d.settings.fixedRowsTop},fixedRowsBottom:function(){return d.settings.fixedRowsBottom},minSpareRows:function(){return d.settings.minSpareRows},renderAllRows:d.settings.renderAllRows,rowHeaders:function(){var b=[];f.hasRowHeaders()&&b.push(function(a,b){d.appendRowHeader(a,b)});a.hooks.run(f,"afterGetRowHeaderRenderers",b);return b},columnHeaders:function(){var b=[];f.hasColHeaders()&&b.push(function(a,b){d.appendColHeader(a,b)});a.hooks.run(f,"afterGetColumnHeaderRenderers",b);return b},columnWidth:f.getColWidth,rowHeight:f.getRowHeight,cellRenderer:function(a,b,f){var e=d.instance.getCellMeta(a,b),g=d.instance.colToProp(b),m=d.instance.getDataAtRowProp(a,g);d.instance.hasHook("beforeValueRender")&&(m=d.instance.runHooks("beforeValueRender",m));d.instance.runHooks("beforeRenderer",f,a,b,g,m,e);d.instance.getCellRenderer(e)(d.instance,f,a,b,g,m,e);d.instance.runHooks("afterRenderer",f,a,b,g,m,e)},selections:h,hideBorderOnMouseDownOver:function(){return d.settings.fragmentSelection},onCellMouseDown:function(b,e,g,n){var h={row:!1,column:!1,cells:!1};f.listen();d.activeWt=n;m=!0;a.hooks.run(f,"beforeOnCellMouseDown",b,e,g,h);if(!A(b)){var l=f.getSelectedRange();n=f.selection;var k=n.selectedHeader;if(b.shiftKey&&l)0<=e.row&&0<=e.col&&!h.cells?(n.setSelectedHeaders(!1,!1),n.setRangeEnd(e)):(k.cols||k.rows)&&0<=e.row&&0<=e.col&&!h.cells?(n.setSelectedHeaders(!1,!1),n.setRangeEnd(new D(e.row,e.col))):k.cols&&0>e.row&&!h.column?n.setRangeEnd(new D(l.to.row,e.col)):k.rows&&0>e.col&&!h.row?n.setRangeEnd(new D(e.row,l.to.col)):(!k.cols&&!k.rows&&0>e.col||k.cols&&0>e.col)&&!h.row?(n.setSelectedHeaders(!0,!1),n.setRangeStartOnly(new D(l.from.row,0)),n.setRangeEnd(new D(e.row,f.countCols()-1))):(!k.cols&&!k.rows&&0>e.row||k.rows&&0>e.row)&&!h.column&&(n.setSelectedHeaders(!1,!0),n.setRangeStartOnly(new D(0,l.from.col)),n.setRangeEnd(new D(f.countRows()-1,e.col)));else{var t=!0;if(l){var t=l.from,l=l.to,u=!n.inInSelection(e);0>e.row&&k.cols?(k=Math.max(t.col,l.col),t=e.col<Math.min(t.col,l.col)||e.col>k):0>e.col&&k.rows?(k=Math.max(t.row,l.row),t=e.row<Math.min(t.row,l.row)||e.row>k):t=u}k=B(b);l=G(b)||"touchstart"===b.type;if(0>e.row&&0<=e.col&&!h.column){if(n.setSelectedHeaders(!1,!0),l||k&&t)n.setRangeStartOnly(new D(0,e.col)),n.setRangeEnd(new D(Math.max(f.countRows()-1,0),e.col),!1)}else if(0>e.col&&0<=e.row&&!h.row){if(n.setSelectedHeaders(!0,!1),l||k&&t)n.setRangeStartOnly(new D(e.row,0)),n.setRangeEnd(new D(e.row,Math.max(f.countCols()-1,0)),!1)}else if(0<=e.col&&0<=e.row&&!h.cells){if(l||k&&t)n.setSelectedHeaders(!1,!1),n.setRangeStart(e)}else 0>e.col&&0>e.row&&(e.row=0,e.col=0,n.setSelectedHeaders(!1,!1,!0),n.setRangeStart(e))}a.hooks.run(f,"afterOnCellMouseDown",b,e,g);d.activeWt=d.wt}},onCellMouseOut:function(b,e,g,m){d.activeWt=m;a.hooks.run(f,"beforeOnCellMouseOut",b,e,g);A(b)||(a.hooks.run(f,"afterOnCellMouseOut",b,e,g),d.activeWt=d.wt)},onCellMouseOver:function(b,e,g,n){var h={row:!1,column:!1,cell:!1};d.activeWt=n;a.hooks.run(f,"beforeOnCellMouseOver",b,e,g,h);A(b)||(0===b.button&&m&&(f.selection.selectedHeader.cols&&!h.column?f.selection.setRangeEnd(new D(f.countRows()-1,e.col),!1):f.selection.selectedHeader.rows&&!h.row?f.selection.setRangeEnd(new D(e.row,f.countCols()-1),!1):h.cell||f.selection.setRangeEnd(e)),a.hooks.run(f,"afterOnCellMouseOver",b,e,g),d.activeWt=d.wt)},onCellMouseUp:function(b,e,g,m){d.activeWt=m;a.hooks.run(f,"beforeOnCellMouseUp",b,e,g);a.hooks.run(f,"afterOnCellMouseUp",b,e,g);d.activeWt=d.wt},onCellCornerMouseDown:function(b){b.preventDefault();a.hooks.run(f,"afterOnCellCornerMouseDown",b)},onCellCornerDblClick:function(b){b.preventDefault();a.hooks.run(f,"afterOnCellCornerDblClick",b)},beforeDraw:function(a,b){d.beforeRender(a,b)},onDraw:function(a){d.onDraw(a)},onScrollVertically:function(){f.runHooks("afterScrollVertically")},onScrollHorizontally:function(){f.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(a,b){f.runHooks("beforeDrawBorders",a,b)},onBeforeTouchScroll:function(){f.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){f.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(a,b){return f.runHooks("beforeStretchingColumnWidth",a,b)},onModifyRowHeaderWidth:function(a){return f.runHooks("modifyRowHeaderWidth",a)},viewportRowCalculatorOverride:function(a){var b=f.countRows(),e=d.settings.viewportRowRenderingOffset;"auto"===e&&d.settings.fixedRowsTop&&(e=10);"number"===typeof e&&(a.startRow=Math.max(a.startRow-e,0),a.endRow=Math.min(a.endRow+e,b-1));"auto"===e&&(e=Math.ceil((a.startRow+a.endRow-a.startRow)/b*12),a.startRow=Math.max(a.startRow-e,0),a.endRow=Math.min(a.endRow+e,b-1));f.runHooks("afterViewportRowCalculatorOverride",a)},viewportColumnCalculatorOverride:function(a){var b=f.countCols(),e=d.settings.viewportColumnRenderingOffset;"auto"===e&&d.settings.fixedColumnsLeft&&(e=10);"number"===typeof e&&(a.startColumn=Math.max(a.startColumn-e,0),a.endColumn=Math.min(a.endColumn+e,b-1));"auto"===e&&(e=Math.ceil((a.startColumn+a.endColumn-a.startColumn)/b*12),a.startRow=Math.max(a.startColumn-e,0),a.endColumn=Math.min(a.endColumn+e,b-1));f.runHooks("afterViewportColumnCalculatorOverride",a)},rowHeaderWidth:function(){return d.settings.rowHeaderWidth},columnHeaderHeight:function(){var a=f.runHooks("modifyColumnHeaderHeight");return d.settings.columnHeaderHeight||a}};a.hooks.run(f,"beforeInitWalkontable",g);this.activeWt=this.wt=new H(g);this.eventManager.addEventListener(d.wt.wtTable.spreader,"mousedown",function(a){a.target===d.wt.wtTable.spreader&&3===a.which&&E(a)});this.eventManager.addEventListener(d.wt.wtTable.spreader,"contextmenu",function(a){a.target===d.wt.wtTable.spreader&&3===a.which&&E(a)});this.eventManager.addEventListener(document.documentElement,"click",function(){d.settings.observeDOMVisibility&&d.wt.drawInterrupted&&(d.instance.forceFullRender=!0,d.render())})}Object.defineProperties(r,{TableView:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g,e,n,m,a=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];q=(h=p("helpers/dom/element"),h&&h.__esModule&&h||{"default":h});var b=q.addClass,f=q.empty,t=q.fastInnerHTML,u=q.fastInnerText,v=q.getScrollbarWidth,y=q.hasClass,w=q.isChildOf,z=q.isInput,x=q.isOutsideInput;p("helpers/object");var C=(l=p("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager;h=(g=p("helpers/dom/event"),g&&g.__esModule&&g||{"default":g});var E=h.stopPropagation,A=h.isImmediatePropagationStopped,B=h.isRightClick,G=h.isLeftClick,D=(e=p("3rdparty/walkontable/src/cell/coords"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords,F=(n=p("3rdparty/walkontable/src/selection"),n&&n.__esModule&&n||{"default":n}).WalkontableSelection,H=(m=p("3rdparty/walkontable/src/core"),m&&m.__esModule&&m||{"default":m}).Walkontable;a.TableView=k;k.prototype.isTextSelectionAllowed=function(a){if(z(a))return!0;a=w(a,this.instance.view.wt.wtTable.spreader);return!0===this.settings.fragmentSelection&&a||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&a||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()?!0:!1};k.prototype.isSelectedOnlyCell=function(){var a=this.instance.getSelected()||[],b=a[0],f=a[1],e=a[2],a=a[3];return void 0!==b&&b===e&&f===a};k.prototype.isCellEdited=function(){var a=this.instance.getActiveEditor();return a&&a.isOpened()};k.prototype.beforeRender=function(b,f){b&&a.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender,f)};k.prototype.onDraw=function(b){b&&a.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)};k.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1;this.instance.renderCall=!1};k.prototype.getCellAtCoords=function(a,b){var f=this.wt.getCell(a,b);return 0>f?null:f};k.prototype.scrollViewport=function(a){this.wt.scrollViewport(a)};k.prototype.appendRowHeader=function(b,e){if(e.firstChild){var d=e.firstChild;if(!y(d,"relative")){f(e);this.appendRowHeader(b,e);return}this.updateCellHeader(d.querySelector(".rowHeader"),b,this.instance.getRowHeader)}else{var d=document.createElement("div"),g=document.createElement("span");d.className="relative";g.className="rowHeader";this.updateCellHeader(g,b,this.instance.getRowHeader);d.appendChild(g);e.appendChild(d)}a.hooks.run(this.instance,"afterGetRowHeader",b,e)};k.prototype.appendColHeader=function(b,e){if(e.firstChild){var d=e.firstChild;y(d,"relative")?this.updateCellHeader(d.querySelector(".colHeader"),b,this.instance.getColHeader):(f(e),this.appendColHeader(b,e))}else{var d=document.createElement("div"),g=document.createElement("span");d.className="relative";g.className="colHeader";this.updateCellHeader(g,b,this.instance.getColHeader);d.appendChild(g);e.appendChild(d)}a.hooks.run(this.instance,"afterGetColHeader",b,e)};k.prototype.updateCellHeader=function(a,f,e){var d=f,g=this.wt.wtOverlays.getParentOverlay(a)||this.wt;a.parentNode&&(y(a,"colHeader")?d=g.wtTable.columnFilter.sourceToRendered(f):y(a,"rowHeader")&&(d=g.wtTable.rowFilter.sourceToRendered(f)));-1<d?t(a,e(f)):(u(a,String.fromCharCode(160)),b(a,"cornerHeader"))};k.prototype.maximumVisibleElementWidth=function(a){a=this.wt.wtViewport.getWorkspaceWidth()-a;return 0<a?a:0};k.prototype.maximumVisibleElementHeight=function(a){a=this.wt.wtViewport.getWorkspaceHeight()-a;return 0<a?a:0};k.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};k.prototype.destroy=function(){this.wt.destroy();this.eventManager.destroy()}},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/core":8,"3rdparty/walkontable/src/selection":19,browser:24,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53}],128:[function(p,q,r){Object.defineProperties(r,{NodeStructure:{get:function(){return d}},LinkedList:{get:function(){return h}},__esModule:{value:!0}});var k;p=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];var d=function(d){this.data=d;this.prev=this.next=null};$traceurRuntime.createClass(d,{},{});var h=function(){this.last=this.first=null};$traceurRuntime.createClass(h,{push:function(h){h=new d(h);if(null===this.first)this.first=this.last=h;else{var g=this.last;this.last=h;h.prev=g;g.next=h}},unshift:function(h){h=new d(h);if(null===this.first)this.first=this.last=h;else{var g=this.first;this.first=h;h.next=g;g.prev=h}},inorder:function(d){for(var g=this.first;g;)d(g),g=g.next},remove:function(d){if(null===this.first)return!1;for(var g=this.first,e;g;){if(g.data===d)return d=g.next,e=g.prev,d&&(d.prev=e),e&&(e.next=d),g===this.first&&(this.first=d),g===this.last&&(this.last=e),!0;g=g.next}return!1},hasCycle:function(){for(var d=this.first,g=this.first;;){if(null===d)return!1;d=d.next;if(null===d)return!1;d=d.next;g=g.next;if(d===g)return!0}},pop:function(){if(null===this.last)return null;var d=this.last;this.last=this.last.prev;return d},shift:function(){if(null===this.first)return null;var d=this.first;this.first=this.first.next;return d},recursiveReverse:function(){function d(e,g){g&&(d(g,g.next),g.next=e)}if(this.first){d(this.first,this.first.next);this.first.next=null;var g=this.first;this.first=this.last;this.last=g}},reverse:function(){if(this.first&&this.first.next){for(var d=this.first.next,g=this.first,e;d;)e=d.next,d.next=g,g=g.prev=d,d=e;this.first.next=null;this.last.prev=null;e=this.first;this.first=g;this.last=e}}},{});p.utils.NodeStructure=d;p.utils.LinkedList=h},{browser:24}],129:[function(p,q,r){Object.defineProperties(r,{Stack:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];var d=function(d){this.items=void 0!==d?d:[]};$traceurRuntime.createClass(d,{push:function(){for(var d,l=[],g=0;g<arguments.length;g++)l[g]=arguments[g];(d=this.items).push.apply(d,$traceurRuntime.spread(l))},pop:function(){return this.items.pop()},peek:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]},isEmpty:function(){return!this.size()},size:function(){return this.items.length}},{});p.utils.Stack=d},{browser:24}],130:[function(p,q,r){Object.defineProperties(r,{GhostTable:{get:function(){return m}},__esModule:{value:!0}});var k,d,h;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var l=k.addClass,g=k.outerHeight,e=k.outerWidth,n=(h=p("helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;p("helpers/object");p("helpers/number");p("helpers/mixed");var m=function(a){this.hot=a;this.container=null;this.injected=!1;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:!0}};$traceurRuntime.createClass(m,{addRow:function(a,b){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var f={row:a};this.rows.push(f);this.samples=b;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(a));this.container.container.appendChild(this.table.fragment);f.table=this.table.table},addColumnHeadersRow:function(a){if(null!=this.hot.getColHeader(0)){var b={row:-1};this.rows.push(b);this.container=this.createContainer(this.hot.rootElement.className);this.samples=a;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);b.table=this.table.table}},addColumn:function(a,b){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var f={col:a};this.columns.push(f);this.samples=b;this.table=this.createTable(this.hot.table.className);this.getSetting("useHeaders")&&null!==this.hot.getColHeader(a)&&this.hot.view.appendColHeader(a,this.table.th);this.table.tBody.appendChild(this.createCol(a));this.container.container.appendChild(this.table.fragment);f.table=this.table.table},getHeights:function(a){this.injected||this.injectTable();n(this.rows,function(b){a(b.row,g(b.table)-1)})},getWidths:function(a){this.injected||this.injectTable();n(this.columns,function(b){a(b.col,e(b.table))})},setSettings:function(a){this.settings=a},setSetting:function(a,b){this.settings||(this.settings={});this.settings[a]=b},getSettings:function(){return this.settings},getSetting:function(a){return this.settings?this.settings[a]:null},createColGroupsCol:function(){var a=this,b=document.createDocumentFragment();this.hot.hasRowHeaders()&&b.appendChild(this.createColElement(-1));this.samples.forEach(function(f){n(f.strings,function(f){b.appendChild(a.createColElement(f.col))})});return b},createRow:function(a){var b=this,f=document,e=f.createDocumentFragment(),d=f.createElement("th");this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(a,d),e.appendChild(d));this.samples.forEach(function(d){n(d.strings,function(d){var g=d.col,m=b.hot.getCellMeta(a,g);m.col=g;m.row=a;var n=b.hot.getCellRenderer(m),h=f.createElement("td");n(b.hot,h,a,g,b.hot.colToProp(g),d.value,m);e.appendChild(h)})});return e},createColumnHeadersRow:function(){var a=this,b=document,f=b.createDocumentFragment();if(this.hot.hasRowHeaders()){var e=b.createElement("th");this.hot.view.appendColHeader(-1,e);f.appendChild(e)}this.samples.forEach(function(e){n(e.strings,function(e){e=e.col;var d=b.createElement("th");a.hot.view.appendColHeader(e,d);f.appendChild(d)})});return f},createCol:function(a){var b=this,f=document,e=f.createDocumentFragment();this.samples.forEach(function(d){n(d.strings,function(d){var g=d.row,m=b.hot.getCellMeta(g,a);m.col=a;m.row=g;var n=b.hot.getCellRenderer(m),h=f.createElement("td"),l=f.createElement("tr");n(b.hot,h,g,a,b.hot.colToProp(a),d.value,m);l.appendChild(h);e.appendChild(l)})});return e},clean:function(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;this.samples&&this.samples.clear();this.samples=null;this.removeTable()},injectTable:function(a){this.injected||(((void 0!==a?a:null)||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)},removeTable:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)},createColElement:function(a){var b=document.createElement("col");b.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(a)+"px";return b},createTable:function(a){a=void 0!==a?a:"";var b=document,f=b.createDocumentFragment(),e=b.createElement("table"),d=b.createElement("thead"),g=b.createElement("tbody"),m=b.createElement("colgroup"),n=b.createElement("tr"),b=b.createElement("th");this.isVertical()&&e.appendChild(m);this.isHorizontal()&&(n.appendChild(b),d.appendChild(n),e.style.tableLayout="auto",e.style.width="auto");e.appendChild(d);this.isVertical()&&g.appendChild(n);e.appendChild(g);l(e,a);f.appendChild(e);return{fragment:f,table:e,tHead:d,tBody:g,colGroup:m,tr:n,th:b}},createContainer:function(a){a=void 0!==a?a:"";var b=document,f=b.createDocumentFragment(),b=b.createElement("div");a="htGhostTable htAutoSize "+a.trim();l(b,a);f.appendChild(b);return{fragment:f,container:b}},isVertical:function(){return this.rows.length&&!this.columns.length?!0:!1},isHorizontal:function(){return this.columns.length&&!this.rows.length?!0:!1}},{});q.utils.GhostTable=m},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],131:[function(p,q,r){function k(e){"string"===typeof e&&/fps$/.test(e)&&(e=1E3/parseInt(e.replace("fps","")||0,10));return e}Object.defineProperties(r,{Interval:{get:function(){return e}},__esModule:{value:!0}});var d,h;q=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];p=(h=p("helpers/feature"),h&&h.__esModule&&h||{"default":h});var l=p.requestAnimationFrame,g=p.cancelAnimationFrame,e=function(e,a){var b=this;this.timer=null;this.func=e;this.delay=k(a);this.stopped=!0;this._then=null;this._callback=function(){return b.__callback()}},n=e;$traceurRuntime.createClass(e,{start:function(){this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=l(this._callback));return this},stop:function(){this.stopped||(this.stopped=!0,g(this.timer),this.timer=null);return this},__callback:function(){this.timer=l(this._callback);if(this.delay){var e=Date.now(),a=e-this._then;a>this.delay&&(this._then=e-a%this.delay,this.func())}else this.func()}},{create:function(e,a){return new n(e,a)}});q.utils.Interval=e},{browser:24,"helpers/feature":49}],132:[function(p,q,r){function k(a,f){m.set(a,f)}function d(b){var f;if(!(b instanceof g.Core)){if(!m.has(b))throw Error("Record translator was not registered for this object identity");b=m.get(b)}a.has(b)?f=a.get(b):(f=new n(b),a.set(b,f));return f}Object.defineProperties(r,{registerIdentity:{get:function(){return k}},getTranslator:{get:function(){return d}},__esModule:{value:!0}});var h,l,g=(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"],e=(l=p("helpers/object"),l&&l.__esModule&&l||{"default":l}).isObject,n=function(a){this.hot=a};$traceurRuntime.createClass(n,{toVisualRow:function(a){return this.hot.runHooks("unmodifyRow",a)},toVisualColumn:function(a){return this.hot.runHooks("unmodifyCol",a)},toVisual:function(a,f){return e(a)?{row:this.toVisualRow(a.row),column:this.toVisualColumn(a.column)}:[this.toVisualRow(a),this.toVisualColumn(f)]},toPhysicalRow:function(a){return this.hot.runHooks("modifyRow",a)},toPhysicalColumn:function(a){return this.hot.runHooks("modifyCol",a)},toPhysical:function(a,f){return e(a)?{row:this.toPhysicalRow(a.row),column:this.toPhysicalColumn(a.column)}:[this.toPhysicalRow(a),this.toPhysicalColumn(f)]}},{});var m=new WeakMap,a=new WeakMap;g.utils.RecordTranslator=n;g.utils.RecordTranslatorUtils={registerIdentity:k,getTranslator:d}},{browser:24,"helpers/object":53}],133:[function(p,q,r){var k;Object.defineProperties(r,{SamplesGenerator:{get:function(){return a}},__esModule:{value:!0}});var d,h,l,g;q=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];p("helpers/dom/element");p("helpers/array");var e=(h=p("helpers/object"),h&&h.__esModule&&h||{"default":h}).isObject,n=(l=p("helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,m=(g=p("helpers/mixed"),g&&g.__esModule&&g||{"default":g}).stringify,a=function(a){this.samples=null;this.dataFactory=a;this.customSampleCount=null;this.allowDuplicates=!1},b=a;$traceurRuntime.createClass(a,(k={},Object.defineProperty(k,"getSampleCount",{value:function(){return this.customSampleCount?this.customSampleCount:b.SAMPLE_COUNT},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setSampleCount",{value:function(a){this.customSampleCount=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"setAllowDuplicates",{value:function(a){this.allowDuplicates=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"generateRowSamples",{value:function(a,b){return this.generateSamples("row",b,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"generateColumnSamples",{value:function(a,b){return this.generateSamples("col",b,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"generateSamples",{value:function(a,b,e){var f=this,d=new Map;"number"===typeof e&&(e={from:e,to:e});n(e.from,e.to,function(e){var g=f.generateSample(a,b,e);d.set(e,g)});return d},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(k,"generateSample",{value:function(a,b,d){var f=this,g=new Map,h=[],l;n(b.from,b.to,function(b){var n,k;if("row"===a)k=f.dataFactory(d,b);else if("col"===a)k=f.dataFactory(b,d);else throw Error("Unsupported sample type");l=e(k)?Object.keys(k).length:Array.isArray(k)?k.length:m(k).length;g.has(l)||g.set(l,{needed:f.getSampleCount(),strings:[]});var t=g.get(l);if(t.needed&&(!(-1<h.indexOf(k))||f.allowDuplicates)){var u="row"===a?"col":"row";t.strings.push((n={},Object.defineProperty(n,"value",{value:k,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(n,u,{value:b,configurable:!0,enumerable:!0,writable:!0}),n));h.push(k);t.needed--}});return g},configurable:!0,enumerable:!0,writable:!0}),k),{get SAMPLE_COUNT(){return 3}});q.utils.SamplesGenerator=a},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],134:[function(p,q,r){function k(e,d,m,a){d=void 0!==d?d:g;m=void 0!==m?m:0;var b=void 0!==a?a:e.length;if(1>=Math.abs(b-m))return[];var f=Math.ceil((m+b)/2);k(e,d,m,f);k(e,d,f,b);a=new l;for(var n=new l,h=f-m,v=b-f,p=Math.max(h,v),b=b-m,w=0;w<p;w+=1)w<h&&a.push(e[m+w]),w<v&&n.push(e[f+w]);for(f=0;f<b;)a.first&&n.first?0<d(a.first.data,n.first.data)?e[m+f]=n.shift().data:e[m+f]=a.shift().data:e[m+f]=a.first?a.shift().data:n.shift().data,f+=1;return e}Object.defineProperties(r,{mergeSort:{get:function(){return k}},__esModule:{value:!0}});var d,h,l=(d=p("../dataStructures/linkedList"),d&&d.__esModule&&d||{"default":d}).LinkedList,g=function(e,d){var g=e.toString(),a=d.toString();return g===a?0:g<a?-1:1};(h=p("browser"),h&&h.__esModule&&h||{"default":h})["default"].utils.mergeSort=k},{"../dataStructures/linkedList":128,browser:24}],135:[function(p,q,r){function k(d,l){return function(g){for(var e=!1,n=0,m=g.length;n<m;n++)if(d===g[n]){e=!0;break}l(e)}}var d;q=(d=p("browser"),d&&d.__esModule&&d||{"default":d})["default"];p("helpers/mixed");q.AutocompleteValidator=function(d,l){null==d&&(d="");this.allowEmpty&&""===d?l(!0):this.strict&&this.source?"function"===typeof this.source?this.source(d,k(d,l)):k(d,l)(this.source):l(!0)}},{browser:24,"helpers/mixed":51}],136:[function(p,q,r){var k,d,h,l;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];var g=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],e=(h=p("../helpers/date"),h&&h.__esModule&&h||{"default":h}).getNormalizedDate,n=(l=p("editors"),l&&l.__esModule&&l||{"default":l}).getEditor;q.DateValidator=function(d,a){var b=!0,f=n("date",this.instance);null==d&&(d="");var m=g(new Date(d)).isValid()||g(d,f.defaultDateFormat).isValid(),f=g(d,this.dateFormat||f.defaultDateFormat,!0).isValid();this.allowEmpty&&""===d&&(f=m=!0);m||(b=!1);!m&&f&&(b=!0);if(m&&!f)if(!0===this.correctFormat){var h=d,b=this.dateFormat,m=g(e(h)),f=g(h,b),h=-1<h.search(/[A-z]/g),b=(m.isValid()&&m.format("x")===f.format("x")||!f.isValid()||h?m:f).format(b),m=this.instance.runHooks("unmodifyRow",this.row),f=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(m,f,b,"dateValidator");b=!0}else b=!1;a(b)}},{"../helpers/date":46,browser:24,editors:30,moment:"moment"}],137:[function(p,q,r){var k;(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"].NumericValidator=function(d,h){null==d&&(d="");this.allowEmpty&&""===d?h(!0):""===d?h(!1):h(/^-?\d*(\.|\,)?\d*$/.test(d))}},{browser:24}],138:[function(p,q,r){var k,d;q=(k=p("browser"),k&&k.__esModule&&k||{"default":k})["default"];var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];q.TimeValidator=function(d,e){var g=!0,m=this.timeFormat||"h:mm:ss a";null===d&&(d="");d=/^\d{3,}$/.test(d)?parseInt(d,10):d;var a=/^\d{1,2}$/.test(d);a&&(d+=":00");var b=h(d,l,!0).isValid()?h(d):h(d,m),f=b.isValid(),a=h(d,m,!0).isValid()&&!a;this.allowEmpty&&""===d&&(a=f=!0);f||(g=!1);!f&&a&&(g=!0);f&&!a&&(!0===this.correctFormat?(g=b.format(m),m=this.instance.runHooks("unmodifyRow",this.row),b=this.instance.runHooks("unmodifyCol",this.col),this.instance.setDataAtCell(m,b,g,"timeValidator"),g=!0):g=!1);e(g)}},{browser:24,moment:"moment"}],139:[function(p,q,r){Object.defineProperties(r,{WalkontableBottomOverlay:{get:function(){return t}},__esModule:{value:!0}});var k,d;q=(k=p("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.addClass,l=q.getScrollbarWidth,g=q.getScrollTop,e=q.getWindowScrollLeft,n=q.hasClass,m=q.outerHeight,a=q.removeClass,b=q.resetCssTransform,f=(d=p("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,t=function(a){$traceurRuntime.superConstructor(u).call(this,a);this.clone=this.makeClone(f.CLONE_BOTTOM)},u=t;$traceurRuntime.createClass(t,{repositionOverlay:function(){var a=l(),b=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(a=0);b.style.top="";b.style.bottom=a+"px"},shouldBeRendered:function(){return this.wot.getSetting("fixedRowsBottom")?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,f;a.style.top="";if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var e=this.wot.wtTable.hider.getBoundingClientRect();f=Math.ceil(e.bottom);var d;d=document.body.offsetHeight;e=this.wot.wtTable.hider.style.left;f=d=f>d?f-d:0;a.style.top="";a.style.left=""===e?0:e;a.style.bottom=d+"px"}else f=this.getScrollPosition(),b(a),this.repositionOverlay();this.adjustHeaderBordersPosition(f)}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(e(),a):this.mainTableScrollableElement.scrollTop=a},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(a,b){for(var f=0,e=this.wot.wtSettings.settings.defaultRowHeight;a<b;){var d=this.wot.wtTable.getRowHeight(a),f=f+(void 0===d?e:d);a++}return f},adjustElementsSize:function(a){a=void 0!==a?a:!1;this.updateTrimmingContainer();if(this.needFullRender||a)this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0)},adjustRootElementSize:function(){var a=this.wot.wtTable.holder,b=a.clientWidth===a.offsetWidth?0:l(),a=this.clone.wtTable.holder.parentNode.style;a.width=this.trimmingContainer===window?"":this.wot.wtViewport.getWorkspaceWidth()-b+"px";this.clone.wtTable.holder.style.width=a.width;b=m(this.clone.wtTable.TABLE);a.height=b+"px"},adjustRootChildrenSize:function(){var a=l();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;0===a&&(a=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalRows");this.areElementSizesAdjusted||this.adjustElementsSize();if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(0===a)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.left="number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""},scrollTo:function(a,b){var f=this.getTableParentOffset(),e=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,d=0;b&&e.offsetHeight!==e.clientHeight&&(d=l());b?(f+=this.sumCellSizes(0,a+1),f-=this.wot.wtViewport.getViewportHeight(),f+=1):f+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),a);this.setScrollPosition(f+d)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return g(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(b){if(0===this.wot.getSetting("fixedRowsBottom")&&0<this.wot.getSetting("columnHeaders").length){var f=this.wot.wtTable.holder.parentNode,e=n(f,"innerBorderTop");b?h(f,"innerBorderTop"):a(f,"innerBorderTop");(!e&&b||e&&!b)&&this.wot.wtOverlays.adjustElementsSize()}0===this.wot.getSetting("rowHeaders").length&&(b=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"))&&(b.style["border-left-width"]=0)}},{},f);window.WalkontableBottomOverlay=t;f.registerOverlay(f.CLONE_BOTTOM,t)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],140:[function(p,q,r){Object.defineProperties(r,{WalkontableBottomLeftCornerOverlay:{get:function(){return m}},__esModule:{value:!0}});var k,d;q=(k=p("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var h=q.getScrollbarWidth,l=q.outerHeight,g=q.outerWidth,e=q.resetCssTransform,n=(d=p("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),d&&d.__esModule&&d||{"default":d}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(a).call(this,b);this.clone=this.makeClone(n.CLONE_BOTTOM_LEFT_CORNER)},a=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsBottom")&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},repositionOverlay:function(){var a=h(),f=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(a=0);f.style.top="";f.style.bottom=a+"px"},resetFixedPosition:function(){this.updateTrimmingContainer();if(this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,f=l(this.clone.wtTable.TABLE),d=g(this.clone.wtTable.TABLE);a.style.top="";if(this.trimmingContainer===window){var m=this.wot.wtTable.hider.getBoundingClientRect(),n=Math.ceil(m.bottom),m=Math.ceil(m.left),h=document.body.offsetHeight;a.style.top="";a.style.left=(0>m?-m:0)+"px";a.style.bottom=(n>h?n-h:0)+"px"}else e(a),this.repositionOverlay();a.style.height=f+"px";a.style.width=d+"px"}}},{},n);window.WalkontableBottomLeftCornerOverlay=m;n.registerOverlay(n.CLONE_BOTTOM_LEFT_CORNER,m)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],141:[function(p,q,r){var k;r=(k=p("../node_modules/hot-builder/node_modules/handsontable/src/browser"),k&&k.__esModule&&k||{"default":k})["default"];p("3rdparty/walkontable/src/overlay/bottom");p("3rdparty/walkontable/src/overlay/bottomLeftCorner");q.exports=r},{"../node_modules/hot-builder/node_modules/handsontable/src/browser":24,"3rdparty/walkontable/src/overlay/bottom":139,"3rdparty/walkontable/src/overlay/bottomLeftCorner":140}],142:[function(p,q,r){Object.defineProperties(r,{BindRowsWithHeaders:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");var g=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach;k=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),h&&h.__esModule&&h||{"default":h}).registerPlugin;var e=(l=p("bindStrategy"),l&&l.__esModule&&l||{"default":l}).BindStrategy,n=function(a){$traceurRuntime.superConstructor(m).call(this,a);this.bindStrategy=new e;this.removedRows=[]},m=n;$traceurRuntime.createClass(n,{isEnabled:function(){return!!this.hot.getSettings().bindRowsWithHeaders},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().bindRowsWithHeaders;"string"!==typeof b&&(b=e.DEFAULT_STRATEGY);this.bindStrategy.setStrategy(b);this.bindStrategy.createMap(this.hot.countSourceRows());this.addHook("modifyRowHeader",function(b){return a.onModifyRowHeader(b)});this.addHook("afterCreateRow",function(b,e){return a.onAfterCreateRow(b,e)});this.addHook("beforeRemoveRow",function(b,e){return a.onBeforeRemoveRow(b,e)});this.addHook("afterRemoveRow",function(b,e){return a.onAfterRemoveRow(b,e)});this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)});$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this)}},updatePlugin:function(){$traceurRuntime.superGet(this,m.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.removedRows.length=0;this.bindStrategy.clearMap();$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},onModifyRowHeader:function(a){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",a))},onAfterCreateRow:function(a,b){this.bindStrategy.createRow(a,b)},onBeforeRemoveRow:function(a,b){var f=this;this.removedRows.length=0;!1!==a&&g(a,a+b-1,function(a){f.removedRows.push(f.hot.runHooks("modifyRow",a))})},onAfterRemoveRow:function(a,b){this.bindStrategy.removeRow(this.removedRows)},onAfterLoadData:function(a){a||this.bindStrategy.createMap(this.hot.countSourceRows())},destroy:function(){this.bindStrategy.destroy();$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)}},{},q);k("bindRowsWithHeaders",n)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,bindStrategy:143}],143:[function(p,q,r){Object.defineProperties(r,{BindStrategy:{get:function(){return g}},__esModule:{value:!0}});var k,d;q=(k=p("../../browser"),k&&k.__esModule&&k||{"default":k})["default"];p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper");p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");var h=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach,l={},g=function(){this.strategy=null};$traceurRuntime.createClass(g,{setStrategy:function(e){var d=l[e];if(!d)throw Error('Bind strategy "'+e+'" does not exist.');this.strategy=new d},createMap:function(e){var d=this.strategy;e=void 0===e?d._arrayMap.length:e;d._arrayMap.length=0;h(e-1,function(e){d._arrayMap.push(e)})},createRow:function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];this.strategy.createRow.apply(this.strategy,e)},removeRow:function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];this.strategy.removeRow.apply(this.strategy,e)},translate:function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];return this.strategy.getValueByIndex.apply(this.strategy,e)},clearMap:function(){this.strategy.clearMap()},destroy:function(){this.strategy&&this.strategy.destroy();this.strategy=null}},{get DEFAULT_STRATEGY(){return"loose"},registerStrategy:function(e,d){l[e]=d}});q.utils.BindStrategy=g},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],144:[function(p,q,r){Object.defineProperties(r,{LooseBindStrategy:{get:function(){return l}},__esModule:{value:!0}});var k,d,h;q=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),k&&k.__esModule&&k||{"default":k}).arrayMapper;k=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).mixin;p=(h=p("bindStrategy"),h&&h.__esModule&&h||{"default":h}).BindStrategy;var l=function(){};$traceurRuntime.createClass(l,{createRow:function(d,e){this.shiftItems(d,e)},removeRow:function(d,e){this.unshiftItems(d,e)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"loose"}});k(l,q);p.registerStrategy(l.STRATEGY_NAME,l)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],145:[function(p,q,r){Object.defineProperties(r,{StrictBindStrategy:{get:function(){return l}},__esModule:{value:!0}});var k,d,h;q=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),k&&k.__esModule&&k||{"default":k}).arrayMapper;k=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).mixin;p=(h=p("bindStrategy"),h&&h.__esModule&&h||{"default":h}).BindStrategy;var l=function(){};$traceurRuntime.createClass(l,{createRow:function(d,e){this.insertItems(d,e)},removeRow:function(d,e){this.removeItems(d,e)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"strict"}});k(l,q);p.registerStrategy(l.STRATEGY_NAME,l)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],146:[function(p,q,r){Object.defineProperties(r,{CollapsibleColumns:{get:function(){return w}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k}).objectEach,a=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,b=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach;q=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),l&&l.__esModule&&l||{"default":l});var f=q.addClass,t=q.hasClass,u=q.fastInnerText;q=p("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager");l=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;var v=(e=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),e&&e.__esModule&&e||{"default":e}).stopImmediatePropagation,y=(q=p("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),q&&q.__esModule&&q||{"default":q}).eventManager;p=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n})["default"];var w=function(a){$traceurRuntime.superConstructor(z).call(this,a);this.settings=null;this.buttonEnabledList={};this.nestedHeadersPlugin=this.hiddenColumnsPlugin=null;this.collapsedSections={};this.eventManager=this.columnHeaderLevelCount=null},z=w;$traceurRuntime.createClass(w,{isEnabled:function(){return!!this.hot.getSettings().collapsibleColumns},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!==typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return a.onAfterRender()}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("afterGetColHeader",function(b,f){return a.onAfterGetColHeader(b,f)}),this.addHook("beforeOnCellMouseDown",function(b,f,e){return a.onBeforeOnCellMouseDown(b,f,e)}),this.eventManager=y(this.hot),$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.collapsedSections={};this.clearButtons();$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this)},clearButtons:function(){if(this.hot.view){var a=this.hot.view.wt.getSetting("columnHeaders").length,f=this.hot.view.wt.wtTable.THEAD,e=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;b(0,a-1,function(a){var g=f.childNodes[a],m=e.childNodes[a],n=d?d.childNodes[a]:null;b(0,g.childNodes.length-1,function(a){var b=g.childNodes[a].querySelector(".collapsibleIndicator");b&&b.parentNode.removeChild(b);m&&m.childNodes[a]&&(b=m.childNodes[a].querySelector(".collapsibleIndicator"))&&b.parentNode.removeChild(b);d&&n&&n.childNodes[a]&&(b=n.childNodes[a].querySelector(".collapsibleIndicator"))&&b.parentNode.removeChild(b)})},!0)}},parseSettings:function(){var a=this;m(this.settings,function(b){a.buttonEnabledList[b.row]||(a.buttonEnabledList[b.row]={});a.buttonEnabledList[b.row][b.col]=b.collapsible})},meetsDependencies:function(){var a=this.hot.getSettings();return a.nestedHeaders&&a.hiddenColumns},checkDependencies:function(){var a=this.hot.getSettings();this.meetsDependencies()||(a.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),a.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))},generateIndicator:function(a,b){var e=b.parentNode,d=e.parentNode,e=-1*d.childNodes.length+Array.prototype.indexOf.call(d.childNodes,e);if(0<Object.keys(this.buttonEnabledList).length&&(!this.buttonEnabledList[e]||!this.buttonEnabledList[e][a]))return null;d=document.createElement("DIV");f(d,"collapsibleIndicator");this.collapsedSections[e]&&!0===this.collapsedSections[e][a]?(f(d,"collapsed"),u(d,"+")):(f(d,"expanded"),u(d,"-"));return d},markSectionAs:function(a,b,f,e){this.collapsedSections[b]||(this.collapsedSections[b]={});switch(a){case "collapsed":this.collapsedSections[b][f]=!0;break;case "expanded":this.collapsedSections[b][f]=void 0}if(e){e=this.nestedHeadersPlugin.colspanArray;var d=this.nestedHeadersPlugin.rowCoordsToLevel(b);f=this.nestedHeadersPlugin.getChildHeaders(b,f);e=e[d+1];for(d=1;d<f.length;d++)e&&1<e[f[d]].colspan&&this.markSectionAs(a,b+1,f[d],!0)}},expandSection:function(a){this.markSectionAs("expanded",a.row,a.col,!0);this.toggleCollapsibleSection(a,"expand")},collapseSection:function(a){this.markSectionAs("collapsed",a.row,a.col,!0);this.toggleCollapsibleSection(a,"collapse")},toggleAllCollapsibleSections:function(b){var f=this,e=this.nestedHeadersPlugin.colspanArray;!0===this.settings?a(e,function(e,d){a(e,function(a,e){if(1<a.colspan){d=parseInt(d,10);e=parseInt(e,10);var g=f.nestedHeadersPlugin.levelToRowCoords(d),m=e;f.markSectionAs("collapse"===b?"collapsed":"expanded",g,m,!0);f.toggleCollapsibleSection({row:g,col:m},b)}})}):m(this.buttonEnabledList,function(a,e){m(a,function(a,d){e=parseInt(e,10);d=parseInt(d,10);f.markSectionAs("collapse"===b?"collapsed":"expanded",e,d,!0);f.toggleCollapsibleSection({row:e,col:d},b)})})},collapseAll:function(){this.toggleAllCollapsibleSections("collapse")},expandAll:function(){this.toggleAllCollapsibleSections("expand")},toggleCollapsibleSection:function(a,f){var e=this;a.row&&(a.row=parseInt(a.row,10));a.col&&(a.col=parseInt(a.col,10));for(var d=this.hiddenColumnsPlugin.hiddenColumns,g=this.nestedHeadersPlugin.colspanArray,m=this.nestedHeadersPlugin.rowCoordsToLevel(a.row),n=g[m][a.col].colspan,h=this.nestedHeadersPlugin.getChildHeaders(a.row,a.col),m=m+1,l=g[m],l=l?l[h[0]].colspan||1:1;l===n&&m<this.columnHeaderLevelCount;)m+=1,l=(l=g[m])?l[h[0]].colspan||1:1;b(l,n-1,function(b){b=a.col+b;switch(f){case "collapse":e.hiddenColumnsPlugin.isHidden(b)||d.push(b);break;case "expand":e.hiddenColumnsPlugin.isHidden(b)&&d.splice(d.indexOf(b),1)}});this.hot.render()},onAfterGetColHeader:function(a,b){if(b.hasAttribute("colspan")&&1<b.getAttribute("colspan")&&a>=this.hot.getSettings().fixedColumnsLeft){var f=this.generateIndicator(a,b);null!==f&&b.querySelector("div:first-child").appendChild(f)}},onBeforeOnCellMouseDown:function(a,b){if(t(a.target,"collapsibleIndicator"))return t(a.target,"expanded")?(this.collapsedSections[b.row]||(this.collapsedSections[b.row]=[]),this.markSectionAs("collapsed",b.row,b.col,!0),this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection(b,"collapse")):t(a.target,"collapsed")&&(this.markSectionAs("expanded",b.row,b.col,!0),this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection(b,"expand")),v(a),!1},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length},onAfterRender:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()},destroy:function(){this.columnHeaderLevelCount=this.collapsedSections=this.nestedHeadersPlugin=this.hiddenColumnsPlugin=this.buttonEnabledList=this.settings=null;$traceurRuntime.superGet(this,z.prototype,"destroy").call(this)}},{},p);l("collapsibleColumns",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63}],147:[function(p,q,r){Object.defineProperties(r,{ColumnSummary:{get:function(){return g}},__esModule:{value:!0}});var k,d,h;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),k&&k.__esModule&&k||{"default":k})["default"];var l=(d=p("endpoints"),d&&d.__esModule&&d||{"default":d}).Endpoints;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");p=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),h&&h.__esModule&&h||{"default":h}).registerPlugin;var g=function(d){$traceurRuntime.superConstructor(e).call(this,d);this.endpoints=null},e=g;$traceurRuntime.createClass(g,{isEnabled:function(){return!!this.hot.getSettings().columnSummary},enablePlugin:function(){var d=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new l(this,this.settings),this.addHook("afterInit",function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return d.onAfterInit.apply(d,$traceurRuntime.spread(e))}),this.addHook("afterChange",function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return d.onAfterChange.apply(d,$traceurRuntime.spread(e))}),this.addHook("beforeCreateRow",function(e,a,b){return d.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,a,null,b)}),this.addHook("beforeCreateCol",function(e,a,b){return d.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,a,null,b)}),this.addHook("beforeRemoveRow",function(){for(var e,a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return(e=d.endpoints).resetSetupBeforeStructureAlteration.apply(e,$traceurRuntime.spread(["remove_row"],a))}),this.addHook("beforeRemoveCol",function(){for(var e,a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return(e=d.endpoints).resetSetupBeforeStructureAlteration.apply(e,$traceurRuntime.spread(["remove_col"],a))}),this.addHook("beforeRowMove",function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return d.onBeforeRowMove.apply(d,$traceurRuntime.spread(e))}),this.addHook("afterCreateRow",function(e,a,b){return d.endpoints.resetSetupAfterStructureAlteration("insert_row",e,a,null,b)}),this.addHook("afterCreateCol",function(e,a,b){return d.endpoints.resetSetupAfterStructureAlteration("insert_col",e,a,null,b)}),this.addHook("afterRemoveRow",function(){for(var e,a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return(e=d.endpoints).resetSetupAfterStructureAlteration.apply(e,$traceurRuntime.spread(["remove_row"],a))}),this.addHook("afterRemoveCol",function(){for(var e,a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return(e=d.endpoints).resetSetupAfterStructureAlteration.apply(e,$traceurRuntime.spread(["remove_col"],a))}),this.addHook("afterRowMove",function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return d.onAfterRowMove.apply(d,$traceurRuntime.spread(e))}),$traceurRuntime.superGet(this,e.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.currentEndpoint=this.settings=this.endpoints=null},calculate:function(e){switch(e.type.toLowerCase()){case "sum":e.result=this.calculateSum(e);break;case "min":e.result=this.calculateMinMax(e,e.type);break;case "max":e.result=this.calculateMinMax(e,e.type);break;case "count":e.result=this.countEntries(e);break;case "average":e.result=this.calculateAverage(e);break;case "custom":e.result=e.customFunction.call(this,e)}},calculateSum:function(e){var d=0,a;for(a in e.ranges)e.ranges.hasOwnProperty(a)&&(d+=this.getPartialSum(e.ranges[a],e.sourceColumn));return d},getPartialSum:function(e,d){var a=0,b=e[1]||e[0],f,g=0;do{f=this.getCellValue(b,d)||0;var m=((f+"").split(".")[1]||[]).length||1;m>g&&(g=m);a+=f||0;b--}while(b>=e[0]);return Math.round(a*Math.pow(10,g))/Math.pow(10,g)},calculateMinMax:function(e,d){var a=null,b;for(b in e.ranges)if(e.ranges.hasOwnProperty(b)){var f=this.getPartialMinMax(e.ranges[b],e.sourceColumn,d);null===a&&null!==f&&(a=f);if(null!==f)switch(d){case "min":a=Math.min(a,f);break;case "max":a=Math.max(a,f)}}return null===a?"Not enough data":a},getPartialMinMax:function(e,d,a){var b=null,f=e[1]||e[0],g;do{g=this.getCellValue(f,d)||null;if(null===b)b=g;else if(null!==g)switch(a){case "min":b=Math.min(b,g);break;case "max":b=Math.max(b,g)}f--}while(f>=e[0]);return b},countEmpty:function(e,d){var a,b=0,f=e[1]||e[0];do(a=this.getCellValue(f,d))||b++,f--;while(f>=e[0]);return b},countEntries:function(e){var d=0,a=e.ranges,b;for(b in a)if(a.hasOwnProperty(b))var f=void 0===a[b][1]?1:a[b][1]-a[b][0]+1,g=this.countEmpty(a[b],e.sourceColumn),d=d+f,d=d-g;return d},calculateAverage:function(e){var d=this.calculateSum(e);e=this.countEntries(e);return d/e},getCellValue:function(e,d){var a=this.endpoints.getVisualRowIndex(e),b=this.endpoints.getVisualColumnIndex(d),f=this.hot.getSourceDataAtCell(e,d);if(-1<(this.hot.getCellMeta(a,b).className||"").indexOf("columnSummaryResult"))return null;this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof f&&(f=f.replace(/,/,".")),f=parseFloat(f));if(isNaN(f)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error("ColumnSummary plugin: cell at ("+e+", "+d+") is not in a numeric format. Cannot do the calculation.");return f},onAfterInit:function(){this.endpoints.endpoints=this.endpoints.parseSettings();this.endpoints.refreshAllEndpoints(!0)},onAfterChange:function(e,d){e&&"ColumnSummary.reset"!==d&&"ColumnSummary.set"!==d&&"loadData"!==d&&this.endpoints.refreshChangedEndpoints(e)},onBeforeRowMove:function(e,d){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName)},onAfterRowMove:function(e,d){this.endpoints.resetSetupAfterStructureAlteration("move_row",d,e.length,e,this.pluginName)}},{},q);p("columnSummary",g)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,endpoints:148}],148:[function(p,q,r){Object.defineProperties(r,{Endpoints:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");var l=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),d&&d.__esModule&&d||{"default":d}).getTranslator,g=function(e,d){this.plugin=e;this.hot=this.plugin.hot;this.endpoints=[];this.settings=d;this.settingsType="array";this.currentEndpoint=null;this.cellsToSetCache=[];this.recordTranslator=l(this.hot)};$traceurRuntime.createClass(g,{getEndpoint:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]},getAllEndpoints:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints},fillMissingEndpointData:function(e){return this.parseSettings(e.call(this))},parseSettings:function(e){var d=this,g=[];if(e||"function"!==typeof this.settings)return e||(e=this.settings),h(e,function(a){var b={};d.assignSetting(a,b,"ranges",[[0,d.hot.countRows()-1]]);d.assignSetting(a,b,"reversedRowCoords",!1);d.assignSetting(a,b,"destinationRow",Error("You must provide a destination row for the Column Summary plugin in order to work properly!"));d.assignSetting(a,b,"destinationColumn",Error("You must provide a destination column for the Column Summary plugin in order to work properly!"));d.assignSetting(a,b,"sourceColumn",a.destinationColumn);d.assignSetting(a,b,"type","sum");d.assignSetting(a,b,"forceNumeric",!1);d.assignSetting(a,b,"suppressDataTypeErrors",!0);d.assignSetting(a,b,"suppressDataTypeErrors",!0);d.assignSetting(a,b,"customFunction",null);d.assignSetting(a,b,"readOnly",!0);d.assignSetting(a,b,"roundFloat",!1);g.push(b)}),g;this.settingsType="function"},assignSetting:function(e,d,g,a){if("ranges"===g&&void 0===e[g])d[g]=a;else if("ranges"!==g||0!==e[g].length)if(void 0===e[g]){if(a instanceof Error)throw a;d[g]=a}else d[g]="destinationRow"===g&&d.reversedRowCoords?this.hot.countRows()-e[g]-1:e[g]},resetSetupBeforeStructureAlteration:function(e,d,g,a,b){if("function"===this.settingsType){var f=-1<e.indexOf("row")?"row":"col";a=this.getAllEndpoints();h(a,function(a,b,m){"row"===f&&a.destinationRow>=d&&("insert_row"===e?a.alterRowOffset=g:"remove_row"===e&&(a.alterRowOffset=-1*g));"col"===f&&a.destinationColumn>=d&&("insert_col"===e?a.alterColumnOffset=g:"remove_col"===e&&(a.alterColumnOffset=-1*g))});this.resetAllEndpoints(a,!1)}},resetSetupAfterStructureAlteration:function(e,d,g,a,b,f){b=void 0!==f?f:!0;var m=this;if("function"===this.settingsType){var n=function(){m.hot.removeHook("beforeRender",n);return m.refreshAllEndpoints(!0)};this.hot.addHookOnce("beforeRender",n)}else{var l=-1<e.indexOf("row")?"row":"col",k=-1<e.indexOf("remove")?-1:1;f=this.getAllEndpoints();e=0===e.indexOf("move_row");h(f,function(a,b,e){"row"===l&&a.destinationRow>=d&&(a.alterRowOffset=k*g);"col"===l&&a.destinationColumn>=d&&(a.alterColumnOffset=k*g)});this.resetAllEndpoints(f,!e);e?h(f,function(b,e,f){m.extendEndpointRanges(b,d,a[0],a.length);m.recreatePhysicalRanges(b);m.clearOffsetInformation(b)}):h(f,function(a,b,e){m.shiftEndpointCoordinates(a,d)});b&&this.refreshAllEndpoints(!0)}},clearOffsetInformation:function(e){e.alterRowOffset=void 0;e.alterColumnOffset=void 0},extendEndpointRanges:function(e,d,g,a){h(e.ranges,function(b,e){b[1]&&(d>=b[0]&&d<=b[1]?g>b[1]?b[1]+=a:g<b[0]&&(b[0]-=a):g>=b[0]&&g<=b[1]&&(b[1]-=a,d<=b[0]&&(b[0]++,b[1]++)))})},recreatePhysicalRanges:function(e){var d=this,g=[],a=[];h(e.ranges,function(b){var e=[];if(b[1])for(var g=b[0];g<=b[1];g++)e.push(d.recordTranslator.toPhysicalRow(g));else e.push(d.recordTranslator.toPhysicalRow(b[0]));a.push(e)});h(a,function(a){var b=[];h(a,function(e,f){0===f?b.push(e):a[f]!==a[f-1]+1&&(b.push(a[f-1]),g.push(b),b=[],b.push(e));f===a.length-1&&(b.push(e),g.push(b))})});e.ranges=g},shiftEndpointCoordinates:function(e,d){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,h(e.ranges,function(g,a){h(g,function(a,f){a>=d&&(g[f]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)},resetAllEndpoints:function(e,d){var g=void 0!==d?d:!0,a=this;this.cellsToSetCache=[];e||(e=this.getAllEndpoints());h(e,function(b){a.resetEndpointValue(b,g)});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshAllEndpoints:function(e){var d=this;this.cellsToSetCache=[];h(this.getAllEndpoints(),function(e){d.currentEndpoint=e;d.plugin.calculate(e);d.setEndpointValue(e,"init")});this.currentEndpoint=null;this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshChangedEndpoints:function(e){var d=this,g=[];this.cellsToSetCache=[];h(e,function(a,b,e){(a[2]||"")+""!==a[3]+""&&h(d.getAllEndpoints(),function(a,f){d.hot.propToCol(e[b][1])===a.sourceColumn&&-1===g.indexOf(f)&&g.push(f)})});h(g,function(a){d.refreshEndpoint(d.getEndpoint(a))});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshEndpoint:function(e){this.currentEndpoint=e;this.plugin.calculate(e);this.setEndpointValue(e);this.currentEndpoint=null},resetEndpointValue:function(e,d){var g,a=void 0!==d?d:!0,b=e.alterRowOffset||0,f=e.alterColumnOffset||0,h,n;g=this.recordTranslator.toVisual(e.destinationRow,e.destinationColumn);h=g[0];n=g[1];g;g=this.hot.getCellMeta(h,n);g.readOnly=!1;g.className="";this.cellsToSetCache.push([this.recordTranslator.toVisualRow(e.destinationRow+(a?b:0)),this.recordTranslator.toVisualColumn(e.destinationColumn+(a?f:0)),""])},setEndpointValue:function(e,d,g){g=void 0!==g?g:!1;var a=-1*e.alterRowOffset||0,b=-1*e.alterColumnOffset||0,f=this.getVisualRowIndex(e.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(e.destinationRow+a),e.destinationColumn+b);if(f>this.hot.countRows()||e.destinationColumn>this.hot.countCols())this.throwOutOfBoundsWarning();else{if("init"===d||a.readOnly!==e.readOnly)a.readOnly=e.readOnly,a.className="columnSummaryResult";e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat));g?this.hot.setDataAtCell(f,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([f,e.destinationColumn,e.result]);e.alterRowOffset=void 0;e.alterColumnOffset=void 0}},getVisualRowIndex:function(e){return this.hot.runHooks("unmodifyRow",e,"columnSummary")},getVisualColumnIndex:function(e){return this.hot.runHooks("unmodifyCol",e,"columnSummary")},throwOutOfBoundsWarning:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],149:[function(p,q,r){Object.defineProperties(r,{DropdownMenu:{get:function(){return J}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f,t=(k=p("../../browser"),k&&k.__esModule&&k||{"default":k})["default"];q=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),d&&d.__esModule&&d||{"default":d})["default"];var u=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");var v=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor"),l&&l.__esModule&&l||{"default":l}).CommandExecutor,y=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),g&&g.__esModule&&g||{"default":g}).EventManager,w=(e=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),e&&e.__esModule&&e||{"default":e}).hasClass,z=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory"),n&&n.__esModule&&n||{"default":n}).ItemsFactory,x=(m=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),m&&m.__esModule&&m||{"default":m}).Menu;d=(a=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{"default":a}).registerPlugin;var C=(b=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),b&&b.__esModule&&b||{"default":b}).stopPropagation;p=(f=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),f&&f.__esModule&&f||{"default":f});var E=p.COLUMN_LEFT,A=p.COLUMN_RIGHT,B=p.REMOVE_COLUMN,G=p.CLEAR_COLUMN,D=p.READ_ONLY,F=p.ALIGNMENT,H=p.SEPARATOR,J=function(a){var b=this;$traceurRuntime.superConstructor(K).call(this,a);this.eventManager=new y(this);this.commandExecutor=new v(this.hot);this.menu=this.itemsFactory=null;this.hot.addHook("afterGetColHeader",function(a,e){return b.onAfterGetColHeader(a,e)})},K=J;$traceurRuntime.createClass(J,{isEnabled:function(){return this.hot.getSettings().dropdownMenu},enablePlugin:function(){var a=this;if(!this.enabled){this.itemsFactory=new z(this.hot,K.DEFAULT_ITEMS);var b=this.hot.getSettings().dropdownMenu,e={items:this.itemsFactory.getItems(b)};this.registerEvents();"function"===typeof b.callback&&this.commandExecutor.setCommonCallback(b.callback);$traceurRuntime.superGet(this,K.prototype,"enablePlugin").call(this);this.callOnPluginsReady(function(){a.hot.runHooks("afterDropdownMenuDefaultOptions",e);a.itemsFactory.setPredefinedItems(e.items);var f=a.itemsFactory.getItems(b);a.menu=new x(a.hot,{className:"htDropdownMenu",keepInViewport:!0});a.hot.runHooks("beforeDropdownMenuSetItems",f);a.menu.setMenuItems(f);a.menu.addLocalHook("afterOpen",function(){return a.onMenuAfterOpen()});a.menu.addLocalHook("afterClose",function(){return a.onMenuAfterClose()});a.menu.addLocalHook("executeCommand",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.executeCommand.apply(a,b)});u(f,function(b){return a.commandExecutor.registerCommand(b.key,b)})})}},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,K.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close();this.menu&&this.menu.destroy();$traceurRuntime.superGet(this,K.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(b){return a.onTableClick(b)})},open:function(a){this.menu&&(this.menu.open(),a.width&&this.menu.setOffset("left",a.width),this.menu.setPosition(a),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,t.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.commandExecutor.execute.apply(this.commandExecutor,a)},setListening:function(a){(void 0!==a?a:1)?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten()},onTableClick:function(a){C(a);if(w(a.target,"changeType")&&!this.menu.isOpened()){var b=a.target.getBoundingClientRect();this.open({left:b.left,top:b.top+a.target.offsetHeight+3,width:b.width,height:b.height})}},onAfterGetColHeader:function(a,b){var e=b.parentNode;if(e){var f=e.parentNode.childNodes,e=Array.prototype.indexOf.call(f,e);0>a||e!==f.length-1||(f=b.querySelector(".changeType"),this.enabled&&f||(this.enabled?(f=document.createElement("button"),f.className="changeType",f.onclick=function(){return!1},b.firstChild.insertBefore(f,b.firstChild.firstChild)):f&&f.parentNode.removeChild(f)))}},onMenuAfterOpen:function(){this.hot.runHooks("afterDropdownMenuShow",this)},onMenuAfterClose:function(){this.hot.listen();this.hot.runHooks("afterDropdownMenuHide",this)},destroy:function(){this.close();this.menu&&this.menu.destroy();$traceurRuntime.superGet(this,K.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[E,A,H,B,H,G,H,D,H,F]}},q);J.SEPARATOR={name:H};t.hooks.register("afterDropdownMenuDefaultOptions");t.hooks.register("afterDropdownMenuShow");t.hooks.register("afterDropdownMenuHide");t.hooks.register("afterDropdownMenuExecute");d("dropdownMenu",J)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor":71,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory":74,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"../../browser":141}],150:[function(p,q,r){Object.defineProperties(r,{DataProvider:{get:function(){return h}},__esModule:{value:!0}});var k;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");var d=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),k&&k.__esModule&&k||{"default":k}).rangeEach,h=function(d){this.hot=d;this.options={}};$traceurRuntime.createClass(h,{setOptions:function(d){this.options=d},getData:function(){var h=this,g=this._getDataRange(),e=g.startCol,n=g.endCol,m=this.options,a=[];d(g.startRow,g.endRow,function(b){var f=[];if(m.exportHiddenRows||!h._isHiddenRow(b))d(e,n,function(a){if(m.exportHiddenColumns||!h._isHiddenColumn(a))f.push(h.hot.getDataAtCell(b,a)),isNaN(f[f.length-1])&&(f[f.length-1]=f[f.length-1].replace(/<[^>]*href[^>]*>|<\/a>/g,""))}),a.push(f)});return a},getRowHeaders:function(){var h=this,g=[];if(this.options.rowHeaders){var e=this._getDataRange(),n=e.startRow,e=e.endRow,m=this.hot.getRowHeader();d(n,e,function(a){!h.options.exportHiddenRows&&h._isHiddenRow(a)||g.push(m[a])})}return g},getColumnHeaders:function(){var h=this,g=[];if(this.options.columnHeaders){var e=this._getDataRange(),n=e.startCol,e=e.endCol,m=this.hot.getColHeader();d(n,e,function(a){!h.options.exportHiddenColumns&&h._isHiddenColumn(a)||g.push(m[a])})}return g},_getDataRange:function(){var d,g,e,h,m=this.hot.countCols()-1,a=this.hot.countRows()-1,b=this.options.range,f=void 0===(d=b[0])?0:d;d=void 0===(g=b[1])?0:g;g=void 0===(e=b[2])?a:e;e=void 0===(h=b[3])?m:h;f=Math.max(f,0);d=Math.max(d,0);g=Math.min(g,a);e=Math.min(e,m);return{startRow:f,startCol:d,endRow:g,endCol:e}},_isHiddenRow:function(d){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",d)},_isHiddenColumn:function(d){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",d)}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],151:[function(p,q,r){Object.defineProperties(r,{ExportFile:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var g=(h=p("dataProvider"),h&&h.__esModule&&h||{"default":h}).DataProvider;p=(l=p("typeFactory"),l&&l.__esModule&&l||{"default":l});var e=p.typeFactory,n=p.EXPORT_TYPES,m=function(b){$traceurRuntime.superConstructor(a).call(this,b)},a=m;$traceurRuntime.createClass(m,{isEnabled:function(){return!0},exportAsString:function(a,e){return this._createTypeFormatter(a,void 0!==e?e:{})["export"]()},exportAsBlob:function(a,e){return this._createBlob(this._createTypeFormatter(a,void 0!==e?e:{}))},downloadFile:function(a,e){var b=this._createTypeFormatter(a,void 0!==e?e:{}),f=this._createBlob(b),d=window.URL||window.webkitURL,g=document.createElement("a"),b=b.options.filename+"."+b.options.fileExtension;if(void 0!==g.download){var m=d.createObjectURL(f);g.style.display="none";g.setAttribute("href",m);g.setAttribute("download",b);document.body.appendChild(g);g.dispatchEvent(new MouseEvent("click"));document.body.removeChild(g);setTimeout(function(){d.revokeObjectURL(m)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,b)},_createTypeFormatter:function(a,f){var b=void 0!==f?f:{};if(!n[a])throw Error('Export format type "'+a+'" is not supported.');return e(a,new g(this.hot),b)},_createBlob:function(a){var b=null;"undefined"!==typeof Blob&&(b=new Blob([a["export"]()],{type:a.options.mimeType+";charset\x3d"+a.options.encoding}));return b}},{},q);k("exportFile",m)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:150,typeFactory:152}],152:[function(p,q,r){function k(e,a,b){return"function"===typeof n[e]?new n[e](a,b):null}var d;Object.defineProperties(r,{TYPE_CSV:{get:function(){return l}},TYPE_EXCEL:{get:function(){return g}},TYPE_PDF:{get:function(){return e}},EXPORT_TYPES:{get:function(){return n}},typeFactory:{get:function(){return k}},__esModule:{value:!0}});var h;p=(h=p("types/csv.js"),h&&h.__esModule&&h||{"default":h}).Csv;var l="csv",g="excel",e="pdf",n=(d={},Object.defineProperty(d,l,{value:p,configurable:!0,enumerable:!0,writable:!0}),d)},{"types/csv.js":154}],153:[function(p,q,r){Object.defineProperties(r,{BaseType:{get:function(){return n}},__esModule:{value:!0}});var k,d;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");q=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k});var h=q.extend,l=q.clone;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number");p=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),d&&d.__esModule&&d||{"default":d});var g=p.substitute,e=p.padStart,n=function(a,b){this.dataProvider=a;this.options=this._mergeOptions(b);this.dataProvider.setOptions(this.options)},m=n;$traceurRuntime.createClass(n,{_mergeOptions:function(a){var b=l(this.constructor.DEFAULT_OPTIONS),f=new Date,b=h(l(m.DEFAULT_OPTIONS),b),b=h(b,a);b.filename=g(b.filename,{YYYY:f.getFullYear(),MM:e(f.getMonth()+1,2,"0"),DD:e(f.getDate(),2,"0")});return b}},{get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55}],154:[function(p,q,r){Object.defineProperties(r,{Csv:{get:function(){return b}},__esModule:{value:!0}});var k,d,h;q=(k=p("_base.js"),k&&k.__esModule&&k||{"default":k}).BaseType;k=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d});var l=k.arrayEach,g=k.arrayMap,e=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,n=String.fromCharCode(13),m=String.fromCharCode(34),a=String.fromCharCode(10),b=function(a,b){$traceurRuntime.superConstructor(f).call(this,a,b)},f=b;$traceurRuntime.createClass(b,{"export":function(){var a=this,b=this.options,e=this.dataProvider.getData(),f=this.dataProvider.getColumnHeaders(),d=0<f.length,m=this.dataProvider.getRowHeaders(),h=0<m.length,n='\ufeff"\u6570\u636e\u6765\u6e90\uff1aCNABS"',n=n+b.rowDelimiter;d&&(f=g(f,function(b){return a._escapeCell(b,!0)}),h&&(n+=b.columnDelimiter),n+=f.join(b.columnDelimiter),n+=b.rowDelimiter);l(e,function(e,f){0<f&&(n+=b.rowDelimiter);h&&(n+=a._escapeCell(m[f])+b.columnDelimiter);n+=e.map(function(b){return a._escapeCell(b)}).join(b.columnDelimiter)});return n},_escapeCell:function(b,f){var d=void 0!==f?f:!1;b=e(b);""!==b&&(d||0<=b.indexOf(n)||0<=b.indexOf(m)||0<=b.indexOf(a)||0<=b.indexOf(this.options.columnDelimiter))&&(b=b.replace(RegExp('"',"g"),'""'),b='"'+b+'"');return b}},{get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"_base.js":153}],155:[function(p,q,r){Object.defineProperties(r,{BaseComponent:{get:function(){return e}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach;q=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).mixin;d=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),h&&h.__esModule&&h||{"default":h}).localHooks;p=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver"),l&&l.__esModule&&l||{"default":l}).stateSaver;var e=function(e){this.hot=e;this.elements=[];this.hidden=!1};$traceurRuntime.createClass(e,{reset:function(){g(this.elements,function(e){return e.reset()})},hide:function(){this.hidden=!0},show:function(){this.hidden=!1},isHidden:function(){return this.hidden},destroy:function(){this.clearLocalHooks();g(this.elements,function(e){return e.destroy()});this.hot=this.elements=null}},{});q(e,d);q(e,p)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver":59}],156:[function(p,q,r){Object.defineProperties(r,{ActionBarComponent:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,e=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach;q=(h=p("_base"),h&&h.__esModule&&h||{"default":h}).BaseComponent;var n=(l=p("ui/input"),l&&l.__esModule&&l||{"default":l}).InputUI;p("ui/select");var m=function(b){$traceurRuntime.superConstructor(a).call(this,b);this.elements.push(new n(this.hot,{type:"button",value:"\u786e\u5b9a",className:"htUIButton htUIButtonOK",identifier:a.BUTTON_OK}));this.elements.push(new n(this.hot,{type:"button",value:"\u53d6\u6d88",className:"htUIButton htUIButtonCancel",identifier:a.BUTTON_CANCEL}));this.registerHooks()},a=m;$traceurRuntime.createClass(m,{registerHooks:function(){var a=this;e(this.elements,function(b){b.addLocalHook("click",function(b,e){return a.onButtonClick(b,e)})})},getMenuItemDescriptor:function(){var a=this;return{key:"filter_action_bar",name:"Action bar",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(b,d,m,h,n,l){g(d.parentNode,"htFiltersMenuActionBar");e(a.elements,function(a){return d.appendChild(a.element)});return d}}},accept:function(){this.runLocalHooks("accept")},cancel:function(){this.runLocalHooks("cancel")},onButtonClick:function(b,e){e.options.identifier===a.BUTTON_OK?this.accept():this.cancel()}},{get BUTTON_OK(){return"ok"},get BUTTON_CANCEL(){return"cancel"}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,_base:155,"ui/input":187,"ui/select":189}],157:[function(p,q,r){Object.defineProperties(r,{ConditionComponent:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,f=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),d&&d.__esModule&&d||{"default":d}).stopImmediatePropagation;q=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h});var t=q.arrayEach,u=q.arrayFilter;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");var v=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),l&&l.__esModule&&l||{"default":l}).isKey;h=(g=p("_base"),g&&g.__esModule&&g||{"default":g}).BaseComponent;g=(e=p("constants"),e&&e.__esModule&&e||{"default":e});var y=g.getOptionsList,w=g.FORMULA_NONE,z=g.FORMULA_BY_VALUE,x=(n=p("ui/input"),n&&n.__esModule&&n||{"default":n}).InputUI,C=(m=p("ui/select"),m&&m.__esModule&&m||{"default":m}).SelectUI,E=(a=p("formulaRegisterer"),a&&a.__esModule&&a||{"default":a}).getFormulaDescriptor,A=function(a){$traceurRuntime.superConstructor(B).call(this,a);this.elements.push(new C(this.hot));this.elements.push(new x(this.hot,{placeholder:"Value"}));this.elements.push(new x(this.hot,{placeholder:"Second value"}));this.registerHooks()},B=A;$traceurRuntime.createClass(A,{registerHooks:function(){var a=this;this.getSelectElement().addLocalHook("select",function(b){return a.onConditionSelect(b)});t(this.getInputElements(),function(b){b.addLocalHook("keydown",function(b){return a.onInputKeyDown(b)})})},setState:function(a){var b=this;this.reset();a&&(this.getSelectElement().setValue(a.command),t(a.args,function(e,f){var d=b.getInputElement(f);d.setValue(e);d[a.command.inputsCount>f?"show":"hide"]();f||setTimeout(function(){return d.focus()},10)}))},getState:function(){var a=this.getSelectElement().getValue()||E(w),b=[];t(this.getInputElements(),function(e,f){a.inputsCount>f&&b.push(e.getValue())});return{command:a,args:b}},updateState:function(a){var b=a.editedFormulaStack.column;(a=u(a.editedFormulaStack.formulas,function(a){return a.name!==z})[0])&&a.name===z||this.setCachedState(b,{command:a?E(a.name):E(w),args:a?a.args:[]})},getSelectElement:function(){return this.elements.filter(function(a){return a instanceof C})[0]},getInputElement:function(a){a=void 0!==a?a:0;return this.getInputElements()[a]},getInputElements:function(){return this.elements.filter(function(a){return a instanceof x})},getMenuItemDescriptor:function(){var a=this;return{key:"filter_by_condition",name:"",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(e,f,d,g,m,h){b(f.parentNode,"htFiltersMenuCondition");e=document.createElement("div");b(e,"htFiltersMenuLabel");e.textContent="\u6309\u6761\u4ef6\u7b5b\u9009:";f.appendChild(e);t(a.elements,function(a){return f.appendChild(a.element)});return f}}},reset:function(){var a=this.hot.getPlugin("filters").getSelectedColumn(),a=a&&a.visualIndex,a=this.hot.getDataType.apply(this.hot,this.hot.getSelected()||[0,a]),a=y(a);t(this.getInputElements(),function(a){return a.hide()});this.getSelectElement().setItems(a);$traceurRuntime.superGet(this,B.prototype,"reset").call(this);this.getSelectElement().setValue(a[0])},onConditionSelect:function(a){t(this.getInputElements(),function(b,e){b[a.inputsCount>e?"show":"hide"]();e||setTimeout(function(){return b.focus()},10)});this.runLocalHooks("change",a)},onInputKeyDown:function(a){v(a.keyCode,"ENTER")?(this.runLocalHooks("accept"),f(a)):v(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),f(a))}},{},h)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,_base:155,constants:159,formulaRegisterer:184,"ui/input":187,"ui/select":189}],158:[function(p,q,r){Object.defineProperties(r,{ValueComponent:{get:function(){return G}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).addClass,f=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),d&&d.__esModule&&d||{"default":d}).stopImmediatePropagation;q=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h});var t=q.arrayEach,u=q.arrayFilter,v=q.arrayMap;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort");p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object");p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string");h=(l=p("utils"),l&&l.__esModule&&l||{"default":l});var y=h.unifyColumnValues,w=h.intersectValues,z=h.toEmptyString;l=(g=p("_base"),g&&g.__esModule&&g||{"default":g}).BaseComponent;var x=(e=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),e&&e.__esModule&&e||{"default":e}).isKey,C=(n=p("ui/multipleSelect"),n&&n.__esModule&&n||{"default":n}).MultipleSelectUI;g=(m=p("constants"),m&&m.__esModule&&m||{"default":m});var E=g.FORMULA_BY_VALUE,A=g.FORMULA_NONE,B=(a=p("formulaRegisterer"),a&&a.__esModule&&a||{"default":a}).getFormulaDescriptor,G=function(a){$traceurRuntime.superConstructor(D).call(this,a);this.elements.push(new C(this.hot));this.registerHooks()},D=G;$traceurRuntime.createClass(G,{registerHooks:function(){var a=this;this.getMultipleSelectElement().addLocalHook("keydown",function(b){return a.onInputKeyDown(b)})},setState:function(a){this.reset();if(a&&a.command.key===E){var b=this.getMultipleSelectElement();b.setItems(a.itemsSnapshot);b.setValue(a.args[0])}},getState:function(){var a=this.getMultipleSelectElement(),b=a.getItems();return{command:{key:a.isSelectedAllValues()||!b.length?A:E},args:[a.getValue()],itemsSnapshot:b}},updateState:function(a){var b=this,e=function(a,e,f,d,g){var m=u(e,function(a){return a.name===E})[0];e={};if(m){d=v(d(a,g),function(a){return a.value});d=y(d);f&&(m.args[0]=f);var h=[];f=w(d,m.args[0],function(a){a.checked&&h.push(a.value)});e.args=[h];e.command=B(E);e.itemsSnapshot=f}else e.args=[],e.command=B(A);b.setCachedState(a,e)};e(a.editedFormulaStack.column,a.editedFormulaStack.formulas,a.formulaArgsChange,a.filteredRowsFactory);a.dependentFormulaStacks.length&&e(a.dependentFormulaStacks[0].column,a.dependentFormulaStacks[0].formulas,a.formulaArgsChange,a.filteredRowsFactory,a.editedFormulaStack)},getMultipleSelectElement:function(){return this.elements.filter(function(a){return a instanceof C})[0]},getMenuItemDescriptor:function(){var a=this;return{key:"filter_by_value",name:"Filter by value",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(e,f,d,g,m,h){b(f.parentNode,"htFiltersMenuValue");e=document.createElement("div");b(e,"htFiltersMenuLabel");e.textContent="\u6839\u636e\u503c\u7b5b\u9009:";f.appendChild(e);t(a.elements,function(a){return f.appendChild(a.element)});return f}}},reset:function(){var a=y(this._getColumnVisibleValues()),b=w(a,a);this.getMultipleSelectElement().setItems(b);$traceurRuntime.superGet(this,D.prototype,"reset").call(this);this.getMultipleSelectElement().setValue(a)},onInputKeyDown:function(a){x(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),f(a))},_getColumnVisibleValues:function(){var a=this.hot.getPlugin("filters").getSelectedColumn();return v(this.hot.getDataAtCol(a&&a.visualIndex),function(a){return z(a)})}},{},l)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort":134,_base:155,constants:159,formulaRegisterer:184,"ui/multipleSelect":188,utils:190}],159:[function(p,q,r){function k(a){var b=[];ta[a]||(a=ja);I(ta[a],function(a){a=a===O?{name:O}:K(Q(a));b.push(a)});return b}var d;Object.defineProperties(r,{FORMULA_NONE:{get:function(){return R}},FORMULA_EMPTY:{get:function(){return M}},FORMULA_NOT_EMPTY:{get:function(){return S}},FORMULA_EQUAL:{get:function(){return U}},FORMULA_NOT_EQUAL:{get:function(){return V}},FORMULA_GREATER_THAN:{get:function(){return ga}},FORMULA_GREATER_THAN_OR_EQUAL:{get:function(){return P}},FORMULA_LESS_THAN:{get:function(){return ua}},FORMULA_LESS_THAN_OR_EQUAL:{get:function(){return Z}},FORMULA_BETWEEN:{get:function(){return oa}},FORMULA_NOT_BETWEEN:{get:function(){return W}},FORMULA_BEGINS_WITH:{get:function(){return T}},FORMULA_ENDS_WITH:{get:function(){return wa}},
FORMULA_CONTAINS:{get:function(){return ra}},FORMULA_NOT_CONTAINS:{get:function(){return ia}},FORMULA_DATE_BEFORE:{get:function(){return la}},FORMULA_DATE_AFTER:{get:function(){return aa}},FORMULA_TOMORROW:{get:function(){return fa}},FORMULA_TODAY:{get:function(){return pa}},FORMULA_YESTERDAY:{get:function(){return ha}},FORMULA_BY_VALUE:{get:function(){return xa}},TYPE_NUMERIC:{get:function(){return sa}},TYPE_TEXT:{get:function(){return ja}},TYPE_DATE:{get:function(){return Aa}},TYPES:{get:function(){return ta}},getOptionsList:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n,m,a,b,f,t,u,v,y,w,z,x,C,E,A,B,G,D,F,H,J,K=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{"default":h}).clone,I=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach,O=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),g&&g.__esModule&&g||{"default":g}).SEPARATOR,Q=(e=p("formulaRegisterer"),e&&e.__esModule&&e||{"default":e}).getFormulaDescriptor,R=(n=p("formula/none"),n&&n.__esModule&&n||{"default":n}).FORMULA_NAME,M=(m=p("formula/empty"),m&&m.__esModule&&m||{"default":m}).FORMULA_NAME,S=(a=p("formula/notEmpty"),a&&a.__esModule&&a||{"default":a}).FORMULA_NAME,U=(b=p("formula/equal"),b&&b.__esModule&&b||{"default":b}).FORMULA_NAME,V=(f=p("formula/notEqual"),f&&f.__esModule&&f||{"default":f}).FORMULA_NAME,ga=(t=p("formula/greaterThan"),t&&t.__esModule&&t||{"default":t}).FORMULA_NAME,P=(u=p("formula/greaterThanOrEqual"),u&&u.__esModule&&u||{"default":u}).FORMULA_NAME,ua=(v=p("formula/lessThan"),v&&v.__esModule&&v||{"default":v}).FORMULA_NAME,Z=(y=p("formula/lessThanOrEqual"),y&&y.__esModule&&y||{"default":y}).FORMULA_NAME,oa=(w=p("formula/between"),w&&w.__esModule&&w||{"default":w}).FORMULA_NAME,W=(z=p("formula/notBetween"),z&&z.__esModule&&z||{"default":z}).FORMULA_NAME,T=(x=p("formula/beginsWith"),x&&x.__esModule&&x||{"default":x}).FORMULA_NAME,wa=(C=p("formula/endsWith"),C&&C.__esModule&&C||{"default":C}).FORMULA_NAME,ra=(E=p("formula/contains"),E&&E.__esModule&&E||{"default":E}).FORMULA_NAME,ia=(A=p("formula/notContains"),A&&A.__esModule&&A||{"default":A}).FORMULA_NAME,la=(B=p("formula/date/before"),B&&B.__esModule&&B||{"default":B}).FORMULA_NAME,aa=(G=p("formula/date/after"),G&&G.__esModule&&G||{"default":G}).FORMULA_NAME,fa=(D=p("formula/date/tomorrow"),D&&D.__esModule&&D||{"default":D}).FORMULA_NAME,pa=(F=p("formula/date/today"),F&&F.__esModule&&F||{"default":F}).FORMULA_NAME,ha=(H=p("formula/date/yesterday"),H&&H.__esModule&&H||{"default":H}).FORMULA_NAME,xa=(J=p("formula/byValue"),J&&J.__esModule&&J||{"default":J}).FORMULA_NAME,sa="numeric",ja="text",Aa="date",ta=(d={},Object.defineProperty(d,sa,{value:[R,O,M,S,O,U,V,O,ga,P,ua,Z,oa,W],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,ja,{value:[R,O,M,S,O,U,V,O,T,wa,O,ra,ia],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,Aa,{value:[R,O,M,S,O,U,V,O,la,aa,oa,O,fa,pa,ha],configurable:!0,enumerable:!0,writable:!0}),d)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"formula/beginsWith":162,"formula/between":163,"formula/byValue":164,"formula/contains":165,"formula/date/after":166,"formula/date/before":167,"formula/date/today":168,"formula/date/tomorrow":169,"formula/date/yesterday":170,"formula/empty":171,"formula/endsWith":172,"formula/equal":173,"formula/greaterThan":174,"formula/greaterThanOrEqual":175,"formula/lessThan":176,"formula/lessThanOrEqual":177,"formula/none":178,"formula/notBetween":179,"formula/notContains":180,"formula/notEmpty":181,"formula/notEqual":182,formulaRegisterer:184}],160:[function(p,q,r){Object.defineProperties(r,{DataFilter:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("../../browser"),k&&k.__esModule&&k||{"default":k})["default"];var h=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,l=function(d,e){var g=void 0!==e?e:function(e){return[]};this.formulaCollection=d;this.columnDataFactory=g};$traceurRuntime.createClass(l,{filter:function(){var d=this,e=[];this.formulaCollection.isEmpty()||h(this.formulaCollection.orderStack,function(g,m){var a=d.columnDataFactory(g);m&&(a=d._getIntersectData(a,e));e=d.filterByColumn(g,a)});return e},filterByColumn:function(d,e){var g=this,m=[];h(void 0!==e?e:[],function(a){void 0!==a&&g.formulaCollection.isMatch(a,d)&&m.push(a)});return m},_getIntersectData:function(d,e){var g=[];h(e,function(e){e=e.meta.visualRow;void 0!==d[e]&&(g[e]=d[e])});return g}},{});q.utils.FiltersDataFilter=l},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../browser":141}],161:[function(p,q,r){Object.defineProperties(r,{Filters:{get:function(){return S}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f,t,u,v,y;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d});var w=k.arrayEach,z=k.arrayMap,x=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,C=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;d=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),g&&g.__esModule&&g||{"default":g});var E=d.addClass,A=d.removeClass,B=d.closest;g=(e=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin;var G=(n=p("component/condition"),n&&n.__esModule&&n||{"default":n}).ConditionComponent,D=(m=p("component/value"),m&&m.__esModule&&m||{"default":m}).ValueComponent,F=(a=p("component/actionBar"),a&&a.__esModule&&a||{"default":a}).ActionBarComponent,H=(b=p("formulaCollection"),b&&b.__esModule&&b||{"default":b}).FormulaCollection,J=(f=p("dataFilter"),f&&f.__esModule&&f||{"default":f}).DataFilter,K=(t=p("formulaUpdateObserver"),t&&t.__esModule&&t||{"default":t}).FormulaUpdateObserver;e=(u=p("utils"),u&&u.__esModule&&u||{"default":u});var I=e.createArrayAssertion,O=e.toEmptyString,Q=e.unifyColumnValues,R=(v=p("constants"),v&&v.__esModule&&v||{"default":v}).FORMULA_NONE,M=(y=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),y&&y.__esModule&&y||{"default":y}).SEPARATOR,S=function(a){var b=this;$traceurRuntime.superConstructor(U).call(this,a);this.eventManager=new C(this);this.lastSelectedColumn=this.actionBarComponent=this.valueComponent=this.conditionComponent=this.formulaUpdateObserver=this.formulaCollection=this.dropdownMenuPlugin=this.trimRowsPlugin=null;this.hot.addHook("afterGetColHeader",function(a,e){return b.onAfterGetColHeader(a,e)})},U=S;$traceurRuntime.createClass(S,{isEnabled:function(){return this.hot.getSettings().filters?!0:!1},enablePlugin:function(){var a=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var b=function(b){b.addLocalHook("accept",function(){return a.onActionBarSubmit("accept")});b.addLocalHook("cancel",function(){return a.onActionBarSubmit("cancel")});b.addLocalHook("change",function(e){return a.onComponentChange(b,e)});return b};this.conditionComponent||(this.conditionComponent=b(new G(this.hot)));this.valueComponent||(this.valueComponent=b(new D(this.hot)));this.actionBarComponent||(this.actionBarComponent=b(new F(this.hot)));this.formulaCollection||(this.formulaCollection=new H);this.formulaUpdateObserver||(this.formulaUpdateObserver=new K(this.formulaCollection,function(b){return a.getDataMapAtColumn(b)}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var b,e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];return(b=a.conditionComponent).updateState.apply(b,$traceurRuntime.spread(e))}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var b,e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];return(b=a.valueComponent).updateState.apply(b,$traceurRuntime.spread(e))}));this.conditionComponent.show();this.valueComponent.show();this.actionBarComponent.show();this.registerEvents();this.addHook("beforeDropdownMenuSetItems",function(b){return a.onBeforeDropdownMenuSetItems(b)});this.addHook("afterDropdownMenuDefaultOptions",function(b){return a.onAfterDropdownMenuDefaultOptions(b)});this.addHook("afterDropdownMenuShow",function(){return a.onAfterDropdownMenuShow()});this.addHook("afterDropdownMenuHide",function(){return a.onAfterDropdownMenuHide()});this.addHook("afterChange",function(b,e){return a.onAfterChange(b)});this.hot.getSettings().trimRows=!0;this.trimRowsPlugin.enablePlugin();this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin());$traceurRuntime.superGet(this,U.prototype,"enablePlugin").call(this)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(b){return a.onTableClick(b)})},disablePlugin:function(){this.enabled&&(this.conditionComponent.hide(),this.valueComponent.hide(),this.actionBarComponent.hide(),this.formulaCollection.clean(),this.trimRowsPlugin.untrimAll());$traceurRuntime.superGet(this,U.prototype,"disablePlugin").call(this)},addFormula:function(a,b,e){a=this.t.toPhysicalColumn(a);this.formulaCollection.addFormula(a,{command:{key:b},args:e})},removeFormulas:function(a){a=this.t.toPhysicalColumn(a);this.formulaCollection.removeFormulas(a)},clearFormulas:function(a){var b=this.t.toPhysicalColumn(a);void 0===a?this.formulaCollection.clean():this.formulaCollection.clearFormulas(b)},filter:function(){var a=this._createDataFilter(),b=!this.formulaCollection.isEmpty(),e=[],f=this.formulaCollection.exportAllFormulas();if(!1!==this.hot.runHooks("beforeFilter",f))if(b){var d=[];this.trimRowsPlugin.trimmedRows.length=0;var e=z(a.filter(),function(a){return a.meta.visualRow}),g=I(e);x(this.hot.countSourceRows()-1,function(a){g(a)||d.push(a)});this.trimRowsPlugin.trimRows(d);e.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0);this.hot.render();this.clearColumnSelection();this.hot.runHooks("afterFilter",f)},getSelectedColumn:function(){return this.lastSelectedColumn},clearColumnSelection:function(){var a=this.hot.getSelected()||[],b=a[0],a=a[1];void 0!==b&&void 0!==a&&this.hot.selectCell(b,a)},getDataMapAtColumn:function(a){var b=this,e=this.t.toVisualColumn(a),f=[];w(this.hot.getSourceDataAtCol(e),function(a,d){var g=b.hot.getCellMeta(d,e);f.push({meta:{row:g.row,col:g.col,visualCol:g.visualCol,visualRow:g.visualRow,type:g.type,instance:g.instance,dateFormat:g.dateFormat},value:O(a)})});return f},onAfterChange:function(a){var b=this;a&&w(a,function(a){a=b.hot.propToCol(a[1]);b.updateValueComponentFormula(a)})},updateValueComponentFormula:function(a){var b=this.hot.getDataAtCol(a),b=Q(b);this.formulaUpdateObserver.updateStatesAtColumn(a,b)},onAfterDropdownMenuShow:function(){var a=this.getSelectedColumn(),a=a&&a.physicalIndex,b=this.conditionComponent,e=this.valueComponent;b.isHidden()||b.restoreState(a);e.isHidden()||e.restoreState(a)},onAfterDropdownMenuHide:function(){this.conditionComponent.getSelectElement().closeOptions()},onBeforeDropdownMenuSetItems:function(a){a=z(a,function(a){return a.key});var b=this.conditionComponent,e=this.valueComponent;b[-1===a.indexOf(b.getMenuItemDescriptor().key)?"hide":"show"]();e[-1===a.indexOf(e.getMenuItemDescriptor().key)?"hide":"show"]()},onAfterDropdownMenuDefaultOptions:function(a){a.items.push({name:M});a.items.push(this.conditionComponent.getMenuItemDescriptor());a.items.push(this.valueComponent.getMenuItemDescriptor());a.items.push(this.actionBarComponent.getMenuItemDescriptor())},onActionBarSubmit:function(a){if("accept"===a){a=(a=this.getSelectedColumn())&&a.physicalIndex;var b=this.conditionComponent.getState(),e=this.valueComponent.getState();this.formulaUpdateObserver.groupChanges();this.formulaCollection.clearFormulas(a);b.command.key===R&&e.command.key===R&&this.formulaCollection.removeFormulas(a);b.command.key!==R&&this.formulaCollection.addFormula(a,b);e.command.key!==R&&this.formulaCollection.addFormula(a,e);this.formulaUpdateObserver.flush();this.conditionComponent.saveState(a);this.valueComponent.saveState(a);this.filter()}this.dropdownMenuPlugin.close()},onComponentChange:function(a,b){a!==this.conditionComponent||b.inputsCount||this.dropdownMenuPlugin.setListening()},onAfterGetColHeader:function(a,b){var e=this.t.toPhysicalColumn(a);this.enabled&&this.formulaCollection.hasFormulas(e)?E(b,"htFiltersActive"):A(b,"htFiltersActive")},onTableClick:function(a){if(a=B(a.target,"TH")){a=this.hot.getCoords(a).col;var b=this.t.toPhysicalColumn(a);this.lastSelectedColumn={visualIndex:a,physicalIndex:b}}},destroy:function(){this.enabled&&(this.conditionComponent.destroy(),this.valueComponent.destroy(),this.actionBarComponent.destroy(),this.formulaCollection.destroy(),this.formulaUpdateObserver.destroy());$traceurRuntime.superGet(this,U.prototype,"destroy").call(this)},_createDataFilter:function(a){var b=this;return new J(void 0!==a?a:this.formulaCollection,function(a){return b.getDataMapAtColumn(a)})}},{},q);g("filters",S)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"component/actionBar":156,"component/condition":157,"component/value":158,constants:159,dataFilter:160,formulaCollection:183,formulaUpdateObserver:185,utils:190}],162:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return e}},__esModule:{value:!0}});var k,d,h;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),d&&d.__esModule&&d||{"default":d}).startsWith,g=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,e="begins_with";q(e,function(e,d){var a=(void 0!==d?d:inputValues)[0];return l(g(e.value).toLowerCase(),g(a))},{name:"\u4ee5...\u5f00\u59cb",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],163:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return n}},__esModule:{value:!0}});var k,d,h;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k});k=q.registerFormula;var l=q.getFormula,g=(d=p("date/after"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME,e=(h=p("date/before"),h&&h.__esModule&&h||{"default":h}).FORMULA_NAME,n="between";k(n,function(d,a){var b=void 0!==a?a:inputValues,f=b[0],m=b[1];if("numeric"===d.meta.type)b=parseFloat(f,10),m=parseFloat(m,10),f=Math.min(b,m),m=Math.max(b,m);else if("date"===d.meta.type)return b=l(e,[m]),f=l(g,[f]),b(d)&&f(d);return d.value>=f&&d.value<=m},{name:"\u5728...\u4e4b\u95f4",inputsCount:2})},{"date/after":166,"date/before":167,formulaRegisterer:184}],164:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("utils"),d&&d.__esModule&&d||{"default":d}).createArrayAssertion,l="by_value";q(l,function(d,e){return(0,(void 0!==e?e:inputValues)[0])(d.value)},{name:"By value",inputsCount:0,inputValuesDecorator:function(d){return[h((void 0!==d?d:inputValues)[0])]}})},{formulaRegisterer:184,utils:190}],165:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),d&&d.__esModule&&d||{"default":d}).stringify,l="contains";q(l,function(d,e){var g=(void 0!==e?e:inputValues)[0];return 0<=h(d.value).toLowerCase().indexOf(h(g))},{name:"\u5305\u542b",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],166:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l="date_after";q(l,function(d,e){var g=(void 0!==e?e:inputValues)[0],m=h(d.value,d.meta.dateFormat),g=h(g,d.meta.dateFormat);return m.isValid()&&g.isValid()?0<=m.diff(g):!1},{name:"\u5728\u4e4b\u540e",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],167:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l="date_before";q(l,function(d,e){var g=(void 0!==e?e:inputValues)[0],m=h(d.value,d.meta.dateFormat),g=h(g,d.meta.dateFormat);return m.isValid()&&g.isValid()?0>=m.diff(g):!1},{name:"\u5728\u4e4b\u524d",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],168:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l="date_today";q(l,function(d){d=h(d.value,d.meta.dateFormat);return d.isValid()?d.isSame(h().startOf("day"),"d"):!1},{name:"\u4eca\u5929",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],169:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l="date_tomorrow";q(l,function(d){d=h(d.value,d.meta.dateFormat);return d.isValid()?d.isSame(h().subtract(-1,"days").startOf("day"),"d"):!1},{name:"\u660e\u5929",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],170:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var h=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],l="date_yesterday";q(l,function(d){d=h(d.value,d.meta.dateFormat);return d.isValid()?d.isSame(h().subtract(1,"days").startOf("day"),"d"):!1},{name:"\u6628\u5929",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],171:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="empty";p(d,function(d){return""===d.value||null===d.value||void 0===d.value},{name:"\u4e3a\u7a7a",inputsCount:0})},{formulaRegisterer:184}],172:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return e}},__esModule:{value:!0}});var k,d,h;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),d&&d.__esModule&&d||{"default":d}).endsWith,g=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,e="ends_with";q(e,function(e,d){var a=(void 0!==d?d:inputValues)[0];return l(g(e.value).toLowerCase(),g(a))},{name:"\u4ee5...\u7ed3\u5c3e",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],173:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var k,d,h=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),k&&k.__esModule&&k||{"default":k}).stringify;p=(d=p("formulaRegisterer"),d&&d.__esModule&&d||{"default":d}).registerFormula;var l="eq";p(l,function(d,e){var g=(void 0!==e?e:inputValues)[0];return h(d.value).toLowerCase()===h(g)},{name:"\u7b49\u4e8e",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],174:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="gt";p(d,function(d,l){var g=(void 0!==l?l:inputValues)[0];"numeric"===d.meta.type&&(g=parseFloat(g,10));return d.value>g},{name:"\u5927\u4e8e",inputsCount:1})},{formulaRegisterer:184}],175:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="gte";p(d,function(d,l){var g=(void 0!==l?l:inputValues)[0];"numeric"===d.meta.type&&(g=parseFloat(g,10));return d.value>=g},{name:"\u5927\u4e8e\u7b49\u4e8e",inputsCount:1})},{formulaRegisterer:184}],176:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="lt";p(d,function(d,l){var g=(void 0!==l?l:inputValues)[0];"numeric"===d.meta.type&&(g=parseFloat(g,10));return d.value<g},{name:"\u5c0f\u4e8e",inputsCount:1})},{formulaRegisterer:184}],177:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="lte";p(d,function(d,l){var g=(void 0!==l?l:inputValues)[0];"numeric"===d.meta.type&&(g=parseFloat(g,10));return d.value<=g},{name:"\u5c0f\u4e8e\u7b49\u4e8e",inputsCount:1})},{formulaRegisterer:184}],178:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var k;p=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k}).registerFormula;var d="none";p(d,function(){return!0},{name:"\u65e0\u6761\u4ef6",inputsCount:0})},{formulaRegisterer:184}],179:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return g}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k});k=q.registerFormula;var h=q.getFormula,l=(d=p("between"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME,g="not_between";k(g,function(e,d){return!h(l,d)(e)},{name:"\u4e0d\u5728...\u4e4b\u95f4",inputsCount:2})},{between:163,formulaRegisterer:184}],180:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return g}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k});k=q.registerFormula;var h=q.getFormula,l=(d=p("contains"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME,g="not_contains";k(g,function(e,d){return!h(l,d)(e)},{name:"\u4e0d\u5305\u542b",inputsCount:1})},{contains:165,formulaRegisterer:184}],181:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return g}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k});k=q.registerFormula;var h=q.getFormula,l=(d=p("empty"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME,g="not_empty";k(g,function(e,d){return!h(l,d)(e)},{name:"\u975e\u7a7a\u503c",inputsCount:0})},{empty:171,formulaRegisterer:184}],182:[function(p,q,r){Object.defineProperties(r,{FORMULA_NAME:{get:function(){return g}},__esModule:{value:!0}});var k,d;q=(k=p("formulaRegisterer"),k&&k.__esModule&&k||{"default":k});k=q.registerFormula;var h=q.getFormula,l=(d=p("equal"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME,g="neq";k(g,function(e,d){return!h(l,d)(e)},{name:"\u4e0d\u7b49\u4e8e",inputsCount:1})},{equal:173,formulaRegisterer:184}],183:[function(p,q,r){Object.defineProperties(r,{FormulaCollection:{get:function(){return b}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k});var g=q.arrayEach,e=q.arrayMap,n=q.arrayFilter;k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d});var m=k.objectEach;d=k.mixin;var a=(h=p("formulaRegisterer"),h&&h.__esModule&&h||{"default":h}).getFormula;p=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),l&&l.__esModule&&l||{"default":l}).localHooks;var b=function(){this.formulas=Object.create(null);this.orderStack=[]};$traceurRuntime.createClass(b,{isEmpty:function(){return!this.orderStack.length},isMatch:function(a,b){var e=this,f=!0;void 0===b?m(this.formulas,function(b){return f=e.isMatchInFormulas(b,a)}):f=this.isMatchInFormulas(this.getFormulas(b),a);return f},isMatchInFormulas:function(a,b){var e=!1;a.length?g(a,function(a){return e=a.func(b)}):e=!0;return e},addFormula:function(b,d){var f=e(d.args,function(a){return"string"===typeof a?a.toLowerCase():a}),m=d.name||d.command.key;this.runLocalHooks("beforeAdd",b);-1===this.orderStack.indexOf(b)&&this.orderStack.push(b);this.hasFormulas(b,m)?g(this.getFormulas(b),function(b){if(b.name===m)return b.func=a(b.name,f),b.args=f,!1}):this.getFormulas(b).push({name:m,args:f,func:a(m,f)});this.runLocalHooks("afterAdd",b)},getFormulas:function(a){this.formulas[a]||(this.formulas[a]=[]);return this.formulas[a]},exportAllFormulas:function(){var a=this,b=[];g(this.orderStack,function(f){var d=e(a.getFormulas(f),function(a){a=void 0!==a?a:formula;return{name:a.name,args:a.args}});b.push({column:f,formulas:d})});return b},importAllFormulas:function(a){var b=this;this.clean();g(a,function(a){b.orderStack.push(a.column);g(a.formulas,function(e){return b.addFormula(a.column,e)})})},removeFormulas:function(a){this.runLocalHooks("beforeRemove",a);0<=this.orderStack.indexOf(a)&&this.orderStack.splice(this.orderStack.indexOf(a),1);this.clearFormulas(a);this.runLocalHooks("afterRemove",a)},clearFormulas:function(a){this.runLocalHooks("beforeClear",a);this.getFormulas(a).length=0;this.runLocalHooks("afterClear",a)},hasFormulas:function(a,b){var e=!1,e=this.getFormulas(a);return e=b?0<n(e,function(a){return a.name===b}).length:0<e.length},clean:function(){this.runLocalHooks("beforeClean");this.formulas=Object.create(null);this.orderStack.length=0;this.runLocalHooks("afterClean")},destroy:function(){this.clearLocalHooks();this.orderStack=this.formulas=null}},{});d(b,p)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,formulaRegisterer:184}],184:[function(p,q,r){function k(e,d){if(!g[e])throw Error('Filter formula "'+e+'" does not exist.');var m=g[e],a=m.formula,m=m.descriptor;m.inputValuesDecorator&&(d=m.inputValuesDecorator(d));return function(b){return a.apply(b.meta.instance,[].concat([b],[d]))}}function d(e){if(!g[e])throw Error('Filter formula "'+e+'" does not exist.');return g[e].descriptor}function h(e,d,m){m.key=e;g[e]={formula:d,descriptor:m}}Object.defineProperties(r,{getFormula:{get:function(){return k}},getFormulaDescriptor:{get:function(){return d}},registerFormula:{get:function(){return h}},__esModule:{value:!0}});var l,g={};(l=p("../../browser"),l&&l.__esModule&&l||{"default":l})["default"].utils.FiltersFormulaRegisterer={getFormula:k,registerFormula:h,getFormulaDescriptor:d,formulas:g}},{"../../browser":141}],185:[function(p,q,r){Object.defineProperties(r,{FormulaUpdateObserver:{get:function(){return w}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k});var m=q.arrayEach,a=q.arrayMap,b=q.arrayFilter,f=(d=p("formulaCollection"),d&&d.__esModule&&d||{"default":d}).FormulaCollection,t=(h=p("dataFilter"),h&&h.__esModule&&h||{"default":h}).DataFilter,u=(l=p("utils"),l&&l.__esModule&&l||{"default":l}).createArrayAssertion;k=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),g&&g.__esModule&&g||{"default":g});g=k.mixin;var v=k.objectEach,y=(e=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),e&&e.__esModule&&e||{"default":e}).curry;p=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),n&&n.__esModule&&n||{"default":n}).localHooks;var w=function(a,b){var e=void 0!==b?b:function(a){return[]},f=this;this.formulaCollection=a;this.columnDataFactory=e;this.changes=[];this.grouping=!1;this.latestEditedColumnPosition=-1;this.latestOrderStack=[];this.formulaCollection.addLocalHook("beforeRemove",function(a){return f._onFormulaBeforeModify(a)});this.formulaCollection.addLocalHook("afterAdd",function(a){return f.updateStatesAtColumn(a)});this.formulaCollection.addLocalHook("afterClear",function(a){return f.updateStatesAtColumn(a)});this.formulaCollection.addLocalHook("beforeClean",function(){return f._onFormulaBeforeClean()});this.formulaCollection.addLocalHook("afterClean",function(){return f._onFormulaAfterClean()})};$traceurRuntime.createClass(w,{groupChanges:function(){this.grouping=!0},flush:function(){var a=this;this.grouping=!1;m(this.changes,function(b){return a.updateStatesAtColumn(b)});this.changes.length=0},_onFormulaBeforeModify:function(a){this.latestEditedColumnPosition=this.formulaCollection.orderStack.indexOf(a)},updateStatesAtColumn:function(e,d){var g=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var m=this.formulaCollection.exportAllFormulas(),h=this.formulaCollection.orderStack.indexOf(e);-1===h&&(h=this.latestEditedColumnPosition);var n=m.slice(0,h),m=m.slice(h);m.length&&m[0].column===e&&m.shift();n=y(function(e,d,m){var h=void 0!==m?m:[];m=new f;e=[].concat(e,h);m.importAllFormulas(e);e=g.columnDataFactory(d);d=m.isEmpty()?e:(new t(m,function(a){return g.columnDataFactory(a)})).filter();d=a(d,function(a){return a.meta.visualRow});var n=u(d);return b(e,function(a){return n(a.meta.visualRow)})})(n);h=[].concat(this.formulaCollection.getFormulas(e));this.runLocalHooks("update",{editedFormulaStack:{column:e,formulas:h},dependentFormulaStacks:m,filteredRowsFactory:n,formulaArgsChange:d})}},_onFormulaBeforeClean:function(){this.latestOrderStack=[].concat(this.formulaCollection.orderStack)},_onFormulaAfterClean:function(){var a=this;m(this.latestOrderStack,function(b){return a.updateStatesAtColumn(b)})},destroy:function(){var a=this;this.clearLocalHooks();v(this,function(b,e){return a[e]=null})}},{});g(w,p)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,dataFilter:160,formulaCollection:183,utils:190}],186:[function(p,q,r){Object.defineProperties(r,{BaseUI:{get:function(){return u}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k});var e=q.clone,n=q.extend;q=q.mixin;r=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),d&&d.__esModule&&d||{"default":d}).localHooks;var m=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),h&&h.__esModule&&h||{"default":h}).EventManager,a=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).addClass,b=(g=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),g&&g.__esModule&&g||{"default":g}).arrayEach,f=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k}).objectEach,t="click input keydown keypress keyup focus blur".split(" "),u=function(a,b){this.hot=a;this.eventManager=new m(this);this.options=n(v.DEFAULTS,b);this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName);this.buildState=!1},v=u;$traceurRuntime.createClass(u,{setValue:function(a){this.options.value=a;this.update()},getValue:function(){return this.options.value},get element(){if("building"===this.buildState)return this._element;if("built"===this.buildState)return this.update(),this._element;this.buildState="building";this.build();this.buildState="built";return this._element},isBuilt:function(){return"built"===this.buildState},build:function(){var e=this,d=function(a,b){e.eventManager.addEventListener(a,b,function(a){return e.runLocalHooks(b,a,e)})};this.buildState||(this.buildState="building");this.options.className&&a(this._element,this.options.className);if(this.options.children.length)b(this.options.children,function(a){return e._element.appendChild(a.element)});else if(this.options.wrapIt){var g=document.createElement(this.options.tagName);f(this.options,function(a,b){void 0!==g[b]&&"className"!==b&&"tagName"!==b&&"children"!==b&&(g[b]=a)});this._element.appendChild(g);b(t,function(a){return d(g,a)})}else b(t,function(a){return d(e._element,a)})},update:function(){},reset:function(){this.options.value="";this.update()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},focus:function(){},destroy:function(){this.eventManager.destroy();this.hot=this.eventManager=null;this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null}},{get DEFAULTS(){return e({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}});q(u,r)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58}],187:[function(p,q,r){Object.defineProperties(r,{InputUI:{get:function(){return m}},__esModule:{value:!0}});var k,d,h;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass;k=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{"default":h});var g=k.clone,e=k.extend;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");var n=new WeakMap,m=function(b,f){n.set(this,{});$traceurRuntime.superConstructor(a).call(this,b,e(a.DEFAULTS,f));this.registerHooks()},a=m;$traceurRuntime.createClass(m,{registerHooks:function(){var a=this;this.addLocalHook("click",function(b){return a.onClick(b)});this.addLocalHook("keyup",function(b){return a.onKeyup(b)})},build:function(){$traceurRuntime.superGet(this,a.prototype,"build").call(this);var b=n.get(this),e=document.createElement("div");b.input=this._element.firstChild;l(this._element,"htUIInput");l(e,"htUIInputIcon");this._element.appendChild(e);this.update()},update:function(){if(this.isBuilt()){var a=n.get(this).input;a.type=this.options.type;a.value=this.options.value}},focus:function(){this.isBuilt()&&n.get(this).input.focus()},onClick:function(a){},onKeyup:function(a){this.options.value=a.target.value}},{get DEFAULTS(){return g({placeholder:"",type:"text",tagName:"input"})}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,_base:186}],188:[function(p,q,r){function k(a,b){var e=F(b);return C(a,function(a){a.checked=e(a.value);return a})}function d(a){var b=[];E(a,function(a){a.checked&&b.push(a.value)});return b}Object.defineProperties(r,{MultipleSelectUI:{get:function(){return J}},__esModule:{value:!0}});var h,l,g,e,n,m,a,b,f,t,u=(h=p("../../../browser"),h&&h.__esModule&&h||{"default":h})["default"],v=(l=p("_base"),l&&l.__esModule&&l||{"default":l}).BaseUI,y=(g=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),g&&g.__esModule&&g||{"default":g}).addClass;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu");q=(e=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),e&&e.__esModule&&e||{"default":e});var w=q.clone,z=q.extend;e=(n=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n});var x=e.arrayFilter,C=e.arrayMap,E=e.arrayEach;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string");var A=(m=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),m&&m.__esModule&&m||{"default":m}).isKey,B=(a=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),a&&a.__esModule&&a||{"default":a}).partial,G=(b=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),b&&b.__esModule&&b||{"default":b}).stopImmediatePropagation,D=(f=p("input"),f&&f.__esModule&&f||{"default":f}).InputUI,F=(t=p("utils"),t&&t.__esModule&&t||{"default":t}).createArrayAssertion,H=new WeakMap,J=function(a,b){H.set(this,{});$traceurRuntime.superConstructor(K).call(this,a,z(K.DEFAULTS,b));this.searchInput=new D(this.hot,{placeholder:"\u67e5\u627e...",className:"htUIMultipleSelectSearch"});this.selectAllUI=new v(this.hot,{tagName:"a",textContent:"\u5168\u9009",href:"#",className:"htUISelectAll"});this.clearAllUI=new v(this.hot,{tagName:"a",textContent:"\u6e05\u9664",href:"#",className:"htUIClearAll"});this.items=[];this.itemsBox=null;this.registerHooks()},K=J;$traceurRuntime.createClass(J,{registerHooks:function(){var a=this;this.searchInput.addLocalHook("keydown",function(b){return a.onInputKeyDown(b)});this.searchInput.addLocalHook("input",function(b){return a.onInput(b)});this.selectAllUI.addLocalHook("click",function(b){return a.onSelectAllClick(b)});this.clearAllUI.addLocalHook("click",function(b){return a.onClearAllClick(b)})},setItems:function(a){this.items=a;this.itemsBox&&this.itemsBox.loadData(this.items)},getItems:function(){return $traceurRuntime.spread(this.items)},getValue:function(){return d(this.items)},isSelectedAllValues:function(){return this.items.length===this.getValue().length},build:function(){var a=this;$traceurRuntime.superGet(this,K.prototype,"build").call(this);var b=document.createElement("div"),e=new v(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element);this._element.appendChild(e.element);this._element.appendChild(b);var f=function(b){a._element&&(a.itemsBox&&a.itemsBox.destroy(),y(b,"htUIMultipleSelectHot"),a.itemsBox=new u(b,{data:a.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],autoWrapCol:!0,colWidths:150,height:110,width:168,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(b){return a.onItemsBoxBeforeKeyDown(b)}}))};f(b);setTimeout(function(){return f(b)},100)},reset:function(){this.searchInput.reset()},update:function(){this.isBuilt()&&(this.itemsBox.loadData(k(this.items,this.options.value)),$traceurRuntime.superGet(this,K.prototype,"update").call(this))},destroy:function(){this.itemsBox&&this.itemsBox.destroy();this.items=this.searchInput=this.itemsBox=null;$traceurRuntime.superGet(this,K.prototype,"destroy").call(this)},onInput:function(a){var b=a.target.value.toLowerCase();a=""===b?$traceurRuntime.spread(this.items):x(this.items,function(a){return 0<=(a.value+"").toLowerCase().indexOf(b)});this.itemsBox.loadData(a)},onInputKeyDown:function(a){this.runLocalHooks("keydown",a,this);B(A,a.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(G(a),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))},onItemsBoxBeforeKeyDown:function(a){var b=B(A,a.keyCode);b("ESCAPE")&&this.runLocalHooks("keydown",a,this);b("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(G(a),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())},onSelectAllClick:function(a){a.preventDefault();E(this.itemsBox.getSourceData(),function(a){a.checked=!0});this.itemsBox.render()},onClearAllClick:function(a){a.preventDefault();E(this.itemsBox.getSourceData(),function(a){a.checked=!1});this.itemsBox.render()}},{get DEFAULTS(){return w({className:"htUIMultipleSelect",value:[]})}},v)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../browser":141,_base:186,input:187,utils:190}],189:[function(p,q,r){Object.defineProperties(r,{SelectUI:{get:function(){return u}},__esModule:{value:!0}});var k,d,h,l,g,e=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element");var n=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),d&&d.__esModule&&d||{"default":d}).Menu;q=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{"default":h});var m=q.clone,a=q.extend,b=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach,f=(g=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),g&&g.__esModule&&g||{"default":g}).SEPARATOR,t=new WeakMap,u=function(b,e){t.set(this,{});$traceurRuntime.superConstructor(v).call(this,b,a(v.DEFAULTS,e));this.menu=null;this.items=[];this.registerHooks()},v=u;$traceurRuntime.createClass(u,{registerHooks:function(){var a=this;this.addLocalHook("click",function(b){return a.onClick(b)})},setItems:function(a){this.items=a;this.menu&&this.menu.setMenuItems(this.items)},build:function(){var a=this;$traceurRuntime.superGet(this,v.prototype,"build").call(this);this.menu=new n(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0});this.menu.setMenuItems(this.items);var f=new e(this.hot,{className:"htUISelectCaption"}),d=new e(this.hot,{className:"htUISelectDropdown"});t.get(this).caption=f.element;b([f,d],function(b){return a._element.appendChild(b.element)});this.menu.addLocalHook("select",function(b){return a.onMenuSelect(b)});this.update()},update:function(){this.isBuilt()&&(t.get(this).caption.textContent=this.options.value?this.options.value.name:"None",$traceurRuntime.superGet(this,v.prototype,"update").call(this))},openOptions:function(){var a=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:a.left-5,top:a.top,width:a.width,height:a.height}))},closeOptions:function(){this.menu&&this.menu.close()},onMenuSelect:function(a){a.name!==f&&(this.options.value=a,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))},onClick:function(a){this.openOptions()},destroy:function(){this.menu&&(this.menu.destroy(),this.menu=null);$traceurRuntime.superGet(this,v.prototype,"destroy").call(this)}},{get DEFAULTS(){return m({className:"htUISelect",wrapIt:!1})}},e)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,_base:186}],190:[function(p,q,r){function k(a,b){return"number"===typeof a&&"number"===typeof b?a-b:f(a,b)}function d(a){""===a&&(a="(\u7a7a)");return a}function h(a){t&&(a=new Set(a));return function(b){return t?a.has(b):!!~a.indexOf(b)}}function l(a){return null==a?"":a}function g(b){b=u?Array.from(new Set(b)):a(b);return b=b.sort(function(a,b){return"number"===typeof a&&"number"===typeof b?a-b:a===b?0:a>b?1:-1})}function e(a,e,f){var g=[],m=a===e,n;m||(n=h(e));b(a,function(a){var b=!1;if(m||n(a))b=!0;a={checked:b,value:a,visualValue:d(a)};f&&f(a);g.push(a)});return g}Object.defineProperties(r,{sortComparison:{get:function(){return k}},toVisualValue:{get:function(){return d}},createArrayAssertion:{get:function(){return h}},toEmptyString:{get:function(){return l}},unifyColumnValues:{get:function(){return g}},intersectValues:{get:function(){return e}},__esModule:{value:!0}});var n,m;q=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature"),n&&n.__esModule&&n||{"default":n}).getComparisonFunction;p=(m=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),m&&m.__esModule&&m||{"default":m});var a=p.arrayUnique,b=p.arrayEach,f=q(),t=(new Set([1])).has(1),u=t&&"function"===typeof Array.from},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature":49}],191:[function(p,q,r){function k(b,e){a.has(b)||a.set(b,{prepare:e.prepare||f,operate:e.operate||f})}Object.defineProperties(r,{AlterManager:{get:function(){return b}},registerOperation:{get:function(){return k}},__esModule:{value:!0}});var d,h,l,g,e,n,m;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");q=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).mixin;d=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),h&&h.__esModule&&h||{"default":h}).localHooks;h=(l=p("alterOperation/columnSorting"),l&&l.__esModule&&l||{"default":l});l=(g=p("alterOperation/insertColumn"),g&&g.__esModule&&g||{"default":g});g=(e=p("alterOperation/insertRow"),e&&e.__esModule&&e||{"default":e});e=(n=p("alterOperation/removeColumn"),n&&n.__esModule&&n||{"default":n});p=(m=p("alterOperation/removeRow"),m&&m.__esModule&&m||{"default":m});var a=new Map;k(h.OPERATION_NAME,h);k(l.OPERATION_NAME,l);k(g.OPERATION_NAME,g);k(e.OPERATION_NAME,e);k(p.OPERATION_NAME,p);var b=function(a){this.sheet=a;this.hot=a.hot;this.dataProvider=a.dataProvider;this.matrix=a.matrix};$traceurRuntime.createClass(b,{prepareAlter:function(b){for(var e=[],f=1;f<arguments.length;f++)e[f-1]=arguments[f];if(!a.has(b))throw Error('Alter operation "'+b+'" not exist.');a.get(b).prepare.apply(this,e)},triggerAlter:function(b){for(var e=[],f=1;f<arguments.length;f++)e[f-1]=arguments[f];if(!a.has(b))throw Error('Alter operation "'+b+'" not exist.');a.get(b).operate.apply(this,e);this.runLocalHooks.apply(this,$traceurRuntime.spread(["afterAlter"],e))},destroy:function(){this.matrix=this.dataProvider=this.hot=this.sheet=null}},{});q(b,d);var f=function(){}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"alterOperation/columnSorting":192,"alterOperation/insertColumn":193,"alterOperation/insertRow":194,"alterOperation/removeColumn":195,"alterOperation/removeRow":196}],192:[function(p,q,r){function k(){var a=this.matrix,b=this.dataProvider;t=new WeakMap;n(a.data,function(a){t.set(a,b.t.toVisualRow(a.row))})}function d(){var e=this.matrix,f=this.dataProvider;e.cellReferences.length=0;n(e.data,function(e){e.setState(a.STATE_OUT_OFF_DATE);e.clearPrecedents();var d=e.row,g=e.column,h=f.getSourceDataAtCell(d,g);m(h)&&(e=t.get(e),h=new b(h),h.translate({row:f.t.toVisualRow(d)-e}),f.updateSourceData(d,g,h.toString()))});t=null}Object.defineProperties(r,{OPERATION_NAME:{get:function(){return f}},prepare:{get:function(){return k}},operate:{get:function(){return d}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,m=(l=p("utils"),l&&l.__esModule&&l||{"default":l}).isFormulaExpression,a=(g=p("cell/value"),g&&g.__esModule&&g||{"default":g}).CellValue,b=(e=p("expressionModifier"),e&&e.__esModule&&e||{"default":e}).ExpressionModifier,f="column_sorting",t},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],193:[function(p,q,r){function k(e,g,h){var l=void 0!==h?h:!0;h=this.matrix;var k=this.dataProvider,t=[0,g];n(h.cellReferences,function(a){a.column>=e&&a.translateTo.apply(a,$traceurRuntime.spread(t))});n(h.data,function(h){var n=h.row,u=h.column;h.column>=e&&(h.translateTo.apply(h,$traceurRuntime.spread(t)),h.setState(b.STATE_OUT_OFF_DATE));if(l){var p=h.row;h=h.column;var v=k.getSourceDataAtCell(p,h);if(a(v)){var x=m("column",e),v=new f(v);v.useCustomModifier(d);v.translate({column:g},x({row:n,column:u}));k.updateSourceData(p,h,v.toString())}}})}function d(a,b,e,f){var d=a.end[b].index,g=e;f>a.start[b].index&&(g=0);f>d&&(e=0);return[g,e,!1]}Object.defineProperties(r,{OPERATION_NAME:{get:function(){return t}},operate:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;q=(l=p("utils"),l&&l.__esModule&&l||{"default":l});var m=q.cellCoordFactory,a=q.isFormulaExpression,b=(g=p("cell/value"),g&&g.__esModule&&g||{"default":g}).CellValue,f=(e=p("expressionModifier"),e&&e.__esModule&&e||{"default":e}).ExpressionModifier,t="insert_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],194:[function(p,q,r){function k(e,g,h){var l=void 0!==h?h:!0;h=this.matrix;var k=this.dataProvider,t=[g,0];n(h.cellReferences,function(a){a.row>=e&&a.translateTo.apply(a,$traceurRuntime.spread(t))});n(h.data,function(h){var n=h.row,u=h.column;h.row>=e&&(h.translateTo.apply(h,$traceurRuntime.spread(t)),h.setState(b.STATE_OUT_OFF_DATE));if(l){var p=h.row;h=h.column;var v=k.getSourceDataAtCell(p,h);if(a(v)){var x=m("row",e),v=new f(v);v.useCustomModifier(d);v.translate({row:g},x({row:n,column:u}));k.updateSourceData(p,h,v.toString())}}})}function d(a,b,e,f){var d=a.end[b].index,g=e;f>a.start[b].index&&(g=0);f>d&&(e=0);return[g,e,!1]}Object.defineProperties(r,{OPERATION_NAME:{get:function(){return t}},operate:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;q=(l=p("utils"),l&&l.__esModule&&l||{"default":l});var m=q.cellCoordFactory,a=q.isFormulaExpression,b=(g=p("cell/value"),g&&g.__esModule&&g||{"default":g}).CellValue,f=(e=p("expressionModifier"),e&&e.__esModule&&e||{"default":e}).ExpressionModifier,t="insert_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],195:[function(p,q,r){function k(e,g,h){var l=void 0!==h?h:!0;g=-g;h=this.matrix;var k=this.dataProvider,t=this.sheet,u=[0,g],p=Math.abs(g)-1,v=h.removeCellRefsAtRange({column:e},{column:e+p}),y=[];n(h.data,function(a){n(v,function(e){a.hasPrecedent(e)&&(a.removePrecedent(e),a.setState(b.STATE_OUT_OFF_DATE),n(t.getCellDependencies(a.row,a.column),function(a){a.setState(b.STATE_OUT_OFF_DATE)}))});a.column>=e&&a.column<=e+p&&y.push(a)});h.remove(y);n(h.cellReferences,function(a){a.column>=e&&a.translateTo.apply(a,$traceurRuntime.spread(u))});n(h.data,function(h){var n=h.row,t=h.column;h.column>=e&&(h.translateTo.apply(h,$traceurRuntime.spread(u)),h.setState(b.STATE_OUT_OFF_DATE));if(l){var p=h.row;h=h.column;var v=k.getSourceDataAtCell(p,h);if(a(v)){var x=m("column",e),v=new f(v);v.useCustomModifier(d);v.translate({column:g},x({row:n,column:t}));k.updateSourceData(p,h,v.toString())}}})}function d(a,b,e,f){var d=a.type,g=a.start[b].index;a=a.end[b].index;b=Math.abs(e)-1;var m=e,h=!1;g>=f&&a<=f+b&&(h=!0);!h&&"cell"===d&&f>=g&&(e=m=0);h||"range"!==d||(f>=g&&(m=0),f>a?e=0:a<=f+b&&(e-=Math.min(a-(f+b),0)));0>g+m&&(m-=g+m);return[m,e,h]}Object.defineProperties(r,{OPERATION_NAME:{get:function(){return t}},operate:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;q=(l=p("utils"),l&&l.__esModule&&l||{"default":l});var m=q.cellCoordFactory,a=q.isFormulaExpression,b=(g=p("cell/value"),g&&g.__esModule&&g||{"default":g}).CellValue,f=(e=p("expressionModifier"),e&&e.__esModule&&e||{"default":e}).ExpressionModifier,t="remove_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],196:[function(p,q,r){function k(e,g,h){var l=void 0!==h?h:!0;g=-g;h=this.matrix;var k=this.dataProvider,t=this.sheet,u=[g,0],p=Math.abs(g)-1,v=h.removeCellRefsAtRange({row:e},{row:e+p}),y=[];n(h.data,function(a){n(v,function(e){a.hasPrecedent(e)&&(a.removePrecedent(e),a.setState(b.STATE_OUT_OFF_DATE),n(t.getCellDependencies(a.row,a.column),function(a){a.setState(b.STATE_OUT_OFF_DATE)}))});a.row>=e&&a.row<=e+p&&y.push(a)});h.remove(y);n(h.cellReferences,function(a){a.row>=e&&a.translateTo.apply(a,$traceurRuntime.spread(u))});n(h.data,function(h){var n=h.row,t=h.column;h.row>=e&&(h.translateTo.apply(h,$traceurRuntime.spread(u)),h.setState(b.STATE_OUT_OFF_DATE));if(l){var p=h.row;h=h.column;var v=k.getSourceDataAtCell(p,h);if(a(v)){var x=m("row",e),v=new f(v);v.useCustomModifier(d);v.translate({row:g},x({row:n,column:t}));k.updateSourceData(p,h,v.toString())}}})}function d(a,b,e,f){var d=a.type,g=a.start[b].index;a=a.end[b].index;b=Math.abs(e)-1;var m=e,h=!1;g>=f&&a<=f+b&&(h=!0);!h&&"cell"===d&&f>=g&&(e=m=0);h||"range"!==d||(f>=g&&(m=0),f>a?e=0:a<=f+b&&(e-=Math.min(a-(f+b),0)));0>g+m&&(m-=g+m);return[m,e,h]}Object.defineProperties(r,{OPERATION_NAME:{get:function(){return t}},operate:{get:function(){return k}},__esModule:{value:!0}});var h,l,g,e,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach;q=(l=p("utils"),l&&l.__esModule&&l||{"default":l});var m=q.cellCoordFactory,a=q.isFormulaExpression,b=(g=p("cell/value"),g&&g.__esModule&&g||{"default":g}).CellValue,f=(e=p("expressionModifier"),e&&e.__esModule&&e||{"default":e}).ExpressionModifier,t="remove_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],197:[function(p,q,r){Object.defineProperties(r,{BaseCell:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k}).isObject,l=(d=p("hot-formula-parser"),d&&d.__esModule&&d||{"default":d}).toLabel,g=function(e,d){var g=h(e),a=h(d);this._row=g?e.index:e;this.rowAbsolute=g?e.isAbsolute:!0;this._column=a?d.index:d;this.columnAbsolute=a?d.isAbsolute:!0;this.columnOffset=this.rowOffset=0;Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(a){this._row=a},enumerable:!0,configurable:!0});Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(a){this._column=a},enumerable:!0,configurable:!0})};$traceurRuntime.createClass(g,{translateTo:function(e,d){this.row+=e;this.column+=d},isEqual:function(e){return e.row===this.row&&e.column===this.column},toString:function(){return l({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"hot-formula-parser":"hot-formula-parser"}],198:[function(p,q,r){Object.defineProperties(r,{CellReference:{get:function(){return l}},__esModule:{value:!0}});var k,d;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseCell;var h=(d=p("hot-formula-parser"),d&&d.__esModule&&d||{"default":d}).toLabel,l=function(e,d){$traceurRuntime.superConstructor(g).call(this,e,d)},g=l;$traceurRuntime.createClass(l,{toString:function(){return h({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}},{},q)},{_base:197,"hot-formula-parser":"hot-formula-parser"}],199:[function(p,q,r){Object.defineProperties(r,{CellValue:{get:function(){return n}},__esModule:{value:!0}});var k,d,h;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseCell;var l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayFilter,g=(h=p("hot-formula-parser"),h&&h.__esModule&&h||{"default":h}).ERROR_REF,e=[1,2,3],n=function(a,b){$traceurRuntime.superConstructor(m).call(this,a,b);this.precedents=[];this.error=this.value=null;this.state=m.STATE_UP_TO_DATE},m=n;$traceurRuntime.createClass(n,{setValue:function(a){this.value=a},getValue:function(){return this.value},setError:function(a){this.error=a},getError:function(){return this.error},hasError:function(){return null!==this.error},setState:function(a){if(-1===e.indexOf(a))throw Error("Unrecognized state: "+a);this.state=a},isState:function(a){return this.state===a},addPrecedent:function(a){if(this.isEqual(a))throw Error(g);this.hasPrecedent(a)||this.precedents.push(a)},removePrecedent:function(a){if(this.isEqual(a))throw Error(g);this.precedents=l(this.precedents,function(b){return!b.isEqual(a)})},clearPrecedents:function(){this.precedents.length=0},getPrecedents:function(){return this.precedents},hasPrecedents:function(){return 0<this.precedents.length},hasPrecedent:function(a){return l(this.precedents,function(b){return b.isEqual(a)}).length?!0:!1}},{get STATE_OUT_OFF_DATE(){return 1},get STATE_COMPUTING(){return 2},get STATE_UP_TO_DATE(){return 3}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,_base:197,"hot-formula-parser":"hot-formula-parser"}],200:[function(p,q,r){Object.defineProperties(r,{DataProvider:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number");var g=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),d&&d.__esModule&&d||{"default":d}).getTranslator,e=(h=p("utils"),h&&h.__esModule&&h||{"default":h}).isFormulaExpression,n=function(e){this.hot=e;this.changes={};this.t=g(this.hot)};$traceurRuntime.createClass(n,{collectChanges:function(d,a,b){e(b)||(this.changes[this._coordId(d,a)]=b)},clearChanges:function(){this.changes={}},isInDataRange:function(e,a){return 0<=e&&e<this.hot.countRows()&&0<=a&&a<this.hot.countCols()},getDataAtCell:function(e,a){var b=this._coordId.apply(this,$traceurRuntime.spread(this.t.toPhysical(e,a)));return this.changes.hasOwnProperty(b)?this.changes[b]:this.hot.getDataAtCell(e,a)},getDataByRange:function(e,a,b,f){var d=this,g=this.hot.getData(e,a,b,f);l(g,function(b,f){l(b,function(b,m){var h=d._coordId.apply(d,$traceurRuntime.spread(d.t.toPhysical(f+e,m+a)));d.changes.hasOwnProperty(h)&&(g[f][m]=d.changes[h])})});return g},getSourceDataAtCell:function(e,a){return this.hot.getSourceDataAtCell(e,a)},getRawDataAtCell:function(e,a){return this.getSourceDataAtCell.apply(this,$traceurRuntime.spread(this.t.toPhysical(e,a)))},getSourceDataByRange:function(e,a,b,f){return this.hot.getSourceDataArray(e,a,b,f)},getRawDataByRange:function(e,a,b,f){e=$traceurRuntime.spread(this.t.toPhysical(e,a),this.t.toPhysical(b,f));return this.getSourceDataByRange.apply(this,$traceurRuntime.spread(e))},updateSourceData:function(e,a,b){this.hot.getSourceData()[e][this.hot.colToProp(a)]=b},_coordId:function(e,a){return e+":"+a},destroy:function(){this.t=this.changes=this.hot=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,utils:206}],201:[function(p,q,r){Object.defineProperties(r,{ExpressionModifier:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("../../browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d});var m=k.arrayEach,a=k.arrayFilter,b=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),h&&h.__esModule&&h||{"default":h}).startsWith;d=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),l&&l.__esModule&&l||{"default":l}).mixin;l=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),g&&g.__esModule&&g||{"default":g}).localHooks;var f=(e=p("utils"),e&&e.__esModule&&e||{"default":e}).toUpperCaseFormula;p=(n=p("hot-formula-parser"),n&&n.__esModule&&n||{"default":n});var t=p.toLabel,u=p.extractLabel,v=p.error,y=p.ERROR_REF,w=/^\$?[A-Z]+\$?\d+$/,z=/\$?[A-Z]+\$?\d+/,x=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,C=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,E=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,A=function(a){this.expression="";this.cells=[];this.customModifier=null;"string"===typeof a&&this.setExpression(a)};$traceurRuntime.createClass(A,{setExpression:function(a){this.cells.length=0;this.expression=f(a);this._extractCells();this._extractCellsRange();return this},useCustomModifier:function(a){this.customModifier=a},translate:function(a,b){var e=a.row,f=a.column,d=void 0!==b?b:{},g=this;m(this.cells,function(a){null!=e&&g._translateCell(a,"row",e,d.row);null!=f&&g._translateCell(a,"column",f,d.column)});return this},toString:function(){var a=this,e=this.expression.replace(E,function(b,e,f){var d=-1===b.indexOf(":"),g=b,m=b;d&&(m=w.test(e)?e:f);if(e=a._searchCell(m))g=e.refError?v(y):e.toLabel(),g=d?b.replace(m,g):g;return g});b(e,"\x3d")||(e="\x3d"+e);return e},_translateCell:function(a,b,e,f){var d=a.start,g=a.end,m=d[b].index,h=g[b].index,n=e,l=e,k=!1;this.customModifier?(e=this.customModifier(a,b,e,f),n=e[0],l=e[1],k=e[2],e):(d[b].isAbsolute&&(n=0),g[b].isAbsolute&&(l=0));n&&!k&&(0>m+n&&(k=!0),d[b].index=Math.max(m+n,0));l&&!k&&(0>h+l&&(k=!0),g[b].index=Math.max(h+l,0));k&&(a.refError=!0)},_extractCells:function(){var a=this,b=this.expression.match(x);b&&m(b,function(b){if(b=b.match(z)){var e=u(b[0]),f=e[0],e=e[1];a.cells.push(a._createCell({row:f,column:e},{row:f,column:e},b[0]))}})},_extractCellsRange:function(){var a=this,b=this.expression.match(C);b&&m(b,function(b){var e=b.split(":"),f=e[1],d=u(e[0]),e=d[0],d=d[1],f=u(f);a.cells.push(a._createCell({row:e,column:d},{row:f[0],column:f[1]},b))})},_searchCell:function(b){return a(this.cells,function(a){return a.origLabel===b})[0]||null},_createCell:function(a,b,e){return{start:a,end:b,origLabel:e,type:-1===e.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var a=t(this.start.row,this.start.column);"range"===this.type&&(a+=":"+t(this.end.row,this.end.column));return a}}}},{});d(A,l);q.utils.FormulasUtils=q.utils.FormulasUtils||{};q.utils.FormulasUtils.ExpressionModifier=A},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../browser":141,"hot-formula-parser":"hot-formula-parser",utils:206}],202:[function(p,q,r){Object.defineProperties(r,{Formulas:{get:function(){return A}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];var b=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach;k=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{"default":h});var f=k.isObject,t=k.objectEach,u=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;h=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;g=(e=p("utils"),e&&e.__esModule&&e||{"default":e});var v=g.isFormulaExpression,y=g.toUpperCaseFormula,w=g.isFormulaExpressionEscaped,z=g.unescapeFormulaExpression,x=(n=p("sheet"),n&&n.__esModule&&n||{"default":n}).Sheet,C=(m=p("dataProvider"),m&&m.__esModule&&m||{"default":m}).DataProvider,E=(a=p("undoRedoSnapshot"),a&&a.__esModule&&a||{"default":a}).UndoRedoSnapshot,A=function(a){$traceurRuntime.superConstructor(B).call(this,a);this.eventManager=new u(this);this.dataProvider=new C(this.hot);this.sheet=new x(this.hot,this.dataProvider);this.undoRedoSnapshot=new E(this.sheet);this._skipRendering=!1},B=A;$traceurRuntime.createClass(A,{isEnabled:function(){return this.hot.getSettings().formulas?!0:!1},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().formulas;f(b)&&f(b.variables)&&t(b.variables,function(b,e){return a.setVariable(e,b)});this.addHook("afterColumnSort",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterColumnSort.apply(a,$traceurRuntime.spread(b))});this.addHook("afterCreateCol",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterCreateCol.apply(a,$traceurRuntime.spread(b))});this.addHook("afterCreateRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterCreateRow.apply(a,$traceurRuntime.spread(b))});this.addHook("afterLoadData",function(){return a.onAfterLoadData()});this.addHook("afterRemoveCol",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterRemoveCol.apply(a,$traceurRuntime.spread(b))});this.addHook("afterRemoveRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterRemoveRow.apply(a,$traceurRuntime.spread(b))});this.addHook("afterSetDataAtCell",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterSetDataAtCell.apply(a,$traceurRuntime.spread(b))});this.addHook("afterSetDataAtRowProp",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterSetDataAtCell.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeColumnSort",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeColumnSort.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeCreateCol",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeCreateCol.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeCreateRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeCreateRow.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeRemoveCol",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeRemoveCol.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeRemoveRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeRemoveRow.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeValidate",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeValidate.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeValueRender",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeValueRender.apply(a,$traceurRuntime.spread(b))});this.addHook("modifyData",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onModifyData.apply(a,$traceurRuntime.spread(b))});this.sheet.addLocalHook("afterRecalculate",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onSheetAfterRecalculate.apply(a,$traceurRuntime.spread(b))});$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},getCellValue:function(a,b){var e=this.sheet.getCellAt(a,b);return e?e.getError()||e.getValue():void 0},hasComputedCellValue:function(a,b){return this.sheet.getCellAt(a,b)?!0:!1},recalculate:function(){this.sheet.recalculate()},recalculateFull:function(){this.sheet.recalculateFull()},recalculateOptimized:function(){this.sheet.recalculateOptimized()},setVariable:function(a,b){this.sheet.setVariable(a,b)},getVariable:function(a){return this.sheet.getVariable(a)},onSheetAfterRecalculate:function(a,e){if(this._skipRendering)this._skipRendering=!1;else{var f=this.hot;b(a,function(a){var b=a.row;a=a.column;f.validateCell(f.getDataAtCell(b,a),f.getCellMeta(b,a),function(){})});f.render()}},onModifyData:function(a,b,e,f){"get"===f&&this.hasComputedCellValue(a,b)?e.value=this.getCellValue(a,b):"set"===f&&v(e.value)&&(e.value=y(e.value))},onBeforeValueRender:function(a){w(a)&&(a=z(a));return a},onBeforeValidate:function(a,b,e,f){e=this.hot.propToCol(e);this.hasComputedCellValue(b,e)&&(a=this.getCellValue(b,e));return a},onAfterSetDataAtCell:function(a,e){var f=this;"loadData"!==e&&(this.dataProvider.clearChanges(),b(a,function(a){var b=a[0],e=a[1],d=a[2];a=a[3];e=f.hot.propToCol(e);b=f.t.toPhysicalRow(b);v(a)&&(a=y(a));f.dataProvider.collectChanges(b,e,a);d!==a&&f.sheet.applyChanges(b,e,a)}),this.recalculate())},onBeforeCreateRow:function(a,b,e){"UndoRedo.undo"===e&&this.undoRedoSnapshot.restore()},onAfterCreateRow:function(a,b,e){this.sheet.alterManager.triggerAlter("insert_row",a,b,"UndoRedo.undo"!==e)},onBeforeRemoveRow:function(a,b){this.undoRedoSnapshot.save("row",a,b)},onAfterRemoveRow:function(a,b){this.sheet.alterManager.triggerAlter("remove_row",a,b)},onBeforeCreateCol:function(a,b,e){"UndoRedo.undo"===e&&this.undoRedoSnapshot.restore()},onAfterCreateCol:function(a,b,e){this.sheet.alterManager.triggerAlter("insert_column",a,b,"UndoRedo.undo"!==e)},onBeforeRemoveCol:function(a,b){this.undoRedoSnapshot.save("column",a,b)},onAfterRemoveCol:function(a,b){this.sheet.alterManager.triggerAlter("remove_column",a,b)},onBeforeColumnSort:function(a,b){this.sheet.alterManager.prepareAlter("column_sorting",a,b)},onAfterColumnSort:function(a,b){this.sheet.alterManager.triggerAlter("column_sorting",a,b)},onAfterLoadData:function(){this._skipRendering=!0;this.recalculateFull()},destroy:function(){this.dataProvider.destroy();this.dataProvider=null;this.sheet.destroy();this.sheet=null;$traceurRuntime.superGet(this,B.prototype,"destroy").call(this)}},{},q);h("formulas",A)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:200,sheet:204,undoRedoSnapshot:205,utils:206}],203:[function(p,q,r){Object.defineProperties(r,{Matrix:{get:function(){return n}},__esModule:{value:!0}});var k,d;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k});var h=q.arrayEach,l=q.arrayFilter,g=q.arrayReduce,e=(d=p("cell/value"),d&&d.__esModule&&d||{"default":d}).CellValue,n=function(e){this.t=e;this.data=[];this.cellReferences=[]};$traceurRuntime.createClass(n,{getCellAt:function(e,a){var b=null;h(this.data,function(f){if(f.row===e&&f.column===a)return b=f,!1});return b},getOutOfDateCells:function(){return l(this.data,function(d){return d.isState(e.STATE_OUT_OFF_DATE)})},add:function(e){l(this.data,function(a){return a.isEqual(e)}).length||this.data.push(e)},remove:function(e){var a=Array.isArray(e),b=function(b,e){var f=!1;a?h(e,function(a){if(b.isEqual(a))return f=!0,!1}):f=b.isEqual(e);return f};this.data=l(this.data,function(a){return!b(a,e)})},getDependencies:function(e){var a=this,b=function(b){return g(a.data,function(a,e){e.hasPrecedent(b)&&-1===a.indexOf(e)&&a.push(e);return a},[])},f=function(e){var d=b(e);d.length&&h(d,function(b){b.hasPrecedents()&&(d=d.concat(f(a.t.toVisual(b))))});return d};return f(e)},registerCellRef:function(e){l(this.cellReferences,function(a){return a.isEqual(e)}).length||this.cellReferences.push(e)},removeCellRefsAtRange:function(e,a){var b=e.row,f=e.column,d=a.row,g=a.column,m=[];this.cellReferences=l(this.cellReferences,function(a){return(void 0===b||a.row>=b&&a.row<=d)&&(void 0===f||a.column>=f&&a.column<=g)?(m.push(a),!1):!0});return m},reset:function(){this.data.length=0;this.cellReferences.length=0}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199}],204:[function(p,q,r){Object.defineProperties(r,{Sheet:{get:function(){return G}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m,a,b,f,t=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach,u=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach,v=(h=p("cell/value"),h&&h.__esModule&&h||{"default":h}).CellValue,y=(l=p("cell/reference"),l&&l.__esModule&&l||{"default":l}).CellReference;q=(g=p("utils"),g&&g.__esModule&&g||{"default":g});var w=q.isFormulaExpression,z=q.toUpperCaseFormula,x=(e=p("matrix"),e&&e.__esModule&&e||{"default":e}).Matrix,C=(n=p("alterManager"),n&&n.__esModule&&n||{"default":n}).AlterManager;g=(m=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),m&&m.__esModule&&m||{"default":m}).localHooks;var E=(a=p("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),a&&a.__esModule&&a||{"default":a}).getTranslator;m=(b=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),b&&b.__esModule&&b||{"default":b}).mixin;p=(f=p("hot-formula-parser"),f&&f.__esModule&&f||{"default":f});var A=p.Parser,B=p.ERROR_REF,G=function(a,b){var e=this;this.hot=a;this.t=E(this.hot);this.dataProvider=b;this.parser=new A;this.matrix=new x(this.t);this.alterManager=new C(this);this._processingCell=null;this._state=3;this.parser.on("callCellValue",function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return e._onCallCellValue.apply(e,$traceurRuntime.spread(a))});this.parser.on("callRangeValue",function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return e._onCallRangeValue.apply(e,$traceurRuntime.spread(a))});this.alterManager.addLocalHook("afterAlter",function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return e._onAfterAlter.apply(e,$traceurRuntime.spread(a))})};$traceurRuntime.createClass(G,{recalculate:function(){switch(this._state){case 3:this.recalculateFull();break;case 2:this.recalculateOptimized()}},recalculateOptimized:function(){var a=this,b=this.matrix.getOutOfDateCells();t(b,function(b){var e=a.dataProvider.getSourceDataAtCell(b.row,b.column);w(e)&&a.parseExpression(b,e.substr(1))});this._state=1;this.runLocalHooks("afterRecalculate",b,"optimized")},recalculateFull:function(){var a=this,b=this.dataProvider.getSourceDataByRange();this.matrix.reset();t(b,function(b,e){t(b,function(b,f){w(b)&&a.parseExpression(new v(e,f),b.substr(1))})});this._state=1;this.runLocalHooks("afterRecalculate",b,"full")},setVariable:function(a,b){this.parser.setVariable(a,b)},getVariable:function(a){return this.parser.getVariable(a)},applyChanges:function(a,b,e){this.matrix.remove({row:a,column:b});w(e)&&this.parseExpression(new v(a,b),e.substr(1));a=this.getCellDependencies.apply(this,$traceurRuntime.spread(this.t.toVisual(a,b)));t(a,function(a){a.setState(v.STATE_OUT_OFF_DATE)});this._state=2},parseExpression:function(a,b){a.setState(v.STATE_COMPUTING);this._processingCell=a;var e=this.parser.parse(z(b)),f=e.error;a.setValue(e.result);a.setError(f);a.setState(v.STATE_UP_TO_DATE);this.matrix.add(a);this._processingCell=null},getCellAt:function(a,b){return this.matrix.getCellAt(a,b)},getCellDependencies:function(a,b){return this.matrix.getDependencies({row:a,column:b})},_onCallCellValue:function(a,b){var e=a.row,f=a.column,d=new y(e,f);if(!this.dataProvider.isInDataRange(d.row,d.column))throw Error(B);this.matrix.registerCellRef(d);this._processingCell.addPrecedent(d);b(this.dataProvider.getDataAtCell(e.index,f.index))},_onCallRangeValue:function(a,b,e){var f=a.row,d=a.column;a=b.row;var g=b.column,m=this;u(f.index,a.index,function(a){u(d.index,g.index,function(b){b=new y(a,b);m.matrix.registerCellRef(b);m._processingCell.addPrecedent(b)})});e(this.dataProvider.getDataByRange(f.index,d.index,a.index,g.index))},_onAfterAlter:function(){this.recalculateOptimized()},destroy:function(){this.t=this.hot=null;this.dataProvider.destroy();this.dataProvider=null;this.alterManager.destroy();this.parser=this.alterManager=null;this.matrix.reset();this.matrix=null}},{});m(G,g)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,alterManager:191,"cell/reference":198,"cell/value":199,"hot-formula-parser":"hot-formula-parser",matrix:203,utils:206}],205:[function(p,q,r){Object.defineProperties(r,{UndoRedoSnapshot:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number");var g=(d=p("cell/value"),d&&d.__esModule&&d||{"default":d}).CellValue,e=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack"),h&&h.__esModule&&h||{"default":h}).Stack,n=function(d){this.sheet=d;this.stack=new e};$traceurRuntime.createClass(n,{save:function(e,a,b){var f=this.sheet,d=f.dataProvider,g=[];l(f.matrix.data,function(f){var m=f.row,h=f.column;if(f[e]<a||f[e]>a+(b-1))f=d.getSourceDataAtCell(m,h),g.push({row:m,column:h,value:f})});this.stack.push({axis:e,index:a,amount:b,changes:g})},restore:function(){var e=this.sheet,a=e.matrix,b=e.dataProvider,e=this.stack.pop(),f=e.axis,d=e.index,h=e.amount;(e=e.changes)&&l(e,function(e){e[f]>d+(h-1)&&(e[f]-=h);var m=e.row,n=e.column;e=e.value;b.getSourceDataAtCell(m,n)!==e&&(b.updateSourceData(m,n,e),a.getCellAt(m,n).setState(g.STATE_OUT_OFF_DATE))})},destroy:function(){this.stack=this.sheet=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack":129,"cell/value":199}],206:[function(p,q,r){function k(e){return(e+="")&&2<=e.length&&"\x3d"===e.charAt(0)?!0:!1}function d(e){return e&&"'"===(e+"").charAt(0)&&"\x3d"===(e+"").charAt(1)?!0:!1}function h(e){return d(e)?e.substr(1):e}function l(e){var d=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,a=e.match(d)||[],b=-1;return e.toUpperCase().replace(d,function(){++b;return a[b]})}function g(e,d){return function(a){return{row:"row"===e?d:a.row,column:"column"===e?d:a.column}}}Object.defineProperties(r,{isFormulaExpression:{get:function(){return k}},isFormulaExpressionEscaped:{get:function(){return d}},unescapeFormulaExpression:{get:function(){return h}},toUpperCaseFormula:{get:function(){return l}},cellCoordFactory:{get:function(){return g}},__esModule:{value:!0}});var e;p=(e=p("../../browser"),e&&e.__esModule&&e||{"default":e})["default"];p.utils.FormulasUtils=p.utils.FormulasUtils||{};p.utils.FormulasUtils.isFormulaExpression=k;p.utils.FormulasUtils.isFormulaExpressionEscaped=d;p.utils.FormulasUtils.unescapeFormulaExpression=h;p.utils.FormulasUtils.toUpperCaseFormula=l},{"../../browser":141}],207:[function(p,q,r){Object.defineProperties(r,{DateCalculator:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),k&&k.__esModule&&k||{"default":k}).arrayEach,l=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).objectEach,g=function(e){this.year=e;this.firstWeekDay="monday";this.weekSectionCount=0;this.monthList=this.calculateMonthData();this.daysInColumns={};this.calculateWeekStructure()};$traceurRuntime.createClass(g,{setYear:function(e){this.year=e;this.monthList=this.calculateMonthData();this.calculateWeekStructure()},setFirstWeekDay:function(e){e=e.toLowerCase();"monday"!==e&&"sunday"!==e&&console.warn("First day of the week must be set to either Monday or Sunday");this.firstWeekDay=e;this.calculateWeekStructure()},countWeekSections:function(){return this.weekSectionCount},getFirstWeekDay:function(){return this.firstWeekDay},getYear:function(){return this.year},getMonthList:function(){return this.monthList},parseDate:function(e){return e instanceof Date||(e=new Date(e),"Invalid Date"!==e.toString())?e:null},dateToColumn:function(e){e=this.parseDate(e);if(!e||e.getFullYear()!==this.year)return!1;var d=e.getMonth(),g=e.getDate()-1,a=null;l(this.daysInColumns[d],function(b,e){if(-1<b.indexOf(g+1))return a=parseInt(e,10),!1});return a},columnToDate:function(e){var d=null;l(this.daysInColumns,function(g,a){if(g[e])return d=a,!1});return 1===this.daysInColumns[d][e].length?new Date(this.year,d,this.daysInColumns[d][e][0]):this.daysInColumns[d][e]},isOnTheEdgeOfWeek:function(e){e=this.parseDate(e);if(!e)return null;var d=e.getMonth(),g=e.getDate()-1,a=!1;l(this.daysInColumns[d],function(b){var e=b.indexOf(g+1);if(0===e)return a=[1,0],!1;if(e===b.length-1)return a=[0,1],!1});return a},addDaysToCache:function(e,d,g,a){this.daysInColumns[e]||(this.daysInColumns[e]={});for(this.daysInColumns[e][d]||(this.daysInColumns[e][d]=[]);g<=a;g++)this.daysInColumns[e][d].push(g)},isValidRangeBarData:function(e,d){var g=this.parseDate(e),a=this.parseDate(d);return g&&a&&g.getTime()<=a.getTime()},calculateMonthData:function(){return[{name:"January",days:31},{name:"February",days:(new Date(this.year,2,0)).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}]},countMonths:function(){return this.monthList.length},countMonthDays:function(e){return this.monthList[e-1].days},countMonthFullWeeks:function(e){return this.monthList[e-1].fullWeeks},calculateWeekStructure:function(){var e=0,d=0,g=this.getFirstWeekDay(),a=this.getMonthList(),b=this.getYear();"monday"===g&&(e=1);h(a,function(a,g){var f=(new Date(b,g,1)).getDay();a.daysBeforeFullWeeks=(7-f+e)%7;a.fullWeeks=Math.floor((a.days-a.daysBeforeFullWeeks)/7);a.daysAfterFullWeeks=a.days-a.daysBeforeFullWeeks-7*a.fullWeeks;d+=a.fullWeeks+(a.daysBeforeFullWeeks?1:0)+(a.daysAfterFullWeeks?1:0)});this.weekSectionCount=d}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],208:[function(p,q,r){Object.defineProperties(r,{GanttChart:{get:function(){return w}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var m=q.addClass,a=q.removeClass;k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d});var b=k.objectEach,f=k.deepClone,t=k.extend;p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array");p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number");var u=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data"),h&&h.__esModule&&h||{"default":h}).createEmptySpreadsheetData;d=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var v=(g=p("dateCalculator"),g&&g.__esModule&&g||{"default":g}).DateCalculator,y=(e=p("ganttChartDataFeed"),e&&e.__esModule&&e||{"default":e}).GanttChartDataFeed;p=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),n&&n.__esModule&&n||{"default":n})["default"];var w=function(a){$traceurRuntime.superConstructor(z).call(this,a);this.settings={};this.currentYear=this.dateCalculator=null;this.monthList=[];this.monthHeadersArray=[];this.weekHeadersArray=[];this.rangeBars={};this.rangeList={};this.dataFeed=this.initialSettings=this.overallWeekSectionCount=this.hotSource=this.nestedHeadersPlugin=null;this.colorData={};this.rangeBarMeta=Object.create(null)},z=w;$traceurRuntime.createClass(w,{checkDependencies:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")},isEnabled:function(){return!!this.hot.getSettings().ganttChart},enablePlugin:function(){var a=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new v(this.currentYear),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return a.onAfterInit()}),m(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),a(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this))},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,z.prototype,"updatePlugin").call(this)},parseSettings:function(){this.settings=this.hot.getSettings().ganttChart;"boolean"===typeof this.settings&&(this.settings={});this.settings.firstWeekDay||(this.settings.firstWeekDay="monday")},applyDataSource:function(){if(this.settings.dataSource){var a=this.settings.dataSource;a.instance?this.loadData(a.instance,a.startDateColumn,a.endDateColumn,a.additionalData,a.asyncUpdates):this.loadData(a)}},loadData:function(a,b,e,f,d){1<a.length&&this.hot.alter("insert_row",0,a.length-1,this.pluginName+".loadData");this.dataFeed=new y(this.hot,a,b,e,f,d);this.hot.render()},clearRangeBars:function(){this.rangeBars={}},clearRangeList:function(){this.rangeList={}},getRangeBarCoordinates:function(a){return this.rangeList[a]},generateHeaderSet:function(a){var e=this,f=[];b(this.monthList,function(b,d){var g=0<b.daysBeforeFullWeeks?1:0,m=0<b.daysAfterFullWeeks?1:0,h=b.fullWeeks+g+m,n=parseInt(d,10);if("months"===a)f.push({label:b.name,colspan:h});else if("weeks"===a)for(var l=0;l<h;l++){if(g&&0===l){var k=l+1,t=b.daysBeforeFullWeeks;k===t?f.push(k):f.push(k+" - "+t)}else m&&l===h-1?(k=b.days-b.daysAfterFullWeeks+1,t=b.days,k===t?f.push(k):f.push(k+" - "+t)):(k=b.daysBeforeFullWeeks+7*(l-g)+1,t=k+6,f.push(k+" - "+t));e.dateCalculator.addDaysToCache(n,f.length-1,k,t)}else if("days"===a)for(g=0;g<b.days;g++)f.push(g+1)});return f},generateMonthHeaders:function(){return this.generateHeaderSet("months")},generateWeekHeaders:function(){return this.generateHeaderSet("weeks")},generateDayHeaders:function(){return this.generateHeaderSet("days")},assignGanttSettings:function(){var a=this;this.initialSettings=f(this.hot.getSettings());var b={data:u(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(b,e,f,d,g,h,m){return a.uniformBackgroundRenderer(b,e,f,d,g,h,m)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0;this.hot.updateSettings(b);this.internalUpdateSettings=void 0},deassignGanttSettings:function(){this.internalUpdateSettings=!0;this.initialSettings&&this.hot.updateSettings(this.initialSettings);this.internalUpdateSettings=void 0},cacheRangeBarMeta:function(a,b,e,f){this.rangeBarMeta[a]||(this.rangeBarMeta[a]={});this.rangeBarMeta[a][b]||(this.rangeBarMeta[a][b]={});this.rangeBarMeta[a][b][e]=f},applyRangeBarMetaCache:function(){var a=this;b(this.rangeBarMeta,function(e,f){b(e,function(e,d){b(e,function(b,e){a.hot.setCellMeta(f,d,e,b)})})})},addRangeBar:function(a,e,f,d){var g=this,h=this.dateCalculator.dateToColumn(e),m=this.dateCalculator.dateToColumn(f);if(!this.dateCalculator.isValidRangeBarData(e,f)||null==h||null==m)return!1;this.rangeBars[a]||(this.rangeBars[a]={});this.rangeBars[a][h]={barLength:m-h+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(e)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(f)[1],additionalData:{}};b(d,function(b,e){g.rangeBars[a][h].additionalData[e]=b});this.colorData[a]&&(this.rangeBars[a][h].colors=this.colorData[a]);this.rangeList[a]=[a,h];this.renderRangeBar(a,h,m,d);return[a,h]},getRangeBarData:function(a,b){var e=this.getRangeBarCoordinates(a);if(!e)return!1;var f=this.rangeBars[e[0]][e[1]];return f&&a===e[0]&&(b===e[1]||b>e[1]&&b<e[1]+f.barLength)?f:!1},updateRangeBarData:function(a,e,f){var d=this.getRangeBarData(a,e);b(f,function(a,b){d[b]!==a&&(d[b]=a)})},renderRangeBar:function(a,b,e,f){f=this.rangeBars[a][b];for(var d=b;d<=e;d++){var g=this.hot.getCellMeta(a,d),h=(g.className||"")+" rangeBar";if(d===b&&f.partialStart||d===e&&f.partialEnd)h+=" partial";d===e&&(h+=" last");this.hot.setCellMeta(a,d,"originalClassName",g.className);this.hot.setCellMeta(a,d,"className",h);this.hot.setCellMeta(a,d,"additionalData",f.additionalData);this.cacheRangeBarMeta(a,d,"originalClassName",g.className);this.cacheRangeBarMeta(a,d,"className",h);this.cacheRangeBarMeta(a,d,"additionalData",f.additionalData)}},removeRangeBarByDate:function(a,b){var e=this.dateCalculator.dateToColumn(b);this.removeRangeBarByColumn(a,e)},removeRangeBarByColumn:function(a,e){var f=this,d=this.rangeBars[a][e];d&&(this.unrenderRangeBar(a,e,e+d.barLength-1),this.rangeBars[a][e]=null,b(this.rangeList,function(b,d){d=parseInt(d,10);JSON.stringify(b)===JSON.stringify([a,e])&&(f.rangeList[d]=null)}))},removeAllRangeBars:function(){var a=this;b(this.rangeBars,function(e,f){b(e,function(b,e){a.removeRangeBarByColumn(f,e)})})},unrenderRangeBar:function(a,b,e){for(;b<=e;b++){var f=this.hot.getCellMeta(a,b);this.hot.setCellMeta(a,b,"className",f.originalClassName);this.hot.setCellMeta(a,b,"originalClassName",void 0);this.cacheRangeBarMeta(a,b,"className",f.originalClassName);this.cacheRangeBarMeta(a,b,"originalClassName",void 0)}this.hot.render()},uniformBackgroundRenderer:function(a,e,f,d,g,h,m){a=this.getRangeBarData(f,d);f=this.getRangeBarCoordinates(f);m.className&&(e.className=m.className);var n="";b(m.additionalData,function(a,b){n+=b+": "+a+"\n"});n=n.replace(/\n$/,"");e.title=n;e.style.background=a&&a.colors?d===f[1]&&a.partialStart||d===f[1]+a.barLength-1&&a.partialEnd?a.colors[1]:a.colors[0]:""},setRangeBarColors:function(a){var e=this;this.colorData=a;b(a,function(a,b){var f=e.getRangeBarCoordinates(b);f&&e.updateRangeBarData(f[0],f[1],{colors:a})});this.hot.render()},setYear:function(a){a=t(this.hot.getSettings().ganttChart,{startYear:a});this.hot.updateSettings({ganttChart:a})},onAfterInit:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.applyDataSource()},onUpdateSettings:function(){this.internalUpdateSettings?this.applyRangeBarMetaCache():$traceurRuntime.superGet(this,z.prototype,"onUpdateSettings").call(this)},destroy:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource);$traceurRuntime.superGet(this,z.prototype,"destroy").call(this)}},{},p);d("ganttChart",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data":45,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,dateCalculator:207,ganttChartDataFeed:209}],209:[function(p,q,r){Object.defineProperties(r,{GanttChartDataFeed:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),k&&k.__esModule&&k||{"default":k}).objectEach,l=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach;p("dateCalculator");var g=function(e,d,g,a,b,f){this.data=d;this.chartInstance=e;this.chartPlugin=this.chartInstance.getPlugin("ganttChart");this.hotSource=null;this.sourceHooks={};this.ongoingAsync=!1;this.applyData(d,g,a,b,f||!1)};$traceurRuntime.createClass(g,{applyData:function(e,d,g,a,b){"[object Array]"===Object.prototype.toString.call(e)?this.loadData(e):e.guid&&this.bindWithHotInstance(e,d,g,a,b)},bindWithHotInstance:function(e,d,g,a,b){this.hotSource={instance:e,startColumn:d,endColumn:g,additionalData:a,asyncUpdates:b};this.addSourceHotHooks();this.asyncCall(this.updateFromSource)},asyncCall:function(e){var d=this;this.hotSource.asyncUpdates?(this.asyncStart(),setTimeout(function(){e.call(d);d.asyncEnd()},0)):e.call(this)},asyncStart:function(){this.ongoingAsync=!0},asyncEnd:function(){this.ongoingAsync=!1},addSourceHotHooks:function(){var e=this;this.sourceHooks={afterLoadData:function(d){return e.onAfterSourceLoadData(d)},afterChange:function(d,g){return e.onAfterSourceChange(d,g)},afterColumnSort:function(d,g){return e.onAfterColumnSort(d,g)}};this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData);this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange);this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)},removeSourceHotHooks:function(e){this.sourceHooks.afterLoadData&&e.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData);this.sourceHooks.afterChange&&e.instance.removeHook("afterChange",this.sourceHooks.afterChange);this.sourceHooks.afterColumnSort&&e.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)},getDataFromSource:function(e){var d={},g=this.hotSource,a,b=[];void 0===e?a=g.instance.getData(0,0,g.instance.countRows()-1,g.instance.countCols()-1):(a=[],a[e]=g.instance.getDataAtRow(e));var f=function(e,f){d={};var m=a[e];if(null===m[g.startColumn]||""===m[g.startColumn])return 0;h(g.additionalData,function(a,b){d[b]=m[a]});b.push([e,m[g.startColumn],m[g.endColumn],d,e])},l=e||0,k=a.length;for(;l<(e?e+1:k);l++)f(l,k);return b},updateFromSource:function(e){var d=this,g=this.getDataFromSource(e);!e&&isNaN(e)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList());l(g,function(a){a=d.trimRangeIfNeeded(a);d.chartPlugin.addRangeBar.apply(d.chartPlugin,a)})},loadData:function(e){var d=this;l(e,function(e,a){e=d.trimRangeIfNeeded(e);d.chartPlugin.addRangeBar(a,e.startDate,e.endDate,e.additionalData)})},trimRangeIfNeeded:function(e){var d,g;e[1]?(d=1,g=2):(d="startDate",g="endDate");var a=new Date(e[d]),b=new Date(e[g]);if("string"===typeof a||"string"===typeof b)return!1;a=a.getFullYear();b=b.getFullYear();a<this.chartPlugin.currentYear&&b>=this.chartPlugin.currentYear&&(e[d]="01/01/"+this.chartPlugin.currentYear);b>this.chartPlugin.currentYear&&a<=this.chartPlugin.currentYear&&(e[g]="12/31/"+this.chartPlugin.currentYear);return e},onAfterSourceChange:function(e,d){var g=this;this.asyncCall(function(){if(e){for(var a={},b=0,f=e.length;b<f;b++){var d=e[b],m=parseInt(d[0],10),n=parseInt(d[1],10);a[m]||(a[m]={});a[m][n]=[d[2],d[3]]}h(a,function(a,b){b=parseInt(b,10);g.chartPlugin.getRangeBarCoordinates(b)&&g.chartPlugin.removeRangeBarByColumn(b,g.chartPlugin.rangeList[b][1]);g.updateFromSource(b)})}})},onAfterSourceLoadData:function(e){var d=this;this.asyncCall(function(e){d.chartPlugin.removeAllRangeBars();d.updateFromSource()})},onAfterColumnSort:function(e,d){var g=this;this.asyncCall(function(){g.chartPlugin.removeAllRangeBars();g.updateFromSource()})}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,dateCalculator:207}],210:[function(p,q,r){Object.defineProperties(r,{HeaderTooltips:{get:function(){return n}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js"),k&&k.__esModule&&k||{"default":k}).outerWidth;q=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var e=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach;p=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),l&&l.__esModule&&l||{"default":l})["default"];var n=function(a){$traceurRuntime.superConstructor(m).call(this,a);this.settings=null},m=n;$traceurRuntime.createClass(n,{isEnabled:function(){return!!this.hot.getSettings().headerTooltips},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(b,e){return a.onAfterGetHeader(b,e)}),this.addHook("afterGetRowHeader",function(b,e){return a.onAfterGetHeader(b,e)}),$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null;this.clearTitleAttributes();$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},parseSettings:function(){"boolean"===typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})},clearTitleAttributes:function(){var a=this.hot.view.wt.getSetting("columnHeaders").length,b=this.hot.view.wt.wtTable.THEAD,f=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;e(0,a-1,function(a){var g=b.childNodes[a],h=f.childNodes[a],m=d?d.childNodes[a]:null;e(0,g.childNodes.length-1,function(a){g.childNodes[a].removeAttribute("title");h&&h.childNodes[a]&&h.childNodes[a].removeAttribute("title");d&&m&&m.childNodes[a]&&m.childNodes[a].removeAttribute("title")})},!0)},onAfterGetHeader:function(a,b){var e=b.querySelector("span"),d="THEAD"===b.parentNode.parentNode.nodeName;if(d&&this.settings.columns||!d&&this.settings.rows)this.settings.onlyTrimmed?g(e)>=g(b)&&0!==g(e)&&b.setAttribute("title",e.textContent):b.setAttribute("title",e.textContent)},destroy:function(){this.settings=null;$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)}},{},p);q("headerTooltips",n)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63}],211:[function(p,q,r){function k(d){return{key:"hidden_columns_hide",name:"Hide column",callback:function(){var g=this.getSelectedRange(),e=g.from,g=g.to;h(Math.min(e.col,g.col),Math.max(e.col,g.col),function(e){return d.hideColumn(e)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}Object.defineProperties(r,{hideColumnItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],212:[function(p,q,r){function k(d){var g=[],e=[];return{key:"hidden_columns_show",name:"Show column",callback:function(){var n=this.getSelectedRange(),m=n.from,a=n.to,n=Math.min(m.col,a.col),m=Math.max(m.col,a.col);n===m?(g.length===n&&(d.showColumns(g),g.length=0),e.length===this.countSourceCols()-(n+1)&&(d.showColumns(e),e.length=0)):h(n,m,function(a){return d.showColumn(a)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!d.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;g.length=0;e.length=0;var n=this.getSelectedRange(),m=n.from,n=n.to,a=Math.min(m.col,n.col),m=Math.max(m.col,n.col),b=!1;if(a===m){if(m=this.countSourceCols(),h(0,m,function(b){if(g.length+e.length===d.hiddenColumns.length)return!1;b<a&&d.isHidden(b)?g.push(b):d.isHidden(b)&&e.push(b)}),--m,g.length===a&&0<a||e.length===m-a&&a<m)b=!0}else h(a,m,function(a){if(d.isHidden(a))return b=!0,!1});return!b}}}Object.defineProperties(r,{showColumnItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],213:[function(p,q,r){function k(a,b){b.textContent=""}Object.defineProperties(r,{HiddenColumns:{get:function(){return w}},__esModule:{value:!0}});var d,h,l,g,e,n,m,a;q=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),d&&d.__esModule&&d||{"default":d})["default"];var b=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).addClass,f=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,t=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),g&&g.__esModule&&g||{"default":g}).arrayEach;d=(e=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin;var u=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),n&&n.__esModule&&n||{"default":n}).SEPARATOR,v=(m=p("contextMenuItem/hideColumn"),m&&m.__esModule&&m||{"default":m}).hideColumnItem,y=(a=p("contextMenuItem/showColumn"),a&&a.__esModule&&a||{"default":a}).showColumnItem,w=function(a){$traceurRuntime.superConstructor(z).call(this,a);this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1},z=w;$traceurRuntime.createClass(w,{isEnabled:function(){return!!this.hot.getSettings().hiddenColumns},enablePlugin:function(){var a=this;if(!this.enabled){this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(b,e){return a.onAfterGetColHeader(b,e)}):this.addHook("afterRenderer",function(b,e,f){return a.onAfterGetColHeader(f,b)});this.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)});this.addHook("afterGetCellMeta",function(b,e,f){return a.onAfterGetCellMeta(b,e,f)});this.addHook("modifyColWidth",function(b,e){return a.onModifyColWidth(b,e)});this.addHook("beforeSetRangeStartOnly",function(b){return a.onBeforeSetRangeStart(b)});this.addHook("beforeSetRangeEnd",function(b){return a.onBeforeSetRangeEnd(b)});this.addHook("hiddenColumn",function(b){return a.isHidden(b)});this.addHook("beforeStretchingColumnWidth",function(b,e){return a.onBeforeStretchingColumnWidth(b,e)});this.addHook("afterCreateCol",function(b,e){return a.onAfterCreateCol(b,e)});this.addHook("afterRemoveCol",function(b,e){return a.onAfterRemoveCol(b,e)});if(this.hot.view)this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this)}},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,z.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1;this.hot.render();$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this);this.resetCellsMeta()},showColumns:function(a){var b=this;t(a,function(a){a=parseInt(a,10);a=b.getLogicalColumnIndex(a);b.isHidden(a,!0)&&b.hiddenColumns.splice(b.hiddenColumns.indexOf(a),1)})},showColumn:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.showColumns(a)},hideColumns:function(a){var b=this;t(a,function(a){a=parseInt(a,10);a=b.getLogicalColumnIndex(a);b.isHidden(a,!0)||b.hiddenColumns.push(a)})},hideColumn:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.hideColumns(a)},isHidden:function(a,b){void 0!==b&&b||(a=this.getLogicalColumnIndex(a));return-1<this.hiddenColumns.indexOf(a)},resetCellsMeta:function(){t(this.hot.getCellsMeta(),function(a){a&&(a.skipColumnOnPaste=!1,null!==a.baseRenderer&&(a.renderer=a.baseRenderer,a.baseRenderer=null))})},getLogicalColumnIndex:function(a){return this.hot.runHooks("modifyCol",a)},onBeforeStretchingColumnWidth:function(a,b){this.isHidden(b)&&(a=0);return a},onModifyColWidth:function(a,b){if(this.isHidden(b))return.1;if(this.settings.indicators&&(this.isHidden(b+1)||this.isHidden(b-1)))return a+(this.hot.hasColHeaders()?15:0)},onAfterGetCellMeta:function(a,b,e){b=this.hot.runHooks("unmodifyCol",b);!1===this.settings.copyPasteEnabled&&this.isHidden(b)&&(e.skipColumnOnPaste=!0);this.isHidden(b)?(e.renderer!==k&&(e.baseRenderer=e.renderer),e.renderer=k):null!==e.baseRenderer&&(e.renderer=e.baseRenderer,e.baseRenderer=null);if(this.isHidden(e.visualCol-1)){a=!0;b=e.visualCol-1;e.className=e.className||"";-1===e.className.indexOf("afterHiddenColumn")&&(e.className+=" afterHiddenColumn");do{if(!this.isHidden(b)){a=!1;break}b--}while(0<=b);a&&-1===e.className.indexOf("firstVisibleColumn")&&(e.className+=" firstVisibleColumn")}else if(e.className&&(a=e.className.split(" "),a.length)){b=a.indexOf("afterHiddenColumn");var f=a.indexOf("firstVisibleColumn");-1<b&&a.splice(b,1);-1<f&&a.splice(f,1);e.className=a.join(" ")}},onModifyCopyableRange:function(a){var b=this,e=[];t(a,function(a){var d=!0,g=0;f(a.startCol,a.endCol,function(f){b.isHidden(f)?(d||e.push({startRow:a.startRow,endRow:a.endRow,startCol:g,endCol:f-1}),d=!0):(d&&(g=f),f===a.endCol&&e.push({startRow:a.startRow,endRow:a.endRow,startCol:g,endCol:f}),d=!1)})});return e},onAfterGetColHeader:function(a,e){if(!this.isHidden(a)){var f=!0,d=a-1;do{if(!this.isHidden(d)){f=!1;break}d--}while(0<=d);f&&b(e,"firstVisibleColumn");this.settings.indicators&&(this.isHidden(a-1)&&b(e,"afterHiddenColumn"),this.isHidden(a+1)&&-1<a&&b(e,"beforeHiddenColumn"))}},onBeforeSetRangeStart:function(a){var b=this;if(!(0<a.col)){a.col=0;var e=function(a){var f=b.getLogicalColumnIndex(a);b.isHidden(f,!0)&&(a=e(++a));return a};a.col=e(a.col)}},onBeforeSetRangeEnd:function(a){var b=this,e=this.hot.countCols(),d=function(g){var h=b.getLogicalColumnIndex(g);b.isHidden(h,!0)&&(b.lastSelectedColumn>g||a.col===e-1?0<g?g=d(--g):f(0,b.lastSelectedColumn,function(a){if(!b.isHidden(a))return g=a,!1}):g=d(++g));return g};a.col=d(a.col);this.lastSelectedColumn=a.col},onAfterContextMenuDefaultOptions:function(a){a.items.push({name:u},v(this),y(this))},onAfterCreateCol:function(a,b){var e=[];t(this.hiddenColumns,function(f){f>=a&&(f+=b);e.push(f)});this.hiddenColumns=e},onAfterRemoveCol:function(a,b){var e=[];t(this.hiddenColumns,function(f){f>=a&&(f-=b);e.push(f)});this.hiddenColumns=e},onAfterPluginsInitialized:function(){var a=this,b=this.hot.getSettings().hiddenColumns;"object"===typeof b&&(this.settings=b,void 0===b.copyPasteEnabled&&(b.copyPasteEnabled=!0),Array.isArray(b.columns)&&this.hideColumns(b.columns),b.copyPasteEnabled||this.addHook("modifyCopyableRange",function(b){return a.onModifyCopyableRange(b)}))},destroy:function(){$traceurRuntime.superGet(this,z.prototype,"destroy").call(this)}},{},q);d("hiddenColumns",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"contextMenuItem/hideColumn":211,"contextMenuItem/showColumn":212}],214:[function(p,q,r){function k(d){return{key:"hidden_rows_hide",name:"Hide row",callback:function(){var g=this.getSelectedRange(),e=g.from,g=g.to;h(Math.min(e.row,g.row),Math.max(e.row,g.row),function(e){return d.hideRow(e)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}Object.defineProperties(r,{hideRowItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],215:[function(p,q,r){function k(d){var g=[],e=[];return{key:"hidden_rows_show",name:"Show row",callback:function(){var n=this.getSelectedRange(),m=n.from,a=n.to,n=Math.min(m.row,a.row),m=Math.max(m.row,a.row);n===m?(g.length===n&&(d.showRows(g),g.length=0),e.length===this.countSourceRows()-(n+1)&&(d.showRows(e),e.length=0)):h(n,m,function(a){return d.showRow(a)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!d.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;g.length=0;e.length=0;var n=this.getSelectedRange(),m=n.from,n=n.to,a=Math.min(m.row,n.row),m=Math.max(m.row,n.row),b=!1;if(a===m){if(m=this.countSourceRows(),h(0,m,function(b){if(g.length+e.length===d.hiddenRows.length)return!1;b<a?d.isHidden(b)&&g.push(b):d.isHidden(b)&&e.push(b)}),--m,g.length===a&&0<a||e.length===m-a&&a<m)b=!0}else h(a,m,function(a){if(d.isHidden(a))return b=!0,!1});return!b}}}Object.defineProperties(r,{showRowItem:{get:function(){return k}},__esModule:{value:!0}});var d,h=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],216:[function(p,q,r){Object.defineProperties(r,{HiddenRows:{get:function(){return v}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),d&&d.__esModule&&d||{"default":d});var m=k.addClass,a=k.removeClass,b=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,f=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach;d=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;var t=(e=p("contextMenuItem/hideRow"),e&&e.__esModule&&e||{"default":e}).hideRowItem,u=(n=p("contextMenuItem/showRow"),n&&n.__esModule&&n||{"default":n}).showRowItem,v=function(a){$traceurRuntime.superConstructor(y).call(this,a);this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1},y=v;$traceurRuntime.createClass(v,{isEnabled:function(){return!!this.hot.getSettings().hiddenRows},enablePlugin:function(){var a=this;if(!this.enabled){this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(b,e){return a.onAfterGetRowHeader(b,e)}):this.addHook("afterRenderer",function(b,e){return a.onAfterGetRowHeader(e,b)});this.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)});this.addHook("afterGetCellMeta",function(b,e,f){return a.onAfterGetCellMeta(b,e,f)});this.addHook("modifyRowHeight",function(b,e){return a.onModifyRowHeight(b,e)});this.addHook("beforeSetRangeStartOnly",function(b){return a.onBeforeSetRangeStartOnly(b)});this.addHook("beforeSetRangeStart",function(b){return a.onBeforeSetRangeStart(b)});this.addHook("beforeSetRangeEnd",function(b){return a.onBeforeSetRangeEnd(b)});this.addHook("hiddenRow",function(b){return a.isHidden(b)});this.addHook("afterCreateRow",function(b,e){return a.onAfterCreateRow(b,e)});this.addHook("afterRemoveRow",function(b,e){return a.onAfterRemoveRow(b,e)});if(this.hot.view)this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,y.prototype,"enablePlugin").call(this)}},updatePlugin:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,y.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1;$traceurRuntime.superGet(this,y.prototype,"disablePlugin").call(this);this.resetCellsMeta()},showRows:function(a){var b=this;f(a,function(a){a=parseInt(a,10);a=b.getLogicalRowIndex(a);b.isHidden(a,!0)&&b.hiddenRows.splice(b.hiddenRows.indexOf(a),1)})},showRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.showRows(a)},hideRows:function(a){var b=this;f(a,function(a){a=parseInt(a,10);a=b.getLogicalRowIndex(a);b.isHidden(a,!0)||b.hiddenRows.push(a)})},hideRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.hideRows(a)},isHidden:function(a,b){void 0!==b&&b||(a=this.getLogicalRowIndex(a));return-1<this.hiddenRows.indexOf(a)},resetCellsMeta:function(){f(this.hot.getCellsMeta(),function(a){a&&(a.skipRowOnPaste=!1)})},getLogicalRowIndex:function(a){return this.hot.runHooks("modifyRow",a)},onAfterGetCellMeta:function(a,b,e){a=this.hot.runHooks("unmodifyRow",a);!1===this.settings.copyPasteEnabled&&this.isHidden(a)?e.skipRowOnPaste=!0:e.skipRowOnPaste=!1;if(this.isHidden(a-1)){b=!0;--a;e.className=e.className||"";-1===e.className.indexOf("afterHiddenRow")&&(e.className+=" afterHiddenRow");do{if(!this.isHidden(a)){b=!1;break}a--}while(0<=a);b&&-1===e.className.indexOf("firstVisibleRow")&&(e.className+=" firstVisibleRow")}else if(e.className&&(a=e.className.split(" "),a.length)){b=a.indexOf("afterHiddenRow");var f=a.indexOf("firstVisibleRow");-1<b&&a.splice(b,1);-1<f&&a.splice(f,1);e.className=a.join(" ")}},onAfterGetRowHeader:function(b,e){var f=e.parentNode;f&&(this.isHidden(b)?m(f,"hide"):a(f,"hide"));var f=!0,d=b-1;do{if(!this.isHidden(d)){f=!1;break}d--}while(0<=d);f&&m(e,"firstVisibleRow");this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(b-1)&&m(e,"afterHiddenRow"),this.isHidden(b+1)&&m(e,"beforeHiddenRow"))},onModifyRowHeight:function(a,b){return this.isHidden(b)?.1:a},onModifyCopyableRange:function(a){var e=this,d=[];f(a,function(a){var f=!0,g=0;b(a.startRow,a.endRow,function(b){e.isHidden(b)?(f||d.push({startRow:g,endRow:b-1,startCol:a.startCol,endCol:a.endCol}),f=!0):(f&&(g=b),b===a.endRow&&d.push({startRow:g,endRow:b,startCol:a.startCol,endCol:a.endCol}),f=!1)})});return d},onBeforeSetRangeStart:function(a){var b=this,e=this.hot.getSelected()||!1,f=this.hot.countRows()-1,d=function(a){var g=0;e&&(g=a>e[0]?1:-1,b.lastSelectedRow=e[0]);if(f<a||0>a)return b.lastSelectedRow;b.isHidden(a)&&(a=d(a+g));return a};a.row=d(a.row)},onBeforeSetRangeStartOnly:function(a){var b=this;if(!(0<a.row)){a.row=0;var e=function(a){b.isHidden(a)&&(a=e(++a));return a};a.row=e(a.row)}},onBeforeSetRangeEnd:function(a){var e=this,f=this.hot.countRows(),d=function(g){e.isHidden(g)&&(e.lastSelectedRow>g||a.row===f-1?0<g?g=d(--g):b(0,e.lastSelectedRow,function(a){if(!e.isHidden(a))return g=a,!1}):g=d(++g));return g};a.row=d(a.row);this.lastSelectedRow=a.row},onAfterContextMenuDefaultOptions:function(a){a.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,t(this),u(this))},onAfterCreateRow:function(a,b){var e=[];f(this.hiddenRows,function(f){f>=a&&(f+=b);e.push(f)});this.hiddenRows=e},onAfterRemoveRow:function(a,b){var e=[];f(this.hiddenRows,function(f){f>=a&&(f-=b);e.push(f)});this.hiddenRows=e},onAfterPluginsInitialized:function(){var a=this,b=this.hot.getSettings().hiddenRows;"object"===typeof b&&(this.settings=b,void 0===b.copyPasteEnabled&&(b.copyPasteEnabled=!0),Array.isArray(b.rows)&&this.hideRows(b.rows),b.copyPasteEnabled||this.addHook("modifyCopyableRange",function(b){return a.onModifyCopyableRange(b)}))},destroy:function(){$traceurRuntime.superGet(this,y.prototype,"destroy").call(this)}},{},q);d("hiddenRows",v)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"contextMenuItem/hideRow":214,"contextMenuItem/showRow":215}],217:[function(p,q,r){Object.defineProperties(r,{NestedHeaders:{get:function(){return z}},__esModule:{value:!0}});var k,d,h,l,g,e,n;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k});var m=q.addClass,a=q.removeClass,b=q.hasClass,f=q.fastInnerHTML,t=q.empty,u=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach,v=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,y=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),l&&l.__esModule&&l||{"default":l}).objectEach;k=(g=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),g&&g.__esModule&&g||{"default":g}).registerPlugin;var w=(e=p("utils/ghostTable"),e&&e.__esModule&&e||{"default":e}).GhostTable;p=(n=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n})["default"];var z=function(a){$traceurRuntime.superConstructor(x).call(this,a);this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable=new w(this)},x=z;$traceurRuntime.createClass(z,{isEnabled:function(){return!!this.hot.getSettings().nestedHeaders},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(b){return a.onAfterGetColumnHeaderRenderers(b)}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(b,e,f){return a.onAfterOnCellMouseDown(b,e,f)}),this.addHook("beforeOnCellMouseOver",function(b,e,f,d){return a.onBeforeOnCellMouseOver(b,e,f,d)}),this.addHook("afterViewportColumnCalculatorOverride",function(b){return a.onAfterViewportColumnCalculatorOverride(b)}),this.addHook("modifyColWidth",function(b,e){return a.onModifyColWidth(b,e)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,$traceurRuntime.superGet(this,x.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.clearColspans();this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable.clear();$traceurRuntime.superGet(this,x.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,x.prototype,"updatePlugin").call(this);this.ghostTable.buildWidthsMapper()},clearColspans:function(){if(this.hot.view)for(var a=this.hot.view.wt.getSetting("columnHeaders").length,b=this.hot.view.wt.wtTable.THEAD,e=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,f=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,d=0;d<a;d++){var g=b.childNodes[d];if(!g)break;for(var h=e.childNodes[d],m=f?f.childNodes[d]:null,n=0,l=g.childNodes.length;n<l;n++)g.childNodes[n].removeAttribute("colspan"),h&&h.childNodes[n]&&h.childNodes[n].removeAttribute("colspan"),f&&m&&m.childNodes[n]&&m.childNodes[n].removeAttribute("colspan")}},checkForFixedColumnsCollision:function(){var a=this,b=this.hot.getSettings().fixedColumnsLeft;v(this.colspanArray,function(e,f){a.getNestedParent(f,b)!==b&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})},checkForOverlappingHeaders:function(){var a=this;v(this.colspanArray,function(b,e){v(a.colspanArray[e],function(b,f){if(1<b.colspan){var d=a.levelToRowCoords(e),g=a.getChildHeaders(d,f);if(0<g.length){var h=0;v(g,function(b,e){h+=a.getColspan(d+1,b)});h>b.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches.");return!1}}})})},setupColspanArray:function(){var a=this;y(this.settings,function(b,e){y(b,function(b,f,d){b=a.colspanArray;b[e]||(b[e]=[]);void 0===d[f].colspan?a.colspanArray[e].push({label:d[f]||"",colspan:1,hidden:!1}):(b=d[f].colspan||1,a.colspanArray[e].push({label:d[f].label||"",colspan:b,hidden:!1}),a.fillColspanArrayWithDummies(b,e))})})},fillColspanArrayWithDummies:function(a,b){var e=this;u(0,a-2,function(a){e.colspanArray[b].push({label:"",colspan:1,hidden:!0})})},headerRendererFactory:function(b){var e=this;return function(d,g){g.removeAttribute("colspan");a(g,"hiddenHeader");if(e.colspanArray[b][d]&&e.colspanArray[b][d].colspan){var h=e.colspanArray[b][d].colspan,n=e.hot.getSettings().fixedColumnsLeft||0,l=e.hot.view.wt.wtOverlays.topLeftCornerOverlay,k=e.hot.view.wt.wtOverlays.leftOverlay,l=l?l.clone.wtTable.THEAD.contains(g):!1,k=k?k.clone.wtTable.THEAD.contains(g):!1;1<h&&g.setAttribute("colspan",l||k?Math.min(h,n-d):h);(l||k&&d===n-1)&&m(g,"overlayEdge")}e.colspanArray[b][d]&&e.colspanArray[b][d].hidden&&m(g,"hiddenHeader");t(g);h=document.createElement("DIV");m(h,"relative");n=document.createElement("SPAN");m(n,"colHeader");f(n,e.colspanArray[b][d]?e.colspanArray[b][d].label||"":"");h.appendChild(n);g.appendChild(h);e.hot.runHooks("afterGetColHeader",d,g)}},getColspan:function(a,b){var e=this.colspanArray[this.rowCoordsToLevel(a)][b];return e?e.colspan:1},levelToRowCoords:function(a){return a-this.columnHeaderLevelCount},rowCoordsToLevel:function(a){return a+this.columnHeaderLevelCount},getNestedParent:function(a,b){if(0>a)return!1;var e=this.colspanArray[a][b]?this.colspanArray[a][b].colspan:1,f=this.colspanArray[a][b]?this.colspanArray[a][b].hidden:!1;if(1<e||1===e&&!1===f)return b;e=b-1;do{if(1<this.colspanArray[a][e].colspan)break;e--}while(0<=b);return e},getChildHeaders:function(a,b){var e=this.rowCoordsToLevel(a),f=this.colspanArray[e+1],d=this.getNestedParent(e,b),g=this.colspanArray[e][b].colspan,h=[];if(!f)return h;u(d,d+g-1,function(a){f[a]&&1<f[a].colspan&&(g-=f[a].colspan-1);f[a]&&!f[a].hidden&&-1===h.indexOf(a)&&h.push(a)});return h},fillTheRemainingColspans:function(){var a=this;y(this.settings,function(b,e){u(a.colspanArray[e].length-1,a.hot.countCols()-1,function(f){a.colspanArray[e].push({label:b[f]||"",colspan:1,hidden:!1})},!0)})},updateHeadersHighlight:function(){var e=this,f=this.hot.getSelected();if(void 0!==f){var d=this.hot.view.wt.wtOverlays,g=this.hot.selection.selectedHeader.cols,h=Math.min(f[1],f[3]),n=Math.max(f[1],f[3]),l=g?-1:this.columnHeaderLevelCount-1;u(h,n,function(f){for(var k=function(k){var t=e.getNestedParent(k,f),u=d.topOverlay?d.topOverlay.clone.wtTable.getColumnHeader(t,k):void 0,p=d.topLeftCornerOverlay?d.topLeftCornerOverlay.clone.wtTable.getColumnHeader(t,k):void 0,u=[u,p],p=e.getColspan(k-e.columnHeaderLevelCount,t),y=t>=h&&t+p-1<=n;v(u,function(e,f,d){if(void 0===e)return!1;!g&&k<l||g&&!y?b(e,"ht__highlight")&&a(e,"ht__highlight"):b(e,"ht__highlight")||m(e,"ht__highlight")})},t=e.columnHeaderLevelCount-1;-1<t;t--)k(t)})}},onAfterViewportColumnCalculatorOverride:function(a){var b=this,e=a.startColumn;u(0,Math.max(this.columnHeaderLevelCount-1,0),function(f){f=b.getNestedParent(f,a.startColumn);f<a.startColumn&&(e=Math.min(e,f))});a.startColumn=e},onAfterOnCellMouseDown:function(a,b,e){0>b.row&&(a=this.getColspan(b.row,b.col),b=b.col+a-1,1<a&&(a=this.hot.countRows()-1,this.hot.selection.setRangeEnd(new WalkontableCellCoords(a,b))))},onBeforeOnCellMouseOver:function(a,b,e,f){var d;if(0>b.row&&0<=b.col&&this.hot.view.isMouseDown()){e=this.hot.getSelectedRange();a=e.from;e=e.to;var g=this.getColspan(b.row,b.col),h=b.col+g-1;d=!1;if(a.col<=e.col){if(b.col<a.col&&h===e.col||b.col<a.col&&h<a.col||b.col<a.col&&h>=a.col&&h<e.col)d=!0}else if(b.col<e.col&&h>a.col||b.col>a.col||b.col<=e.col&&h>a.col||b.col>e.col&&h>a.col)d=!0;d&&(d=[e.col,a.col],a.col=d[0],e.col=d[1],d);1<g&&(f.column=!0,f.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),a.col===e.col&&(h<=a.col&&b.col<a.col?(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,e.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(e.row,b.col))):(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,b.col<a.col?b.col:a.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(e.row,h>e.col?h:e.col)))),a.col<e.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,b.col<a.col?b.col:a.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(e.row,h))),a.col>e.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,a.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(e.row,b.col))))}},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length;this.fillTheRemainingColspans();this.checkForOverlappingHeaders();this.ghostTable.buildWidthsMapper()},onAfterGetColumnHeaderRenderers:function(a){if(a){a.length=0;for(var b=this.colspanArray.length-1;0<=b;b--)a.push(this.headerRendererFactory(b));a.reverse()}this.updateHeadersHighlight()},onModifyColWidth:function(a,b){var e=this.ghostTable.widthsCache[b];return a>e?a:e},destroy:function(){this.colspanArray=this.columnHeaderLevelCount=this.settings=null;$traceurRuntime.superGet(this,x.prototype,"destroy").call(this)}},{},p);k("nestedHeaders",z)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"utils/ghostTable":218}],218:[function(p,q,r){Object.defineProperties(r,{GhostTable:{get:function(){return g}},__esModule:{value:!0}});var k,d,h=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),k&&k.__esModule&&k||{"default":k}).fastInnerHTML,l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).clone,g=function(e){this.nestedHeaders=e;this.container=void 0;this.widthsCache=[]};$traceurRuntime.createClass(g,{buildWidthsMapper:function(){this.container=document.createElement("div");this.buildGhostTable(this.container);this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var e=this.container.querySelectorAll("tr:last-of-type th"),d=e.length,g=0;g<d;g++)this.widthsCache.push(e[g].offsetWidth);this.container.parentNode.removeChild(this.container);this.container=null;this.nestedHeaders.hot.render()},buildGhostTable:function(e){for(var d=document,g=d.createDocumentFragment(),a=d.createElement("table"),b=!1,f=!!this.nestedHeaders.hot.getSettings().dropdownMenu,k=this.nestedHeaders.colspanArray.length,u=this.nestedHeaders.hot.countCols(),p=k-1,y=0;y<k;y++){for(var w=d.createElement("tr"),b=!1,z=0;z<u;z++){var x=d.createElement("th"),q=l(this.nestedHeaders.colspanArray[y][z]);q&&!q.hidden&&(y===p&&(1<q.colspan&&(b=!0),f&&(q.label+='\x3cbutton class\x3d"changeType"\x3e\x3c/button\x3e')),h(x,q.label),x.colSpan=q.colspan,w.appendChild(x))}a.appendChild(w)}if(b){b=d.createElement("tr");for(f=0;f<u;f++)k=d.createElement("th"),b.appendChild(k);a.appendChild(b)}g.appendChild(a);e.appendChild(g)},clear:function(){this.container=null;this.widthsCache.length=0}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],219:[function(p,q,r){Object.defineProperties(r,{DataManager:{get:function(){return a}},__esModule:{value:!0}});var k,d,h,l,g=(k=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),k&&k.__esModule&&k||{"default":k}).rangeEach,e=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),d&&d.__esModule&&d||{"default":d}).objectEach,n=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,m=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),l&&l.__esModule&&l||{"default":l}).getTranslator,a=function(a,e,d){this.hot=e;this.data=d;this.plugin=a;this.parentReference=new WeakMap;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};this.recordTranslator=m(this.hot)};$traceurRuntime.createClass(a,{rewriteCache:function(){var a=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};g(0,this.data.length-1,function(b){a.cacheNode(a.data[b],0,null)})},cacheNode:function(a,e,d){var b=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount++);this.cache.levels[e].push(a);this.cache.rows.push(a);this.cache.nodeInfo.set(a,{parent:d,row:this.cache.rows.length-1,level:e});this.hasChildren(a)&&n(a.__children,function(f,d){b.cacheNode(f,e+1,a)})},getDataObject:function(a){return null==a?null:this.cache.rows[a]},readTreeNodes:function(a,e,d,g){var b=this,f=!1;if(isNaN(e)&&e.end)return e;a||(a={__children:this.data},f=!0,e--);if(null!=d&&e===d)return{result:a,end:!0};if(null!=g&&a===g)return{result:e,end:!0};e++;a.__children&&n(a.__children,function(h,m){b.parentReference.set(h,f?null:a);e=b.readTreeNodes(h,e,d,g);if(isNaN(e)&&e.end)return!1});return e},updateParentReference:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())},mockParent:function(){var a=this.mockNode();a.__children=this.data;return a},mockNode:function(){var a={};e(this.data[0],function(b,e){a[e]=null});return a},getRowIndex:function(a){return null==a?null:this.cache.nodeInfo.get(a).row},getRowIndexWithinParent:function(a){var b;b=isNaN(a)?a:this.getDataObject(a);a=this.getRowParent(a);return null==a?this.data.indexOf(b):a.__children.indexOf(b)},countAllRows:function(){return this.countChildren({__children:this.data})},countChildren:function(a){var b=this,e=0;isNaN(a)||(a=this.getDataObject(a));if(!a||!a.__children)return 0;n(a.__children,function(a,f){e++;a.__children&&(e+=b.countChildren(a))});return e},getRowParent:function(a){a=isNaN(a)?a:this.getDataObject(a);return this.getRowObjectParent(a)},getRowObjectParent:function(a){return"object"!==typeof a?null:this.cache.nodeInfo.get(a).parent},getRowLevel:function(a){return(a=isNaN(a)?a:this.getDataObject(a))?this.getRowObjectLevel(a):null},getRowObjectLevel:function(a){return null==a?null:this.cache.nodeInfo.get(a).level},hasChildren:function(a){isNaN(a)||(a=this.getDataObject(a));return!(!a.__children||!a.__children.length)},isParent:function(a){isNaN(a)||(a=this.getDataObject(a));return!!a.hasOwnProperty("__children")},addChild:function(a,e){this.hot.runHooks("beforeAddChild",a,e);var b=null;a&&(b=this.getRowIndex(a));this.hot.runHooks("beforeCreateRow",b+this.countChildren(a)+1,1);(b=a)||(b=this.mockParent());b.__children||(b.__children=[]);e||(e=this.mockNode());b.__children.push(e);this.rewriteCache();b=this.getRowIndex(e);this.hot.runHooks("afterCreateRow",b,1);this.hot.runHooks("afterAddChild",a,e)},addChildAtIndex:function(a,e,d,g){this.hot.runHooks("beforeAddChild",a,d,e);this.hot.runHooks("beforeCreateRow",g+1,1);var b=a;a||(b=this.mockParent());b.__children||(b.__children=[]);d||(d=this.mockNode());b.__children.splice(e,null,d);this.rewriteCache();this.hot.runHooks("afterCreateRow",g+1,1);this.hot.runHooks("afterAddChild",a,d,e)},addSibling:function(a,e){var b=void 0!==e?e:"below",f=this.translateTrimmedRow(a),d=this.getRowParent(f),f=this.getRowIndexWithinParent(f);switch(b){case "below":this.addChildAtIndex(d,f+1,null,a);break;case "above":this.addChildAtIndex(d,f,null,a)}},detachFromParent:function(a,e){var b=void 0!==e?e:!0,f=this,d=null,h=[];Array.isArray(a)?(g(a[0],a[2],function(a){a=f.translateTrimmedRow(a);h.push(f.getDataObject(a))}),g(0,h.length-2,function(a){f.detachFromParent(h[a],!1)}),d=h[h.length-1]):d=a;var m=this.getRowIndex(d),n=this.getRowIndexWithinParent(d),l=this.getRowParent(d),k=this.getRowParent(l),p=this.getRowIndex(k),q=null;this.hot.runHooks("beforeDetachChild",l,d);null!=n&&(this.hot.runHooks("beforeRemoveRow",m,1,[m],this.plugin.pluginName),l.__children.splice(n,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",m,1,[m],this.plugin.pluginName),k?(q=p+this.countChildren(k),this.hot.runHooks("beforeCreateRow",q,1,this.plugin.pluginName),k.__children.push(d)):(q=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",q,1,this.plugin.pluginName),this.data.push(d)));this.rewriteCache();this.hot.runHooks("afterCreateRow",q,1,this.plugin.pluginName);b&&this.hot.render();this.hot.runHooks("afterDetachChild",l,d)},filterData:function(a,e,d){var b=this,f=[];n(d,function(a,e){f.push(b.getDataObject(a))});n(f,function(a,e){var f=b.getRowIndexWithinParent(a),d=b.getRowParent(a);null===d?b.data.splice(f,1):d.__children.splice(f,1)});this.rewriteCache()},spliceData:function(a,e,d){a=this.translateTrimmedRow(a);if(null!=a){var b=this.getDataObject(a-1);b&&b.__children&&0===b.__children.length?a=0:(b=this.getRowParent(a),a=this.getRowIndexWithinParent(a));b?d?b.__children.splice(a,e,d):b.__children.splice(a,e):d?this.data.splice(a,e,d):this.data.splice(a,e);this.rewriteCache()}},moveRow:function(a,e){var b=this.isParent(e),f=this.getRowParent(a),d=this.getRowIndexWithinParent(a),g=this.getRowParent(e);null==g&&(g=this.getRowParent(e-1));null==g&&(g=this.getDataObject(e-1));g?g.__children||(g.__children=[]):(g=this.getDataObject(e),g.__children=[]);var h=this.getRowParent(e-1),b=b?this.countChildren(h):this.getRowIndexWithinParent(e),h=f.__children.slice(d,d+1);f.__children.splice(d,1);g.__children.splice(b,0,h[0])},moveCellMeta:function(a,e){var b=this.hot.getCellMetaAtRow(a);this.hot.spliceCellsMeta(e,0,b);this.hot.spliceCellsMeta(a+(a<e?0:1),1)},translateTrimmedRow:function(a){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(a):a}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],220:[function(p,q,r){Object.defineProperties(r,{NestedRows:{get:function(){return w}},__esModule:{value:!0}});var k,d,h,l,g,e,n,m;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var a=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,b=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach,f=(g=p("data/dataManager"),g&&g.__esModule&&g||{"default":g}).DataManager,t=(e=p("ui/collapsing"),e&&e.__esModule&&e||{"default":e}).CollapsingUI,u=(n=p("ui/headers"),n&&n.__esModule&&n||{"default":n}).HeadersUI,v=(m=p("ui/contextMenu"),m&&m.__esModule&&m||{"default":m}).ContextMenuUI,y=new WeakMap,w=function(a){y.set(this,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null});this.headersUI=this.dataManager=this.bindRowsWithHeadersPlugin=this.trimRowsPlugin=this.sourceData=null;$traceurRuntime.superConstructor(z).call(this,a)},z=w;$traceurRuntime.createClass(w,{isEnabled:function(){return!!this.hot.getSettings().nestedRows},enablePlugin:function(){var a=this;this.sourceData=this.hot.getSourceData();this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove");this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders");this.dataManager=new f(this,this.hot,this.sourceData);this.collapsingUI=new t(this,this.hot,this.trimRowsPlugin);this.headersUI=new u(this,this.hot);this.contextMenuUI=new v(this,this.hot);this.dataManager.rewriteCache();this.addHook("afterInit",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterInit.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeRender",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeRender.apply(a,$traceurRuntime.spread(b))});this.addHook("modifyRowData",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onModifyRowData.apply(a,$traceurRuntime.spread(b))});this.addHook("modifySourceLength",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onModifySourceLength.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeDataSplice",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeDataSplice.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeDataFilter",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeDataFilter.apply(a,$traceurRuntime.spread(b))});this.addHook("afterContextMenuDefaultOptions",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterContextMenuDefaultOptions.apply(a,$traceurRuntime.spread(b))});this.addHook("afterGetRowHeader",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterGetRowHeader.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeOnCellMouseDown",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeOnCellMouseDown.apply(a,$traceurRuntime.spread(b))});this.addHook("afterRemoveRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterRemoveRow.apply(a,$traceurRuntime.spread(b))});this.addHook("modifyRemovedAmount",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onModifyRemovedAmount.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeAddChild",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeAddChild.apply(a,$traceurRuntime.spread(b))});this.addHook("afterAddChild",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterAddChild.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeDetachChild",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeDetachChild.apply(a,$traceurRuntime.spread(b))});this.addHook("afterDetachChild",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterDetachChild.apply(a,$traceurRuntime.spread(b))});this.addHook("modifyRowHeaderWidth",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onModifyRowHeaderWidth.apply(a,$traceurRuntime.spread(b))});this.addHook("afterCreateRow",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterCreateRow.apply(a,$traceurRuntime.spread(b))});this.addHook("beforeRowMove",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onBeforeRowMove.apply(a,$traceurRuntime.spread(b))});this.addHook("afterRowMove",function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];return a.onAfterRowMove.apply(a,$traceurRuntime.spread(b))});this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0);$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,z.prototype,"updatePlugin").call(this)},onBeforeRowMove:function(a,b){var e,f=y.get(this),d=a.length,g=[],h=this.dataManager.translateTrimmedRow(b),m=!0,n;for(n=0;n<d;n++)g.push(this.dataManager.translateTrimmedRow(a[n])),this.dataManager.isParent(g[n])&&(m=!1);if(-1<g.indexOf(h)||!m)return!1;m=this.dataManager.getRowParent(g[0]);n=this.dataManager.getRowParent(h);null==n&&(n=this.dataManager.getRowParent(h-1));null==n&&(n=this.dataManager.getDataObject(h-1),f.movedToFirstChild=!0);if(!n)return!1;m=m===n;f.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(n);this.collapsingUI.collapsedRowsStash.stash();m||((e=Math).max.apply(e,$traceurRuntime.spread(g))<=h?this.collapsingUI.collapsedRowsStash.shiftStash(g[0],-1*a.length):this.collapsingUI.collapsedRowsStash.shiftStash(h,a.length));f.changeSelection=!0;if(g[d-1]<=h&&m||!0===f.movedToFirstChild)a.reverse(),g.reverse(),!0!==f.movedToFirstChild&&h--;for(n=0;n<d;n++)this.dataManager.moveRow(g[n],h);if(g[g.length-1]<h)for(n=d-1;0<=n;n--)this.dataManager.moveCellMeta(g[n],h);else for(n=0;n<d;n++)this.dataManager.moveCellMeta(g[n],h);(g[d-1]<=h&&m||this.dataManager.isParent(h))&&a.reverse();this.dataManager.rewriteCache();return!1},onAfterRowMove:function(a,b){var e,f=y.get(this);if(f.changeSelection){var d=a.length,g,h;this.collapsingUI.collapsedRowsStash.applyStash();g=this.dataManager.translateTrimmedRow(b);f.movedToFirstChild?(f.movedToFirstChild=!1,g=b,h=b+d-1,b>=(e=Math).max.apply(e,$traceurRuntime.spread(a))&&(g-=d,h-=d)):f.movedToCollapsed?(h=this.dataManager.getRowParent(g-1),null==h&&(h=this.dataManager.getDataObject(g-1)),h=g=this.dataManager.getRowIndex(h)):a[d-1]<b?(h=b-1,g=h-d+1):(g=b,h=g+d-1);e=this.hot.selection;d=this.hot.countCols()-1;e.setRangeStart(new WalkontableCellCoords(g,0));e.setRangeEnd(new WalkontableCellCoords(h,d),!0);f.changeSelection=!1}},onBeforeOnCellMouseDown:function(a,b,e){this.collapsingUI.toggleState(a,b,e)},onModifyRowData:function(a){return this.dataManager.getDataObject(a)},onModifySourceLength:function(){return this.dataManager.countAllRows()},onBeforeDataSplice:function(a,b,e){this.dataManager.spliceData(a,b,e);return!1},onBeforeDataFilter:function(b,e,f){var d=[];f=this.dataManager.translateTrimmedRow(b);var g=y.get(this);a(f,f+e-1,function(a){d.push(a)});this.collapsingUI.collapsedRowsStash.stash();this.collapsingUI.collapsedRowsStash.trimStash(f,e);this.collapsingUI.collapsedRowsStash.shiftStash(f,-1*e);this.dataManager.filterData(b,e,d);g.skipRender=!0;return!1},onAfterContextMenuDefaultOptions:function(a){return this.contextMenuUI.appendOptions(a)},onAfterGetRowHeader:function(a,b){this.headersUI.appendLevelIndicators(a,b)},onModifyRowHeaderWidth:function(a){return this.headersUI.rowHeaderWidthCache||a},onAfterRemoveRow:function(a,b,e,f){var d=this;if(f!==this.pluginName){var g=y.get(this);setTimeout(function(){g.skipRender=null;d.headersUI.updateRowHeaderWidth();d.collapsingUI.collapsedRowsStash.applyStash()},0)}},onModifyRemovedAmount:function(e,f){var d=this,g=[],h=0;a(f,f+e-1,function(a){var e=!1;a=d.collapsingUI.translateTrimmedRow(a);var f=d.dataManager.getDataObject(a);d.dataManager.hasChildren(f)&&(g.push(f),b(g,function(a){if(-1<a.__children.indexOf(f))return e=!0,!1}),e||(h+=d.dataManager.countChildren(f)));e=!1;b(g,function(a){if(-1<a.__children.indexOf(f))return e=!0,!1});e&&h--});return e+h},onBeforeAddChild:function(a,b){this.collapsingUI.collapsedRowsStash.stash()},onAfterAddChild:function(a,b){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(b));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()},onBeforeDetachChild:function(a,b){this.collapsingUI.collapsedRowsStash.stash()},onAfterDetachChild:function(a,b){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(b));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()},onAfterCreateRow:function(a,b,e){e!==this.pluginName&&this.dataManager.rewriteCache()},onAfterInit:function(){var a;this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var b=(a=Math).max.apply(a,$traceurRuntime.spread(this.dataManager.cache.levels));0<b&&this.headersUI.updateRowHeaderWidth(b)},onBeforeRender:function(a,b){y.get(this).skipRender&&(b.skipRender=!0)}},{},q);k("nestedRows",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"data/dataManager":219,"ui/collapsing":222,"ui/contextMenu":223,"ui/headers":224}],221:[function(p,q,r){Object.defineProperties(r,{BaseUI:{get:function(){return k}},__esModule:{value:!0}});var k=function(d,h){this.hot=h;this.plugin=d};$traceurRuntime.createClass(k,{},{})},{}],222:[function(p,q,r){Object.defineProperties(r,{CollapsingUI:{get:function(){return t}},__esModule:{value:!0}});var k,d,h,l,g,e;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var n=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),d&&d.__esModule&&d||{"default":d}).stopImmediatePropagation,m=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,a=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,b=(g=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),g&&g.__esModule&&g||{"default":g}).hasClass,f=(e=p("headers"),e&&e.__esModule&&e||{"default":e}).HeadersUI,t=function(b,e){var f=this;$traceurRuntime.superConstructor(u).call(this,b,e);this.trimRowsPlugin=b.trimRowsPlugin;this.dataManager=this.plugin.dataManager;this.collapsedRows=[];this.collapsedRowsStash={stash:function(){f.lastCollapsedRows=f.collapsedRows.slice(0);f.expandMultipleChildren(f.lastCollapsedRows,!1)},shiftStash:function(a,b){var e=void 0!==b?b:1;a=f.translateTrimmedRow(a);m(f.lastCollapsedRows,function(b,d){b>a-1&&(f.lastCollapsedRows[d]=b+e)})},applyStash:function(){f.hot.runHooks("skipLengthCache",100);f.collapseMultipleChildren(f.lastCollapsedRows,!0);f.lastCollapsedRows=void 0},trimStash:function(b,e){a(b,b+e-1,function(a){a=f.lastCollapsedRows.indexOf(a);-1<a&&f.lastCollapsedRows.splice(a,1)})}}},u=t;$traceurRuntime.createClass(t,{collapseChildren:function(a,b,e){b=void 0!==b?b:!0;e=void 0!==e?e:!0;var f=this,d=[],g=null,h=null,g=null;isNaN(a)?(g=a,h=this.dataManager.getRowIndex(g)):(g=this.dataManager.getDataObject(a),h=a);this.dataManager.hasChildren(g)&&m(g.__children,function(a,b){d.push(f.dataManager.getRowIndex(a))});g=this.collapseRows(d,!0,!1);e&&this.trimRowsPlugin.trimRows(g);b&&this.renderAndAdjust();-1===this.collapsedRows.indexOf(h)&&this.collapsedRows.push(h);return g},collapseMultipleChildren:function(a,b,e){b=void 0!==b?b:!0;e=void 0!==e?e:!0;var f=this,d=[];m(a,function(a,b){d=d.concat(f.collapseChildren(a,!1,!1))});e&&this.trimRowsPlugin.trimRows(d);b&&this.renderAndAdjust()},collapseRow:function(a,b){this.collapseRows([a],void 0!==b?b:!0)},collapseRows:function(a,b,e){var f=void 0!==b?b:!0;b=void 0!==e?e:!1;var d=this,g=[];m(a,function(a,b){g.push(a);f&&d.collapseChildRows(a,g)});b&&this.trimRowsPlugin.trimRows(g);return g},collapseChildRows:function(a,b,e,f){var d=void 0!==b?b:[];b=void 0!==f?f:!1;var g=this;this.dataManager.hasChildren(a)&&(a=this.dataManager.getDataObject(a),m(a.__children,function(a,b){var e=g.dataManager.getRowIndex(a);d.push(e);g.collapseChildRows(e,d)}));b&&this.trimRowsPlugin.trimRows(d)},expandRow:function(a,b){this.expandRows([a],void 0!==b?b:!0)},expandRows:function(a,b,e){var f=void 0!==b?b:!0;b=void 0!==e?e:!1;var d=this,g=[];m(a,function(a,b){g.push(a);f&&d.expandChildRows(a,g)});b&&this.trimRowsPlugin.untrimRows(g);return g},expandChildRows:function(a,b,e,f){var d=void 0!==b?b:[];b=void 0!==f?f:!1;var g=this;this.dataManager.hasChildren(a)&&(a=this.dataManager.getDataObject(a),m(a.__children,function(a,b){if(!g.isAnyParentCollapsed(a)){var e=g.dataManager.getRowIndex(a);d.push(e);g.expandChildRows(e,d)}}));b&&this.trimRowsPlugin.untrimRows(d)},expandChildren:function(a,b,e){b=void 0!==b?b:!0;e=void 0!==e?e:!0;var f=this,d=[],g=null,h=null,g=null;isNaN(a)?(g=a,h=this.dataManager.getRowIndex(a)):(g=this.dataManager.getDataObject(a),h=a);this.collapsedRows.splice(this.collapsedRows.indexOf(h),1);this.dataManager.hasChildren(g)&&m(g.__children,function(a,b){var e=f.dataManager.getRowIndex(a);d.push(e)});g=this.expandRows(d,!0,!1);e&&this.trimRowsPlugin.untrimRows(g);b&&this.renderAndAdjust();return g},expandMultipleChildren:function(a,b,e){b=void 0!==b?b:!0;e=void 0!==e?e:!0;var f=this,d=[];m(a,function(a,b){d=d.concat(f.expandChildren(a,!1,!1))});e&&this.trimRowsPlugin.untrimRows(d);b&&this.renderAndAdjust()},collapseAll:function(){var a=this,b=this.hot.getSourceData(),e=[];m(b,function(b,f){a.dataManager.hasChildren(b)&&e.push(b)});this.collapseMultipleChildren(e);this.renderAndAdjust()},expandAll:function(){var a=this,b=this.hot.getSourceData(),e=[];m(b,function(b,f){a.dataManager.hasChildren(b)&&e.push(b)});this.expandMultipleChildren(e);this.renderAndAdjust()},areChildrenCollapsed:function(a){var b=this,e=null,f=!0,e=isNaN(a)?a:this.dataManager.getDataObject(a);this.dataManager.hasChildren(e)&&m(e.__children,function(a,e){var d=b.dataManager.getRowIndex(a);if(!b.trimRowsPlugin.isTrimmed(d))return f=!1});return f},isAnyParentCollapsed:function(a){for(;null!==a;){a=this.dataManager.getRowParent(a);var b=this.dataManager.getRowIndex(a);if(-1<this.collapsedRows.indexOf(b))return!0}return!1},toggleState:function(a,e,d){0<=e.col||(e=this.translateTrimmedRow(e.row),b(a.target,f.CSS_CLASSES.button)&&(this.areChildrenCollapsed(e)?this.expandChildren(e):this.collapseChildren(e),n(a)))},translateTrimmedRow:function(a){return this.trimRowsPlugin.rowsMapper.getValueByIndex(a)},renderAndAdjust:function(){this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize()}},{},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221,headers:224}],223:[function(p,q,r){Object.defineProperties(r,{ContextMenuUI:{get:function(){return n}},__esModule:{value:!0}});var k,d,h;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var l=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach,g=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),h&&h.__esModule&&h||{"default":h}).arrayEach,e=new WeakMap,n=function(a,b){var f=this;e.set(this,{row_above:function(a,b){f.dataManager.addSibling(b.start.row,"above")},row_below:function(a,b){f.dataManager.addSibling(b.start.row,"below")}});$traceurRuntime.superConstructor(m).call(this,a,b);this.dataManager=this.plugin.dataManager},m=n;$traceurRuntime.createClass(n,{appendOptions:function(a){var b=this,e=[{key:"add_child",name:function(){return"Insert child row"},callback:function(){var a=b.dataManager.translateTrimmedRow(b.hot.getSelected()[0]),a=b.dataManager.getDataObject(a);b.dataManager.addChild(a)},disabled:function(){var a=b.hot.getSelected();return!a||0>a[0]||b.hot.selection.selectedHeader.cols||b.hot.countRows()>=b.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return"Detach from parent"},callback:function(){var a=b.dataManager.translateTrimmedRow(b.hot.getSelected()[0]);b.dataManager.getDataObject(a);b.dataManager.detachFromParent(b.hot.getSelected())},disabled:function(){var a=b.hot.getSelected(),e=b.dataManager.translateTrimmedRow(a[0]);return!b.dataManager.getRowParent(e)||!a||0>a[0]||b.hot.selection.selectedHeader.cols||b.hot.countRows()>=b.hot.getSettings().maxRows}},Handsontable.plugins.ContextMenu.SEPARATOR];l(0,a.items.length-1,function(b){if(0===b)return g(e,function(e,f){a.items.splice(b+f,0,e)}),!1});return a=this.modifyRowInsertingOptions(a)},modifyRowInsertingOptions:function(a){var b=e.get(this);l(0,a.items.length-1,function(e){null!=b[a.items[e].key]&&(a.items[e].callback=b[a.items[e].key])});return a}},{},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],224:[function(p,q,r){Object.defineProperties(r,{HeadersUI:{get:function(){return m}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("_base"),k&&k.__esModule&&k||{"default":k}).BaseUI;var g=(d=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,e=(h=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,n=(l=p("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).addClass,m=function(b,e){$traceurRuntime.superConstructor(a).call(this,b,e);this.dataManager=this.plugin.dataManager;this.collapsingUI=this.plugin.collapsingUI;this.rowHeaderWidthCache=null;this.trimRowsPlugin=b.trimRowsPlugin},a=m;$traceurRuntime.createClass(m,{appendLevelIndicators:function(b,f){b=this.trimRowsPlugin.rowsMapper.getValueByIndex(b);var d=this.dataManager.getRowLevel(b),h=this.dataManager.getDataObject(b),m=f.getElementsByTagName("DIV")[0],l=m.querySelector("span.rowHeader"),k=m.querySelectorAll('[class^\x3d"ht_nesting"]');g(k,function(a,b){a&&m.removeChild(a)});n(f,a.CSS_CLASSES.indicatorContainer);d&&(l=l.cloneNode(!0),m.innerHTML="",e(0,d-1,function(b){b=document.createElement("SPAN");n(b,a.CSS_CLASSES.emptyIndicator);m.appendChild(b)}),m.appendChild(l));this.dataManager.hasChildren(h)&&(d=document.createElement("DIV"),n(f,a.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(b)?n(d,a.CSS_CLASSES.button+" "+a.CSS_CLASSES.expandButton):n(d,a.CSS_CLASSES.button+" "+a.CSS_CLASSES.collapseButton),m.appendChild(d))},updateRowHeaderWidth:function(a){a||(a=this.dataManager.cache.levelCount);this.rowHeaderWidthCache=Math.max(50,10*a+36);this.hot.render()}},{get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],225:[function(p,q,r){Object.defineProperties(r,{RowsMapper:{get:function(){return e}},__esModule:{value:!0}});var k,d,h,l;q=(k=p("../../browser"),k&&k.__esModule&&k||{"default":k})["default"];k=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),d&&d.__esModule&&d||{"default":d}).arrayMapper;d=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{"default":h}).mixin;var g=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,e=function(e){this.trimRows=e};$traceurRuntime.createClass(e,{createMap:function(e){var d=this,a=0;e=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0;g(e-1,function(b){d.trimRows.isTrimmed(b)?a++:d._arrayMap[b-a]=b})},destroy:function(){this._arrayMap=null}},{});d(e,k);q.utils.TrimRowsRowsMapper=e},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],226:[function(p,q,r){Object.defineProperties(r,{TrimRows:{get:function(){return a}},__esModule:{value:!0}});var k,d,h,l,g;q=(k=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),k&&k.__esModule&&k||{"default":k})["default"];var e=(d=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,n=(h=p("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach;k=(l=p("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var m=(g=p("rowsMapper"),g&&g.__esModule&&g||{"default":g}).RowsMapper,a=function(a){$traceurRuntime.superConstructor(b).call(this,a);this.trimmedRows=[];this.removedRows=[];this.rowsMapper=new m(this)},b=a;$traceurRuntime.createClass(a,{isEnabled:function(){return!!this.hot.getSettings().trimRows},enablePlugin:function(){var a=this;if(!this.enabled){var e=this.hot.getSettings().trimRows;Array.isArray(e)&&(this.trimmedRows=e);this.rowsMapper.createMap(this.hot.countSourceRows());this.addHook("modifyRow",function(b,e){return a.onModifyRow(b,e)});this.addHook("unmodifyRow",function(b,e){return a.onUnmodifyRow(b,e)});this.addHook("afterCreateRow",function(b,e){return a.onAfterCreateRow(b,e)});this.addHook("beforeRemoveRow",function(b,e){return a.onBeforeRemoveRow(b,e)});this.addHook("afterRemoveRow",function(b,e){return a.onAfterRemoveRow(b,e)});this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)});$traceurRuntime.superGet(this,b.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().trimRows;Array.isArray(a)&&(this.disablePlugin(),this.enablePlugin());$traceurRuntime.superGet(this,b.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.trimmedRows=[];this.removedRows.length=0;this.rowsMapper.clearMap();$traceurRuntime.superGet(this,b.prototype,"disablePlugin").call(this)},trimRows:function(a){var b=this;e(a,function(a){a=parseInt(a,10);b.isTrimmed(a)||b.trimmedRows.push(a)});this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterTrimRow",a)},trimRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.trimRows(a)},untrimRows:function(a){var b=this;e(a,function(a){a=parseInt(a,10);b.isTrimmed(a)&&b.trimmedRows.splice(b.trimmedRows.indexOf(a),1)});this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterUntrimRow",a)},untrimRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.untrimRows(a)},isTrimmed:function(a){return-1<this.trimmedRows.indexOf(a)},untrimAll:function(){this.untrimRows([].concat(this.trimmedRows))},onModifyRow:function(a,b){b!==this.pluginName&&(a=this.rowsMapper.getValueByIndex(a));return a},onUnmodifyRow:function(a,b){b!==this.pluginName&&(a=this.rowsMapper.getIndexByValue(a));return a},onAfterCreateRow:function(a,b){this.rowsMapper.shiftItems(a,b)},onBeforeRemoveRow:function(a,b){var e=this;this.removedRows.length=0;!1!==a&&n(a,a+b-1,function(a){e.removedRows.push(e.hot.runHooks("modifyRow",a,e.pluginName))})},onAfterRemoveRow:function(a,b){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function(a){a||this.rowsMapper.createMap(this.hot.countSourceRows())},destroy:function(){this.rowsMapper.destroy();$traceurRuntime.superGet(this,b.prototype,"destroy").call(this)}},{},q);k("trimRows",a)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,rowsMapper:225}],SheetClip:[function(p,q,r){(function(k){var d={parse:function(d){var h,g,e=[],n=0,m,a,b,f;g=d.split("\n");1<g.length&&""===g[g.length-1]&&g.pop();d=0;for(h=g.length;d<h;d+=1){g[d]=g[d].split("\t");m=0;for(a=g[d].length;m<a;m+=1)e[n]||(e[n]=[]),b&&0===m?(f=e[n].length-1,e[n][f]=e[n][f]+"\n"+g[d][0],b&&g[d][0].split('"').length-1&1&&(b=!1,e[n][f]=e[n][f].substring(0,e[n][f].length-1).replace(/""/g,'"'))):m===a-1&&0===g[d][m].indexOf('"')&&g[d][m].split('"').length-1&1?(e[n].push(g[d][m].substring(1).replace(/""/g,'"')),b=!0):(e[n].push(g[d][m].replace(/""/g,'"')),b=!1);b||(n+=1)}return e},stringify:function(d){var h,g,e,n,m="",a;h=0;for(g=d.length;h<g;h+=1){n=d[h].length;for(e=0;e<n;e+=1)0<e&&(m+="\t"),a=d[h][e],m="string"===typeof a?-1<a.indexOf("\n")?m+('"'+a.replace(/"/g,'""')+'"'):m+a:null===a||void 0===a?m+"":m+a;m+="\n"}return m}};"undefined"!==typeof r?(r.parse=d.parse,r.stringify=d.stringify):k.SheetClip=d})(window)},{}],autoResize:[function(p,q,r){function k(){var d=200,h=300,l=100,g=300,e,n=document.body,m=document.createTextNode(""),a=document.createElement("SPAN"),b=function(a,b,e){window.attachEvent?a.attachEvent("on"+b,e):a.addEventListener(b,e,!1)},f=function(a,b,e){window.removeEventListener?a.removeEventListener(b,e,!1):a.detachEvent("on"+b,e)},k=function(b){b?/^[a-zA-Z \.,\\\/\|0-9]$/.test(b)||(b="."):b="";void 0!==m.textContent?m.textContent=e.value+b:m.data=e.value+b;a.style.fontSize=(e.currentStyle||document.defaultView.getComputedStyle(e)).fontSize;a.style.fontFamily=(e.currentStyle||document.defaultView.getComputedStyle(e)).fontFamily;a.style.whiteSpace="pre";n.appendChild(a);b=a.clientWidth+2;n.removeChild(a);e.style.height=d+"px";e.style.width=l>b?l+"px":b>g?g+"px":b+"px";b=e.scrollHeight?e.scrollHeight-1:0;d>b?e.style.height=d+"px":h<b?(e.style.height=h+"px",e.style.overflowY="visible"):e.style.height=b+"px"},p=function(){window.setTimeout(k,0)};return{init:function(f,n,t){e=f;n&&n.minHeight&&("inherit"==n.minHeight?d=e.clientHeight:(f=parseInt(n.minHeight),isNaN(f)||(d=f)));n&&n.maxHeight&&("inherit"==n.maxHeight?h=e.clientHeight:(f=parseInt(n.maxHeight),isNaN(f)||(h=f)));n&&n.minWidth&&("inherit"==n.minWidth?l=e.clientWidth:(f=parseInt(n.minWidth),isNaN(f)||(l=f)));n&&n.maxWidth&&("inherit"==n.maxWidth?g=e.clientWidth:(n=parseInt(n.maxWidth),isNaN(n)||(g=n)));a.firstChild||(a.className="autoResize",a.style.display="inline-block",a.appendChild(m));"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=d+"px",e.style.minWidth=l+"px",e.style.maxWidth=g+"px",e.style.overflowY="hidden");t&&(b(e,"change",k),b(e,"cut",p),b(e,"paste",p),b(e,"drop",p),b(e,"keydown",p),b(e,"focus",k));k()},unObserve:function(){f(e,"change",k);f(e,"cut",p);f(e,"paste",p);f(e,"drop",p);f(e,"keydown",p);f(e,"focus",k)},resize:k}}"undefined"!==typeof r&&(q.exports=k)},{}],copyPaste:[function(p,q,r){function k(){h?h.hasBeenDestroyed()&&h.init():h=new d;h.refCounter++;return h}function d(){this.refCounter=0;this.init()}var h;"undefined"!==typeof r&&(q.exports=k);d.prototype.init=function(){var d,g;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];g=document.body;document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",d=this.elDiv.style,d.position="fixed",d.top="-10000px",d.left="-10000px",g.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){var d;"WebkitAppearance"in document.documentElement.style&&(d=e.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(d=d.split("\n"),""===d[d.length-1]&&d.pop(),d=d.join("\n")),this.value=d,e.preventDefault())},d=this.elTextarea.style,d.width="10000px",d.height="10000px",d.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!==typeof d.opacity&&(d.opacity=0));this.onKeyDownRef=this.onKeyDown.bind(this);document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)};d.prototype.onKeyDown=function(d){function g(){var e=document.activeElement;e.shadowRoot&&e.shadowRoot.activeElement&&(e=e.shadowRoot.activeElement);return-1<["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)||"true"===e.contentEditable}var e=this,h=!1;d.metaKey?h=!0:d.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(h=!0);if(h){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||g()))return;this.selectNodeText(this.elTextarea);setTimeout(function(){document.activeElement!==e.elTextarea&&e.selectNodeText(e.elTextarea)},0)}!1===d.isImmediatePropagationEnabled||!h||67!==d.keyCode&&86!==d.keyCode&&88!==d.keyCode||(88===d.keyCode?setTimeout(function(){e.triggerCut(d)},0):86===d.keyCode&&setTimeout(function(){e.triggerPaste(d)},0))};d.prototype.selectNodeText=function(d){d&&d.select()};d.prototype.getSelectionText=function(){var d="";window.getSelection?d=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(d=document.selection.createRange().text);return d};d.prototype.copyable=function(d){if("string"!==typeof d&&void 0===d.toString)throw Error("copyable requires string parameter");this.elTextarea.value=d;this.selectNodeText(this.elTextarea)};d.prototype.onCut=function(d){this.cutCallbacks.push(d)};d.prototype.onPaste=function(d){this.pasteCallbacks.push(d)};d.prototype.removeCallback=function(d){var g,e;g=0;for(e=this.copyCallbacks.length;g<e;g++)if(this.copyCallbacks[g]===d)return this.copyCallbacks.splice(g,1),!0;g=0;for(e=this.cutCallbacks.length;g<e;g++)if(this.cutCallbacks[g]===d)return this.cutCallbacks.splice(g,1),!0;g=0;for(e=this.pasteCallbacks.length;g<e;g++)if(this.pasteCallbacks[g]===d)return this.pasteCallbacks.splice(g,1),!0;return!1};d.prototype.triggerCut=function(d){var g=this;g.cutCallbacks&&setTimeout(function(){for(var e=0,h=g.cutCallbacks.length;e<h;e++)g.cutCallbacks[e](d)},50)};d.prototype.triggerPaste=function(d,g){var e=this;e.pasteCallbacks&&setTimeout(function(){for(var h=g||e.elTextarea.value,m=0,a=e.pasteCallbacks.length;m<a;m++)e.pasteCallbacks[m](h,d)},50)};d.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elTextarea=this.elDiv=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef),this.onKeyDownRef=null)};d.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],es6collections:[function(p,q,r){(function(k){function d(a,b){function e(a){if(!this||this.constructor!==e)return new e(a);this._keys=[];this._values=[];this._itp=[];this.objectOnly=b;a&&h.call(this,a)}b||E(a,"size",{get:z});a.constructor=e;e.prototype=a;return e}function h(a){this.add?a.forEach(this.add,this):a.forEach(function(a){this.set(a[0],a[1])},this)}function l(a){this.has(a)&&(this._keys.splice(r,1),this._values.splice(r,1),this._itp.forEach(function(a){r<a[0]&&a[0]--}));return-1<r}function g(a){return this.has(a)?this._values[r]:void 0}function e(a,b){if(this.objectOnly&&b!==Object(b))throw new TypeError("Invalid value used as weak collection key");if(b!=b||0===b)for(r=a.length;r--&&!A(a[r],b););else r=a.indexOf(b);return-1<r}function n(a){return e.call(this,this._values,a)}function m(a){return e.call(this,this._keys,a)}function a(a,b){this.has(a)?this._values[r]=b:this._values[this._keys.push(a)-1]=b;return this}function b(a){this.has(a)||this._values.push(a);return this}function f(){this._values.length=0}function t(){return q(this._itp,this._keys)}function p(){return q(this._itp,this._values)}function v(){return q(this._itp,this._keys,this._values)}function y(){return q(this._itp,this._values,this._values)}function q(a,b,e){var d=[0],f=!1;a.push(d);return{next:function(){var g,h=d[0];!f&&h<b.length?(g=e?[b[h],e[h]]:b[h],d[0]++):(f=!0,a.splice(a.indexOf(d),1));return{done:f,value:g}}}}function z(){return this._values.length}function x(a,b){for(var e=this.entries();;){var d=e.next();if(d.done)break;a.call(b,d.value[1],d.value[0],this)}}var r,E=Object.defineProperty,A=function(a,b){return isNaN(a)?isNaN(b):a===b};"undefined"==typeof WeakMap&&(k.WeakMap=d({"delete":l,clear:f,get:g,has:m,set:a},!0));"undefined"==typeof Map&&(k.Map=d({"delete":l,has:m,get:g,set:a,keys:t,values:p,entries:v,forEach:x,clear:f}));"undefined"==typeof Set&&(k.Set=d({has:n,add:b,"delete":l,clear:f,keys:p,values:p,entries:y,forEach:x}));"undefined"==typeof WeakSet&&(k.WeakSet=d({"delete":l,add:b,clear:f,has:n},!0))})("undefined"!=typeof r&&"undefined"!=typeof global?global:window)},{}],"hot-formula-parser":[function(p,q,r){(function(k,d){"object"===typeof r&&"object"===typeof q?q.exports=d():"object"===typeof r?r.formulaParser=d():k.formulaParser=d()})(this,function(){return function(k){function d(l){if(h[l])return h[l].exports;var g=h[l]={i:l,l:!1,exports:{}};k[l].call(g.exports,g,g.exports,d);g.l=!0;return g.exports}var h={};d.m=k;d.c=h;d.i=function(d){return d};d.d=function(h,g,e){d.o(h,g)||Object.defineProperty(h,g,{configurable:!1,enumerable:!0,get:e})};d.n=function(h){var g=h&&h.__esModule?function(){return h["default"]}:function(){return h};d.d(g,"a",g);return g};d.o=function(d,g){return Object.prototype.hasOwnProperty.call(d,g)};d.p="";return d(d.s=81)}([function(k,d){d.nil=Error("#NULL!");d.div0=Error("#DIV/0!");d.value=Error("#VALUE!");d.ref=Error("#REF!");d.name=Error("#NAME?");d.num=Error("#NUM!");d.na=Error("#N/A");d.error=Error("#ERROR!");d.data=Error("#GETTING_DATA")},function(k,d,h){d.__esModule=!0;var l;d["default"]=function(a){var e=void 0;a=(a+"").replace(/#|!|\?/g,"");b[a]&&(e=b[a]);return e?e:null};d.isValidStrict=function(a){var e=!1,d;for(d in b)if(Object.prototype.hasOwnProperty.call(b,d)&&b[d]===a){e=!0;break}return e};k=d.ERROR="ERROR";h=d.ERROR_DIV_ZERO="DIV/0";var g=d.ERROR_NAME="NAME",e=d.ERROR_NOT_AVAILABLE="N/A",n=d.ERROR_NULL="NULL",m=d.ERROR_NUM="NUM",a=d.ERROR_REF="REF";d=d.ERROR_VALUE="VALUE";var b=(l={},l[k]="#ERROR!",l[h]="#DIV/0!",l[g]="#NAME?",l[e]="#N/A",l[n]="#NULL!",l[m]="#NUM!",l[a]="#REF!",l[d]="#VALUE!",l)},function(k,d,h){var l=h(0);d.flattenShallow=function(e){return e&&e.reduce?e.reduce(function(e,d){var a=Array.isArray(e),b=Array.isArray(d);return a&&b?e.concat(d):a?(e.push(d),e):b?[e].concat(d):[e,d]}):e};d.isFlat=function(e){if(!e)return!1;for(var d=0;d<e.length;++d)if(Array.isArray(e[d]))return!1;return!0};d.flatten=function(){for(var e=d.argsToArray.apply(null,arguments);!d.isFlat(e);)e=d.flattenShallow(e);return e};d.argsToArray=function(e){var g=[];d.arrayEach(e,function(e){g.push(e)});return g};d.numbers=function(){return this.flatten.apply(null,arguments).filter(function(e){return"number"===typeof e})};d.cleanFloat=function(e){return Math.round(1E14*e)/1E14};d.parseBool=function(e){if("boolean"===typeof e||e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var d=e.toUpperCase();if("TRUE"===d)return!0;if("FALSE"===d)return!1}return e instanceof Date&&!isNaN(e)?!0:l.value};d.parseNumber=function(e){return void 0===e||""===e?l.value:isNaN(e)?l.value:parseFloat(e)};d.parseNumberArray=function(e){var g;if(!e||0===(g=e.length))return l.value;for(var h;g--;){h=d.parseNumber(e[g]);if(h===l.value)return h;e[g]=h}return e};d.parseMatrix=function(e){if(!e||0===e.length)return l.value;for(var g,h=0;h<e.length;h++)if(g=d.parseNumberArray(e[h]),e[h]=g,g instanceof Error)return g;return e};var g=new Date(1900,0,1);d.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);e=parseInt(e,10);return 0>e?l.num:60>=e?new Date(g.getTime()+864E5*(e-1)):new Date(g.getTime()+864E5*(e-2))}return"string"!==typeof e||(e=new Date(e),isNaN(e))?l.value:e};d.parseDateArray=function(e){for(var d=e.length,g;d--;){g=this.parseDate(e[d]);if(g===l.value)return g;e[d]=g}return e};d.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1};d.arrayValuesToNumbers=function(e){for(var d=e.length,g;d--;)g=e[d],"number"!==typeof g&&(!0===g?e[d]=1:!1===g?e[d]=0:"string"===typeof g&&(g=this.parseNumber(g),e[d]=g instanceof Error?0:g));return e};d.rest=function(e,d){return e&&"function"===typeof e.slice?e.slice(d||1):e};d.initial=function(e,d){return e&&"function"===typeof e.slice?e.slice(0,e.length-(d||1)):e};d.arrayEach=function(e,d){for(var g=-1,a=e.length;++g<a&&!1!==d(e[g],g,e););return e}},function(k,d,h){function l(d){var e=void 0;"number"===typeof d?e=d:"string"===typeof d&&(e=-1<d.indexOf(".")?parseFloat(d):parseInt(d,10));return e}d.__esModule=!0;d.toNumber=l;d.invertNumber=function(d){return-1*l(d)}},function(k,d,h){var l=h(2),g=h(0),e=h(5),n=h(7);d.ABS=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.abs(a)};d.ACOS=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.acos(a);isNaN(a)&&(a=g.num);return a};d.ACOSH=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.log(a+Math.sqrt(a*a-1));isNaN(a)&&(a=g.num);return a};d.ACOT=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.atan(1/a)};d.ACOTH=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=.5*Math.log((a+1)/(a-1));isNaN(a)&&(a=g.num);return a};d.AGGREGATE=function(a,b,f,h){a=l.parseNumber(a);b=l.parseNumber(a);if(l.anyIsError(a,b))return g.value;switch(a){case 1:return e.AVERAGE(f);case 2:return e.COUNT(f);case 3:return e.COUNTA(f);case 4:return e.MAX(f);case 5:return e.MIN(f);case 6:return d.PRODUCT(f);case 7:return e.STDEV.S(f);case 8:return e.STDEV.P(f);case 9:return d.SUM(f);case 10:return e.VAR.S(f);case 11:return e.VAR.P(f);case 12:return e.MEDIAN(f);case 13:return e.MODE.SNGL(f);case 14:return e.LARGE(f,h);case 15:return e.SMALL(f,h);case 16:return e.PERCENTILE.INC(f,h);case 17:return e.QUARTILE.INC(f,h);case 18:return e.PERCENTILE.EXC(f,h);case 19:return e.QUARTILE.EXC(f,h)}};d.ARABIC=function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return g.value;var b=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){b+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]});return b};d.ASIN=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.asin(a);isNaN(a)&&(a=g.num);return a};d.ASINH=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))};d.ATAN=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.atan(a)};d.ATAN2=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:Math.atan2(a,b)};d.ATANH=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.log((1+a)/(1-a))/2;isNaN(a)&&(a=g.num);return a};d.BASE=function(a,b,e){e=e||0;a=l.parseNumber(a);b=l.parseNumber(b);e=l.parseNumber(e);if(l.anyIsError(a,b,e))return g.value;e=void 0===e?0:e;a=a.toString(b);return Array(Math.max(e+1-a.length,0)).join("0")+a};d.CEILING=function(a,b,e){b=void 0===b?1:Math.abs(b);e=e||0;a=l.parseNumber(a);b=l.parseNumber(b);e=l.parseNumber(e);if(l.anyIsError(a,b,e))return g.value;if(0===b)return 0;var f=-Math.floor(Math.log(b)/Math.log(10));return 0<=a?d.ROUND(Math.ceil(a/b)*b,f):0===e?-d.ROUND(Math.floor(Math.abs(a)/b)*b,f):-d.ROUND(Math.ceil(Math.abs(a)/b)*b,f)};d.CEILING.MATH=d.CEILING;d.CEILING.PRECISE=d.CEILING;d.COMBIN=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:d.FACT(a)/(d.FACT(b)*d.FACT(a-b))};d.COMBINA=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:0===a&&0===b?1:d.COMBIN(a+b-1,a-1)};d.COS=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.cos(a)};d.COSH=function(a){a=l.parseNumber(a);return a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2};d.COT=function(a){a=l.parseNumber(a);return a instanceof Error?a:1/Math.tan(a)};d.COTH=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a+1)/(a-1)};d.CSC=function(a){a=l.parseNumber(a);return a instanceof Error?a:1/Math.sin(a)};d.CSCH=function(a){a=l.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))};d.DECIMAL=function(a,b){return 1>arguments.length?g.value:parseInt(a,b)};d.DEGREES=function(a){a=l.parseNumber(a);return a instanceof Error?a:180*a/Math.PI};d.EVEN=function(a){a=l.parseNumber(a);return a instanceof Error?a:d.CEILING(a,-2,-1)};d.EXP=Math.exp;var m=[];d.FACT=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);if(0===a||1===a)return 1;0<m[a]||(m[a]=d.FACT(a-1)*a);return m[a]};d.FACTDOUBLE=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);return 0>=a?1:a*d.FACTDOUBLE(a-2)};d.FLOOR=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);if(l.anyIsError(a,b))return g.value;if(0===b)return 0;if(!(0<a&&0<b||0>a&&0>b))return g.num;b=Math.abs(b);var e=-Math.floor(Math.log(b)/Math.log(10));return 0<=a?d.ROUND(Math.floor(a/b)*b,e):-d.ROUND(Math.ceil(Math.abs(a)/b),e)};d.FLOOR.MATH=function(a,b,e){b=void 0===b?1:b;e=void 0===e?0:e;a=l.parseNumber(a);b=l.parseNumber(b);e=l.parseNumber(e);if(l.anyIsError(a,b,e))return g.value;if(0===b)return 0;b=b?Math.abs(b):1;var f=-Math.floor(Math.log(b)/Math.log(10));return 0<=a?d.ROUND(Math.floor(a/b)*b,f):0===e||void 0===e?-d.ROUND(Math.ceil(Math.abs(a)/b)*b,f):-d.ROUND(Math.floor(Math.abs(a)/b)*b,f)};d.FLOOR.PRECISE=d.FLOOR.MATH;d.GCD=function(){var a=l.parseNumberArray(l.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,e=a[0],e=0>e?-e:e,d=1;d<b;d++){for(var g=a[d],g=0>g?-g:g;e&&g;)e>g?e%=g:g%=e;e+=g}return e};d.INT=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.floor(a)};d.ISO={CEILING:d.CEILING};d.LCM=function(){var a=l.parseNumberArray(l.flatten(arguments));if(a instanceof Error)return a;for(var b,e,d,g=1;void 0!==(d=a.pop());)for(;1<d;){if(d%2){b=3;for(e=Math.floor(Math.sqrt(d));b<=e&&d%b;b+=2);e=b<=e?b:d}else e=2;d/=e;g*=e;for(b=a.length;b;0===a[--b]%e&&1===(a[b]/=e)&&a.splice(b,1));}return g};d.LN=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.log(a)};d.LN10=function(){return Math.log(10)};d.LN2=function(){return Math.log(2)};d.LOG10E=function(){return Math.LOG10E};d.LOG2E=function(){return Math.LOG2E};d.LOG=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:Math.log(a)/Math.log(void 0===b?10:b)};d.LOG10=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.log(a)/Math.log(10)};d.MOD=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);if(l.anyIsError(a,b))return g.value;if(0===b)return g.div0;var e=Math.abs(a%b);return 0<b?e:-e};d.MROUND=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:0>a*b?g.num:Math.round(a/b)*b};d.MULTINOMIAL=function(){var a=l.parseNumberArray(l.flatten(arguments));if(a instanceof Error)return a;for(var b=0,e=1,g=0;g<a.length;g++)b+=a[g],e*=d.FACT(a[g]);return d.FACT(b)/e};d.ODD=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;var b=Math.ceil(Math.abs(a)),b=b&1?b:b+1;return 0<a?b:-b};d.PI=function(){return Math.PI};d.E=function(){return Math.E};d.POWER=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);if(l.anyIsError(a,b))return g.value;var e=Math.pow(a,b);return isNaN(e)?g.num:e};d.PRODUCT=function(){var a=l.parseNumberArray(l.flatten(arguments));if(a instanceof Error)return a;for(var b=1,e=0;e<a.length;e++)b*=a[e];return b};d.QUOTIENT=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:parseInt(a/b,10)};d.RADIANS=function(a){a=l.parseNumber(a);return a instanceof Error?a:a*Math.PI/180};d.RAND=function(){return Math.random()};d.RANDBETWEEN=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:a+Math.ceil((b-a+1)*Math.random())-1};d.ROMAN=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=String(a).split("");for(var b=" C CC CCC CD D DC DCC DCCC CM  X XX XXX XL L LX LXX LXXX XC  I II III IV V VI VII VIII IX".split(" "),e="",d=3;d--;)e=(b[+a.pop()+10*d]||"")+e;return Array(+a.join("")+1).join("M")+e};d.ROUND=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:Math.round(a*Math.pow(10,b))/Math.pow(10,b)};d.ROUNDDOWN=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)};d.ROUNDUP=function(a,b){a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)};d.SEC=function(a){a=l.parseNumber(a);return a instanceof Error?a:1/Math.cos(a)};d.SECH=function(a){a=l.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))};d.SERIESSUM=function(a,b,e,d){a=l.parseNumber(a);b=l.parseNumber(b);e=l.parseNumber(e);d=l.parseNumberArray(d);if(l.anyIsError(a,b,e,d))return g.value;for(var f=d[0]*Math.pow(a,b),h=1;h<d.length;h++)f+=d[h]*Math.pow(a,b+h*e);return f};d.SIGN=function(a){a=l.parseNumber(a);return a instanceof Error?a:0>a?-1:0===a?0:1};d.SIN=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.sin(a)};d.SINH=function(a){a=l.parseNumber(a);return a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2};d.SQRT=function(a){a=l.parseNumber(a);return a instanceof Error?a:0>a?g.num:Math.sqrt(a)};d.SQRTPI=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.sqrt(a*Math.PI)};d.SQRT1_2=function(){return 1/Math.sqrt(2)};d.SQRT2=function(){return Math.sqrt(2)};d.SUBTOTAL=function(a,b){a=l.parseNumber(a);if(a instanceof Error)return a;switch(a){case 1:return e.AVERAGE(b);case 2:return e.COUNT(b);case 3:return e.COUNTA(b);case 4:return e.MAX(b);case 5:return e.MIN(b);case 6:return d.PRODUCT(b);case 7:return e.STDEV.S(b);case 8:return e.STDEV.P(b);case 9:return d.SUM(b);case 10:return e.VAR.S(b);case 11:return e.VAR.P(b);case 101:return e.AVERAGE(b);case 102:return e.COUNT(b);case 103:return e.COUNTA(b);case 104:return e.MAX(b);case 105:return e.MIN(b);case 106:return d.PRODUCT(b);case 107:return e.STDEV.S(b);case 108:return e.STDEV.P(b);case 109:return d.SUM(b);case 110:return e.VAR.S(b);case 111:return e.VAR.P(b)}};d.ADD=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:a+b};d.MINUS=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:a-b};d.DIVIDE=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:0===b?g.div0:a/b};d.MULTIPLY=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:a*b};d.GTE=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.error:a>=b};d.LT=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.error:a<b};d.LTE=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.error:a<=b};d.EQ=function(a,b){return 2!==arguments.length?g.na:a===b};d.NE=function(a,b){return 2!==arguments.length?g.na:a!==b};d.POW=function(a,b){if(2!==arguments.length)return g.na;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.error:d.POWER(a,b)};d.SUM=function(){var a=0;l.arrayEach(l.argsToArray(arguments),function(b){"number"===typeof b?a+=b:"string"===typeof b?(b=parseFloat(b),!isNaN(b)&&(a+=b)):Array.isArray(b)&&(a+=d.SUM.apply(null,b))});return a};d.SUMIF=function(a,b){a=l.parseNumberArray(l.flatten(a));if(a instanceof Error)return a;for(var e=0,d=0;d<a.length;d++)e+=eval(a[d]+b)?a[d]:0;return e};d.SUMIFS=function(){var a=l.argsToArray(arguments),b=l.parseNumberArray(l.flatten(a.shift()));if(b instanceof Error)return b;for(var e=b.length,d=a.length,g=0,h=0;h<e;h++){for(var m=b[h],n="",k=0;k<d;k++)n+=m+a[k],k!==d-1&&(n+="\x26\x26");eval(n)&&(g+=m)}return g};d.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return g.value;for(var a=arguments.length+1,b=0,e,d,h,m=0;m<arguments[0].length;m++)if(arguments[0][m]instanceof Array)for(var n=0;n<arguments[0][m].length;n++){for(d=e=1;d<a;d++){h=l.parseNumber(arguments[d-1][m][n]);if(h instanceof Error)return h;e*=h}b+=e}else{for(d=e=1;d<a;d++){h=l.parseNumber(arguments[d-1][m]);if(h instanceof Error)return h;e*=h}b+=e}return b};d.SUMSQ=function(){var a=l.parseNumberArray(l.flatten(arguments));if(a instanceof Error)return a;for(var b=0,e=a.length,d=0;d<e;d++)b+=n.ISNUMBER(a[d])?a[d]*a[d]:0;return b};d.SUMX2MY2=function(a,b){a=l.parseNumberArray(l.flatten(a));b=l.parseNumberArray(l.flatten(b));if(l.anyIsError(a,b))return g.value;for(var e=0,d=0;d<a.length;d++)e+=a[d]*a[d]-b[d]*b[d];return e};d.SUMX2PY2=function(a,b){a=l.parseNumberArray(l.flatten(a));b=l.parseNumberArray(l.flatten(b));if(l.anyIsError(a,b))return g.value;var e=0;a=l.parseNumberArray(l.flatten(a));b=l.parseNumberArray(l.flatten(b));for(var d=0;d<a.length;d++)e+=a[d]*a[d]+b[d]*b[d];return e};d.SUMXMY2=function(a,b){a=l.parseNumberArray(l.flatten(a));b=l.parseNumberArray(l.flatten(b));if(l.anyIsError(a,b))return g.value;var e=0;a=l.flatten(a);b=l.flatten(b);for(var d=0;d<a.length;d++)e+=Math.pow(a[d]-b[d],2);return e};d.TAN=function(a){a=l.parseNumber(a);return a instanceof Error?a:Math.tan(a)};d.TANH=function(a){a=l.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a-1)/(a+1)};d.TRUNC=function(a,b){b=void 0===b?0:b;a=l.parseNumber(a);b=l.parseNumber(b);return l.anyIsError(a,b)?g.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)}},function(k,d,h){var l=h(4);k=h(8);var g=h(13).jStat,e=h(2),n=h(0),m=h(12);d.AVEDEV=function(){var a=e.parseNumberArray(e.flatten(arguments));return a instanceof Error?a:g.sum(g(a).subtract(g.mean(a)).abs()[0])/a.length};d.AVERAGE=function(){for(var a=e.numbers(e.flatten(arguments)),b=a.length,d=0,g=0,h=0;h<b;h++)d+=a[h],g+=1;a=d/g;isNaN(a)&&(a=n.num);return a};d.AVERAGEA=function(){for(var a=e.flatten(arguments),b=a.length,d=0,g=0,h=0;h<b;h++){var m=a[h];"number"===typeof m&&(d+=m);!0===m&&d++;null!==m&&g++}a=d/g;isNaN(a)&&(a=n.num);return a};d.AVERAGEIF=function(a,b,d){if(1>=arguments.length)return n.na;d=d||a;a=e.flatten(a);d=e.parseNumberArray(e.flatten(d));if(d instanceof Error)return d;for(var f=0,g=0,h=0;h<a.length;h++)eval(a[h]+b)&&(g+=d[h],f++);return g/f};d.AVERAGEIFS=function(){for(var a=e.argsToArray(arguments),b=(a.length-1)/2,d=e.flatten(a[0]),g=0,h=0,m=0;m<d.length;m++){for(var n="",l=0;l<b;l++)n+=a[2*l+1][m]+a[2*l+2],l!==b-1&&(n+="\x26\x26");eval(n)&&(h+=d[m],g++)}a=h/g;return isNaN(a)?0:a};d.BETA={};d.BETA.DIST=function(a,b,d,h,m,l){if(4>arguments.length)return n.value;m=void 0===m?0:m;l=void 0===l?1:l;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);m=e.parseNumber(m);l=e.parseNumber(l);if(e.anyIsError(a,b,d,m,l))return n.value;a=(a-m)/(l-m);return h?g.beta.cdf(a,b,d):g.beta.pdf(a,b,d)};d.BETA.INV=function(a,b,d,h,m){h=void 0===h?0:h;m=void 0===m?1:m;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);h=e.parseNumber(h);m=e.parseNumber(m);return e.anyIsError(a,b,d,h,m)?n.value:g.beta.inv(a,b,d)*(m-h)+h};d.BINOM={};d.BINOM.DIST=function(a,b,d,h){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);h=e.parseNumber(h);return e.anyIsError(a,b,d,h)?n.value:h?g.binomial.cdf(a,b,d):g.binomial.pdf(a,b,d)};d.BINOM.DIST.RANGE=function(a,b,d,g){g=void 0===g?d:g;a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);g=e.parseNumber(g);if(e.anyIsError(a,b,d,g))return n.value;for(var f=0;d<=g;d++)f+=l.COMBIN(a,d)*Math.pow(b,d)*Math.pow(1-b,a-d);return f};d.BINOM.INV=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,b,d))return n.value;for(var f=0;f<=a;){if(g.binomial.cdf(f,a,b)>=d)return f;f++}};d.CHISQ={};d.CHISQ.DIST=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:d?g.chisquare.cdf(a,b):g.chisquare.pdf(a,b)};d.CHISQ.DIST.RT=function(a,b){return!a|!b?n.na:1>a||b>Math.pow(10,10)?n.num:"number"!==typeof a||"number"!==typeof b?n.value:1-g.chisquare.cdf(a,b)};d.CHISQ.INV=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:g.chisquare.inv(a,b)};d.CHISQ.INV.RT=function(a,b){return!a|!b?n.na:0>a||1<a||1>b||b>Math.pow(10,10)?n.num:"number"!==typeof a||"number"!==typeof b?n.value:g.chisquare.inv(1-a,b)};d.CHISQ.TEST=function(a,b){if(2!==arguments.length)return n.na;if(!(a instanceof Array&&b instanceof Array)||a.length!==b.length||a[0]&&b[0]&&a[0].length!==b[0].length)return n.value;var e=a.length,d,g;for(g=0;g<e;g++)a[g]instanceof Array||(d=a[g],a[g]=[],a[g].push(d)),b[g]instanceof Array||(d=b[g],b[g]=[],b[g].push(d));var h=a[0].length,m=0,l=Math.PI;for(g=0;g<e;g++)for(d=0;d<h;d++)m+=Math.pow(a[g][d]-b[g][d],2)/b[g][d];return Math.round(1E6*function(a,b){var e=Math.exp(-.5*a);1===b%2&&(e*=Math.sqrt(2*a/l));for(var d=b;2<=d;)e=e*a/d,d-=2;for(var d=e,f=b;d>1E-10*e;)f+=2,d=d*a/f,e+=d;return 1-e}(m,1===h?e-1:(e-1)*(h-1)))/1E6};d.COLUMN=function(a,b){if(2!==arguments.length)return n.na;if(0>b)return n.num;if(!(a instanceof Array)||"number"!==typeof b)return n.value;if(0!==a.length)return g.col(a,b)};d.COLUMNS=function(a){return 1!==arguments.length?n.na:a instanceof Array?0===a.length?0:g.cols(a):n.value};d.CONFIDENCE={};d.CONFIDENCE.NORM=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:g.normalci(1,a,b,d)[1]-1};d.CONFIDENCE.T=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:g.tci(1,a,b,d)[1]-1};d.CORREL=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));return e.anyIsError(a,b)?n.value:g.corrcoeff(a,b)};d.COUNT=function(){return e.numbers(e.flatten(arguments)).length};d.COUNTA=function(){var a=e.flatten(arguments);return a.length-d.COUNTBLANK(a)};d.COUNTIN=function(a,b){var d=0;a=e.flatten(a);for(var g=0;g<a.length;g++)a[g]===b&&d++;return d};d.COUNTBLANK=function(){for(var a=e.flatten(arguments),b=0,d,g=0;g<a.length;g++)d=a[g],null!==d&&""!==d||b++;return b};d.COUNTIF=function(a,b){a=e.flatten(a);/[<>=!]/.test(b)||(b='\x3d\x3d"'+b+'"');for(var d=0,g=0;g<a.length;g++)"string"!==typeof a[g]?eval(a[g]+b)&&d++:eval('"'+a[g]+'"'+b)&&d++;return d};d.COUNTIFS=function(){for(var a=e.argsToArray(arguments),b=Array(e.flatten(a[0]).length),d=0;d<b.length;d++)b[d]=!0;for(d=0;d<a.length;d+=2){var g=e.flatten(a[d]),h=a[d+1];/[<>=!]/.test(h)||(h='\x3d\x3d"'+h+'"');for(var m=0;m<g.length;m++)b[m]="string"!==typeof g[m]?b[m]&&eval(g[m]+h):b[m]&&eval('"'+g[m]+'"'+h)}for(d=a=0;d<b.length;d++)b[d]&&a++;return a};d.COUNTUNIQUE=function(){return m.UNIQUE.apply(null,e.flatten(arguments)).length};d.COVARIANCE={};d.COVARIANCE.P=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var d=g.mean(a),h=g.mean(b),m=0,l=a.length,k=0;k<l;k++)m+=(a[k]-d)*(b[k]-h);return m/l};d.COVARIANCE.S=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));return e.anyIsError(a,b)?n.value:g.covariance(a,b)};d.DEVSQ=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=g.mean(a),d=0,h=0;h<a.length;h++)d+=Math.pow(a[h]-b,2);return d};d.EXPON={};d.EXPON.DIST=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:d?g.exponential.cdf(a,b):g.exponential.pdf(a,b)};d.F={};d.F.DIST=function(a,b,d,h){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:h?g.centralF.cdf(a,b,d):g.centralF.pdf(a,b,d)};d.F.DIST.RT=function(a,b,e){return 3!==arguments.length?n.na:0>a||1>b||1>e?n.num:"number"!==typeof a||"number"!==typeof b||"number"!==typeof e?n.value:1-g.centralF.cdf(a,b,e)};d.F.INV=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:0>=a||1<a?n.num:g.centralF.inv(a,b,d)};d.F.INV.RT=function(a,b,e){return 3!==arguments.length?n.na:0>a||1<a||1>b||b>Math.pow(10,10)||1>e||e>Math.pow(10,10)?n.num:"number"!==typeof a||"number"!==typeof b||"number"!==typeof e?n.value:g.centralF.inv(1-a,b,e)};d.F.TEST=function(a,b){if(!(a&&b&&a instanceof Array&&b instanceof Array))return n.na;if(2>a.length||2>b.length)return n.div0;var e=function(a,b){for(var e=0,d=0;d<a.length;d++)e+=Math.pow(a[d]-b,2);return e},d=l.SUM(a)/a.length,g=l.SUM(b)/b.length,d=e(a,d)/(a.length-1),e=e(b,g)/(b.length-1);return d/e};d.FISHER=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log((1+a)/(1-a))/2};d.FISHERINV=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a-1)/(a+1)};d.FORECAST=function(a,b,d){a=e.parseNumber(a);b=e.parseNumberArray(e.flatten(b));d=e.parseNumberArray(e.flatten(d));if(e.anyIsError(a,b,d))return n.value;for(var f=g.mean(d),h=g.mean(b),m=d.length,l=0,k=0,p=0;p<m;p++)l+=(d[p]-f)*(b[p]-h),k+=Math.pow(d[p]-f,2);b=l/k;return h-b*f+b*a};d.FREQUENCY=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var d=a.length,g=b.length,h=[],m=0;m<=g;m++)for(var l=h[m]=0;l<d;l++)0===m?a[l]<=b[0]&&(h[0]+=1):m<g?a[l]>b[m-1]&&a[l]<=b[m]&&(h[m]+=1):m===g&&a[l]>b[g-1]&&(h[g]+=1);return h};d.GAMMA=function(a){a=e.parseNumber(a);return a instanceof Error?a:0===a||parseInt(a,10)===a&&0>a?n.num:g.gammafn(a)};d.GAMMA.DIST=function(a,b,e,d){return 4!==arguments.length?n.na:0>a||0>=b||0>=e||"number"!==typeof a||"number"!==typeof b||"number"!==typeof e?n.value:d?g.gamma.cdf(a,b,e,!0):g.gamma.pdf(a,b,e,!1)};d.GAMMA.INV=function(a,b,e){return 3!==arguments.length?n.na:0>a||1<a||0>=b||0>=e?n.num:"number"!==typeof a||"number"!==typeof b||"number"!==typeof e?n.value:g.gamma.inv(a,b,e)};d.GAMMALN=function(a){a=e.parseNumber(a);return a instanceof Error?a:g.gammaln(a)};d.GAMMALN.PRECISE=function(a){return 1!==arguments.length?n.na:0>=a?n.num:"number"!==typeof a?n.value:g.gammaln(a)};d.GAUSS=function(a){a=e.parseNumber(a);return a instanceof Error?a:g.normal.cdf(a,0,1)-.5};d.GEOMEAN=function(){var a=e.parseNumberArray(e.flatten(arguments));return a instanceof Error?a:g.geomean(a)};d.GROWTH=function(a,b,d,g){a=e.parseNumberArray(a);if(a instanceof Error)return a;var f;if(void 0===b)for(b=[],f=1;f<=a.length;f++)b.push(f);if(void 0===d)for(d=[],f=1;f<=a.length;f++)d.push(f);b=e.parseNumberArray(b);d=e.parseNumberArray(d);if(e.anyIsError(b,d))return n.value;void 0===g&&(g=!0);var h=a.length,m=0,l=0,k=0,t=0;for(f=0;f<h;f++)var p=b[f],q=Math.log(a[f]),m=m+p,l=l+q,k=k+p*q,t=t+p*p;m/=h;l/=h;k/=h;t/=h;g?(a=(k-m*l)/(t-m*m),m=l-a*m):(a=k/t,m=0);l=[];for(f=0;f<d.length;f++)l.push(Math.exp(m+a*d[f]));return l};d.HARMEAN=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,d=0,g=0;g<b;g++)d+=1/a[g];return b/d};d.HYPGEOM={};d.HYPGEOM.DIST=function(a,b,d,g,h){function f(a,b,e,d){return l.COMBIN(e,a)*l.COMBIN(d-e,b-a)/l.COMBIN(d,b)}function m(a,b,e,d){for(var g=0,h=0;h<=a;h++)g+=f(h,b,e,d);return g}a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);g=e.parseNumber(g);return e.anyIsError(a,b,d,g)?n.value:h?m(a,b,d,g):f(a,b,d,g)};d.INTERCEPT=function(a,b){a=e.parseNumberArray(a);b=e.parseNumberArray(b);return e.anyIsError(a,b)?n.value:a.length!==b.length?n.na:d.FORECAST(0,a,b)};d.KURT=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=g.mean(a),d=a.length,h=0,m=0;m<d;m++)h+=Math.pow(a[m]-b,4);h/=Math.pow(g.stdev(a,!0),4);return d*(d+1)/((d-1)*(d-2)*(d-3))*h-3*(d-1)*(d-1)/((d-2)*(d-3))};d.LARGE=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);return e.anyIsError(a,b)?a:a.sort(function(a,b){return b-a})[b-1]};d.LINEST=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var d=g.mean(a),h=g.mean(b),m=b.length,l=0,k=0,p=0;p<m;p++)l+=(b[p]-h)*(a[p]-d),k+=Math.pow(b[p]-h,2);m=l/k;return[m,d-m*h]};d.LOGEST=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var f=0;f<a.length;f++)a[f]=Math.log(a[f]);f=d.LINEST(a,b);f[0]=Math.round(1E6*Math.exp(f[0]))/1E6;f[1]=Math.round(1E6*Math.exp(f[1]))/1E6;return f};d.LOGNORM={};d.LOGNORM.DIST=function(a,b,d,h){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:h?g.lognormal.cdf(a,b,d):g.lognormal.pdf(a,b,d)};d.LOGNORM.INV=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:g.lognormal.inv(a,b,d)};d.MAX=function(){var a=e.numbers(e.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)};d.MAXA=function(){var a=e.arrayValuesToNumbers(e.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)};d.MEDIAN=function(){var a=e.arrayValuesToNumbers(e.flatten(arguments)),a=g.median(a);isNaN(a)&&(a=n.num);return a};d.MIN=function(){var a=e.numbers(e.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)};d.MINA=function(){var a=e.arrayValuesToNumbers(e.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)};d.MODE={};d.MODE.MULT=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,d={},g=[],h=0,m,n=0;n<b;n++)m=a[n],d[m]=d[m]?d[m]+1:1,d[m]>h&&(h=d[m],g=[]),d[m]===h&&(g[g.length]=m);return g};d.MODE.SNGL=function(){var a=e.parseNumberArray(e.flatten(arguments));return a instanceof Error?a:d.MODE.MULT(a).sort(function(a,e){return a-e})[0]};d.NEGBINOM={};d.NEGBINOM.DIST=function(a,b,d,h){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:h?g.negbin.cdf(a,b,d):g.negbin.pdf(a,b,d)};d.NORM={};d.NORM.DIST=function(a,b,d,h){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:0>=d?n.num:h?g.normal.cdf(a,b,d):g.normal.pdf(a,b,d)};d.NORM.INV=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:g.normal.inv(a,b,d)};d.NORM.S={};d.NORM.S.DIST=function(a,b){a=e.parseNumber(a);return a instanceof Error?n.value:b?g.normal.cdf(a,0,1):g.normal.pdf(a,0,1)};d.NORM.S.INV=function(a){a=e.parseNumber(a);return a instanceof Error?n.value:g.normal.inv(a,0,1)};d.PEARSON=function(a,b){b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return n.value;for(var d=g.mean(a),h=g.mean(b),m=a.length,l=0,k=0,p=0,q=0;q<m;q++)l+=(a[q]-d)*(b[q]-h),k+=Math.pow(a[q]-d,2),p+=Math.pow(b[q]-h,2);return l/Math.sqrt(k*p)};d.PERCENTILE={};d.PERCENTILE.EXC=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;a=a.sort(function(a,b){return a-b});var d=a.length;if(b<1/(d+1)||b>1-1/(d+1))return n.num;var d=b*(d+1)-1,g=Math.floor(d);return e.cleanFloat(d===g?a[d]:a[g]+(d-g)*(a[g+1]-a[g]))};d.PERCENTILE.INC=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;a=a.sort(function(a,b){return a-b});var d=b*(a.length-1),g=Math.floor(d);return e.cleanFloat(d===g?a[d]:a[g]+(d-g)*(a[g+1]-a[g]))};d.PERCENTRANK={};d.PERCENTRANK.EXC=function(a,b,d){d=void 0===d?3:d;a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,b,d))return n.value;a=a.sort(function(a,b){return a-b});var f=m.UNIQUE.apply(null,a),g=a.length,h=f.length;d=Math.pow(10,d);for(var l=0,k=!1,p=0;!k&&p<h;)b===f[p]?(l=(a.indexOf(f[p])+1)/(g+1),k=!0):b>=f[p]&&(b<f[p+1]||p===h-1)&&(l=(a.indexOf(f[p])+1+(b-f[p])/(f[p+1]-f[p]))/(g+1),k=!0),p++;return Math.floor(l*d)/d};d.PERCENTRANK.INC=function(a,b,d){d=void 0===d?3:d;a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);d=e.parseNumber(d);if(e.anyIsError(a,b,d))return n.value;a=a.sort(function(a,b){return a-b});var f=m.UNIQUE.apply(null,a),g=a.length,h=f.length;d=Math.pow(10,d);for(var l=0,k=!1,p=0;!k&&p<h;)b===f[p]?(l=a.indexOf(f[p])/(g-1),k=!0):b>=f[p]&&(b<f[p+1]||p===h-1)&&(l=(a.indexOf(f[p])+(b-f[p])/(f[p+1]-f[p]))/(g-1),k=!0),p++;return Math.floor(l*d)/d};d.PERMUT=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:l.FACT(a)/l.FACT(a-b)};d.PERMUTATIONA=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:Math.pow(a,b)};d.PHI=function(a){a=e.parseNumber(a);return a instanceof Error?n.value:Math.exp(-.5*a*a)/2.5066282746310002};d.POISSON={};d.POISSON.DIST=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:d?g.poisson.cdf(a,b):g.poisson.pdf(a,b)};d.PROB=function(a,b,d,g){if(void 0===d)return 0;g=void 0===g?d:g;a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));d=e.parseNumber(d);g=e.parseNumber(g);if(e.anyIsError(a,b,d,g))return n.value;if(d===g)return 0<=a.indexOf(d)?b[a.indexOf(d)]:0;for(var f=a.sort(function(a,b){return a-b}),h=f.length,m=0,l=0;l<h;l++)f[l]>=d&&f[l]<=g&&(m+=b[a.indexOf(f[l])]);return m};d.QUARTILE={};d.QUARTILE.EXC=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;switch(b){case 1:return d.PERCENTILE.EXC(a,.25);case 2:return d.PERCENTILE.EXC(a,.5);case 3:return d.PERCENTILE.EXC(a,.75);default:return n.num}};d.QUARTILE.INC=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;switch(b){case 1:return d.PERCENTILE.INC(a,.25);case 2:return d.PERCENTILE.INC(a,.5);case 3:return d.PERCENTILE.INC(a,.75);default:return n.num}};d.RANK={};d.RANK.AVG=function(a,b,d){a=e.parseNumber(a);b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;b=e.flatten(b);b=b.sort(d?function(a,b){return a-b}:function(a,b){return b-a});d=b.length;for(var f=0,g=0;g<d;g++)b[g]===a&&f++;return 1<f?(2*b.indexOf(a)+f+1)/2:b.indexOf(a)+1};d.RANK.EQ=function(a,b,d){a=e.parseNumber(a);b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;b=b.sort(d?function(a,b){return a-b}:function(a,b){return b-a});return b.indexOf(a)+1};d.ROW=function(a,b){if(2!==arguments.length)return n.na;if(0>b)return n.num;if(!(a instanceof Array)||"number"!==typeof b)return n.value;if(0!==a.length)return g.row(a,b)};d.ROWS=function(a){return 1!==arguments.length?n.na:a instanceof Array?0===a.length?0:g.rows(a):n.value};d.RSQ=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));return e.anyIsError(a,b)?n.value:Math.pow(d.PEARSON(a,b),2)};d.SKEW=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=g.mean(a),d=a.length,h=0,m=0;m<d;m++)h+=Math.pow(a[m]-b,3);return d*h/((d-1)*(d-2)*Math.pow(g.stdev(a,!0),3))};d.SKEW.P=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var b=g.mean(a),d=a.length,h=0,m=0,n=0;n<d;n++)m+=Math.pow(a[n]-b,3),h+=Math.pow(a[n]-b,2);return m/d/Math.pow(h/d,1.5)};d.SLOPE=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var d=g.mean(b),h=g.mean(a),m=b.length,l=0,k=0,p=0;p<m;p++)l+=(b[p]-d)*(a[p]-h),k+=Math.pow(b[p]-d,2);return l/k};d.SMALL=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);return e.anyIsError(a,b)?a:a.sort(function(a,b){return a-b})[b-1]};d.STANDARDIZE=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:(a-b)/d};d.STDEV={};d.STDEV.P=function(){var a=d.VAR.P.apply(this,arguments),a=Math.sqrt(a);isNaN(a)&&(a=n.num);return a};d.STDEV.S=function(){var a=d.VAR.S.apply(this,arguments);return Math.sqrt(a)};d.STDEVA=function(){var a=d.VARA.apply(this,arguments);return Math.sqrt(a)};d.STDEVPA=function(){var a=d.VARPA.apply(this,arguments),a=Math.sqrt(a);isNaN(a)&&(a=n.num);return a};d.STEYX=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;for(var d=g.mean(b),h=g.mean(a),m=b.length,l=0,k=0,p=0,q=0;q<m;q++)l+=Math.pow(a[q]-h,2),k+=(b[q]-d)*(a[q]-h),p+=Math.pow(b[q]-d,2);return Math.sqrt((l-k*k/p)/(m-2))};d.TRANSPOSE=function(a){return a?g.transpose(a):n.na};d.T=k.T;d.T.DIST=function(a,b,d){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:d?g.studentt.cdf(a,b):g.studentt.pdf(a,b)};d.T.DIST["2T"]=function(a,b){return 2!==arguments.length?n.na:0>a||1>b?n.num:"number"!==typeof a||"number"!==typeof b?n.value:2*(1-g.studentt.cdf(a,b))};d.T.DIST.RT=function(a,b){return 2!==arguments.length?n.na:0>a||1>b?n.num:"number"!==typeof a||"number"!==typeof b?n.value:1-g.studentt.cdf(a,b)};d.T.INV=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return e.anyIsError(a,b)?n.value:g.studentt.inv(a,b)};d.T.INV["2T"]=function(a,b){a=e.parseNumber(a);b=e.parseNumber(b);return 0>=a||1<a||1>b?n.num:e.anyIsError(a,b)?n.value:Math.abs(g.studentt.inv(a/2,b))};d.T.TEST=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));if(e.anyIsError(a,b))return n.value;var f=g.mean(a),h=g.mean(b),m=0,l=0,k;for(k=0;k<a.length;k++)m+=Math.pow(a[k]-f,2);for(k=0;k<b.length;k++)l+=Math.pow(b[k]-h,2);m/=a.length-1;l/=b.length-1;return d.T.DIST["2T"](Math.abs(f-h)/Math.sqrt(m/a.length+l/b.length),a.length+b.length-2)};d.TREND=function(a,b,f){a=e.parseNumberArray(e.flatten(a));b=e.parseNumberArray(e.flatten(b));f=e.parseNumberArray(e.flatten(f));if(e.anyIsError(a,b,f))return n.value;a=d.LINEST(a,b);var g=a[0],h=a[1],m=[];f.forEach(function(a){m.push(g*a+h)});return m};d.TRIMMEAN=function(a,b){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;var d=l.FLOOR(a.length*b,2)/2;return g.mean(e.initial(e.rest(a.sort(function(a,b){return a-b}),d),d))};d.VAR={};d.VAR.P=function(){for(var a=e.numbers(e.flatten(arguments)),b=a.length,f=0,g=d.AVERAGE(a),h=0;h<b;h++)f+=Math.pow(a[h]-g,2);a=f/b;isNaN(a)&&(a=n.num);return a};d.VAR.S=function(){for(var a=e.numbers(e.flatten(arguments)),b=a.length,f=0,g=d.AVERAGE(a),h=0;h<b;h++)f+=Math.pow(a[h]-g,2);return f/(b-1)};d.VARA=function(){for(var a=e.flatten(arguments),b=a.length,f=0,g=0,h=d.AVERAGEA(a),m=0;m<b;m++){var n=a[m],f="number"===typeof n?f+Math.pow(n-h,2):!0===n?f+Math.pow(1-h,2):f+Math.pow(0-h,2);null!==n&&g++}return f/(g-1)};d.VARPA=function(){for(var a=e.flatten(arguments),b=a.length,f=0,g=0,h=d.AVERAGEA(a),m=0;m<b;m++){var l=a[m],f="number"===typeof l?f+Math.pow(l-h,2):!0===l?f+Math.pow(1-h,2):f+Math.pow(0-h,2);null!==l&&g++}a=f/g;isNaN(a)&&(a=n.num);return a};d.WEIBULL={};d.WEIBULL.DIST=function(a,b,d,g){a=e.parseNumber(a);b=e.parseNumber(b);d=e.parseNumber(d);return e.anyIsError(a,b,d)?n.value:g?1-Math.exp(-Math.pow(a/d,b)):Math.pow(a,b-1)*Math.exp(-Math.pow(a/d,b))*b/Math.pow(d,b)};d.Z={};d.Z.TEST=function(a,b,f){a=e.parseNumberArray(e.flatten(a));b=e.parseNumber(b);if(e.anyIsError(a,b))return n.value;f=f||d.STDEV.S(a);var g=a.length;return 1-d.NORM.S.DIST((d.AVERAGE(a)-b)/(f/Math.sqrt(g)),!0)}},function(k,d,h){function l(a){return 1===(new Date(a,1,29)).getMonth()}function g(a,b){return Math.ceil((b-a)/1E3/60/60/24)}function e(b){return(b-a)/864E5+(-22038912E5<b?2:1)}var n=h(0),m=h(2),a=new Date(1900,0,1),b=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],f=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],p=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];d.DATE=function(a,b,e){a=m.parseNumber(a);b=m.parseNumber(b);e=m.parseNumber(e);return m.anyIsError(a,b,e)?n.value:0>a||0>b||0>e?n.num:new Date(a,b-1,e)};d.DATEVALUE=function(b){if("string"!==typeof b)return n.value;b=Date.parse(b);return isNaN(b)?n.value:-22038912E5>=b?(b-a)/864E5+1:(b-a)/864E5+2};d.DAY=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getDate()};d.DAYS=function(a,b){a=m.parseDate(a);b=m.parseDate(b);return a instanceof Error?a:b instanceof Error?b:e(a)-e(b)};d.DAYS360=function(a,b,e){e=m.parseBool(e);a=m.parseDate(a);b=m.parseDate(b);if(a instanceof Error)return a;if(b instanceof Error)return b;if(e instanceof Error)return e;var d=a.getMonth(),f=b.getMonth(),g;e?(e=31===a.getDate()?30:a.getDate(),g=31===b.getDate()?30:b.getDate()):(e=(new Date(a.getFullYear(),d+1,0)).getDate(),g=(new Date(b.getFullYear(),f+1,0)).getDate(),e=a.getDate()===e?30:a.getDate(),b.getDate()===g?30>e?(f++,g=1):g=30:g=b.getDate());return 360*(b.getFullYear()-a.getFullYear())+30*(f-d)+(g-e)};d.EDATE=function(a,b){a=m.parseDate(a);if(a instanceof Error)return a;if(isNaN(b))return n.value;b=parseInt(b,10);a.setMonth(a.getMonth()+b);return e(a)};d.EOMONTH=function(a,b){a=m.parseDate(a);if(a instanceof Error)return a;if(isNaN(b))return n.value;b=parseInt(b,10);return e(new Date(a.getFullYear(),a.getMonth()+b+1,0))};d.HOUR=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getHours()};d.INTERVAL=function(a){if("number"!==typeof a&&"string"!==typeof a)return n.value;a=parseInt(a,10);var b=Math.floor(a/94608E4);a%=94608E4;var e=Math.floor(a/2592E3);a%=2592E3;var d=Math.floor(a/86400);a%=86400;var f=Math.floor(a/3600);a%=3600;var g=Math.floor(a/60);a%=60;return"P"+(0<b?b+"Y":"")+(0<e?e+"M":"")+(0<d?d+"D":"")+"T"+(0<f?f+"H":"")+(0<g?g+"M":"")+(0<a?a+"S":"")};d.ISOWEEKNUM=function(a){a=m.parseDate(a);if(a instanceof Error)return a;a.setHours(0,0,0);a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864E5+1)/7)};d.MINUTE=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getMinutes()};d.MONTH=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getMonth()+1};d.NETWORKDAYS=function(a,b,e){return this.NETWORKDAYS.INTL(a,b,1,e)};d.NETWORKDAYS.INTL=function(a,b,e,d){a=m.parseDate(a);if(a instanceof Error)return a;b=m.parseDate(b);if(b instanceof Error)return b;e=void 0===e?p[1]:p[e];if(!(e instanceof Array))return n.value;void 0===d?d=[]:d instanceof Array||(d=[d]);for(var f=0;f<d.length;f++){var g=m.parseDate(d[f]);if(g instanceof Error)return g;d[f]=g}g=b=(b-a)/864E5+1;for(f=0;f<b;f++){var h=0<(new Date).getTimezoneOffset()?a.getUTCDay():a.getDay(),l=!1;if(h===e[0]||h===e[1])l=!0;for(h=0;h<d.length;h++){var k=d[h];if(k.getDate()===a.getDate()&&k.getMonth()===a.getMonth()&&k.getFullYear()===a.getFullYear()){l=!0;break}}l&&g--;a.setDate(a.getDate()+1)}return g};d.NOW=function(){return new Date};d.SECOND=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getSeconds()};d.TIME=function(a,b,e){a=m.parseNumber(a);b=m.parseNumber(b);e=m.parseNumber(e);return m.anyIsError(a,b,e)?n.value:0>a||0>b||0>e?n.num:(3600*a+60*b+e)/86400};d.TIMEVALUE=function(a){a=m.parseDate(a);return a instanceof Error?a:(3600*a.getHours()+60*a.getMinutes()+a.getSeconds())/86400};d.TODAY=function(){return new Date};d.WEEKDAY=function(a,b){a=m.parseDate(a);if(a instanceof Error)return a;void 0===b&&(b=1);var e=a.getDay();return f[b][e]};d.WEEKNUM=function(a,e){a=m.parseDate(a);if(a instanceof Error)return a;void 0===e&&(e=1);if(21===e)return this.ISOWEEKNUM(a);var d=b[e],f=new Date(a.getFullYear(),0,1),g=f.getDay()<d?1:0,f=f-864E5*Math.abs(f.getDay()-d);return Math.floor((a-f)/864E5/7+1)+g};d.WORKDAY=function(a,b,e){return this.WORKDAY.INTL(a,b,1,e)};d.WORKDAY.INTL=function(a,b,e,d){a=m.parseDate(a);if(a instanceof Error)return a;b=m.parseNumber(b);if(b instanceof Error)return b;if(0>b)return n.num;e=void 0===e?p[1]:p[e];if(!(e instanceof Array))return n.value;void 0===d?d=[]:d instanceof Array||(d=[d]);for(var f=0;f<d.length;f++){var g=m.parseDate(d[f]);if(g instanceof Error)return g;d[f]=g}for(f=0;f<b;)if(a.setDate(a.getDate()+1),g=a.getDay(),g!==e[0]&&g!==e[1]){for(g=0;g<d.length;g++){var h=d[g];if(h.getDate()===a.getDate()&&h.getMonth()===a.getMonth()&&h.getFullYear()===a.getFullYear()){f--;break}}f++}return a};d.YEAR=function(a){a=m.parseDate(a);return a instanceof Error?a:a.getFullYear()};d.YEARFRAC=function(a,b,e){a=m.parseDate(a);if(a instanceof Error)return a;b=m.parseDate(b);if(b instanceof Error)return b;e=e||0;var d=a.getDate(),f=a.getMonth()+1,h=a.getFullYear(),n=b.getDate(),k=b.getMonth()+1,p=b.getFullYear();switch(e){case 0:return 31===d&&31===n?n=d=30:31===d?d=30:30===d&&31===n&&(n=30),(n+30*k+360*p-(d+30*f+360*h))/360;case 1:e=365;if(h===p||h+1===p&&(f>k||f===k&&d>=n)){(d=h===p&&l(h))||(d=a,f=b,h=d.getFullYear(),p=new Date(h,2,1),l(h)&&d<p&&f>=p?d=!0:(h=f.getFullYear(),p=new Date(h,2,1),d=l(h)&&f>=p&&d<p));if(d||1===k&&29===n)e=366;return g(a,b)/e}n=(new Date(p+1,0,1)-new Date(h,0,1))/1E3/60/60/24/(p-h+1);return g(a,b)/n;case 2:return g(a,b)/360;case 3:return g(a,b)/365;case 4:return(n+30*k+360*p-(d+30*f+360*h))/360}}},function(k,d,h){var l=h(0);d.CELL=function(){throw Error("CELL is not implemented");};d.ERROR={};d.ERROR.TYPE=function(d){switch(d){case l.nil:return 1;case l.div0:return 2;case l.value:return 3;case l.ref:return 4;case l.name:return 5;case l.num:return 6;case l.na:return 7;case l.data:return 8}return l.na};d.INFO=function(){throw Error("INFO is not implemented");};d.ISBLANK=function(d){return null===d};d.ISBINARY=function(d){return/^[01]{1,10}$/.test(d)};d.ISERR=function(d){return 0<=[l.value,l.ref,l.div0,l.num,l.name,l.nil].indexOf(d)||"number"===typeof d&&(isNaN(d)||!isFinite(d))};d.ISERROR=function(g){return d.ISERR(g)||g===l.na};d.ISEVEN=function(d){return Math.floor(Math.abs(d))&1?!1:!0};d.ISFORMULA=function(){throw Error("ISFORMULA is not implemented");};d.ISLOGICAL=function(d){return!0===d||!1===d};d.ISNA=function(d){return d===l.na};d.ISNONTEXT=function(d){return"string"!==typeof d};d.ISNUMBER=function(d){return"number"===typeof d&&!isNaN(d)&&isFinite(d)};d.ISODD=function(d){return Math.floor(Math.abs(d))&1?!0:!1};d.ISREF=function(){throw Error("ISREF is not implemented");};d.ISTEXT=function(d){return"string"===typeof d};d.N=function(d){return this.ISNUMBER(d)?d:d instanceof Date?d.getTime():!0===d?1:!1===d?0:this.ISERROR(d)?d:0};d.NA=function(){return l.na};d.SHEET=function(){throw Error("SHEET is not implemented");};d.SHEETS=function(){throw Error("SHEETS is not implemented");};d.TYPE=function(d){if(this.ISNUMBER(d))return 1;if(this.ISTEXT(d))return 2;if(this.ISLOGICAL(d))return 4;if(this.ISERROR(d))return 16;if(Array.isArray(d))return 64}},function(k,d,h){var l=h(2),g=h(0),e=h(14);d.ASC=function(){throw Error("ASC is not implemented");};d.BAHTTEXT=function(){throw Error("BAHTTEXT is not implemented");};d.CHAR=function(e){e=l.parseNumber(e);return e instanceof Error?e:String.fromCharCode(e)};d.CLEAN=function(e){return(e||"").replace(/[\0-\x1F]/g,"")};d.CODE=function(e){e=(e||"").charCodeAt(0);isNaN(e)&&(e=g.na);return e};d.CONCATENATE=function(){for(var e=l.flatten(arguments),d;-1<(d=e.indexOf(!0));)e[d]="TRUE";for(;-1<(d=e.indexOf(!1));)e[d]="FALSE";return e.join("")};d.DBCS=function(){throw Error("DBCS is not implemented");};d.DOLLAR=function(d,h){h=void 0===h?2:h;d=l.parseNumber(d);h=l.parseNumber(h);if(l.anyIsError(d,h))return g.value;var a="";0>=h?(d=Math.round(d*Math.pow(10,h))/Math.pow(10,h),a="($0,0)"):0<h&&(a="($0,0."+Array(h+1).join("0")+")");return e(d).format(a)};d.EXACT=function(e,d){return 2!==arguments.length?g.na:e===d};d.FIND=function(e,d,a){return 2>arguments.length?g.na:d?d.indexOf(e,(void 0===a?0:a)-1)+1:null};d.FIXED=function(d,h,a){h=void 0===h?2:h;a=void 0===a?!1:a;d=l.parseNumber(d);h=l.parseNumber(h);if(l.anyIsError(d,h))return g.value;a=a?"0":"0,0";0>=h?d=Math.round(d*Math.pow(10,h))/Math.pow(10,h):0<h&&(a+="."+Array(h+1).join("0"));return e(d).format(a)};d.HTML2TEXT=function(e){var d="";e&&(e instanceof Array?e.forEach(function(a){""!==d&&(d+="\n");d+=a.replace(/<(?:.|\n)*?>/gm,"")}):d=e.replace(/<(?:.|\n)*?>/gm,""));return d};d.LEFT=function(e,d){d=l.parseNumber(void 0===d?1:d);return d instanceof Error||"string"!==typeof e?g.value:e?e.substring(0,d):null};d.LEN=function(e){return 0===arguments.length?g.error:"string"===typeof e?e?e.length:0:e.length?e.length:g.value};d.LOWER=function(e){return"string"!==typeof e?g.value:e?e.toLowerCase():e};d.MID=function(e,d,a){d=l.parseNumber(d);a=l.parseNumber(a);if(l.anyIsError(d,a)||"string"!==typeof e)return a;--d;return e.substring(d,d+a)};d.NUMBERVALUE=function(e,d,a){a="undefined"===typeof a?",":a;return Number(e.replace("undefined"===typeof d?".":d,".").replace(a,""))};d.PRONETIC=function(){throw Error("PRONETIC is not implemented");};d.PROPER=function(e){if(void 0===e||0===e.length)return g.value;!0===e&&(e="TRUE");!1===e&&(e="FALSE");if(isNaN(e)&&"number"===typeof e)return g.value;"number"===typeof e&&(e=""+e);return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})};d.REGEXEXTRACT=function(e,d){if(2>arguments.length)return g.na;var a=e.match(new RegExp(d));return a?a[1<a.length?a.length-1:0]:null};d.REGEXMATCH=function(e,d,a){if(2>arguments.length)return g.na;var b=e.match(new RegExp(d));return a?b:!!b};d.REGEXREPLACE=function(e,d,a){return 3>arguments.length?g.na:e.replace(new RegExp(d),a)};d.REPLACE=function(e,d,a,b){d=l.parseNumber(d);a=l.parseNumber(a);return l.anyIsError(d,a)||"string"!==typeof e||"string"!==typeof b?g.value:e.substr(0,d-1)+b+e.substr(d-1+a)};d.REPT=function(e,d){d=l.parseNumber(d);return d instanceof Error?d:Array(d+1).join(e)};d.RIGHT=function(e,d){d=l.parseNumber(void 0===d?1:d);return d instanceof Error?d:e?e.substring(e.length-d):g.na};d.SEARCH=function(e,d,a){if("string"!==typeof e||"string"!==typeof d)return g.value;a=void 0===a?0:a;e=d.toLowerCase().indexOf(e.toLowerCase(),a-1)+1;return 0===e?g.value:e};d.SPLIT=function(e,d){return e.split(d)};d.SUBSTITUTE=function(e,d,a,b){if(2>arguments.length)return g.na;if(e&&d&&a){if(void 0===b)return e.replace(new RegExp(d,"g"),a);for(var f=0,h=0;0<e.indexOf(d,f);)if(f=e.indexOf(d,f+1),h++,h===b)return e.substring(0,f)+a+e.substring(f+d.length)}else return e};d.T=function(e){return"string"===typeof e?e:""};d.TEXT=function(d,h){d=l.parseNumber(d);return l.anyIsError(d)?g.na:e(d).format(h)};d.TRIM=function(e){return"string"!==typeof e?g.value:e.replace(/ +/g," ").trim()};d.UNICHAR=d.CHAR;d.UNICODE=d.CODE;d.UPPER=function(e){return"string"!==typeof e?g.value:e.toUpperCase()};d.VALUE=function(d){if("string"!==typeof d)return g.value;d=e().unformat(d);return void 0===d?0:d}},function(k,d,h){function l(a){a=parseInt(a,10);return a=isNaN(a)?-1:Math.max(a-1,-1)}function g(a){var b="";0<=a&&(b=""+(a+1));return b}function e(b){var e=0;if("string"===typeof b){b=b.toUpperCase();for(var d=0,f=b.length-1;d<b.length;d+=1,--f)e+=Math.pow(a,f)*(m.indexOf(b[d])+1)}--e;return e}function n(b){for(var e="";0<=b;)e=String.fromCharCode(b%a+97)+e,b=Math.floor(b/a)-1;return e.toUpperCase()}d.__esModule=!0;d.rowLabelToIndex=l;d.rowIndexToLabel=g;d.columnLabelToIndex=e;d.columnIndexToLabel=n;d.extractLabel=function(a){if("string"!==typeof a||!b.test(a))return[];var d=a.toUpperCase().match(b);a=d[1];var f=d[2],g=d[3],d=d[4];return[{index:l(d),label:d,isAbsolute:"$"===g},{index:e(f),label:f,isAbsolute:"$"===a}]};d.toLabel=function(a,b){var e=(a.isAbsolute?"$":"")+g(a.index);return(b.isAbsolute?"$":"")+n(b.index)+e};var m="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=m.length,b=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(k,d,h){d.__esModule=!0;d["default"]="ABS ACCRINT ACOS ACOSH ACOT ACOTH ADD AGGREGATE AND ARABIC ARGS2ARRAY ASIN ASINH ATAN ATAN2 ATANH AVEDEV AVERAGE AVERAGEA AVERAGEIF AVERAGEIFS BASE BESSELI BESSELJ BESSELK BESSELY BETA.DIST BETA.INV BETADIST BETAINV BIN2DEC BIN2HEX BIN2OCT BINOM.DIST BINOM.DIST.RANGE BINOM.INV BINOMDIST BITAND BITLSHIFT BITOR BITRSHIFT BITXOR CEILING CEILINGMATH CEILINGPRECISE CHAR CHISQ.DIST CHISQ.DIST.RT CHISQ.INV CHISQ.INV.RT CHOOSE CHOOSE CLEAN CODE COLUMN COLUMNS COMBIN COMBINA COMPLEX CONCATENATE CONFIDENCE CONFIDENCE.NORM CONFIDENCE.T CONVERT CORREL COS COSH COT COTH COUNT COUNTA COUNTBLANK COUNTIF COUNTIFS COUNTIN COUNTUNIQUE COVARIANCE.P COVARIANCE.S CSC CSCH CUMIPMT CUMPRINC DATE DATEVALUE DAY DAYS DAYS360 DB DDB DEC2BIN DEC2HEX DEC2OCT DECIMAL DEGREES DELTA DEVSQ DIVIDE DOLLAR DOLLARDE DOLLARFR E EDATE EFFECT EOMONTH EQ ERF ERFC EVEN EXACT EXPON.DIST EXPONDIST F.DIST F.DIST.RT F.INV F.INV.RT FACT FACTDOUBLE FALSE FDIST FDISTRT FIND FINV FINVRT FISHER FISHERINV FIXED FLATTEN FLOOR FORECAST FREQUENCY FV FVSCHEDULE GAMMA GAMMA.DIST GAMMA.INV GAMMADIST GAMMAINV GAMMALN GAMMALN.PRECISE GAUSS GCD GEOMEAN GESTEP GROWTH GTE HARMEAN HEX2BIN HEX2DEC HEX2OCT HOUR HTML2TEXT HYPGEOM.DIST HYPGEOMDIST IF IMABS IMAGINARY IMARGUMENT IMCONJUGATE IMCOS IMCOSH IMCOT IMCSC IMCSCH IMDIV IMEXP IMLN IMLOG10 IMLOG2 IMPOWER IMPRODUCT IMREAL IMSEC IMSECH IMSIN IMSINH IMSQRT IMSUB IMSUM IMTAN INT INTERCEPT INTERVAL IPMT IRR ISBINARY ISBLANK ISEVEN ISLOGICAL ISNONTEXT ISNUMBER ISODD ISODD ISOWEEKNUM ISPMT ISTEXT JOIN KURT LARGE LCM LEFT LEN LINEST LN LOG LOG10 LOGEST LOGNORM.DIST LOGNORM.INV LOGNORMDIST LOGNORMINV LOWER LT LTE MATCH MAX MAXA MEDIAN MID MIN MINA MINUS MINUTE MIRR MOD MODE.MULT MODE.SNGL MODEMULT MODESNGL MONTH MROUND MULTINOMIAL MULTIPLY NE NEGBINOM.DIST NEGBINOMDIST NETWORKDAYS NOMINAL NORM.DIST NORM.INV NORM.S.DIST NORM.S.INV NORMDIST NORMINV NORMSDIST NORMSINV NOT NOW NPER NPV NUMBERS NUMERAL OCT2BIN OCT2DEC OCT2HEX ODD OR PDURATION PEARSON PERCENTILEEXC PERCENTILEINC PERCENTRANKEXC PERCENTRANKINC PERMUT PERMUTATIONA PHI PI PMT POISSON.DIST POISSONDIST POW POWER PPMT PROB PRODUCT PROPER PV QUARTILE.EXC QUARTILE.INC QUARTILEEXC QUARTILEINC QUOTIENT RADIANS RAND RANDBETWEEN RANK.AVG RANK.EQ RANKAVG RANKEQ RATE REFERENCE REGEXEXTRACT REGEXMATCH REGEXREPLACE REPLACE REPT RIGHT ROMAN ROUND ROUNDDOWN ROUNDUP ROW ROWS RRI RSQ SEARCH SEC SECH SECOND SERIESSUM SIGN SIN SINH SKEW SKEW.P SKEWP SLN SLOPE SMALL SPLIT SPLIT SQRT SQRTPI STANDARDIZE STDEV.P STDEV.S STDEVA STDEVP STDEVPA STDEVS STEYX SUBSTITUTE SUBTOTAL SUM SUMIF SUMIFS SUMPRODUCT SUMSQ SUMX2MY2 SUMX2PY2 SUMXMY2 SWITCH SYD T T.DIST T.DIST.2T T.DIST.RT T.INV T.INV.2T TAN TANH TBILLEQ TBILLPRICE TBILLYIELD TDIST TDIST2T TDISTRT TEXT TIME TIMEVALUE TINV TINV2T TODAY TRANSPOSE TREND TRIM TRIMMEAN TRUE TRUNC UNICHAR UNICODE UNIQUE UPPER VALUE VAR.P VAR.S VARA VARP VARPA VARS WEEKDAY WEEKNUM WEIBULL.DIST WEIBULLDIST WORKDAY XIRR XNPV XOR YEAR YEARFRAC".split(" ")},function(k,d,h){var l=h(0),g=h(13).jStat,e=h(8),n=h(2),m=h(32);d.BESSELI=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:m.besseli(a,b)};d.BESSELJ=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:m.besselj(a,b)};d.BESSELK=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:m.besselk(a,b)};d.BESSELY=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:m.bessely(a,b)};d.BIN2DEC=function(a){if(!/^[01]{1,10}$/.test(a))return l.num;var b=parseInt(a,2);a=a.toString();return 10===a.length&&"1"===a.substring(0,1)?parseInt(a.substring(1),2)-512:b};d.BIN2HEX=function(a,b){if(!/^[01]{1,10}$/.test(a))return l.num;var d=a.toString();if(10===d.length&&"1"===d.substring(0,1))return(0xfffffffe00+parseInt(d.substring(1),2)).toString(16);d=parseInt(a,2).toString(16);if(void 0===b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.BIN2OCT=function(a,b){if(!/^[01]{1,10}$/.test(a))return l.num;var d=a.toString();if(10===d.length&&"1"===d.substring(0,1))return(1073741312+parseInt(d.substring(1),2)).toString(8);d=parseInt(a,2).toString(8);if(void 0===b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.BITAND=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?l.num:a&b};d.BITLSHIFT=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(b)?l.num:0<=b?a<<b:a>>-b};d.BITOR=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?l.num:a|b};d.BITRSHIFT=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:0>a||Math.floor(a)!==a||0xffffffffffff<a||53<Math.abs(b)?l.num:0<=b?a>>b:a<<-b};d.BITXOR=function(a,b){a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:0>a||0>b||Math.floor(a)!==a||Math.floor(b)!==b||0xffffffffffff<a||0xffffffffffff<b?l.num:a^b};d.COMPLEX=function(a,b,e){a=n.parseNumber(a);b=n.parseNumber(b);if(n.anyIsError(a,b))return a;e=void 0===e?"i":e;return"i"!==e&&"j"!==e?l.value:0===a&&0===b?0:0===a?1===b?e:b.toString()+e:0===b?a.toString():a.toString()+(0<b?"+":"")+(1===b?e:b.toString()+e)};d.CONVERT=function(a,b,e){a=n.parseNumber(a);if(a instanceof Error)return a;for(var d=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree","\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon","tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},g={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},h=null,m=null,k=b,p=e,q=1,r=1,A,B=0;B<d.length;B++){A=null===d[B][2]?[]:d[B][2];if(d[B][1]===k||0<=A.indexOf(k))h=d[B];if(d[B][1]===p||0<=A.indexOf(p))m=d[B]}if(null===h)for(A=f[b.substring(0,2)],B=g[b.substring(0,1)],"da"===b.substring(0,2)&&(B=["dekao",10,"da"]),A?(q=A[2],k=b.substring(2)):B&&(q=B[1],k=b.substring(B[2].length)),b=0;b<d.length;b++)if(A=null===d[b][2]?[]:d[b][2],d[b][1]===k||0<=A.indexOf(k))h=d[b];if(null===m)for(f=f[e.substring(0,2)],g=g[e.substring(0,1)],"da"===e.substring(0,2)&&(g=["dekao",10,"da"]),f?(r=f[2],p=e.substring(2)):g&&(r=g[1],p=e.substring(g[2].length)),e=0;e<d.length;e++)if(A=null===d[e][2]?[]:d[e][2],d[e][1]===p||0<=A.indexOf(p))m=d[e];return null===h||null===m||h[3]!==m[3]?l.na:a*h[6]*q/(m[6]*r)};d.DEC2BIN=function(a,b){a=n.parseNumber(a);if(a instanceof Error)return a;if(!/^-?[0-9]{1,3}$/.test(a)||-512>a||511<a)return l.num;if(0>a)return"1"+e.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var d=parseInt(a,10).toString(2);if("undefined"===typeof b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.DEC2HEX=function(a,b){a=n.parseNumber(a);if(a instanceof Error)return a;if(!/^-?[0-9]{1,12}$/.test(a)||-549755813888>a||549755813887<a)return l.num;if(0>a)return(1099511627776+a).toString(16);var d=parseInt(a,10).toString(16);if("undefined"===typeof b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.DEC2OCT=function(a,b){a=n.parseNumber(a);if(a instanceof Error)return a;if(!/^-?[0-9]{1,9}$/.test(a)||-536870912>a||536870911<a)return l.num;if(0>a)return(1073741824+a).toString(8);var d=parseInt(a,10).toString(8);if("undefined"===typeof b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.DELTA=function(a,b){b=void 0===b?0:b;a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:a===b?1:0};d.ERF=function(a,b){b=void 0===b?0:b;a=n.parseNumber(a);b=n.parseNumber(b);return n.anyIsError(a,b)?l.value:g.erf(a)};d.ERF.PRECISE=function(){throw Error("ERF.PRECISE is not implemented");};d.ERFC=function(a){return isNaN(a)?l.value:g.erfc(a)};d.ERFC.PRECISE=function(){throw Error("ERFC.PRECISE is not implemented");};d.GESTEP=function(a,b){b=b||0;a=n.parseNumber(a);return n.anyIsError(b,a)?a:a>=b?1:0};d.HEX2BIN=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return l.num;var d=10===a.length&&"f"===a.substring(0,1).toLowerCase()?!0:!1,g=d?parseInt(a,16)-1099511627776:parseInt(a,16);if(-512>g||511<g)return l.num;if(d)return"1"+e.REPT("0",9-(512+g).toString(2).length)+(512+g).toString(2);d=g.toString(2);if(void 0===b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.HEX2DEC=function(a){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return l.num;a=parseInt(a,16);return 549755813888<=a?a-1099511627776:a};d.HEX2OCT=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return l.num;var d=parseInt(a,16);if(536870911<d&&0xffe0000000>d)return l.num;if(0xffe0000000<=d)return(d-0xffc0000000).toString(8);d=d.toString(8);if(void 0===b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.IMABS=function(a){var b=d.IMREAL(a);a=d.IMAGINARY(a);return n.anyIsError(b,a)?l.value:Math.sqrt(Math.pow(b,2)+Math.pow(a,2))};d.IMAGINARY=function(a){if(void 0===a||!0===a||!1===a)return l.value;if(0===a||"0"===a)return 0;if(0<=["i","j"].indexOf(a))return 1;a=a.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var b=a.indexOf("+"),e=a.indexOf("-");0===b&&(b=a.indexOf("+",1));0===e&&(e=a.indexOf("-",1));var d=a.substring(a.length-1,a.length),d="i"===d||"j"===d;return 0<=b||0<=e?d?0<=b?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?l.num:Number(a.substring(b+1,a.length-1)):isNaN(a.substring(0,e))||isNaN(a.substring(e+1,a.length-1))?l.num:-Number(a.substring(e+1,a.length-1)):l.num:d?isNaN(a.substring(0,a.length-1))?l.num:a.substring(0,a.length-1):isNaN(a)?l.num:0};d.IMARGUMENT=function(a){var b=d.IMREAL(a);a=d.IMAGINARY(a);return n.anyIsError(b,a)?l.value:0===b&&0===a?l.div0:0===b&&0<a?Math.PI/2:0===b&&0>a?-Math.PI/2:0===a&&0<b?0:0===a&&0>b?-Math.PI:0<b?Math.atan(a/b):0>b&&0<=a?Math.atan(a/b)+Math.PI:Math.atan(a/b)-Math.PI};d.IMCONJUGATE=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;var g=a.substring(a.length-1);return 0!==e?d.COMPLEX(b,-e,"i"===g||"j"===g?g:"i"):a};d.IMCOS=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.cos(b)*(Math.exp(e)+Math.exp(-e))/2,-Math.sin(b)*(Math.exp(e)-Math.exp(-e))/2,"i"===a||"j"===a?a:"i")};d.IMCOSH=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.cos(e)*(Math.exp(b)+Math.exp(-b))/2,Math.sin(e)*(Math.exp(b)-Math.exp(-b))/2,"i"===a||"j"===a?a:"i")};d.IMCOT=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.value:d.IMDIV(d.IMCOS(a),d.IMSIN(a))};d.IMDIV=function(a,b){var e=d.IMREAL(a),g=d.IMAGINARY(a),h=d.IMREAL(b),m=d.IMAGINARY(b);if(n.anyIsError(e,g,h,m))return l.value;var k=a.substring(a.length-1),p=b.substring(b.length-1),q="i";"j"===k?q="j":"j"===p&&(q="j");if(0===h&&0===m)return l.num;k=h*h+m*m;return d.COMPLEX((e*h+g*m)/k,(g*h-e*m)/k,q)};d.IMEXP=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);b=Math.exp(b);return d.COMPLEX(b*Math.cos(e),b*Math.sin(e),"i"===a||"j"===a?a:"i")};d.IMLN=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.log(Math.sqrt(b*b+e*e)),Math.atan(e/b),"i"===a||"j"===a?a:"i")};d.IMLOG10=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.log(Math.sqrt(b*b+e*e))/Math.log(10),Math.atan(e/b)/Math.log(10),"i"===a||"j"===a?a:"i")};d.IMLOG2=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.log(Math.sqrt(b*b+e*e))/Math.log(2),Math.atan(e/b)/Math.log(2),"i"===a||"j"===a?a:"i")};d.IMPOWER=function(a,b){b=n.parseNumber(b);var e=d.IMREAL(a),g=d.IMAGINARY(a);if(n.anyIsError(b,e,g))return l.value;var e=a.substring(a.length-1),e="i"===e||"j"===e?e:"i",g=Math.pow(d.IMABS(a),b),h=d.IMARGUMENT(a);return d.COMPLEX(g*Math.cos(b*h),g*Math.sin(b*h),e)};d.IMPRODUCT=function(){var a=arguments[0];if(!arguments.length)return l.value;for(var b=1;b<arguments.length;b++){var e=d.IMREAL(a),a=d.IMAGINARY(a),g=d.IMREAL(arguments[b]),h=d.IMAGINARY(arguments[b]);if(n.anyIsError(e,a,g,h))return l.value;a=d.COMPLEX(e*g-a*h,e*h+a*g)}return a};d.IMREAL=function(a){if(void 0===a||!0===a||!1===a)return l.value;if(0===a||"0"===a||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(a))return 0;var b=a.indexOf("+"),e=a.indexOf("-");0===b&&(b=a.indexOf("+",1));0===e&&(e=a.indexOf("-",1));var d=a.substring(a.length-1,a.length),d="i"===d||"j"===d;return 0<=b||0<=e?d?0<=b?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?l.num:Number(a.substring(0,b)):isNaN(a.substring(0,e))||isNaN(a.substring(e+1,a.length-1))?l.num:Number(a.substring(0,e)):l.num:d?isNaN(a.substring(0,a.length-1))?l.num:0:isNaN(a)?l.num:a};d.IMSEC=function(a){if(!0===a||!1===a)return l.value;var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.value:d.IMDIV("1",d.IMCOS(a))};d.IMSECH=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.value:d.IMDIV("1",d.IMCOSH(a))};d.IMSIN=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.sin(b)*(Math.exp(e)+Math.exp(-e))/2,Math.cos(b)*(Math.exp(e)-Math.exp(-e))/2,"i"===a||"j"===a?a:"i")};d.IMSINH=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;a=a.substring(a.length-1);return d.COMPLEX(Math.cos(e)*(Math.exp(b)-Math.exp(-b))/2,Math.sin(e)*(Math.exp(b)+Math.exp(-b))/2,"i"===a||"j"===a?a:"i")};d.IMSQRT=function(a){var b=d.IMREAL(a),e=d.IMAGINARY(a);if(n.anyIsError(b,e))return l.value;b=a.substring(a.length-1);b="i"===b||"j"===b?b:"i";e=Math.sqrt(d.IMABS(a));a=d.IMARGUMENT(a);return d.COMPLEX(e*Math.cos(a/2),e*Math.sin(a/2),b)};d.IMCSC=function(a){if(!0===a||!1===a)return l.value;var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.num:d.IMDIV("1",d.IMSIN(a))};d.IMCSCH=function(a){if(!0===a||!1===a)return l.value;var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.num:d.IMDIV("1",d.IMSINH(a))};d.IMSUB=function(a,b){var e=this.IMREAL(a),d=this.IMAGINARY(a),g=this.IMREAL(b),h=this.IMAGINARY(b);if(n.anyIsError(e,d,g,h))return l.value;var m=a.substring(a.length-1),k=b.substring(b.length-1),p="i";"j"===m?p="j":"j"===k&&(p="j");return this.COMPLEX(e-g,d-h,p)};d.IMSUM=function(){if(!arguments.length)return l.value;for(var a=n.flatten(arguments),b=a[0],e=1;e<a.length;e++){var d=this.IMREAL(b),b=this.IMAGINARY(b),g=this.IMREAL(a[e]),h=this.IMAGINARY(a[e]);if(n.anyIsError(d,b,g,h))return l.value;b=this.COMPLEX(d+g,b+h)}return b};d.IMTAN=function(a){if(!0===a||!1===a)return l.value;var b=d.IMREAL(a),e=d.IMAGINARY(a);return n.anyIsError(b,e)?l.value:this.IMDIV(this.IMSIN(a),this.IMCOS(a))};d.OCT2BIN=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return l.num;var d=10===a.length&&"7"===a.substring(0,1)?!0:!1,g=d?parseInt(a,8)-1073741824:parseInt(a,8);if(-512>g||511<g)return l.num;if(d)return"1"+e.REPT("0",9-(512+g).toString(2).length)+(512+g).toString(2);d=g.toString(2);if("undefined"===typeof b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num};d.OCT2DEC=function(a){if(!/^[0-7]{1,10}$/.test(a))return l.num;a=parseInt(a,8);return 536870912<=a?a-1073741824:a};d.OCT2HEX=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return l.num;var d=parseInt(a,8);if(536870912<=d)return"ff"+(d+3221225472).toString(16);d=d.toString(16);if(void 0===b)return d;if(isNaN(b))return l.value;if(0>b)return l.num;b=Math.floor(b);return b>=d.length?e.REPT("0",b-d.length)+d:l.num}},function(k,d,h){var l=h(2),g=h(14),e=h(0);d.UNIQUE=function(){for(var e=[],d=0;d<arguments.length;++d){for(var a=!1,b=arguments[d],f=0;f<e.length&&!(a=e[f]===b);++f);a||e.push(b)}return e};d.FLATTEN=l.flatten;d.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};d.REFERENCE=function(d,g){if(!arguments.length)return e.error;try{for(var a=g.split("."),b=d,f=0;f<a.length;++f){var h=a[f];if("]"===h[h.length-1])var m=h.indexOf("["),l=h.substring(m+1,h.length-1),b=b[h.substring(0,m)][l];else b=b[h]}return b}catch(y){}};d.JOIN=function(e,d){return e.join(d)};d.NUMBERS=function(){return l.flatten(arguments).filter(function(e){return"number"===typeof e})};d.NUMERAL=function(e,d){return g(e).format(d)}},function(k,d){this.j$=this.jStat=function(d,l){function g(a,b){var e=a>b?a:b;return d.pow(10,17-~~(d.log(0<e?e:-e)*d.LOG10E))}function e(a){return"[object Function]"===v.call(a)}function h(a){return"number"===typeof a&&a===a}function m(){return new m._init(arguments)}function a(){return 0}function b(){return 1}function f(a,b){return a===b?1:0}var k=Array.prototype.concat,p=Array.prototype.slice,v=Object.prototype.toString,q=Array.isArray||function(a){return"[object Array]"===v.call(a)};m.fn=m.prototype;m._init=function(a){var b;if(q(a[0]))if(q(a[0][0])){e(a[1])&&(a[0]=m.map(a[0],a[1]));for(b=0;b<a[0].length;b++)this[b]=a[0][b];this.length=a[0].length}else this[0]=e(a[1])?m.map(a[0],a[1]):a[0],this.length=1;else{if(h(a[0]))this[0]=m.seq.apply(null,a);else{if(a[0]instanceof m)return m(a[0].toArray());this[0]=[]}this.length=1}return this};m._init.prototype=m.prototype;m._init.constructor=m;m.utils={calcRdx:g,isArray:q,isFunction:e,isNumber:h,toVector:function(a){return k.apply([],a)}};m.extend=function(a){var b,e;if(1===arguments.length){for(e in a)m[e]=a[e];return this}for(b=1;b<arguments.length;b++)for(e in arguments[b])a[e]=arguments[b][e];return a};m.rows=function(a){return a.length||1};m.cols=function(a){return a[0].length||1};m.dimensions=function(a){return{rows:m.rows(a),cols:m.cols(a)}};m.row=function(a,b){return q(b)?b.map(function(b){return m.row(a,b)}):a[b]};m.rowa=function(a,b){return m.row(a,b)};m.col=function(a,b){if(q(b)){var e=m.arange(a.length).map(function(a){return Array(b.length)});b.forEach(function(b,d){m.arange(a.length).forEach(function(f){e[f][d]=a[f][b]})});return e}for(var d=Array(a.length),f=0;f<a.length;f++)d[f]=[a[f][b]];return d};m.cola=function(a,b){return m.col(a,b).map(function(a){return a[0]})};m.diag=function(a){for(var b=m.rows(a),e=Array(b),d=0;d<b;d++)e[d]=[a[d][d]];return e};m.antidiag=function(a){for(var b=m.rows(a)-1,e=Array(b),d=0;0<=b;b--,d++)e[d]=[a[d][b]];return e};m.transpose=function(a){var b=[],e,d,f,g,h;q(a[0])||(a=[a]);d=a.length;f=a[0].length;for(h=0;h<f;h++){e=Array(d);for(g=0;g<d;g++)e[g]=a[g][h];b.push(e)}return 1===b.length?b[0]:b};m.map=function(a,b,e){var d,f,g,h;q(a[0])||(a=[a]);d=a.length;f=a[0].length;g=e?a:Array(d);for(e=0;e<d;e++)for(g[e]||(g[e]=Array(f)),h=0;h<f;h++)g[e][h]=b(a[e][h],e,h);return 1===g.length?g[0]:g};m.cumreduce=function(a,b,e){var d,f,g,h;q(a[0])||(a=[a]);d=a.length;f=a[0].length;g=e?a:Array(d);for(e=0;e<d;e++)for(g[e]||(g[e]=Array(f)),0<f&&(g[e][0]=a[e][0]),h=1;h<f;h++)g[e][h]=b(g[e][h-1],a[e][h]);return 1===g.length?g[0]:g};m.alter=function(a,b){return m.map(a,b,!0)};m.create=function(a,b,d){var f=Array(a),g,h;e(b)&&(d=b,b=a);for(g=0;g<a;g++)for(f[g]=Array(b),h=0;h<b;h++)f[g][h]=d(g,h);return f};m.zeros=function(b,e){h(e)||(e=b);return m.create(b,e,a)};m.ones=function(a,e){h(e)||(e=a);return m.create(a,e,b)};m.rand=function(a,b){h(b)||(b=a);return m.create(a,b,d.random)};m.identity=function(a,b){h(b)||(b=a);return m.create(a,b,f)};m.symmetric=function(a){var b=a.length,e,d;if(a.length!==a[0].length)return!1;for(e=0;e<b;e++)for(d=0;d<b;d++)if(a[d][e]!==a[e][d])return!1;return!0};m.clear=function(b){return m.alter(b,a)};m.seq=function(a,b,d,f){e(f)||(f=!1);var h=[],m=g(a,b);d=(b*m-a*m)/((d-1)*m);var l=a,k;for(k=0;l<=b;k++,l=(a*m+d*m*k)/m)h.push(f?f(l,k):l);return h};m.arange=function(a,b,e){var d=[];e=e||1;b===l&&(b=a,a=0);if(a===b||0===e||a<b&&0>e||a>b&&0<e)return[];if(0<e)for(i=a;i<b;i+=e)d.push(i);else for(i=a;i>b;i+=e)d.push(i);return d};m.slice=function(){function a(a,b,e,d){var f=[],g=a.length;if(b===l&&e===l&&d===l)return m.copy(a);b=b||0;e=e||a.length;b=0<=b?b:g+b;e=0<=e?e:g+e;d=d||1;if(b===e||0===d||b<e&&0>d||b>e&&0<d)return[];if(0<d)for(;b<e;b+=d)f.push(a[b]);else for(;b>e;b+=d)f.push(a[b]);return f}return function(b,e){e=e||{};if(h(e.row)){if(h(e.col))return b[e.row][e.col];var d=m.rowa(b,e.row),f=e.col||{};return a(d,f.start,f.end,f.step)}if(h(e.col)){var d=m.cola(b,e.col),g=e.row||{};return a(d,g.start,g.end,g.step)}g=e.row||{};f=e.col||{};return a(b,g.start,g.end,g.step).map(function(b){return a(b,f.start,f.end,f.step)})}}();m.sliceAssign=function(a,b,e){if(h(b.row)){if(h(b.col))return a[b.row][b.col]=e;b.col=b.col||{};b.col.start=b.col.start||0;b.col.end=b.col.end||a[0].length;b.col.step=b.col.step||1;var f=m.arange(b.col.start,d.min(a.length,b.col.end),b.col.step),g=b.row;f.forEach(function(b,d){a[g][b]=e[d]});return a}if(h(b.col)){b.row=b.row||{};b.row.start=b.row.start||0;b.row.end=b.row.end||a.length;b.row.step=b.row.step||1;var k=m.arange(b.row.start,d.min(a[0].length,b.row.end),b.row.step),n=b.col;k.forEach(function(b,d){a[b][n]=e[d]});return a}e[0].length===l&&(e=[e]);b.row.start=b.row.start||0;b.row.end=b.row.end||a.length;b.row.step=b.row.step||1;b.col.start=b.col.start||0;b.col.end=b.col.end||a[0].length;b.col.step=b.col.step||1;k=m.arange(b.row.start,d.min(a.length,b.row.end),b.row.step);f=m.arange(b.col.start,d.min(a[0].length,b.col.end),b.col.step);k.forEach(function(b,d){f.forEach(function(f,g){a[b][f]=e[d][g]})});return a};m.diagonal=function(a){var b=m.zeros(a.length,a.length);a.forEach(function(a,e){b[e][e]=a});return b};m.copy=function(a){return a.map(function(a){return h(a)?a:a.map(function(a){return a})})};var w=m.prototype;w.length=0;w.push=Array.prototype.push;w.sort=Array.prototype.sort;w.splice=Array.prototype.splice;w.slice=Array.prototype.slice;w.toArray=function(){return 1<this.length?p.call(this):p.call(this)[0]};w.map=function(a,b){return m(m.map(this,a,b))};w.cumreduce=function(a,b){return m(m.cumreduce(this,a,b))};w.alter=function(a){m.alter(this,a);return this};(function(a){for(var b=0;b<a.length;b++)(function(a){w[a]=function(b){var e=this,d;if(b)return setTimeout(function(){b.call(e,w[a].call(e))}),this;d=m[a](this);return q(d)?m(d):d}})(a[b])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" "));(function(a){for(var b=0;b<a.length;b++)(function(a){w[a]=function(b,e){var d=this;return e?(setTimeout(function(){e.call(d,w[a].call(d,b))}),this):m(m[a](this,b))}})(a[b])})(["row","col"]);(function(a){for(var b=0;b<a.length;b++){var e=a[b];w[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")}})(["create","zeros","ones","rand","identity"]);return m}(Math);(function(d,l){function g(e,a){return e-a}var e=d.utils.isFunction;d.sum=function(e){for(var a=0,b=e.length;0<=--b;)a+=e[b];return a};d.sumsqrd=function(e){for(var a=0,b=e.length;0<=--b;)a+=e[b]*e[b];return a};d.sumsqerr=function(e){for(var a=d.mean(e),b=0,f=e.length,g;0<=--f;)g=e[f]-a,b+=g*g;return b};d.sumrow=function(e){for(var a=0,b=e.length;0<=--b;)a+=e[b];return a};d.product=function(e){for(var a=1,b=e.length;0<=--b;)a*=e[b];return a};d.min=function(e){for(var a=e[0],b=0;++b<e.length;)e[b]<a&&(a=e[b]);return a};d.max=function(e){for(var a=e[0],b=0;++b<e.length;)e[b]>a&&(a=e[b]);return a};d.unique=function(e){for(var a={},b=[],d=0;d<e.length;d++)a[e[d]]||(a[e[d]]=!0,b.push(e[d]));return b};d.mean=function(e){return d.sum(e)/e.length};d.meansqerr=function(e){return d.sumsqerr(e)/e.length};d.geomean=function(e){return l.pow(d.product(e),1/e.length)};d.median=function(e){var a=e.length;e=e.slice().sort(g);return a&1?e[a/2|0]:(e[a/2-1]+e[a/2])/2};d.cumsum=function(e){return d.cumreduce(e,function(a,b){return a+b})};d.cumprod=function(e){return d.cumreduce(e,function(a,b){return a*b})};d.diff=function(e){var a=[],b=e.length,d;for(d=1;d<b;d++)a.push(e[d]-e[d-1]);return a};d.rank=function(e){for(var a=e.length,b=e.slice().sort(g),d=Array(a),h=0;h<a;h++){var m=b.indexOf(e[h]),l=b.lastIndexOf(e[h]);d[h]=(m===l?m:(m+l)/2)+1}return d};d.mode=function(e){var a=e.length;e=e.slice().sort(g);var b=1,d=0,h=0,m=[],l;for(l=0;l<a;l++)e[l]===e[l+1]?b++:(b>d?(m=[e[l]],d=b,h=0):b===d&&(m.push(e[l]),h++),b=1);return 0===h?m[0]:m};d.range=function(e){return d.max(e)-d.min(e)};d.variance=function(e,a){return d.sumsqerr(e)/(e.length-(a?1:0))};d.deviation=function(e){for(var a=d.mean(e),b=e.length,f=Array(b),g=0;g<b;g++)f[g]=e[g]-a;return f};d.stdev=function(e,a){return l.sqrt(d.variance(e,a))};d.meandev=function(e){var a=0,b=d.mean(e),f;for(f=e.length-1;0<=f;f--)a+=l.abs(e[f]-b);return a/e.length};d.meddev=function(e){var a=0,b=d.median(e),f;for(f=e.length-1;0<=f;f--)a+=l.abs(e[f]-b);return a/e.length};d.coeffvar=function(e){return d.stdev(e)/d.mean(e)};d.quartiles=function(e){var a=e.length;e=e.slice().sort(g);return[e[l.round(a/4)-1],e[l.round(a/2)-1],e[l.round(3*a/4)-1]]};d.quantiles=function(e,a,b,d){var f=e.slice().sort(g),h=[a.length];e=e.length;var m,k,n;"undefined"===typeof b&&(b=.375);"undefined"===typeof d&&(d=.375);for(m=0;m<a.length;m++)k=a[m],n=b+k*(1-b-d),n=e*k+n,k=l.floor(l.max(1,l.min(n,e-1))),n=l.max(0,l.min(n-k,1)),h[m]=(1-n)*f[k-1]+n*f[k];return h};d.percentile=function(e,a){var b=e.slice().sort(g),d=a*(b.length-1),h=parseInt(d),d=d-h;return h+1<b.length?b[h]*(1-d)+b[h+1]*d:b[h]};d.percentileOfScore=function(e,a,b){var d=0,g=e.length,h=!1,m;"strict"===b&&(h=!0);for(m=0;m<g;m++)b=e[m],(h&&b<a||!h&&b<=a)&&d++;return d/g};d.histogram=function(e,a){var b=d.min(e),f=a||4,g=(d.max(e)-b)/f,h=e.length;a=[];var m;for(m=0;m<f;m++)a[m]=0;for(m=0;m<h;m++)a[l.min(l.floor((e[m]-b)/g),f-1)]+=1;return a};d.covariance=function(e,a){var b=d.mean(e),f=d.mean(a),g=e.length,h=Array(g),m;for(m=0;m<g;m++)h[m]=(e[m]-b)*(a[m]-f);return d.sum(h)/(g-1)};d.corrcoeff=function(e,a){return d.covariance(e,a)/d.stdev(e,1)/d.stdev(a,1)};d.spearmancoeff=function(e,a){e=d.rank(e);a=d.rank(a);var b=d.deviation(e),f=d.deviation(a);return d.sum(b.map(function(a,b){return a*f[b]}))/l.sqrt(d.sum(b.map(function(a){return l.pow(a,2)}))*d.sum(f.map(function(a){return l.pow(a,2)})))};d.stanMoment=function(e,a){for(var b=d.mean(e),f=d.stdev(e),g=e.length,h=0,m=0;m<g;m++)h+=l.pow((e[m]-b)/f,a);return h/e.length};d.skewness=function(e){return d.stanMoment(e,3)};d.kurtosis=function(e){return d.stanMoment(e,4)-3};var h=d.prototype;(function(g){for(var a=0;a<g.length;a++)(function(a){h[a]=function(b,g){var f=[],m=0,l=this;e(b)&&(g=b,b=!1);if(g)return setTimeout(function(){g.call(l,h[a].call(l,b))}),this;if(1<this.length){for(l=!0===b?this:this.transpose();m<l.length;m++)f[m]=d[a](l[m]);return f}return d[a](this[0],b)}})(g[a])})(["cumsum","cumprod"]);(function(g){for(var a=0;a<g.length;a++)(function(a){h[a]=function(b,g){var f=[],m=0,l=this;e(b)&&(g=b,b=!1);if(g)return setTimeout(function(){g.call(l,h[a].call(l,b))}),this;if(1<this.length){for("sumrow"!==a&&(l=!0===b?this:this.transpose());m<l.length;m++)f[m]=d[a](l[m]);return!0===b?d[a](d.utils.toVector(f)):f}return d[a](this[0],b)}})(g[a])})("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));(function(g){for(var a=0;a<g.length;a++)(function(a){h[a]=function(){var b=[],g=0,m=this,l=Array.prototype.slice.call(arguments);if(e(l[l.length-1])){var k=l[l.length-1],n=l.slice(0,l.length-1);setTimeout(function(){k.call(m,h[a].apply(m,n))});return this}k=void 0;if(1<this.length){for(m=m.transpose();g<m.length;g++)b[g]=d[a].apply(m,[m[g]].concat(l));return b}return d[a].apply(m,[this[0]].concat(l))}})(g[a])})(["quantiles","percentileOfScore"])})(this.jStat,Math);(function(d,l){d.gammaln=function(d){var e=0,g=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5.395239384953E-6],h=1.000000000190015,a,b;b=(a=d)+5.5;for(b-=(d+.5)*l.log(b);6>e;e++)h+=g[e]/++a;return l.log(2.5066282746310007*h/d)-b};d.gammafn=function(d){var e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],g=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],h=!1,a=0,b=0,f=0,k,p,v;if(0>=d)if(p=d%1+3.6E-16)h=(d&1?-1:1)*l.PI/l.sin(l.PI*p),d=1-d;else return Infinity;v=d;p=1>d?d++:(d-=a=(d|0)-1)-1;for(k=0;8>k;++k)f=(f+e[k])*p,b=b*p+g[k];p=f/b+1;if(v<d)p/=v;else if(v>d)for(k=0;k<a;++k)p*=d,d++;h&&(p=h/p);return p};d.gammap=function(g,e){return d.lowRegGamma(g,e)*d.gammafn(g)};d.lowRegGamma=function(g,e){var h=d.gammaln(g),m=g,a=1/g,b=a,f=e+1-g,k=1/1E-30,p=1/f,v=p,q=1,w=-~(8.5*l.log(1<=g?g:1/g)+.4*g+17);if(0>e||0>=g)return NaN;if(e<g+1){for(;q<=w;q++)a+=b*=e/++m;return a*l.exp(-e+g*l.log(e)-h)}for(;q<=w;q++)m=-q*(q-g),f+=2,p=m*p+f,k=f+m/k,p=1/p,v*=p*k;return 1-v*l.exp(-e+g*l.log(e)-h)};d.factorialln=function(g){return 0>g?NaN:d.gammaln(g+1)};d.factorial=function(g){return 0>g?NaN:d.gammafn(g+1)};d.combination=function(g,e){return 170<g||170<e?l.exp(d.combinationln(g,e)):d.factorial(g)/d.factorial(e)/d.factorial(g-e)};d.combinationln=function(g,e){return d.factorialln(g)-d.factorialln(e)-d.factorialln(g-e)};d.permutation=function(g,e){return d.factorial(g)/d.factorial(g-e)};d.betafn=function(g,e){if(!(0>=g||0>=e))return 170<g+e?l.exp(d.betaln(g,e)):d.gammafn(g)*d.gammafn(e)/d.gammafn(g+e)};d.betaln=function(g,e){return d.gammaln(g)+d.gammaln(e)-d.gammaln(g+e)};d.betacf=function(d,e,h){var g=1,a=e+h,b=e+1,f=e-1,k=1,n=1-a*d/b,p,q,w;1E-30>l.abs(n)&&(n=1E-30);for(w=n=1/n;100>=g&&!(p=2*g,q=g*(h-g)*d/((f+p)*(e+p)),n=1+q*n,1E-30>l.abs(n)&&(n=1E-30),k=1+q/k,1E-30>l.abs(k)&&(k=1E-30),n=1/n,w*=n*k,q=-(e+g)*(a+g)*d/((e+p)*(b+p)),n=1+q*n,1E-30>l.abs(n)&&(n=1E-30),k=1+q/k,1E-30>l.abs(k)&&(k=1E-30),n=1/n,p=n*k,w*=p,3E-7>l.abs(p-1));g++);return w};d.gammapinv=function(g,e){var h=0,m=e-1,a=d.gammaln(e),b,f,k,p,q;if(1<=g)return l.max(100,e+100*l.sqrt(e));if(0>=g)return 0;1<e?(p=l.log(m),q=l.exp(m*(p-1)-a),k=l.sqrt(-2*l.log(.5>g?g:1-g)),b=(2.30753+.27061*k)/(1+k*(.99229+.04481*k))-k,.5>g&&(b=-b),b=l.max(.001,e*l.pow(1-1/(9*e)-b/(3*l.sqrt(e)),3))):(k=1-e*(.253+.12*e),b=g<k?l.pow(g/k,1/e):1-l.log(1-(g-k)/(1-k)));for(;12>h;h++){if(0>=b)return 0;f=d.lowRegGamma(e,b)-g;k=1<e?q*l.exp(-(b-m)+m*(l.log(b)-p)):l.exp(-b+m*l.log(b)-a);f/=k;b-=k=f/(1-.5*l.min(1,f*((e-1)/b-1)));0>=b&&(b=.5*(b+k));if(l.abs(k)<1E-8*b)break}return b};d.erf=function(d){var e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036E-4,3.66839497852761E-4,4.2523324806907E-5,-2.0278578112534E-5,-1.624290004647E-6,1.30365583558E-6,1.5626441722E-8,-8.5238095915E-8,6.529054439E-9,5.059343495E-9,-9.91364156E-10,-2.27365122E-10,9.6467911E-11,2.394038E-12,-6.886027E-12,8.94487E-13,3.13092E-13,-1.12708E-13,3.81E-16,7.106E-15,-1.523E-15,-9.4E-17,1.21E-16,-2.8E-17],g=e.length-1,h=!1,a=0,b=0,f,k,p;0>d&&(d=-d,h=!0);f=2/(2+d);for(k=4*f-2;0<g;g--)p=a,a=k*a-b+e[g],b=p;d=f*l.exp(-d*d+.5*(e[0]+k*a)-b);return h?d-1:1-d};d.erfc=function(g){return 1-d.erf(g)};d.erfcinv=function(g){var e=0,h,m,a;if(2<=g)return-100;if(0>=g)return 100;a=1>g?g:2-g;h=l.sqrt(-2*l.log(a/2));for(h=-.70711*((2.30753+.27061*h)/(1+h*(.99229+.04481*h))-h);2>e;e++)m=d.erfc(h)-a,h+=m/(1.1283791670955126*l.exp(-h*h)-h*m);return 1>g?h:-h};d.ibetainv=function(g,e,h){var m=e-1,a=h-1,b=0,f,k,n,p;if(0>=g)return 0;if(1<=g)return 1;1<=e&&1<=h?(f=l.sqrt(-2*l.log(.5>g?g:1-g)),k=(2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f,.5>g&&(k=-k),f=(k*k-3)/6,p=2/(1/(2*e-1)+1/(2*h-1)),k=k*l.sqrt(f+p)/p-(1/(2*h-1)-1/(2*e-1))*(f+5/6-2/(3*p)),k=e/(e+h*l.exp(2*k))):(f=l.log(e/(e+h)),k=l.log(h/(e+h)),f=l.exp(e*f)/e,n=l.exp(h*k)/h,k=f+n,k=g<f/k?l.pow(e*k*g,1/e):1-l.pow(h*k*(1-g),1/h));for(p=-d.gammaln(e)-d.gammaln(h)+d.gammaln(e+h);10>b&&0!==k&&1!==k&&!(n=d.ibeta(k,e,h)-g,f=l.exp(m*l.log(k)+a*l.log(1-k)+p),n/=f,k-=f=n/(1-.5*l.min(1,n*(m/k-a/(1-k)))),0>=k&&(k=.5*(k+f)),1<=k&&(k=.5*(k+f+1)),l.abs(f)<1E-8*k&&0<b);b++);return k};d.ibeta=function(g,e,h){var m=0===g||1===g?0:l.exp(d.gammaln(e+h)-d.gammaln(e)-d.gammaln(h)+e*l.log(g)+h*l.log(1-g));return 0>g||1<g?!1:g<(e+1)/(e+h+2)?m*d.betacf(g,e,h)/e:1-m*d.betacf(1-g,h,e)/h};d.randn=function(g,e){var h,m,a,b;e||(e=g);if(g)return d.create(g,e,function(){return d.randn()});do h=l.random(),m=1.7156*(l.random()-.5),a=h-.449871,b=l.abs(m)+.386595,a=a*a+b*(.196*b-.25472*a);while(.27597<a&&(.27846<a||m*m>-4*l.log(h)*h*h));return m/h};d.randg=function(g,e,h){var m=g,a,b,f;h||(h=e);g||(g=1);if(e)return m=d.zeros(e,h),m.alter(function(){return d.randg(g)}),m;1>g&&(g+=1);e=g-1/3;h=1/l.sqrt(9*e);do{do f=d.randn(),b=1+h*f;while(0>=b);b*=b*b;a=l.random()}while(a>1-.331*l.pow(f,4)&&l.log(a)>.5*f*f+e*(1-b+l.log(b)));if(g==m)return e*b;do a=l.random();while(0===a);return l.pow(a,1/m)*e*b};(function(g){for(var e=0;e<g.length;e++)(function(e){d.fn[e]=function(){return d(d.map(this,function(g){return d[e](g)}))}})(g[e])})(["gammaln","gammafn","factorial","factorialln"]);(function(g){for(var e=0;e<g.length;e++)(function(e){d.fn[e]=function(){return d(d[e].apply(null,arguments))}})(g[e])})(["randn"])})(this.jStat,Math);(function(d,k){(function(g){for(var e=0;e<g.length;e++)(function(e){d[e]=function(e,a,b){if(!(this instanceof arguments.callee))return new arguments.callee(e,a,b);this._a=e;this._b=a;this._c=b;return this};d.fn[e]=function(g,a,b){g=d[e](g,a,b);g.data=this;return g};d[e].prototype.sample=function(g){var a=this._a,b=this._b,f=this._c;return g?d.alter(g,function(){return d[e].sample(a,b,f)}):d[e].sample(a,b,f)};(function(g){for(var a=0;a<g.length;a++)(function(a){d[e].prototype[a]=function(b){var f=this._a,g=this._b,h=this._c;b||0===b||(b=this.data);return"number"!==typeof b?d.fn.map.call(b,function(b){return d[e][a](b,f,g,h)}):d[e][a](b,f,g,h)}})(g[a])})(["pdf","cdf","inv"]);(function(g){for(var a=0;a<g.length;a++)(function(a){d[e].prototype[a]=function(){return d[e][a](this._a,this._b,this._c)}})(g[a])})(["mean","median","mode","variance"])})(g[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular".split(" "));d.extend(d.beta,{pdf:function(g,e,h){return 1<g||0>g?0:1==e&&1==h?1:512>e&&512>h?k.pow(g,e-1)*k.pow(1-g,h-1)/d.betafn(e,h):k.exp((e-1)*k.log(g)+(h-1)*k.log(1-g)-d.betaln(e,h))},cdf:function(g,e,h){return 1<g||0>g?1*(1<g):d.ibeta(g,e,h)},inv:function(g,e,h){return d.ibetainv(g,e,h)},mean:function(d,e){return d/(d+e)},median:function(g,e){return d.ibetainv(.5,g,e)},mode:function(d,e){return(d-1)/(d+e-2)},sample:function(g,e){var h=d.randg(g);return h/(h+d.randg(e))},variance:function(d,e){return d*e/(k.pow(d+e,2)*(d+e+1))}});d.extend(d.centralF,{pdf:function(g,e,h){return 0>g?0:2>=e?0===g&&2>e?Infinity:0===g&&2===e?1:k.sqrt(k.pow(e*g,e)*k.pow(h,h)/k.pow(e*g+h,e+h))/(g*d.betafn(e/2,h/2)):h/(h+g*e)*e/2*d.binomial.pdf((e-2)/2,(e+h-2)/2,e*g/(h+g*e))},cdf:function(g,e,h){return 0>g?0:d.ibeta(e*g/(e*g+h),e/2,h/2)},inv:function(g,e,h){return h/(e*(1/d.ibetainv(g,e/2,h/2)-1))},mean:function(d,e){return 2<e?e/(e-2):void 0},mode:function(d,e){return 2<d?e*(d-2)/(d*(e+2)):void 0},sample:function(g,e){var h=2*d.randg(g/2),k=2*d.randg(e/2);return h/g/(k/e)},variance:function(d,e){if(!(4>=e))return 2*e*e*(d+e-2)/(d*(e-2)*(e-2)*(e-4))}});d.extend(d.cauchy,{pdf:function(d,e,h){return 0>h?0:h/(k.pow(d-e,2)+k.pow(h,2))/k.PI},cdf:function(d,e,h){return k.atan((d-e)/h)/k.PI+.5},inv:function(d,e,h){return e+h*k.tan(k.PI*(d-.5))},median:function(d,e){return d},mode:function(d,e){return d},sample:function(g,e){return d.randn()*k.sqrt(1/(2*d.randg(.5)))*e+g}});d.extend(d.chisquare,{pdf:function(g,e){return 0>g?0:0===g&&2===e?.5:k.exp((e/2-1)*k.log(g)-g/2-e/2*k.log(2)-d.gammaln(e/2))},cdf:function(g,e){return 0>g?0:d.lowRegGamma(e/2,g/2)},inv:function(g,e){return 2*d.gammapinv(g,.5*e)},mean:function(d){return d},median:function(d){return d*k.pow(1-2/(9*d),3)},mode:function(d){return 0<d-2?d-2:0},sample:function(g){return 2*d.randg(g/2)},variance:function(d){return 2*d}});d.extend(d.exponential,{pdf:function(d,e){return 0>d?0:e*k.exp(-e*d)},cdf:function(d,e){return 0>d?0:1-k.exp(-e*d)},inv:function(d,e){return-k.log(1-d)/e},mean:function(d){return 1/d},median:function(d){return 1/d*k.log(2)},mode:function(d){return 0},sample:function(d){return-1/d*k.log(k.random())},variance:function(d){return k.pow(d,-2)}});d.extend(d.gamma,{pdf:function(g,e,h){return 0>g?0:0===g&&1===e?1/h:k.exp((e-1)*k.log(g)-g/h-d.gammaln(e)-e*k.log(h))},cdf:function(g,e,h){return 0>g?0:d.lowRegGamma(e,g/h)},inv:function(g,e,h){return d.gammapinv(g,e)*h},mean:function(d,e){return d*e},mode:function(d,e){if(1<d)return(d-1)*e},sample:function(g,e){return d.randg(g)*e},variance:function(d,e){return d*e*e}});d.extend(d.invgamma,{pdf:function(g,e,h){return 0>=g?0:k.exp(-(e+1)*k.log(g)-h/g-d.gammaln(e)+e*k.log(h))},cdf:function(g,e,h){return 0>=g?0:1-d.lowRegGamma(e,h/g)},inv:function(g,e,h){return h/d.gammapinv(1-g,e)},mean:function(d,e){return 1<d?e/(d-1):void 0},mode:function(d,e){return e/(d+1)},sample:function(g,e){return e/d.randg(g)},variance:function(d,e){if(!(2>=d))return e*e/((d-1)*(d-1)*(d-2))}});d.extend(d.kumaraswamy,{pdf:function(d,e,h){return 0===d&&1===e?h:1===d&&1===h?e:k.exp(k.log(e)+k.log(h)+(e-1)*k.log(d)+(h-1)*k.log(1-k.pow(d,e)))},cdf:function(d,e,h){return 0>d?0:1<d?1:1-k.pow(1-k.pow(d,e),h)},inv:function(d,e,h){return k.pow(1-k.pow(1-d,1/h),1/e)},mean:function(g,e){return e*d.gammafn(1+1/g)*d.gammafn(e)/d.gammafn(1+1/g+e)},median:function(d,e){return k.pow(1-k.pow(2,-1/e),1/d)},mode:function(d,e){if(1<=d&&1<=e&&1!==d&&1!==e)return k.pow((d-1)/(d*e-1),1/d)},variance:function(d,e){throw Error("variance not yet implemented");}});d.extend(d.lognormal,{pdf:function(d,e,h){return 0>=d?0:k.exp(-k.log(d)-.5*k.log(2*k.PI)-k.log(h)-k.pow(k.log(d)-e,2)/(2*h*h))},cdf:function(g,e,h){return 0>g?0:.5+.5*d.erf((k.log(g)-e)/k.sqrt(2*h*h))},inv:function(g,e,h){return k.exp(-1.4142135623730951*h*d.erfcinv(2*g)+e)},mean:function(d,e){return k.exp(d+e*e/2)},median:function(d,e){return k.exp(d)},mode:function(d,e){return k.exp(d-e*e)},sample:function(g,e){return k.exp(d.randn()*e+g)},variance:function(d,e){return(k.exp(e*e)-1)*k.exp(2*d+e*e)}});d.extend(d.noncentralt,{pdf:function(g,e,h){return 1E-14>k.abs(h)?d.studentt.pdf(g,e):1E-14>k.abs(g)?k.exp(d.gammaln((e+1)/2)-h*h/2-.5*k.log(k.PI*e)-d.gammaln(e/2)):e/g*(d.noncentralt.cdf(g*k.sqrt(1+2/e),e+2,h)-d.noncentralt.cdf(g,e,h))},cdf:function(g,e,h){if(1E-14>k.abs(h))return d.studentt.cdf(g,e);var m=!1;0>g&&(m=!0,h=-h);var a=d.normal.cdf(-h,0,1),b=1E-14+1,f=b;g=g*g/(g*g+e);for(var l=0,n=k.exp(-h*h/2),p=k.exp(-h*h/2-.5*k.log(2)-d.gammaln(1.5))*h;200>l||1E-14<f||1E-14<b;)f=b,0<l&&(n*=h*h/(2*l),p*=h*h/(2*(l+.5))),b=n*d.beta.cdf(g,l+.5,e/2)+p*d.beta.cdf(g,l+1,e/2),a+=.5*b,l++;return m?1-a:a}});d.extend(d.normal,{pdf:function(d,e,h){return k.exp(-.5*k.log(2*k.PI)-k.log(h)-k.pow(d-e,2)/(2*h*h))},cdf:function(g,e,h){return.5*(1+d.erf((g-e)/k.sqrt(2*h*h)))},inv:function(g,e,h){return-1.4142135623730951*h*d.erfcinv(2*g)+e},mean:function(d,e){return d},median:function(d,e){return d},mode:function(d,e){return d},sample:function(g,e){return d.randn()*e+g},variance:function(d,e){return e*e}});d.extend(d.pareto,{pdf:function(d,e,h){return d<e?0:h*k.pow(e,h)/k.pow(d,h+1)},cdf:function(d,e,h){return d<e?0:1-k.pow(e/d,h)},inv:function(d,e,h){return e/k.pow(1-d,1/h)},mean:function(d,e){if(!(1>=e))return e*k.pow(d,e)/(e-1)},median:function(d,e){return d*e*k.SQRT2},mode:function(d,e){return d},variance:function(d,e){if(!(2>=e))return d*d*e/(k.pow(e-1,2)*(e-2))}});d.extend(d.studentt,{pdf:function(g,e){e=1E100<e?1E100:e;return 1/(k.sqrt(e)*d.betafn(.5,e/2))*k.pow(1+g*g/e,-((e+1)/2))},cdf:function(g,e){var h=e/2;return d.ibeta((g+k.sqrt(g*g+e))/(2*k.sqrt(g*g+e)),h,h)},inv:function(g,e){var h=d.ibetainv(2*k.min(g,1-g),.5*e,.5),h=k.sqrt(e*(1-h)/h);return.5<g?h:-h},mean:function(d){return 1<d?0:void 0},median:function(d){return 0},mode:function(d){return 0},sample:function(g){return d.randn()*k.sqrt(g/(2*d.randg(g/2)))},variance:function(d){return 2<d?d/(d-2):1<d?Infinity:void 0}});d.extend(d.weibull,{pdf:function(d,e,h){return 0>d||0>e||0>h?0:h/e*k.pow(d/e,h-1)*k.exp(-k.pow(d/e,h))},cdf:function(d,e,h){return 0>d?0:1-k.exp(-k.pow(d/e,h))},inv:function(d,e,h){return e*k.pow(-k.log(1-d),1/h)},mean:function(g,e){return g*d.gammafn(1+1/e)},median:function(d,e){return d*k.pow(k.log(2),1/e)},mode:function(d,e){return 1>=e?0:d*k.pow((e-1)/e,1/e)},sample:function(d,e){return d*k.pow(-k.log(k.random()),1/e)},variance:function(g,e){return g*g*d.gammafn(1+2/e)-k.pow(d.weibull.mean(g,e),2)}});d.extend(d.uniform,{pdf:function(d,e,h){return d<e||d>h?0:1/(h-e)},cdf:function(d,e,h){return d<e?0:d<h?(d-e)/(h-e):1},inv:function(d,e,h){return e+d*(h-e)},mean:function(d,e){return.5*(d+e)},median:function(g,e){return d.mean(g,e)},mode:function(d,e){throw Error("mode is not yet implemented");},sample:function(d,e){return d/2+e/2+(e/2-d/2)*(2*k.random()-1)},variance:function(d,e){return k.pow(e-d,2)/12}});d.extend(d.binomial,{pdf:function(g,e,h){return 0===h||1===h?e*h===g?1:0:d.combination(e,g)*k.pow(h,g)*k.pow(1-h,e-g)},cdf:function(g,e,h){var k=[],a=0;if(0>g)return 0;if(g<e){for(;a<=g;a++)k[a]=d.binomial.pdf(a,e,h);return d.sum(k)}return 1}});d.extend(d.negbin,{pdf:function(g,e,h){return g!==g>>>0?!1:0>g?0:d.combination(g+e-1,e-1)*k.pow(1-h,g)*k.pow(h,e)},cdf:function(g,e,h){var k=0,a=0;if(0>g)return 0;for(;a<=g;a++)k+=d.negbin.pdf(a,e,h);return k}});d.extend(d.hypgeom,{pdf:function(g,e,h,m){if(g!==g|0)return!1;if(0>g||g<h-(e-m)||g>m||g>h)return 0;if(2*h>e)return 2*m>e?d.hypgeom.pdf(e-h-m+g,e,e-h,e-m):d.hypgeom.pdf(m-g,e,e-h,m);if(2*m>e)return d.hypgeom.pdf(h-g,e,h,e-m);if(h<m)return d.hypgeom.pdf(g,e,m,h);for(var a=1,b=0,f=0;f<g;f++){for(;1<a&&b<m;)a*=1-h/(e-b),b++;a*=(m-f)*(h-f)/((f+1)*(e-h-m+f+1))}for(;b<m;b++)a*=1-h/(e-b);return k.min(1,k.max(0,a))},cdf:function(g,e,h,m){if(0>g||g<h-(e-m))return 0;if(g>=m||g>=h)return 1;if(2*h>e)return 2*m>e?d.hypgeom.cdf(e-h-m+g,e,e-h,e-m):1-d.hypgeom.cdf(m-g-1,e,e-h,m);if(2*m>e)return 1-d.hypgeom.cdf(h-g-1,e,h,e-m);if(h<m)return d.hypgeom.cdf(g,e,m,h);for(var a=1,b=1,f=0,l=0;l<g;l++){for(;1<a&&f<m;){var n=1-h/(e-f),b=b*n,a=a*n;f++}b*=(m-l)*(h-l)/((l+1)*(e-h-m+l+1));a+=b}for(;f<m;f++)a*=1-h/(e-f);return k.min(1,k.max(0,a))}});d.extend(d.poisson,{pdf:function(g,e){return 0>e||0!==g%1||0>g?0:k.pow(e,g)*k.exp(-e)/d.factorial(g)},cdf:function(g,e){var h=[],k=0;if(0>g)return 0;for(;k<=g;k++)h.push(d.poisson.pdf(k,e));return d.sum(h)},mean:function(d){return d},variance:function(d){return d},sample:function(d){var e=1,g=0;d=k.exp(-d);do g++,e*=k.random();while(e>d);return g-1}});d.extend(d.triangular,{pdf:function(d,e,h,k){return h<=e||k<e||k>h?NaN:d<e||d>h?0:d<k?2*(d-e)/((h-e)*(k-e)):d===k?2/(h-e):2*(h-d)/((h-e)*(h-k))},cdf:function(d,e,h,m){return h<=e||m<e||m>h?NaN:d<=e?0:d>=h?1:d<=m?k.pow(d-e,2)/((h-e)*(m-e)):1-k.pow(h-d,2)/((h-e)*(h-m))},inv:function(d,e,h,m){return h<=e||m<e||m>h?NaN:d<=(m-e)/(h-e)?e+(h-e)*k.sqrt((m-e)/(h-e)*d):e+(h-e)*(1-k.sqrt((1-d)*(1-(m-e)/(h-e))))},mean:function(d,e,h){return(d+e+h)/3},median:function(d,e,h){if(h<=(d+e)/2)return e-k.sqrt((e-d)*(e-h))/k.sqrt(2);if(h>(d+e)/2)return d+k.sqrt((e-d)*(h-d))/k.sqrt(2)},mode:function(d,e,h){return h},sample:function(d,e,h){var g=k.random();return g<(h-d)/(e-d)?d+k.sqrt(g*(e-d)*(h-d)):e-k.sqrt((1-g)*(e-d)*(e-h))},variance:function(d,e,h){return(d*d+e*e+h*h-d*e-d*h-e*h)/18}});d.extend(d.laplace,{pdf:function(d,e,h){return 0>=h?0:k.exp(-k.abs(d-e)/h)/(2*h)},cdf:function(d,e,h){return 0>=h?0:d<e?.5*k.exp((d-e)/h):1-.5*k.exp(-(d-e)/h)},mean:function(d,e){return d},median:function(d,e){return d},mode:function(d,e){return d},variance:function(d,e){return 2*e*e},sample:function(d,e){var g=k.random()-.5;return d-e*(g/k.abs(g))*k.log(1-2*k.abs(g))}})})(this.jStat,Math);(function(d,k){function g(e){return h(e)||e instanceof d}var e=Array.prototype.push,h=d.utils.isArray;d.extend({add:function(e,a){return g(a)?(g(a[0])||(a=[a]),d.map(e,function(b,e,d){return b+a[e][d]})):d.map(e,function(b){return b+a})},subtract:function(e,a){return g(a)?(g(a[0])||(a=[a]),d.map(e,function(b,e,d){return b-a[e][d]||0})):d.map(e,function(b){return b-a})},divide:function(e,a){return g(a)?(g(a[0])||(a=[a]),d.multiply(e,d.inv(a))):d.map(e,function(b){return b/a})},multiply:function(e,a){var b,f,h,k,m,l,n,p;if(void 0===e.length&&void 0===a.length)return e*a;m=e.length;l=e[0].length;n=d.zeros(m,h=g(a)?a[0].length:l);p=0;if(g(a)){for(;p<h;p++)for(b=0;b<m;b++){for(f=k=0;f<l;f++)k+=e[b][f]*a[f][p];n[b][p]=k}return 1===m&&1===p?n[0][0]:n}return d.map(e,function(b){return b*a})},outer:function(e,a){return d.multiply(e.map(function(a){return[a]}),[a])},dot:function(e,a){g(e[0])||(e=[e]);g(a[0])||(a=[a]);for(var b=1===e[0].length&&1!==e.length?d.transpose(e):e,f=1===a[0].length&&1!==a.length?d.transpose(a):a,h=[],k=0,m=b.length,l=b[0].length,n,p;k<m;k++){h[k]=[];for(p=n=0;p<l;p++)n+=b[k][p]*f[k][p];h[k]=n}return 1===h.length?h[0]:h},pow:function(e,a){return d.map(e,function(b){return k.pow(b,a)})},exp:function(e){return d.map(e,function(a){return k.exp(a)})},log:function(e){return d.map(e,function(a){return k.log(a)})},abs:function(e){return d.map(e,function(a){return k.abs(a)})},norm:function(e,a){var b=0,d=0;isNaN(a)&&(a=2);for(g(e[0])&&(e=e[0]);d<e.length;d++)b+=k.pow(k.abs(e[d]),a);return k.pow(b,1/a)},angle:function(e,a){return k.acos(d.dot(e,a)/(d.norm(e)*d.norm(a)))},aug:function(d,a){for(var b=[],f=0;f<d.length;f++)b.push(d[f].slice());for(f=0;f<b.length;f++)e.apply(b[f],a[f]);return b},inv:function(e){var a=e.length,b=e[0].length,f=d.identity(a,b);e=d.gauss_jordan(e,f);for(var f=[],g=0,h;g<a;g++)for(f[g]=[],h=b;h<e[0].length;h++)f[g][h-b]=e[g][h];return f},det:function(e){var a=e.length,b=2*a,d=Array(b),g=a-1,h=b-1,k=g-a+1,m=h,l=0,n=0,p;if(2===a)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;l<b;l++)d[l]=1;for(l=0;l<a;l++){for(p=0;p<a;p++)d[0>k?k+a:k]*=e[l][p],d[m<a?m+a:m]*=e[l][p],k++,m--;k=--g-a+1;m=--h}for(l=0;l<a;l++)n+=d[l];for(;l<b;l++)n-=d[l];return n},gauss_elimination:function(e,a){var b,f,g=e.length,h=e[0].length,m,l=[],n,p;e=d.aug(e,a);n=e[0].length;for(b=0;b<g;b++){m=e[b][b];f=b;for(p=b+1;p<h;p++)m<k.abs(e[p][b])&&(m=e[p][b],f=p);if(f!=b)for(p=0;p<n;p++)m=e[b][p],e[b][p]=e[f][p],e[f][p]=m;for(f=b+1;f<g;f++)for(m=e[f][b]/e[b][b],p=b;p<n;p++)e[f][p]-=m*e[b][p]}for(b=g-1;0<=b;b--){h=0;for(f=b+1;f<=g-1;f++)h+=l[f]*e[b][f];l[b]=(e[b][n-1]-h)/e[b][b]}return l},gauss_jordan:function(e,a){for(var b=d.aug(e,a),f=b.length,g=b[0].length,h=0;h<f;h++){for(var m=h,l=h+1;l<f;l++)k.abs(b[l][h])>k.abs(b[m][h])&&(m=l);l=b[h];b[h]=b[m];b[m]=l;for(l=h+1;l<f;l++)for(c=b[l][h]/b[h][h],m=h;m<g;m++)b[l][m]-=b[h][m]*c}for(h=f-1;0<=h;h--){c=b[h][h];for(l=0;l<h;l++)for(m=g-1;m>h-1;m--)b[l][m]-=b[h][m]*b[l][h]/c;b[h][h]/=c;for(m=f;m<g;m++)b[h][m]/=c}return b},triaUpSolve:function(e,a){var b=e[0].length,f=d.zeros(1,b)[0],g,h=!1;void 0!=a[0].length&&(a=a.map(function(a){return a[0]}),h=!0);d.arange(b-1,-1,-1).forEach(function(h){g=d.arange(h+1,b).map(function(a){return f[a]*e[h][a]});f[h]=(a[h]-d.sum(g))/e[h][h]});return h?f.map(function(a){return[a]}):f},triaLowSolve:function(e,a){var b=e[0].length,f=d.zeros(1,b)[0],g,h=!1;void 0!=a[0].length&&(a=a.map(function(a){return a[0]}),h=!0);d.arange(b).forEach(function(b){g=d.arange(b).map(function(a){return e[b][a]*f[a]});f[b]=(a[b]-d.sum(g))/e[b][b]});return h?f.map(function(a){return[a]}):f},lu:function(e){var a=e.length,b=d.identity(a),f=d.zeros(e.length,e[0].length),g;d.arange(a).forEach(function(a){f[0][a]=e[0][a]});d.arange(1,a).forEach(function(h){d.arange(h).forEach(function(a){g=d.arange(a).map(function(e){return b[h][e]*f[e][a]});b[h][a]=(e[h][a]-d.sum(g))/f[a][a]});d.arange(h,a).forEach(function(a){g=d.arange(h).map(function(e){return b[h][e]*f[e][a]});f[h][a]=e[i][a]-d.sum(g)})});return[b,f]},cholesky:function(e){var a=e.length,b=d.zeros(e.length,e[0].length),f;d.arange(a).forEach(function(g){f=d.arange(g).map(function(a){return k.pow(b[g][a],2)});b[g][g]=k.sqrt(e[g][g]-d.sum(f));d.arange(g+1,a).forEach(function(a){f=d.arange(g).map(function(e){return b[g][e]*b[a][e]});b[a][g]=(e[g][a]-d.sum(f))/b[g][g]})});return b},gauss_jacobi:function(e,a,b,f){for(var g=0,h,m=e.length,l=[],n=[],p=[];g<m;g++)for(l[g]=[],n[g]=[],p[g]=[],h=0;h<m;h++)g>h?(l[g][h]=e[g][h],n[g][h]=p[g][h]=0):g<h?(n[g][h]=e[g][h],l[g][h]=p[g][h]=0):(p[g][h]=e[g][h],l[g][h]=n[g][h]=0);e=d.multiply(d.multiply(d.inv(p),d.add(l,n)),-1);p=d.multiply(d.inv(p),a);a=b;b=d.add(d.multiply(e,b),p);for(g=2;k.abs(d.norm(d.subtract(b,a)))>f;)a=b,b=d.add(d.multiply(e,a),p),g++;return b},gauss_seidel:function(e,a,b,f){for(var g=0,h=e.length,m=[],l=[],n=[],p;g<h;g++)for(m[g]=[],l[g]=[],n[g]=[],p=0;p<h;p++)g>p?(m[g][p]=e[g][p],l[g][p]=n[g][p]=0):g<p?(l[g][p]=e[g][p],m[g][p]=n[g][p]=0):(n[g][p]=e[g][p],m[g][p]=l[g][p]=0);e=d.multiply(d.multiply(d.inv(d.add(n,m)),l),-1);m=d.multiply(d.inv(d.add(n,m)),a);a=b;b=d.add(d.multiply(e,b),m);for(g=2;k.abs(d.norm(d.subtract(b,a)))>f;)a=b,b=d.add(d.multiply(e,a),m),g+=1;return b},SOR:function(e,a,b,f,g){for(var h=0,m=e.length,l=[],n=[],p=[],t;h<m;h++)for(l[h]=[],n[h]=[],p[h]=[],t=0;t<m;t++)h>t?(l[h][t]=e[h][t],n[h][t]=p[h][t]=0):h<t?(n[h][t]=e[h][t],l[h][t]=p[h][t]=0):(p[h][t]=e[h][t],l[h][t]=n[h][t]=0);e=d.multiply(d.inv(d.add(p,d.multiply(l,g))),d.subtract(d.multiply(p,1-g),d.multiply(n,g)));g=d.multiply(d.multiply(d.inv(d.add(p,d.multiply(l,g))),a),g);a=b;b=d.add(d.multiply(e,b),g);for(h=2;k.abs(d.norm(d.subtract(b,a)))>f;)a=b,b=d.add(d.multiply(e,a),g),h++;return b},householder:function(e){for(var a=e.length,b=e[0].length,f=0,g,h,m;f<a-1;f++){h=0;for(g=f+1;g<b;g++)h+=e[g][f]*e[g][f];g=0<e[f+1][f]?-1:1;h=g*k.sqrt(h);m=k.sqrt((h*h-e[f+1][f]*h)/2);g=d.zeros(a,1);g[f+1][0]=(e[f+1][f]-h)/(2*m);for(h=f+2;h<a;h++)g[h][0]=e[h][f]/(2*m);h=d.subtract(d.identity(a,b),d.multiply(d.multiply(g,d.transpose(g)),2));e=d.multiply(h,d.multiply(e,h))}return e},QR:function(){return function(e){var a=[];d.arange(e[0].length).forEach(function(b){var f,g=d.slice(e,{row:{start:b},col:b});f=g.length;var h=d.norm(g,2),k=d.zeros(1,f)[0];k[0]=1;g=d.add(d.multiply(d.multiply(k,h),-1),g);h=d.norm(g,2);g=d.divide(g,h);f=d.subtract(d.identity(f),d.multiply(d.outer(g,g),2));g=d.identity(e.length);g=d.sliceAssign(g,{row:{start:b},col:{start:b}},f);e=d.multiply(g,e);a.push(g)});return[a.reduce(function(a,e){return d.multiply(a,e)}),e]}}(),lstsq:function(e,a){function b(a){a=d.copy(a);var b=a.length,e=d.identity(b);d.arange(b-1,-1,-1).forEach(function(b){d.sliceAssign(e,{row:b},d.divide(d.slice(e,{row:b}),a[b][b]));d.sliceAssign(a,{row:b},d.divide(d.slice(a,{row:b}),a[b][b]));d.arange(b).forEach(function(f){var g=d.multiply(a[f][b],-1),h=d.slice(a,{row:f}),k=d.multiply(d.slice(a,{row:b}),g);d.sliceAssign(a,{row:f},d.add(h,k));h=d.slice(e,{row:f});g=d.multiply(d.slice(e,{row:b}),g);d.sliceAssign(e,{row:f},d.add(h,g))})});return e}return function(a,e){var f=!1;void 0===e[0].length&&(e=e.map(function(a){return[a]}),f=!0);var g=d.QR(a),h=g[1],k=a[0].length,g=d.slice(g[0],{col:{end:k}}),h=d.slice(h,{row:{end:k}}),h=b(h),g=d.multiply(d.multiply(h,d.transpose(g)),e);return f?g.map(function(a){return a[0]}):g}}(),jacobi:function(e){for(var a=1,b=0,f=e.length,g=d.identity(f,f),h=[],m,l,n,p;1===a;){b++;p=e[0][1];a=0;n=1;for(m=0;m<f;m++)for(l=0;l<f;l++)m!=l&&p<k.abs(e[m][l])&&(p=k.abs(e[m][l]),a=m,n=l);m=e[a][a]===e[n][n]?0<e[a][n]?k.PI/4:-k.PI/4:k.atan(2*e[a][n]/(e[a][a]-e[n][n]))/2;l=d.identity(f,f);l[a][a]=k.cos(m);l[a][n]=-k.sin(m);l[n][a]=k.sin(m);l[n][n]=k.cos(m);g=d.multiply(g,l);e=d.multiply(d.multiply(d.inv(l),e),l);a=0;for(m=1;m<f;m++)for(l=1;l<f;l++)m!=l&&.001<k.abs(e[m][l])&&(a=1)}for(m=0;m<f;m++)h.push(e[m][m]);return[g,h]},rungekutta:function(e,a,b,d,g,h){var f,k,m;if(2===h)for(;d<=b;)f=a*e(d,g),k=a*e(d+a,g+f),g+=(f+k)/2,d+=a;if(4===h)for(;d<=b;)f=a*e(d,g),k=a*e(d+a/2,g+f/2),h=a*e(d+a/2,g+k/2),m=a*e(d+a,g+h),g+=(f+2*k+2*h+m)/6,d+=a;return g},romberg:function(e,a,b,d){for(var f=0,g=(b-a)/2,h=[],m=[],l=[],n,p,q;f<d/2;){q=e(a);p=a;for(n=0;p<=b;p+=g,n++)h[n]=p;n=h.length;for(p=1;p<n-1;p++)q+=(0!==p%2?4:2)*e(h[p]);q=g/3*(q+e(b));l[f]=q;g/=2;f++}e=l.length;for(n=1;1!==e;){for(p=0;p<e-1;p++)m[p]=(k.pow(4,n)*l[p+1]-l[p])/(k.pow(4,n)-1);e=m.length;l=m;m=[];n++}return l},richardson:function(e,a,b,d){function f(a,b){for(var e=0,d=a.length,f;e<d;e++)a[e]===b&&(f=e);return f}for(var g=k.abs(b-e[f(e,b)+1]),h=0,m=[],l=[],n,p;d>=g;)n=f(e,b+d),p=f(e,b),m[h]=(a[n]-2*a[p]+a[2*p-n])/(d*d),d/=2,h++;a=m.length;for(e=1;1!=a;){for(b=0;b<a-1;b++)l[b]=(k.pow(4,e)*m[b+1]-m[b])/(k.pow(4,e)-1);a=l.length;m=l;l=[];e++}return m},simpson:function(e,a,b,d){d=(b-a)/d;var f=e(a),g=[],h=a,k=0;for(a=1;h<=b;h+=d,k++)g[k]=h;for(h=g.length;a<h-1;a++)f+=(0!==a%2?4:2)*e(g[a]);return d/3*(f+e(b))},hermite:function(e,a,b,d){for(var f=e.length,g=0,h=0,k=[],m=[],l=[],n=[],p;h<f;h++){k[h]=1;for(p=0;p<f;p++)h!=p&&(k[h]*=(d-e[p])/(e[h]-e[p]));for(p=m[h]=0;p<f;p++)h!=p&&(m[h]+=1/(e[h]-e[p]));l[h]=(1-2*(d-e[h])*m[h])*k[h]*k[h];n[h]=(d-e[h])*k[h]*k[h];g+=l[h]*a[h]+n[h]*b[h]}return g},lagrange:function(e,a,b){for(var d=0,g=0,h,k,m=e.length;g<m;g++){k=a[g];for(h=0;h<m;h++)g!=h&&(k*=(b-e[h])/(e[g]-e[h]));d+=k}return d},cubic_spline:function(e,a,b){for(var f=e.length,g=0,h=[],k=[],m=[],l=[],n=[],p=[];g<f-1;g++)l[g]=e[g+1]-e[g];m[0]=0;for(g=1;g<f-1;g++)m[g]=3/l[g]*(a[g+1]-a[g])-3/l[g-1]*(a[g]-a[g-1]);for(g=1;g<f-1;g++)h[g]=[],k[g]=[],h[g][g-1]=l[g-1],h[g][g]=2*(l[g-1]+l[g]),h[g][g+1]=l[g],k[g][0]=m[g];h=d.multiply(d.inv(h),k);for(g=0;g<f-1;g++)n[g]=(a[g+1]-a[g])/l[g]-l[g]*(h[g+1][0]+2*h[g][0])/3,p[g]=(h[g+1][0]-h[g][0])/(3*l[g]);for(g=0;g<f&&!(e[g]>b);g++);--g;return a[g]+(b-e[g])*n[g]+d.sq(b-e[g])*h[g]+(b-e[g])*d.sq(b-e[g])*p[g]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented");},PCA:function(e){var a=e.length,b=e[0].length,f,g,h,k=[],m=[],l;l=[];h=[];for(f=0;f<a;f++)k[f]=d.sum(e[f])/b;for(f=0;f<b;f++)for(l[f]=[],g=0;g<a;g++)l[f][g]=e[g][f]-k[g];l=d.transpose(l);for(f=0;f<a;f++)for(h[f]=[],g=0;g<a;g++)h[f][g]=d.dot([l[f]],[l[g]])/(b-1);g=d.jacobi(h);f=g[0];b=g[1];k=d.transpose(f);for(f=0;f<b.length;f++)for(g=f;g<b.length;g++)b[f]<b[g]&&(h=b[f],b[f]=b[g],b[g]=h,h=k[f],k[f]=k[g],k[g]=h);l=d.transpose(l);for(f=0;f<a;f++)for(m[f]=[],g=0;g<l.length;g++)m[f][g]=d.dot([k[f]],[l[g]]);return[e,b,k,m]}});(function(e){for(var a=0;a<e.length;a++)(function(a){d.fn[a]=function(b,e){var f=this;return e?(setTimeout(function(){e.call(f,d.fn[a].call(f,b))},15),this):"number"===typeof d[a](this,b)?d[a](this,b):d(d[a](this,b))}})(e[a])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,Math);(function(d,k){function g(a,b,e,d){if(1<a||1<e||0>=a||0>=e)throw Error("Proportions should be greater than 0 and less than 1");var f=(a*b+e*d)/(b+d);b=k.sqrt(f*(1-f)*(1/b+1/d));return(a-e)/b}var e=[].slice,h=d.utils.isNumber,m=d.utils.isArray;d.extend({zscore:function(){var a=e.call(arguments);return h(a[1])?(a[0]-a[1])/a[2]:(a[0]-d.mean(a[1]))/d.stdev(a[1],a[2])},ztest:function(){var a=e.call(arguments),b;if(m(a[1]))return b=d.zscore(a[0],a[1],a[3]),1===a[2]?d.normal.cdf(-k.abs(b),0,1):2*d.normal.cdf(-k.abs(b),0,1);if(2<a.length)return b=d.zscore(a[0],a[1],a[2]),1===a[3]?d.normal.cdf(-k.abs(b),0,1):2*d.normal.cdf(-k.abs(b),0,1);b=a[0];return 1===a[1]?d.normal.cdf(-k.abs(b),0,1):2*d.normal.cdf(-k.abs(b),0,1)}});d.extend(d.fn,{zscore:function(a,b){return(a-this.mean())/this.stdev(b)},ztest:function(a,b,e){a=k.abs(this.zscore(a,e));return 1===b?d.normal.cdf(-a,0,1):2*d.normal.cdf(-a,0,1)}});d.extend({tscore:function(){var a=e.call(arguments);return 4===a.length?(a[0]-a[1])/(a[2]/k.sqrt(a[3])):(a[0]-d.mean(a[1]))/(d.stdev(a[1],!0)/k.sqrt(a[1].length))},ttest:function(){var a=e.call(arguments),b;if(5===a.length)return b=k.abs(d.tscore(a[0],a[1],a[2],a[3])),1===a[4]?d.studentt.cdf(-b,a[3]-1):2*d.studentt.cdf(-b,a[3]-1);if(h(a[1]))return b=k.abs(a[0]),1==a[2]?d.studentt.cdf(-b,a[1]-1):2*d.studentt.cdf(-b,a[1]-1);b=k.abs(d.tscore(a[0],a[1]));return 1==a[2]?d.studentt.cdf(-b,a[1].length-1):2*d.studentt.cdf(-b,a[1].length-1)}});d.extend(d.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/k.sqrt(this.cols()))},ttest:function(a,b){return 1===b?1-d.studentt.cdf(k.abs(this.tscore(a)),this.cols()-1):2*d.studentt.cdf(-k.abs(this.tscore(a)),this.cols()-1)}});d.extend({anovafscore:function(){var a=e.call(arguments),b,f,g,h,m,l;if(1===a.length){b=Array(a[0].length);for(m=0;m<a[0].length;m++)b[m]=a[0][m];a=b}if(2===a.length)return d.variance(a[0])/d.variance(a[1]);f=[];for(m=0;m<a.length;m++)f=f.concat(a[m]);g=d.mean(f);for(m=b=0;m<a.length;m++)b+=a[m].length*k.pow(d.mean(a[m])-g,2);b/=a.length-1;for(m=h=0;m<a.length;m++)for(g=d.mean(a[m]),l=0;l<a[m].length;l++)h+=k.pow(a[m][l]-g,2);h/=f.length-a.length;return b/h},anovaftest:function(){var a=e.call(arguments),b,f,g;if(h(a[0]))return 1-d.centralF.cdf(a[0],a[1],a[2]);anovafscore=d.anovafscore(a);b=a.length-1;for(g=f=0;g<a.length;g++)f+=a[g].length;return 1-d.centralF.cdf(anovafscore,b,f-b-1)},ftest:function(a,b,e){return 1-d.centralF.cdf(a,b,e)}});d.extend(d.fn,{anovafscore:function(){return d.anovafscore(this.toArray())},anovaftes:function(){var a=0,b;for(b=0;b<this.length;b++)a+=this[b].length;return d.ftest(this.anovafscore(),this.length-1,a-this.length)}});d.extend({normalci:function(){var a=e.call(arguments),b=Array(2),f;f=4===a.length?k.abs(d.normal.inv(a[1]/2,0,1)*a[2]/k.sqrt(a[3])):k.abs(d.normal.inv(a[1]/2,0,1)*d.stdev(a[2])/k.sqrt(a[2].length));b[0]=a[0]-f;b[1]=a[0]+f;return b},tci:function(){var a=e.call(arguments),b=Array(2),f;f=4===a.length?k.abs(d.studentt.inv(a[1]/2,a[3]-1)*a[2]/k.sqrt(a[3])):k.abs(d.studentt.inv(a[1]/2,a[2].length-1)*d.stdev(a[2],!0)/k.sqrt(a[2].length));b[0]=a[0]-f;b[1]=a[0]+f;return b},significant:function(a,b){return a<b}});d.extend(d.fn,{normalci:function(a,b){return d.normalci(a,b,this.toArray())},tci:function(a,b){return d.tci(a,b,this.toArray())}});d.extend(d.fn,{oneSidedDifferenceOfProportions:function(a,b,e,h){a=g(a,b,e,h);return d.ztest(a,1)},twoSidedDifferenceOfProportions:function(a,b,e,h){a=g(a,b,e,h);return d.ztest(a,2)}})})(this.jStat,Math);this.jStat.models=function(){function d(e,d){return k(e,d)}function d(e){var d=e[0].length;return jStat.arange(d).map(function(g){var a=jStat.arange(d).filter(function(a){return a!==g});return k(jStat.col(e,g).map(function(a){return a[0]}),jStat.col(e,a))})}function k(e,d){var g=e.length,a=d[0].length-1,b=g-a-1,f=jStat.lstsq(d,e),h=jStat.multiply(d,f.map(function(a){return[a]})).map(function(a){return a[0]}),k=jStat.subtract(e,h),l=jStat.mean(e),n=jStat.sum(h.map(function(a){return Math.pow(a-l,2)})),p=jStat.sum(e.map(function(a,b){return Math.pow(a-h[b],2)})),q=n+p;return{exog:d,endog:e,nobs:g,df_model:a,df_resid:b,coef:f,predict:h,resid:k,ybar:l,SST:q,SSE:n,SSR:p,R2:n/q}}function g(e){var g=d(e.exog),h=Math.sqrt(e.SSR/e.df_resid),a=g.map(function(a){return h/Math.sqrt(a.SST*(1-a.R2))}),g=e.coef.map(function(b,e){return(b-0)/a[e]}),b=g.map(function(a){a=jStat.studentt.cdf(a,e.df_resid);return 2*(.5<a?1-a:a)}),f=jStat.studentt.inv(.975,e.df_resid),k=e.coef.map(function(b,e){var d=f*a[e];return[b-d,b+d]});return{se:a,t:g,p:b,sigmaHat:h,interval95:k}}return{ols:function(e,d){var h=k(e,d),a=g(h),b;b=h.R2/h.df_model/((1-h.R2)/h.df_resid);var f=h.df_model,l=h.df_resid,f=1-jStat.beta.cdf(b/(l/f+b),f/2,l/2);b={F_statistic:b,pvalue:f};f=1-(h.nobs-1)/h.df_resid*(1-h.rsquared);h.t=a;h.f=b;h.adjust_R2=f;return h}}}()},function(k,d,h){(function(l){var g,e;(function(){function n(a){this._value=a}function m(a){var b,e="";for(b=0;b<a;b++)e+="0";return e}function a(a,b,e,d){var f=Math.pow(10,b);if(-1<a.toString().indexOf("e")){var g,h;e=a.toString();f=e.split("e")[0];a=e.split("e")[1];e=f.split(".")[0];g=f.split(".")[1]||"";0<+a?e=e+g+m(a-g.length):(f=0>+e?"-0":"0",0<b&&(f+="."),h=m(-1*a-1),e=(h+Math.abs(e)+g).substr(0,b),e=f+e);0<+a&&0<b&&(e+="."+m(b));b=e;"-"===b.charAt(0)&&0<=+b&&(b=b.substr(1))}else b=(e(a+"e+"+b)/f).toFixed(b);d&&(d=new RegExp("0{1,"+d+"}$"),b=b.replace(d,""));return b}function b(a,b,e,d){var f=e,g=f.indexOf("$"),h=f.indexOf("("),k=f.indexOf("+"),m=f.indexOf("-"),l="",n="";-1===f.indexOf("$")?"infix"===G[F].currency.position?(n=b,G[F].currency.spaceSeparated&&(n=" "+n+" ")):G[F].currency.spaceSeparated&&(l=" "):-1<f.indexOf(" $")?(l=" ",f=f.replace(" $","")):-1<f.indexOf("$ ")?(l=" ",f=f.replace("$ ","")):f=f.replace("$","");a=p(a._value,f,d,n);if(-1===e.indexOf("$"))switch(G[F].currency.position){case "postfix":-1<a.indexOf(")")?(a=a.split(""),a.splice(-1,0,l+b),a=a.join("")):a=a+l+b;break;case "infix":break;case "prefix":-1<a.indexOf("(")||-1<a.indexOf("-")?(a=a.split(""),e=Math.max(h,m)+1,a.splice(e,0,b+l),a=a.join("")):a=b+l+a;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]');}else if(1>=g)if(-1<a.indexOf("(")||-1<a.indexOf("+")||-1<a.indexOf("-")){a=a.split("");e=1;if(g<h||g<k||g<m)e=0;a.splice(e,0,b+l);a=a.join("")}else a=b+l+a;else-1<a.indexOf(")")?(a=a.split(""),a.splice(-1,0,l+b),a=a.join("")):a=a+l+b;return a}function f(a,b,e){var d=b[0],f,g,h,k=Math.abs(a);if(k>=e){for(f=1;f<b.length;++f)if(g=Math.pow(e,f),h=Math.pow(e,f+1),k>=g&&k<h){d=b[f];a/=g;break}d===b[0]&&(a/=Math.pow(e,b.length-1),d=b[b.length-1])}return{value:a,suffix:d}}function p(b,e,d,g){var h=!1,k=!1,l=!1,n="",p,q,t,u,v,r="",D,w="";D=Math.abs(b);var y,x,J,z,O,E,A="",I=!1,C=!1,K;if(0===b&&null!==H)return H;if(!isFinite(b))return""+b;if(0===e.indexOf("{")){E=e.indexOf("}");if(-1===E)throw Error('Format should also contain a "}"');O=e.slice(1,E);e=e.slice(E+1)}else O="";if(e.indexOf("}")===e.length-1){K=e.indexOf("{");if(-1===K)throw Error('Format should also contain a "{"');E=e.slice(K+1,-1);e=e.slice(0,K+1)}else E="";K=-1===e.indexOf(".")?e.match(/([0-9]+).*/):e.match(/([0-9]+)\..*/);K=null===K?-1:K[1].length;-1!==e.indexOf("-")&&(I=!0);-1<e.indexOf("(")?(h=!0,e=e.slice(1,-1)):-1<e.indexOf("+")&&(k=!0,e=e.replace(/\+/g,""));if(-1<e.indexOf("a")&&(z=e.split(".")[0].match(/[0-9]+/g)||["0"],z=parseInt(z[0],10),p=0<=e.indexOf("aK"),q=0<=e.indexOf("aM"),t=0<=e.indexOf("aB"),u=0<=e.indexOf("aT"),v=p||q||t||u,-1<e.indexOf(" a")?(n=" ",e=e.replace(" a","")):e=e.replace("a",""),y=Math.floor(Math.log(D)/Math.LN10)+1,J=y%3,J=0===J?3:J,z&&0!==D&&(x=Math.floor(Math.log(D)/Math.LN10)+1-z,y=3*~~((Math.min(z,y)-J)/3),D/=Math.pow(10,y),-1===e.indexOf(".")&&3<z&&(x=0===x?0:3*~~(x/3)-x,e=e+"[.]"+m(0>x?x+3:x))),Math.floor(Math.log(Math.abs(b))/Math.LN10)+1!==z))if(D>=Math.pow(10,12)&&!v||u)n+=G[F].abbreviations.trillion,b/=Math.pow(10,12);else if(D<Math.pow(10,12)&&D>=Math.pow(10,9)&&!v||t)n+=G[F].abbreviations.billion,b/=Math.pow(10,9);else if(D<Math.pow(10,9)&&D>=Math.pow(10,6)&&!v||q)n+=G[F].abbreviations.million,b/=Math.pow(10,6);else if(D<Math.pow(10,6)&&D>=Math.pow(10,3)&&!v||p)n+=G[F].abbreviations.thousand,b/=Math.pow(10,3);for(p=0;p<B.length;++p)if(D=B[p],-1<e.indexOf(D.marker)){-1<e.indexOf(" "+D.marker)&&(r=" ");e=e.replace(r+D.marker,"");D=f(b,D.suffixes,D.scale);b=D.value;r+=D.suffix;break}-1<e.indexOf("o")&&(-1<e.indexOf(" o")?(w=" ",e=e.replace(" o","")):e=e.replace("o",""),G[F].ordinal&&(w+=G[F].ordinal(b)));-1<e.indexOf("[.]")&&(l=!0,e=e.replace("[.]","."));b.toString().split(".");p=e.split(".")[1];D=e.indexOf(",");p?(-1!==p.indexOf("*")?A=a(b,b.toString().split(".")[1].length,d):-1<p.indexOf("[")?(p=p.replace("]",""),p=p.split("["),A=a(b,p[0].length+p[1].length,d,p[1].length)):A=a(b,p.length,d),d=A.split(".")[0],A=A.split(".")[1].length?(g?n+g:G[F].delimiters.decimal)+A.split(".")[1]:"",l&&0===Number(A.slice(1))&&(A="")):d=a(b,0,d);-1<d.indexOf("-")&&(d=d.slice(1),C=!0);d.length<K&&(d=m(K-d.length)+d);-1<D&&(d=d.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+G[F].delimiters.thousands));0===e.indexOf(".")&&(d="");l=e.indexOf("(");e=e.indexOf("-");return O+(l<e?(h&&C?"(":"")+(I&&C||!h&&C?"-":""):(I&&C||!h&&C?"-":"")+(h&&C?"(":""))+(!C&&k&&0!==b?"+":"")+d+A+(w?w:"")+(n&&!g?n:"")+(r?r:"")+(h&&C?")":"")+E}function q(a){F=a;(a=G[a].defaults)&&a.format&&w.defaultFormat(a.format);a&&a.currencyFormat&&w.defaultCurrencyFormat(a.currencyFormat)}function v(a){a=a.toString().split(".");return 2>a.length?1:Math.pow(10,a[1].length)}function r(){return Array.prototype.slice.call(arguments).reduce(function(a,b){var e=v(a),d=v(b);return e>d?e:d},-Infinity)}var w,z="B KiB MiB GiB TiB PiB EiB ZiB YiB".split(" "),x="B KB MB GB TB PB EB ZB YB".split(" "),C={scale:1024,suffixes:x,marker:"bd"},E={scale:1024,suffixes:z,marker:"b"},A={scale:1E3,suffixes:x,marker:"d"},B=[C,E,A],G={},D=G,F="en-US",H=null,J="0,0",K="0$",I="undefined"!==typeof k&&k.exports;w=function(a){w.isNumbro(a)?a=a.value():0===a||"undefined"===typeof a?a=0:Number(a)||(a=w.fn.unformat(a));return new n(Number(a))};w.version="1.9.3";w.isNumbro=function(a){return a instanceof n};w.setLanguage=function(a,b){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var e=a,d=a.split("-")[0],f=null;D[e]||(Object.keys(D).forEach(function(a){f||a.split("-")[0]!==d||(f=a)}),e=f||b||"en-US");q(e)};w.setCulture=function(a,b){var e=a,d=a.split("-")[1],f=null;G[e]||(d&&Object.keys(G).forEach(function(a){f||a.split("-")[1]!==d||(f=a)}),e=f||b||"en-US");q(e)};w.language=function(a,b){console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead");if(!a)return F;if(a&&!b){if(!D[a])throw Error("Unknown language : "+a);q(a)}if(b||!D[a])G[a]=b;return w};w.culture=function(a,b){if(!a)return F;if(a&&!b){if(!G[a])throw Error("Unknown culture : "+a);q(a)}if(b||!G[a])G[a]=b;return w};w.languageData=function(a){console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead");if(!a)return D[F];if(!D[a])throw Error("Unknown language : "+a);return D[a]};w.cultureData=function(a){if(!a)return G[F];if(!G[a])throw Error("Unknown culture : "+a);return G[a]};w.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}});w.languages=function(){console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead");return D};w.cultures=function(){return G};w.zeroFormat=function(a){H="string"===typeof a?a:null};w.defaultFormat=function(a){J="string"===typeof a?a:"0.0"};w.defaultCurrencyFormat=function(a){K="string"===typeof a?a:"0$"};w.validate=function(a,b){var e,d,f,g,h;"string"!==typeof a&&(a+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",a));a=a.trim();a=a.replace(/^[+-]?/,"");if(a.match(/^\d+$/))return!0;if(""===a)return!1;try{d=w.cultureData(b)}catch(ga){d=w.cultureData(w.culture())}f=d.currency.symbol;g=d.abbreviations;e=d.delimiters.decimal;d="."===d.delimiters.thousands?"\\.":d.delimiters.thousands;h=a.match(/^[^\d\.\,]+/);if(null!==h&&(a=a.substr(1),h[0]!==f))return!1;h=a.match(/[^\d]+$/);if(null!==h&&(a=a.slice(0,-1),h[0]!==g.thousand&&h[0]!==g.million&&h[0]!==g.billion&&h[0]!==g.trillion))return!1;f=new RegExp(d+"{2}");return a.match(/[^\d.,]/g)||(e=a.split(e),2<e.length)?!1:2>e.length?!!e[0].match(/^\d+.*\d$/)&&!e[0].match(f):""===e[0]?!e[0].match(f)&&!!e[1].match(/^\d+$/):1===e[0].length?!!e[0].match(/^\d+$/)&&!e[0].match(f)&&!!e[1].match(/^\d+$/):!!e[0].match(/^\d+.*\d$/)&&!e[0].match(f)&&!!e[1].match(/^\d+$/)};w.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");w.loadCulturesInNode()};w.loadCulturesInNode=function(){var a=h(58),b;for(b in a)b&&w.culture(b,a[b])};"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof a)throw new TypeError(a+" is not a function");var e,d,f=this.length>>>0,g=!1;1<arguments.length&&(d=b,g=!0);for(e=0;f>e;++e)this.hasOwnProperty(e)&&(g?d=a(d,this[e],e,this):(d=this[e],g=!0));if(!g)throw new TypeError("Reduce of empty array with no initial value");return d});w.fn=n.prototype={clone:function(){return w(this)},format:function(a,e){var d=a?a:J,f=void 0!==e?e:Math.round,g=d.replace(/\{[^\{\}]*\}/g,"");if(-1<g.indexOf("$"))f=b(this,G[F].currency.symbol,d,f);else if(-1<g.indexOf("%")){var g=d,d="",h=100*this._value;-1<g.indexOf(" %")?(d=" ",g=g.replace(" %","")):g=g.replace("%","");f=p(h,g,f);-1<f.indexOf(")")?(f=f.split(""),f.splice(-1,0,d+"%"),f=f.join("")):f=f+d+"%"}else-1<g.indexOf(":")?(f=Math.floor(this._value/60/60),d=Math.floor((this._value-3600*f)/60),g=Math.round(this._value-3600*f-60*d),f=f+":"+(10>d?"0"+d:d)+":"+(10>g?"0"+g:g)):f=p(this._value,d,f);return f},formatCurrency:function(a,e){return b(this,G[F].currency.symbol,a?a:K,void 0!==e?e:Math.round)},formatForeignCurrency:function(a,e,d){return b(this,a,e?e:K,void 0!==d?d:Math.round)},unformat:function(a){if("number"===typeof a)return a;if("string"===typeof a){var b=a,e,d,f,g,h=!1,k;if(-1<a.indexOf(":"))a=a.split(":"),b=0,3===a.length?(b+=3600*Number(a[0]),b+=60*Number(a[1]),b+=Number(a[2])):2===a.length&&(b+=60*Number(a[0]),b+=Number(a[1])),this._value=Number(b);else if(a===H)this._value=0;else{"."!==G[F].delimiters.decimal&&(a=a.replace(/\./g,"").replace(G[F].delimiters.decimal,"."));e=new RegExp("[^a-zA-Z]"+G[F].abbreviations.thousand+"(?:\\)|(\\"+G[F].currency.symbol+")?(?:\\))?)?$");d=new RegExp("[^a-zA-Z]"+G[F].abbreviations.million+"(?:\\)|(\\"+G[F].currency.symbol+")?(?:\\))?)?$");f=new RegExp("[^a-zA-Z]"+G[F].abbreviations.billion+"(?:\\)|(\\"+G[F].currency.symbol+")?(?:\\))?)?$");g=new RegExp("[^a-zA-Z]"+G[F].abbreviations.trillion+"(?:\\)|(\\"+G[F].currency.symbol+")?(?:\\))?)?$");for(k=1;k<z.length&&!h;++k)-1<a.indexOf(z[k])?h=Math.pow(1024,k):-1<a.indexOf(x[k])&&(h=Math.pow(1E3,k));k=a.replace(/[^0-9\.]+/g,"");""===k?this._value=NaN:(this._value=(h?h:1)*(b.match(e)?Math.pow(10,3):1)*(b.match(d)?Math.pow(10,6):1)*(b.match(f)?Math.pow(10,9):1)*(b.match(g)?Math.pow(10,12):1)*(-1<a.indexOf("%")?.01:1)*((a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1)*Number(k),this._value=h?Math.ceil(this._value):this._value)}a=this._value;return isNaN(a)?void 0:a}},binaryByteUnits:function(){return f(this._value,E.suffixes,E.scale).suffix},byteUnits:function(){return f(this._value,C.suffixes,C.scale).suffix},decimalByteUnits:function(){return f(this._value,A.suffixes,A.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){this._value=Number(a);return this},add:function(a){var b=r.call(null,this._value,a);this._value=[this._value,a].reduce(function(a,e){return a+b*e},0)/b;return this},subtract:function(a){var b=r.call(null,this._value,a);this._value=[a].reduce(function(a,e){return a-b*e},this._value*b)/b;return this},multiply:function(a){this._value=[this._value,a].reduce(function(a,b){var e=r(a,b);return e=a*e*b*e/(e*e)},1);return this},divide:function(a){this._value=[this._value,a].reduce(function(a,b){var e=r(a,b);return a*e/(b*e)});return this},difference:function(a){return Math.abs(w(this._value).subtract(a).value())}};"undefined"!==typeof l&&void 0===l.browser&&l.title&&(0===l.title.indexOf("node")||0<l.title.indexOf("meteor-tool")||"grunt"===l.title||"gulp"===l.title)&&w.loadCulturesInNode();I?k.exports=w:("undefined"===typeof ender&&(this.numbro=w),!(g=[],e=function(){return w}.apply(d,g),void 0!==e&&(k.exports=e)))}).call("undefined"===typeof window?this:window)}).call(d,h(15))},function(k,d){function h(){throw Error("setTimeout has not been defined");}function l(){throw Error("clearTimeout has not been defined");}function g(a){if(p===setTimeout)return setTimeout(a,0);if((p===h||!p)&&setTimeout)return p=setTimeout,setTimeout(a,0);try{return p(a,0)}catch(C){try{return p.call(null,a,0)}catch(E){return p.call(this,a,0)}}}function e(a){if(q===clearTimeout)return clearTimeout(a);if((q===l||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(C){try{return q.call(null,a)}catch(E){return q.call(this,a)}}}function n(){r&&w&&(r=!1,w.length?v=w.concat(v):z=-1,v.length&&m())}function m(){if(!r){var a=g(n);r=!0;for(var b=v.length;b;){w=v;for(v=[];++z<b;)w&&w[z].run();z=-1;b=v.length}w=null;r=!1;e(a)}}function a(a,b){this.fun=a;this.array=b}function b(){}var f=k.exports={},p,q;try{p="function"===typeof setTimeout?setTimeout:h}catch(x){p=h}try{q="function"===typeof clearTimeout?clearTimeout:l}catch(x){q=l}var v=[],r=!1,w,z=-1;f.nextTick=function(b){var e=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)e[d-1]=arguments[d];v.push(new a(b,e));1!==v.length||r||g(m)};a.prototype.run=function(){this.fun.apply(null,this.array)};f.title="browser";f.browser=!0;f.env={};f.argv=[];f.version="";f.versions={};f.on=b;f.addListener=b;f.once=b;f.off=b;f.removeListener=b;f.removeAllListeners=b;f.emit=b;f.binding=function(a){throw Error("process.binding is not supported");};f.cwd=function(){return"/"};f.chdir=function(a){throw Error("process.chdir is not supported");};f.umask=function(){return 0}},function(k,d,h){function l(a){return a&&a.__esModule?a:{"default":a}}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function e(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;k=h(78);k=l(k);var n=h(17),m=l(n),a=h(80),b=h(31),f=h(3),p=h(1),q=l(p),v=h(9);h=function(d){function h(){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var e=g(this,d.call(this));e.parser=new a.Parser;e.parser.yy={toNumber:f.toNumber,trimEdges:b.trimEdges,invertNumber:f.invertNumber,throwError:function(a){return e._throwError(a)},callVariable:function(a){return e._callVariable(a)},evaluateByOperator:m["default"],callFunction:m["default"],cellValue:function(a){return e._callCellValue(a)},rangeValue:function(a,b){return e._callRangeValue(a,b)}};e.variables=Object.create(null);e.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null);return e}e(h,d);h.prototype.parse=function(a){var b=null,e=null;try{b=""===a?"":this.parser.parse(a)}catch(E){e=(a=(0,q["default"])(E.message))?a:(0,q["default"])(p.ERROR)}b instanceof Error&&(e=(0,q["default"])(b.message)||(0,q["default"])(p.ERROR),b=null);return{error:e,result:b}};h.prototype.setVariable=function(a,b){this.variables[a]=b;return this};h.prototype.getVariable=function(a){return this.variables[a]};h.prototype._callVariable=function(a){var b=this.getVariable(a);this.emit("callVariable",a,function(a){void 0!==a&&(b=a)});if(void 0===b)throw Error(p.ERROR_NAME);return b};h.prototype._callCellValue=function(a){a=a.toUpperCase();var b=(0,v.extractLabel)(a),e=void 0;this.emit("callCellValue",{label:a,row:b[0],column:b[1]},function(a){e=a});return e};h.prototype._callRangeValue=function(a,b){a=a.toUpperCase();b=b.toUpperCase();var e=(0,v.extractLabel)(a),d=e[0],e=e[1],f=(0,v.extractLabel)(b),g=f[0],f=f[1],h={},k={};d.index<=g.index?(h.row=d,k.row=g):(h.row=g,k.row=d);e.index<=f.index?(h.column=e,k.column=f):(h.column=f,k.column=e);h.label=(0,v.toLabel)(h.row,h.column);k.label=(0,v.toLabel)(k.row,k.column);var m=[];this.emit("callRangeValue",h,k,function(){m=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]});return m};h.prototype._throwError=function(a){if((0,p.isValidStrict)(a))throw Error(a);throw Error(p.ERROR);};return h}(k["default"]);d["default"]=h},function(k,d,h){function l(a){return a&&a.__esModule?a:{"default":a}}function g(a,b){Array.isArray(a)||(a=[a.toUpperCase()]);a.forEach(function(a){x[a]=b.isFactory?b(a):b})}d.__esModule=!0;d["default"]=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];a=a.toUpperCase();if(!x[a])throw Error(z.ERROR_NAME);return x[a].apply(x,b)};d.registerOperation=g;k=h(18);k=l(k);d=h(19);d=l(d);var e=h(20),e=l(e),n=h(21),n=l(n),m=h(22),m=l(m),a=h(24),a=l(a),b=h(23),b=l(b),f=h(26),f=l(f),p=h(25),p=l(p),q=h(27),q=l(q),v=h(28),v=l(v),r=h(29),r=l(r),w=h(30),w=l(w),z=h(1),x=Object.create(null);g(k["default"].SYMBOL,k["default"]);g(d["default"].SYMBOL,d["default"]);g(e["default"].SYMBOL,e["default"]);g(n["default"].SYMBOL,n["default"]);g(w["default"].SYMBOL,w["default"]);g(m["default"].SYMBOL,m["default"]);g(a["default"].SYMBOL,a["default"]);g(b["default"].SYMBOL,b["default"]);g(f["default"].SYMBOL,f["default"]);g(p["default"].SYMBOL,p["default"]);g(v["default"].SYMBOL,v["default"]);g(r["default"].SYMBOL,r["default"]);g(q["default"].SYMBOL,q["default"])},function(k,d,h){function l(d){for(var h=arguments.length,a=Array(1<h?h-1:0),b=1;b<h;b++)a[b-1]=arguments[b];h=a.reduce(function(a,b){return a+(0,g.toNumber)(b)},(0,g.toNumber)(d));if(isNaN(h))throw Error(e.ERROR_VALUE);return h}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=h(3),e=h(1);k=d.SYMBOL="+";l.SYMBOL=k},function(k,d,h){function l(){for(var d=arguments.length,e=Array(d),h=0;h<d;h++)e[h]=arguments[h];return e.reduce(function(e,a){return e+a.toString()},"")}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x26";l.SYMBOL=k},function(k,d,h){function l(d){for(var h=arguments.length,a=Array(1<h?h-1:0),b=1;b<h;b++)a[b-1]=arguments[b];h=a.reduce(function(a,b){return a/(0,g.toNumber)(b)},(0,g.toNumber)(d));if(Infinity===h)throw Error(e.ERROR_DIV_ZERO);if(isNaN(h))throw Error(e.ERROR_VALUE);return h}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=h(3),e=h(1);k=d.SYMBOL="/";l.SYMBOL=k},function(k,d,h){function l(d,e){return d===e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3d";l.SYMBOL=k},function(k,d,h){function l(d){return function(){d=d.toUpperCase();var h=d.split("."),a=!1,b=void 0;if(1===h.length)g[h[0]]&&(a=!0,b=g[h[0]].apply(g,arguments));else{for(var f=h.length,k=0,l=g;k<f;)if(l=l[h[k]],k++,!l){l=null;break}l&&(a=!0,b=l.apply(void 0,arguments))}if(!a)throw Error(e.ERROR_NAME);return b}}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=function(e){if(e&&e.__esModule)return e;var d={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(d[a]=e[a]);d["default"]=e;return d}(h(33));k=(k=h(10))&&k.__esModule?k:{"default":k};var e=h(1);d=d.SYMBOL=k["default"];l.isFactory=!0;l.SYMBOL=d},function(k,d,h){function l(d,e){return d>=e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3e\x3d";l.SYMBOL=k},function(k,d,h){function l(d,e){return d>e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3e";l.SYMBOL=k},function(k,d,h){function l(d,e){return d<=e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3c\x3d";l.SYMBOL=k},function(k,d,h){function l(d,e){return d<e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3c";l.SYMBOL=k},function(k,d,h){function l(d){for(var h=arguments.length,a=Array(1<h?h-1:0),b=1;b<h;b++)a[b-1]=arguments[b];h=a.reduce(function(a,b){return a-(0,g.toNumber)(b)},(0,g.toNumber)(d));if(isNaN(h))throw Error(e.ERROR_VALUE);return h}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=h(3),e=h(1);k=d.SYMBOL="-";l.SYMBOL=k},function(k,d,h){function l(d){for(var h=arguments.length,a=Array(1<h?h-1:0),b=1;b<h;b++)a[b-1]=arguments[b];h=a.reduce(function(a,b){return a*(0,g.toNumber)(b)},(0,g.toNumber)(d));if(isNaN(h))throw Error(e.ERROR_VALUE);return h}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=h(3),e=h(1);k=d.SYMBOL="*";l.SYMBOL=k},function(k,d,h){function l(d,e){return d!==e}d.__esModule=!0;d["default"]=l;k=d.SYMBOL="\x3c\x3e";l.SYMBOL=k},function(k,d,h){function l(d,h){var a=Math.pow((0,g.toNumber)(d),(0,g.toNumber)(h));if(isNaN(a))throw Error(e.ERROR_VALUE);return a}d.__esModule=!0;d.SYMBOL=void 0;d["default"]=l;var g=h(3),e=h(1);k=d.SYMBOL="^";l.SYMBOL=k},function(k,d,h){d.__esModule=!0;d.trimEdges=function(d){var g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return d=d.substring(g,d.length-g)}},function(k,d,h){function l(a,e){return a.reduce(function(a,b){return e*a+b},0)}function g(a,e,d,g,h){h||(h=-1);a=2/a;var b;if(0===e)return d;if(1===e)return g;for(var f=1;f!=e;++f)b=g*f*a+h*d,d=g,g=b;return g}function e(a,e,d,h,k){return function(b,f){if(0===f)return a(b);if(1===f)return e(b);if(0>f)throw d+": Order ("+f+") must be nonnegative";if(1==h&&0===b)throw d+": Undefined when x \x3d\x3d 0";if(2==h&&0>=b)throw d+": Undefined when x \x3c\x3d 0";var l=a(b),m=e(b);return g(b,f,l,m,k)}}var n=Math,m=function(){function a(a){var b,e;e=a*a;var f=n.abs(a)-.785398164;8>n.abs(a)?(b=l(d,e),e=l(h,e),a=b/e):(e=64/e,b=l(k,e),e=l(m,e),a=n.sqrt(.636619772/n.abs(a))*(n.cos(f)*b-n.sin(f)*e*8/n.abs(a)));return a}function e(a){var b,e;e=a*a;var d=n.abs(a)-2.356194491;8>Math.abs(a)?(b=a*l(p,e),e=l(q,e),b/=e):(e=64/e,b=l(r,e),e=l(C,e),b=n.sqrt(.636619772/n.abs(a))*(n.cos(d)*b-n.sin(d)*e*8/n.abs(a)),0>a&&(b=-b));return b}var d=[57568490574,-13362590354,6.516196407E8,-1.121442418E7,77392.33017,-184.9052456].reverse(),h=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),k=[1,-.001098628627,2.734510407E-5,-2.073370639E-6,2.093887211E-7].reverse(),m=[-.01562499995,1.430488765E-4,-6.911147651E-6,7.621095161E-7,-9.34935152E-8].reverse(),p=[72362614232,-7895059235,2.423968531E8,-2972611.439,15704.4826,-30.16036606].reverse(),q=[144725228442,2300535178,1.858330474E7,99447.43394,376.9991397,1].reverse(),r=[1,.00183105,-3.516396496E-5,2.457520174E-6,-2.40337019E-7].reverse(),C=[.04687499995,-2.002690873E-4,8.449199096E-6,-8.8228987E-7,1.05787412E-7].reverse();return function(b,d){d=Math.round(d);if(0===d)return a(n.abs(b));if(1===d)return e(n.abs(b));if(0>d)throw"BESSELJ: Order ("+d+") must be nonnegative";if(0===n.abs(b))return 0;var f,h,k=2/n.abs(b),l,m,p,q,t;if(n.abs(b)>d)f=g(b,d,a(n.abs(b)),e(n.abs(b)),-1);else{h=2*n.floor((d+n.floor(n.sqrt(40*d)))/2);p=f=m=l=0;for(q=1;0<h;h--)t=h*k*q-p,p=q,q=t,1E10<n.abs(q)&&(q*=1E-10,p*=1E-10,f*=1E-10,m*=1E-10),l&&(m+=q),l=!l,h==d&&(f=p);f/=2*m-q}return 0>b&&d%2?-f:f}}();k=function(){var a=[-2957821389,7062834065,-5.123598036E8,1.087988129E7,-86327.92757,228.4622733].reverse(),d=[40076544269,7.452499648E8,7189466.438,47447.2647,226.1030244,1].reverse(),g=[1,-.001098628627,2.734510407E-5,-2.073370639E-6,2.093887211E-7].reverse(),h=[-.01562499995,1.430488765E-4,-6.911147651E-6,7.621095161E-7,-9.34945152E-8].reverse(),k=[-4900604943E3,127527439E4,-51534381390,7.349264551E8,-4237922.726,8511.937935].reverse(),p=[249958057E5,424441966400,3733650367,2.245904002E7,102042.605,354.9632885,1].reverse(),q=[1,.00183105,-3.516396496E-5,2.457520174E-6,-2.40337019E-7].reverse(),r=[.04687499995,-2.002690873E-4,8.449199096E-6,-8.8228987E-7,1.05787412E-7].reverse();return e(function(b){var e,f;f=b*b;var k=b-.785398164;8>b?(e=l(a,f),f=l(d,f),b=e/f+.636619772*m(b,0)*n.log(b)):(f=64/f,e=l(g,f),f=l(h,f),b=n.sqrt(.636619772/b)*(n.sin(k)*e+n.cos(k)*f*8/b));return b},function(a){var b,e;e=a*a;var d=a-2.356194491;8>a?(b=a*l(k,e),e=l(p,e),a=b/e+.636619772*(m(a,1)*n.log(a)-1/a)):(e=64/e,b=l(q,e),e=l(r,e),a=n.sqrt(.636619772/a)*(n.sin(d)*b+n.cos(d)*e*8/a));return a},"BESSELY",1,-1)}();var a=function(){var a=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),d=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,3.2411E-4].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function y(b,f){f=Math.round(f);if(0===f){var h;h=3.75>=b?l(a,b*b/14.0625):n.exp(n.abs(b))/n.sqrt(n.abs(b))*l(e,3.75/n.abs(b));return h}if(1==f)return h=3.75>b?b*l(d,b*b/14.0625):(0>b?-1:1)*n.exp(n.abs(b))/n.sqrt(n.abs(b))*l(g,3.75/n.abs(b)),h;if(0>f)throw"BESSELI Order ("+f+") must be nonnegative";if(0===n.abs(b))return 0;var k,m=2/n.abs(b),p,q,t;k=2*n.round((f+n.round(n.sqrt(40*f)))/2);p=h=0;for(q=1;0<k;k--)t=k*m*q+p,p=q,q=t,1E10<n.abs(q)&&(q*=1E-10,p*=1E-10,h*=1E-10),k==f&&(h=p);h*=y(b,0)/q;return 0>b&&f%2?-h:h}}();h=function(){var b=[-.57721566,.4227842,.23069756,.0348859,.00262698,1.075E-4,7.4E-6].reverse(),d=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,5.3208E-4].reverse(),g=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4.686E-5].reverse(),h=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-6.8245E-4].reverse();return e(function(e){return 2>=e?-n.log(e/2)*a(e,0)+l(b,e*e/4):n.exp(-e)/n.sqrt(e)*l(d,2/e)},function(b){return 2>=b?n.log(b/2)*a(b,1)+1/b*l(g,b*b/4):n.exp(-b)/n.sqrt(b)*l(h,2/b)},"BESSELK",2,1)}();d.besselj=m;d.bessely=k;d.besseli=a;d.besselk=h},function(k,d,h){k=[h(34),h(35),h(11),h(37),h(4),h(8),h(6),h(36),h(7),h(38),h(5),h(12)];for(var l in k){h=k[l];for(var g in h)d[g]=d[g]||h[g]}},function(k,d,h){function l(e,d){if(d)for(var a in d)e[a]=d[a];return e}k=h(4);var g=h(5),e=h(11);h=h(6);d.BETADIST=g.BETA.DIST;d.BETAINV=g.BETA.INV;d.BINOMDIST=g.BINOM.DIST;d.CEILING=d.ISOCEILING=l(k.CEILING.MATH,k.CEILING);d.CEILINGMATH=k.CEILING.MATH;d.CEILINGPRECISE=k.CEILING.PRECISE;d.CHIDIST=g.CHISQ.DIST;d.CHIDISTRT=g.CHISQ.DIST.RT;d.CHIINV=g.CHISQ.INV;d.CHIINVRT=g.CHISQ.INV.RT;d.CHITEST=g.CHISQ.TEST;d.CONFIDENCE=l(g.CONFIDENCE.NORM,g.CONFIDENCE);d.COVAR=g.COVARIANCE.P;d.COVARIANCEP=g.COVARIANCE.P;d.COVARIANCES=g.COVARIANCE.S;d.CRITBINOM=g.BINOM.INV;d.EXPONDIST=g.EXPON.DIST;d.ERFCPRECISE=e.ERFC.PRECISE;d.ERFPRECISE=e.ERF.PRECISE;d.FDIST=g.F.DIST;d.FDISTRT=g.F.DIST.RT;d.FINVRT=g.F.INV.RT;d.FINV=g.F.INV;d.FLOOR=l(k.FLOOR.MATH,k.FLOOR);d.FLOORMATH=k.FLOOR.MATH;d.FLOORPRECISE=k.FLOOR.PRECISE;d.FTEST=g.F.TEST;d.GAMMADIST=g.GAMMA.DIST;d.GAMMAINV=g.GAMMA.INV;d.GAMMALNPRECISE=g.GAMMALN.PRECISE;d.HYPGEOMDIST=g.HYPGEOM.DIST;d.LOGINV=g.LOGNORM.INV;d.LOGNORMINV=g.LOGNORM.INV;d.LOGNORMDIST=g.LOGNORM.DIST;d.MODE=l(g.MODE.SNGL,g.MODE);d.MODEMULT=g.MODE.MULT;d.MODESNGL=g.MODE.SNGL;d.NEGBINOMDIST=g.NEGBINOM.DIST;d.NETWORKDAYSINTL=h.NETWORKDAYS.INTL;d.NORMDIST=g.NORM.DIST;d.NORMINV=g.NORM.INV;d.NORMSDIST=g.NORM.S.DIST;d.NORMSINV=g.NORM.S.INV;d.PERCENTILE=l(g.PERCENTILE.EXC,g.PERCENTILE);d.PERCENTILEEXC=g.PERCENTILE.EXC;d.PERCENTILEINC=g.PERCENTILE.INC;d.PERCENTRANK=l(g.PERCENTRANK.INC,g.PERCENTRANK);d.PERCENTRANKEXC=g.PERCENTRANK.EXC;d.PERCENTRANKINC=g.PERCENTRANK.INC;d.POISSON=l(g.POISSON.DIST,g.POISSON);d.POISSONDIST=g.POISSON.DIST;d.QUARTILE=l(g.QUARTILE.INC,g.QUARTILE);d.QUARTILEEXC=g.QUARTILE.EXC;d.QUARTILEINC=g.QUARTILE.INC;d.RANK=l(g.RANK.EQ,g.RANK);d.RANKAVG=g.RANK.AVG;d.RANKEQ=g.RANK.EQ;d.SKEWP=g.SKEW.P;d.STDEV=l(g.STDEV.S,g.STDEV);d.STDEVP=g.STDEV.P;d.STDEVS=g.STDEV.S;d.TDIST=g.T.DIST;d.TDISTRT=g.T.DIST.RT;d.TINV=g.T.INV;d.TTEST=g.T.TEST;d.VAR=l(g.VAR.S,g.VAR);d.VARP=g.VAR.P;d.VARS=g.VAR.S;d.WEIBULL=l(g.WEIBULL.DIST,g.WEIBULL);d.WEIBULLDIST=g.WEIBULL.DIST;d.WORKDAYINTL=h.WORKDAY.INTL;d.ZTEST=g.Z.TEST},function(k,d,h){function l(b){var e=[];a.arrayEach(b,function(a){a&&e.push(a)});return e}function g(a,e){for(var b={},d=1;d<a[0].length;++d)b[d]=!0;for(var f=e[0].length,d=1;d<e.length;++d)e[d].length>f&&(f=e[d].length);for(d=1;d<a.length;++d)for(var g=1;g<a[d].length;++g){for(var h=!1,k=!1,l=0;l<e.length;++l){var m=e[l];if(!(m.length<f)&&a[d][0]===m[0])for(var k=!0,n=1;n<m.length;++n)h=h||eval(a[d][g]+m[n])}k&&(b[g]=b[g]&&h)}f=[];for(d=0;d<a[0].length;++d)b[d]&&f.push(d-1);return f}var e=h(0),n=h(5),m=h(4),a=h(2);d.FINDFIELD=function(b,d){var f=null;a.arrayEach(b,function(a,b){if(a[0]===d)return f=b,!1});return null==f?e.value:f};d.DAVERAGE=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=0;a.arrayEach(h,function(a){l+=k[a]});return 0===h.length?e.div0:l/h.length};d.DCOUNT=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=[];a.arrayEach(h,function(a){l.push(k[a])});return n.COUNT(l)};d.DCOUNTA=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=[];a.arrayEach(h,function(a){l.push(k[a])});return n.COUNTA(l)};d.DGET=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);"string"===typeof f&&(f=d.FINDFIELD(b,f));b=a.rest(b[f]);return 0===h.length?e.value:1<h.length?e.num:b[h[0]]};d.DMAX=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=k[h[0]];a.arrayEach(h,function(a){l<k[a]&&(l=k[a])});return l};d.DMIN=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=k[h[0]];a.arrayEach(h,function(a){l>k[a]&&(l=k[a])});return l};d.DPRODUCT=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),m=[];a.arrayEach(h,function(a){m.push(k[a])});var m=l(m),n=1;a.arrayEach(m,function(a){n*=a});return n};d.DSTDEV=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),m=[];a.arrayEach(h,function(a){m.push(k[a])});m=l(m);return n.STDEV.S(m)};d.DSTDEVP=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),m=[];a.arrayEach(h,function(a){m.push(k[a])});m=l(m);return n.STDEV.P(m)};d.DSUM=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=[];a.arrayEach(h,function(a){l.push(k[a])});return m.SUM(l)};d.DVAR=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=[];a.arrayEach(h,function(a){l.push(k[a])});return n.VAR.S(l)};d.DVARP=function(b,f,h){if(isNaN(f)&&"string"!==typeof f)return e.value;h=g(b,h);var k=[];"string"===typeof f&&(f=d.FINDFIELD(b,f));var k=a.rest(b[f]),l=[];a.arrayEach(h,function(a){l.push(k[a])});return n.VAR.P(l)}},function(k,d,h){function l(a){return a&&a.getTime&&!isNaN(a.getTime())}function g(a){return a instanceof Date?a:new Date(a)}var e=h(0),n=h(6),m=h(2);d.ACCRINT=function(a,b,d,h,k,m,p){a=g(a);b=g(b);d=g(d);return l(a)&&l(b)&&l(d)?0>=h||0>=k||-1===[1,2,4].indexOf(m)||-1===[0,1,2,3,4].indexOf(p)||d<=a?e.num:(k||0)*h*n.YEARFRAC(a,d,p||0):e.value};d.ACCRINTM=function(){throw Error("ACCRINTM is not implemented");};d.AMORDEGRC=function(){throw Error("AMORDEGRC is not implemented");};d.AMORLINC=function(){throw Error("AMORLINC is not implemented");};d.COUPDAYBS=function(){throw Error("COUPDAYBS is not implemented");};d.COUPDAYS=function(){throw Error("COUPDAYS is not implemented");};d.COUPDAYSNC=function(){throw Error("COUPDAYSNC is not implemented");};d.COUPNCD=function(){throw Error("COUPNCD is not implemented");};d.COUPNUM=function(){throw Error("COUPNUM is not implemented");};d.COUPPCD=function(){throw Error("COUPPCD is not implemented");};d.CUMIPMT=function(a,b,f,g,h,k){a=m.parseNumber(a);b=m.parseNumber(b);f=m.parseNumber(f);if(m.anyIsError(a,b,f))return e.value;if(0>=a||0>=b||0>=f||1>g||1>h||g>h||0!==k&&1!==k)return e.num;b=d.PMT(a,b,f,0,k);var l=0;1===g&&0===k&&(l=-f,g++);for(;g<=h;g++)l=1===k?l+(d.FV(a,g-2,b,f,1)-b):l+d.FV(a,g-1,b,f,0);return l*a};d.CUMPRINC=function(a,b,f,g,h,k){a=m.parseNumber(a);b=m.parseNumber(b);f=m.parseNumber(f);if(m.anyIsError(a,b,f))return e.value;if(0>=a||0>=b||0>=f||1>g||1>h||g>h||0!==k&&1!==k)return e.num;b=d.PMT(a,b,f,0,k);var l=0;1===g&&(l=0===k?b+f*a:b,g++);for(;g<=h;g++)l=0<k?l+(b-(d.FV(a,g-2,b,f,1)-b)*a):l+(b-d.FV(a,g-1,b,f,0)*a);return l};d.DB=function(a,b,d,g,h){h=void 0===h?12:h;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);if(m.anyIsError(a,b,d,g,h))return e.value;if(0>a||0>b||0>d||0>g||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(h)||g>d)return e.num;if(b>=a)return 0;b=(1-Math.pow(b/a,1/d)).toFixed(3);for(var f=h=a*b*h/12,k=0,l=g===d?d-1:g,n=2;n<=l;n++)k=(a-f)*b,f+=k;return 1===g?h:g===d?(a-f)*b:k};d.DDB=function(a,b,d,g,h){h=void 0===h?2:h;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);if(m.anyIsError(a,b,d,g,h))return e.value;if(0>a||0>b||0>d||0>g||0>=h||g>d)return e.num;if(b>=a)return 0;for(var f=0,k=0,l=1;l<=g;l++)k=Math.min(h/d*(a-f),a-b-f),f+=k;return k};d.DISC=function(){throw Error("DISC is not implemented");};d.DOLLARDE=function(a,b){a=m.parseNumber(a);b=m.parseNumber(b);if(m.anyIsError(a,b))return e.value;if(0>b)return e.num;if(0<=b&&1>b)return e.div0;b=parseInt(b,10);var d=parseInt(a,10),d=d+a%1*Math.pow(10,Math.ceil(Math.log(b)/Math.LN10))/b,g=Math.pow(10,Math.ceil(Math.log(b)/Math.LN2)+1);return d=Math.round(d*g)/g};d.DOLLARFR=function(a,b){a=m.parseNumber(a);b=m.parseNumber(b);if(m.anyIsError(a,b))return e.value;if(0>b)return e.num;if(0<=b&&1>b)return e.div0;b=parseInt(b,10);var d=parseInt(a,10);return d+=a%1*Math.pow(10,-Math.ceil(Math.log(b)/Math.LN10))*b};d.DURATION=function(){throw Error("DURATION is not implemented");};d.EFFECT=function(a,b){a=m.parseNumber(a);b=m.parseNumber(b);if(m.anyIsError(a,b))return e.value;if(0>=a||1>b)return e.num;b=parseInt(b,10);return Math.pow(1+a/b,b)-1};d.FV=function(a,b,d,g,h){g=g||0;h=h||0;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);if(m.anyIsError(a,b,d,g,h))return e.value;0===a?a=g+d*b:(b=Math.pow(1+a,b),a=1===h?g*b+d*(1+a)*(b-1)/a:g*b+d*(b-1)/a);return-a};d.FVSCHEDULE=function(a,b){a=m.parseNumber(a);b=m.parseNumberArray(m.flatten(b));if(m.anyIsError(a,b))return e.value;for(var d=b.length,g=a,h=0;h<d;h++)g*=1+b[h];return g};d.INTRATE=function(){throw Error("INTRATE is not implemented");};d.IPMT=function(a,b,f,g,h,k){h=h||0;k=k||0;a=m.parseNumber(a);b=m.parseNumber(b);f=m.parseNumber(f);g=m.parseNumber(g);h=m.parseNumber(h);k=m.parseNumber(k);if(m.anyIsError(a,b,f,g,h,k))return e.value;f=d.PMT(a,f,g,h,k);return(1===b?1===k?0:-g:1===k?d.FV(a,b-2,f,g,1)-f:d.FV(a,b-1,f,g,0))*a};d.IRR=function(a,b){b=b||0;a=m.parseNumberArray(m.flatten(a));b=m.parseNumber(b);if(m.anyIsError(a,b))return e.value;for(var d=function(a,b,e){e+=1;for(var d=a[0],f=1;f<a.length;f++)d+=a[f]/Math.pow(e,(b[f]-b[0])/365);return d},g=function(a,b,e){e+=1;for(var d=0,f=1;f<a.length;f++)var g=(b[f]-b[0])/365,d=d-g*a[f]/Math.pow(e,g+1);return d},h=[],k=!1,l=!1,n=0;n<a.length;n++)h[n]=0===n?0:h[n-1]+365,0<a[n]&&(k=!0),0>a[n]&&(l=!0);if(!k||!l)return e.num;var k=void 0===b?.1:b,p,l=!0;do p=d(a,h,k),l=k-p/g(a,h,k),n=Math.abs(l-k),k=l,l=1E-10<n&&1E-10<Math.abs(p);while(l);return k};d.ISPMT=function(a,b,d,g){a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);return m.anyIsError(a,b,d,g)?e.value:g*a*(b/d-1)};d.MDURATION=function(){throw Error("MDURATION is not implemented");};d.MIRR=function(a,b,f){a=m.parseNumberArray(m.flatten(a));b=m.parseNumber(b);f=m.parseNumber(f);if(m.anyIsError(a,b,f))return e.value;for(var g=a.length,h=[],k=[],l=0;l<g;l++)0>a[l]?h.push(a[l]):k.push(a[l]);a=-d.NPV(f,k)*Math.pow(1+f,g-1);b=d.NPV(b,h)*(1+b);return Math.pow(a/b,1/(g-1))-1};d.NOMINAL=function(a,b){a=m.parseNumber(a);b=m.parseNumber(b);if(m.anyIsError(a,b))return e.value;if(0>=a||1>b)return e.num;b=parseInt(b,10);return(Math.pow(a+1,1/b)-1)*b};d.NPER=function(a,b,d,g,h){h=void 0===h?0:h;g=void 0===g?0:g;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);return m.anyIsError(a,b,d,g,h)?e.value:Math.log((b*(1+a*h)-g*a)/(d*a+b*(1+a*h)))/Math.log(1+a)};d.NPV=function(){var a=m.parseNumberArray(m.flatten(arguments));if(a instanceof Error)return a;for(var b=a[0],e=0,d=1;d<a.length;d++)e+=a[d]/Math.pow(1+b,d);return e};d.ODDFPRICE=function(){throw Error("ODDFPRICE is not implemented");};d.ODDFYIELD=function(){throw Error("ODDFYIELD is not implemented");};d.ODDLPRICE=function(){throw Error("ODDLPRICE is not implemented");};d.ODDLYIELD=function(){throw Error("ODDLYIELD is not implemented");};d.PDURATION=function(a,b,d){a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0>=a?e.num:(Math.log(d)-Math.log(b))/Math.log(1+a)};d.PMT=function(a,b,d,g,h){g=g||0;h=h||0;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);if(m.anyIsError(a,b,d,g,h))return e.value;0===a?a=(d+g)/b:(b=Math.pow(1+a,b),a=1===h?(g*a/(b-1)+d*a/(1-1/b))/(1+a):g*a/(b-1)+d*a/(1-1/b));return-a};d.PPMT=function(a,b,f,g,h,k){h=h||0;k=k||0;a=m.parseNumber(a);f=m.parseNumber(f);g=m.parseNumber(g);h=m.parseNumber(h);k=m.parseNumber(k);return m.anyIsError(a,f,g,h,k)?e.value:d.PMT(a,f,g,h,k)-d.IPMT(a,b,f,g,h,k)};d.PRICE=function(){throw Error("PRICE is not implemented");};d.PRICEDISC=function(){throw Error("PRICEDISC is not implemented");};d.PRICEMAT=function(){throw Error("PRICEMAT is not implemented");};d.PV=function(a,b,d,g,h){g=g||0;h=h||0;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);return m.anyIsError(a,b,d,g,h)?e.value:0===a?-d*b-g:((1-Math.pow(1+a,b))/a*d*(1+a*h)-g)/Math.pow(1+a,b)};d.RATE=function(a,b,d,g,h,k){k=void 0===k?.01:k;g=void 0===g?0:g;h=void 0===h?0:h;a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);h=m.parseNumber(h);k=m.parseNumber(k);if(m.anyIsError(a,b,d,g,h,k))return e.value;var f,l,n,p;f=0;var q,t=k;1E-10>Math.abs(t)||(f=Math.exp(a*Math.log(1+t)));k=d+b*a+g;l=d*f+b*(1/t+h)*(f-1)+g;q=n=0;for(p=t;1E-10<Math.abs(k-l)&&50>q;)t=(l*n-k*p)/(l-k),n=p,p=t,1E-10>Math.abs(t)?f=d*(1+a*t)+b*(1+t*h)*a+g:(f=Math.exp(a*Math.log(1+t)),f=d*f+b*(1/t+h)*(f-1)+g),k=l,l=f,++q;return t};d.RECEIVED=function(){throw Error("RECEIVED is not implemented");};d.RRI=function(a,b,d){a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0===a||0===b?e.num:Math.pow(d/b,1/a)-1};d.SLN=function(a,b,d){a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0===d?e.num:(a-b)/d};d.SYD=function(a,b,d,g){a=m.parseNumber(a);b=m.parseNumber(b);d=m.parseNumber(d);g=m.parseNumber(g);if(m.anyIsError(a,b,d,g))return e.value;if(0===d||1>g||g>d)return e.num;g=parseInt(g,10);return(a-b)*(d-g+1)*2/(d*(d+1))};d.TBILLEQ=function(a,b,d){a=m.parseDate(a);b=m.parseDate(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0>=d||a>b||31536E6<b-a?e.num:365*d/(360-d*n.DAYS360(a,b,!1))};d.TBILLPRICE=function(a,b,d){a=m.parseDate(a);b=m.parseDate(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0>=d||a>b||31536E6<b-a?e.num:100*(1-d*n.DAYS360(a,b,!1)/360)};d.TBILLYIELD=function(a,b,d){a=m.parseDate(a);b=m.parseDate(b);d=m.parseNumber(d);return m.anyIsError(a,b,d)?e.value:0>=d||a>b||31536E6<b-a?e.num:360*(100-d)/(d*n.DAYS360(a,b,!1))};d.VDB=function(){throw Error("VDB is not implemented");};d.XNPV=function(a,b,d){a=m.parseNumber(a);b=m.parseNumberArray(m.flatten(b));d=m.parseDateArray(m.flatten(d));if(m.anyIsError(a,b,d))return e.value;for(var f=0,g=0;g<b.length;g++)f+=b[g]/Math.pow(1+a,n.DAYS(d[g],d[0])/365);return f};d.YIELD=function(){throw Error("YIELD is not implemented");};d.YIELDDISC=function(){throw Error("YIELDDISC is not implemented");};d.YIELDMAT=function(){throw Error("YIELDMAT is not implemented");}},function(k,d,h){var l=h(0),g=h(2),e=h(7);d.AND=function(){for(var e=g.flatten(arguments),d=!0,a=0;a<e.length;a++)e[a]||(d=!1);return d};d.CHOOSE=function(){if(2>arguments.length)return l.na;var e=arguments[0];return 1>e||254<e||arguments.length<e+1?l.value:arguments[e]};d.FALSE=function(){return!1};d.IF=function(e,d,a){return e?d:a};d.IFERROR=function(d,g){return e.ISERROR(d)?g:d};d.IFNA=function(e,d){return e===l.na?d:e};d.NOT=function(e){return!e};d.OR=function(){for(var e=g.flatten(arguments),d=!1,a=0;a<e.length;a++)e[a]&&(d=!0);return d};d.TRUE=function(){return!0};d.XOR=function(){for(var e=g.flatten(arguments),d=0,a=0;a<e.length;a++)e[a]&&d++;return Math.floor(Math.abs(d))&1?!0:!1};d.SWITCH=function(){var e;if(0<arguments.length){var d=arguments[0],a=arguments.length-1,b=Math.floor(a/2),f=!1,g=0===a%2?null:arguments[arguments.length-1];if(b)for(var h=0;h<b;h++)if(d===arguments[2*h+1]){e=arguments[2*h+2];f=!0;break}f||(e=0!==a%2?g:l.na)}else e=l.value;return e}},function(k,d,h){var l=h(0);d.MATCH=function(d,e,h){if(!d&&!e)return l.na;2===arguments.length&&(h=1);if(!(e instanceof Array)||-1!==h&&0!==h&&1!==h)return l.na;for(var g,a,b=0;b<e.length;b++)if(1===h){if(e[b]===d)return b+1;e[b]<d&&(a?e[b]>a&&(g=b+1,a=e[b]):(g=b+1,a=e[b]))}else if(0===h)if("string"===typeof d){if(d=d.replace(/\?/g,"."),e[b].toLowerCase().match(d.toLowerCase()))return b+1}else{if(e[b]===d)return b+1}else if(-1===h){if(e[b]===d)return b+1;e[b]>d&&(a?e[b]<a&&(g=b+1,a=e[b]):(g=b+1,a=e[b]))}return g?g:l.na}},function(k,d){(function(){var d={langLocaleCode:"cs-CZ",cultureCode:"cs-CZ",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"K\u010d",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"da-DK",cultureCode:"da-DK",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mio",billion:"mia",trillion:"b"},ordinal:function(){return"."},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"de-CH",cultureCode:"de-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"de-DE",cultureCode:"de-DE",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"\u20ac",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"en-AU",cultureCode:"en-AU",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){var g=d%10;return 1===~~(d%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"en-GB",cultureCode:"en-GB",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){var g=d%10;return 1===~~(d%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th"},currency:{symbol:"\u00a3",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"en-NZ",cultureCode:"en-NZ",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){var g=d%10;return 1===~~(d%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"en-ZA",cultureCode:"en-ZA",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){var g=d%10;return 1===~~(d%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th"},currency:{symbol:"R",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"es-AR",cultureCode:"es-AR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(d){d%=10;return 1===d||3===d?"er":2===d?"do":7===d||0===d?"mo":8===d?"vo":9===d?"no":"to"},currency:{symbol:"$",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"es-ES",cultureCode:"es-ES",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(d){d%=10;return 1===d||3===d?"er":2===d?"do":7===d||0===d?"mo":8===d?"vo":9===d?"no":"to"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"et-EE",cultureCode:"et-EE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tuh",million:" mln",billion:" mld",trillion:" trl"},ordinal:function(){return"."},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fa-IR",cultureCode:"fa-IR",delimiters:{thousands:"\u060c",decimal:"."},abbreviations:{thousand:"\u0647\u0632\u0627\u0631",million:"\u0645\u06cc\u0644\u06cc\u0648\u0646",billion:"\u0645\u06cc\u0644\u06cc\u0627\u0631\u062f",trillion:"\u062a\u0631\u06cc\u0644\u06cc\u0648\u0646"},ordinal:function(){return"\u0627\u0645"},currency:{symbol:"\ufdfc"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fi-FI",cultureCode:"fi-FI",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(){return"."},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fil-PH",cultureCode:"fil-PH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){var g=d%10;return 1===~~(d%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th"},currency:{symbol:"\u20b1"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fr-CA",cultureCode:"fr-CA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(d){return 1===d?"er":"\u00e8me"},currency:{symbol:"$",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fr-CH",cultureCode:"fr-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){return 1===d?"er":"\u00e8me"},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"fr-FR",cultureCode:"fr-FR",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(d){return 1===d?"er":"\u00e8me"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"he-IL",cultureCode:"he-IL",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u05d0\u05dc\u05e3",million:"\u05de\u05dc\u05d9\u05d5\u05df",billion:"\u05d1\u05dc\u05d9\u05d5\u05df",trillion:"\u05d8\u05e8\u05d9\u05dc\u05d9\u05d5\u05df"},currency:{symbol:"\u20aa",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"\u20aa ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"\u20aa ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"hu-HU",cultureCode:"hu-HU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"E",million:"M",billion:"Mrd",trillion:"T"},ordinal:function(){return"."},currency:{symbol:" Ft",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d,h){d["cs-CZ"]=h(39);d["da-DK"]=h(40);d["de-CH"]=h(41);d["de-DE"]=h(42);d["en-AU"]=h(43);d["en-GB"]=h(44);d["en-NZ"]=h(45);d["en-ZA"]=h(46);d["es-AR"]=h(47);d["es-ES"]=h(48);d["et-EE"]=h(49);d["fa-IR"]=h(50);d["fi-FI"]=h(51);d["fil-PH"]=h(52);d["fr-CA"]=h(53);d["fr-CH"]=h(54);d["fr-FR"]=h(55);d["he-IL"]=h(56);d["hu-HU"]=h(57);d["it-IT"]=h(59);d["ja-JP"]=h(60);d["ko-KR"]=h(61);d["lv-LV"]=h(62);d["nb-NO"]=h(63);d["nl-BE"]=h(64);d["nl-NL"]=h(65);d["pl-PL"]=h(66);d["pt-BR"]=h(67);d["pt-PT"]=h(68);d["ru-RU"]=h(69);d["ru-UA"]=h(70);d["sk-SK"]=h(71);d["sv-SE"]=h(72);d["th-TH"]=h(73);d["tr-TR"]=h(74);d["uk-UA"]=h(75);d["zh-CN"]=h(76);d["zh-TW"]=h(77)},function(k,d){(function(){var d={langLocaleCode:"it-IT",cultureCode:"it-IT",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mila",million:"mil",billion:"b",trillion:"t"},ordinal:function(){return"\u00ba"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"ja-JP",cultureCode:"ja-JP",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767e\u4e07",billion:"\u5341\u5104",trillion:"\u5146"},ordinal:function(){return"."},currency:{symbol:"\u00a5",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"ko-KR",cultureCode:"ko-KR",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\ucc9c",million:"\ubc31\ub9cc",billion:"\uc2ed\uc5b5",trillion:"\uc77c\uc870"},ordinal:function(){return"."},currency:{symbol:"\u20a9"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"lv-LV",cultureCode:"lv-LV",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" t\u016bkst.",million:" milj.",billion:" mljrd.",trillion:" trilj."},ordinal:function(){return"."},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"nb-NO",cultureCode:"nb-NO",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"t"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"nl-BE",cultureCode:"nl-BE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(d){var g=d%100;return 0!==d&&1>=g||8===g||20<=g?"ste":"de"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"nl-NL",cultureCode:"nl-NL",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mrd",trillion:"bln"},ordinal:function(d){var g=d%100;return 0!==d&&1>=g||8===g||20<=g?"ste":"de"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"pl-PL",cultureCode:"pl-PL",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tys.",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(){return"."},currency:{symbol:" z\u0142",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"pt-BR",cultureCode:"pt-BR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mil",million:"milh\u00f5es",billion:"b",trillion:"t"},ordinal:function(){return"\u00ba"},currency:{symbol:"R$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"pt-PT",cultureCode:"pt-PT",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"\u00ba"},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"ru-RU",cultureCode:"ru-RU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"\u0442\u044b\u0441.",million:"\u043c\u043b\u043d",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"\u0440\u0443\u0431.",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"ru-UA",cultureCode:"ru-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"\u0442\u044b\u0441.",million:"\u043c\u043b\u043d",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"\u20b4",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"sk-SK",cultureCode:"sk-SK",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"\u20ac",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"sv-SE",cultureCode:"sv-SE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"tmd"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"th-TH",cultureCode:"th-TH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u0e1e\u0e31\u0e19",million:"\u0e25\u0e49\u0e32\u0e19",billion:"\u0e1e\u0e31\u0e19\u0e25\u0e49\u0e32\u0e19",trillion:"\u0e25\u0e49\u0e32\u0e19\u0e25\u0e49\u0e32\u0e19"},ordinal:function(){return"."},currency:{symbol:"\u0e3f",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'\u00fcnc\u00fc",4:"'\u00fcnc\u00fc",100:"'\u00fcnc\u00fc",6:"'nc\u0131",9:"'uncu",10:"'uncu",30:"'uncu",60:"'\u0131nc\u0131",90:"'\u0131nc\u0131"},l={langLocaleCode:"tr-TR",cultureCode:"tr-TR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"bin",million:"milyon",billion:"milyar",trillion:"trilyon"},ordinal:function(g){if(0===g)return"'\u0131nc\u0131";var e=g%10;return d[e]||d[g%100-e]||d[100<=g?100:null]},currency:{symbol:"\u20ba",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=l);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(l.cultureCode,l)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"uk-UA",cultureCode:"uk-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"\u0442\u0438\u0441.",million:"\u043c\u043b\u043d",billion:"\u043c\u043b\u0440\u0434",trillion:"\u0431\u043b\u043d"},ordinal:function(){return""},currency:{symbol:"\u20b4",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"zh-CN",cultureCode:"zh-CN",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767e\u4e07",billion:"\u5341\u4ebf",trillion:"\u5146"},ordinal:function(){return"."},currency:{symbol:"\u00a5",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){(function(){var d={langLocaleCode:"zh-TW",cultureCode:"zh-TW",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767e\u842c",billion:"\u5341\u5104",trillion:"\u5146"},ordinal:function(){return"\u7b2c"},currency:{symbol:"NT$"}};"undefined"!==typeof k&&k.exports&&(k.exports=d);"undefined"!==typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(d.cultureCode,d)}).call("undefined"===typeof window?this:window)},function(k,d){function h(){}h.prototype={on:function(d,g,e){var h=this.e||(this.e={});(h[d]||(h[d]=[])).push({fn:g,ctx:e});return this},once:function(d,g,e){function h(){k.off(d,h);g.apply(e,arguments)}var k=this;h._=g;return this.on(d,h,e)},emit:function(d){var g=[].slice.call(arguments,1),e=((this.e||(this.e={}))[d]||[]).slice(),h=0,k=e.length;for(h;h<k;h++)e[h].fn.apply(e[h].ctx,g);return this},off:function(d,g){var e=this.e||(this.e={}),h=e[d],k=[];if(h&&g)for(var a=0,b=h.length;a<b;a++)h[a].fn!==g&&h[a].fn._!==g&&k.push(h[a]);k.length?e[d]=k:delete e[d];return this}};k.exports=h},function(k,d){k.exports=function(d){d.webpackPolyfill||(d.deprecate=function(){},d.paths=[],d.children||(d.children=[]),Object.defineProperty(d,"loaded",{enumerable:!0,get:function(){return d.l}}),Object.defineProperty(d,"id",{enumerable:!0,get:function(){return d.i}}),d.webpackPolyfill=1);return d}},function(k,d,h){(function(k,g){var e=function(){function d(){this.yy={}}var e=function(a,b,d,e){d=d||{};for(e=a.length;e--;d[a[e]]=b);return d},a=[1,5],b=[1,8],f=[1,6],g=[1,7],h=[1,9],k=[1,14],l=[1,15],p=[1,16],q=[1,12],r=[1,13],C=[1,17],E=[1,19],A=[1,20],B=[1,21],G=[1,22],D=[1,23],F=[1,24],H=[1,25],J=[1,26],K=[1,27],I=[1,28],O=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],Q=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],R=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],M=[5,10,11,13,14,15,16,17,29,30],S=[5,10,13,14,15,16,29,30],U=[5,10,11,13,14,15,16,17,18,19,29,30],V=[13,29,30],e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"\x26":9,"\x3d":10,"+":11,"(":12,")":13,"\x3c":14,"\x3e":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"\x26",10:"\x3d",11:"+",12:"(",13:")",14:"\x3c",15:"\x3e",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(a,b,d,e,f,g,h){b=g.length-1;switch(f){case 1:return g[b-1];case 2:this.$=e.callVariable(g[b][0]);break;case 3:this.$=e.toNumber(g[b]);break;case 4:this.$=e.trimEdges(g[b]);break;case 5:this.$=e.evaluateByOperator("\x26",[g[b-2],g[b]]);break;case 6:this.$=e.evaluateByOperator("\x3d",[g[b-2],g[b]]);break;case 7:this.$=e.evaluateByOperator("+",[g[b-2],g[b]]);break;case 8:this.$=g[b-1];break;case 9:this.$=e.evaluateByOperator("\x3c\x3d",[g[b-3],g[b]]);break;case 10:this.$=e.evaluateByOperator("\x3e\x3d",[g[b-3],g[b]]);break;case 11:this.$=e.evaluateByOperator("\x3c\x3e",[g[b-3],g[b]]);break;case 12:this.$=e.evaluateByOperator("NOT",[g[b-2],g[b]]);break;case 13:this.$=e.evaluateByOperator("\x3e",[g[b-2],g[b]]);break;case 14:this.$=e.evaluateByOperator("\x3c",[g[b-2],g[b]]);break;case 15:this.$=e.evaluateByOperator("-",[g[b-2],g[b]]);break;case 16:this.$=e.evaluateByOperator("*",[g[b-2],g[b]]);break;case 17:this.$=e.evaluateByOperator("/",[g[b-2],g[b]]);break;case 18:this.$=e.evaluateByOperator("^",[g[b-2],g[b]]);break;case 19:this.$=a=e.invertNumber(g[b]);isNaN(this.$)&&(this.$=0);break;case 20:this.$=a=e.toNumber(g[b]);isNaN(this.$)&&(this.$=0);break;case 21:this.$=e.callFunction(g[b-2]);break;case 22:this.$=e.callFunction(g[b-3],g[b-1]);break;case 26:case 27:case 28:this.$=e.cellValue(g[b]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=e.rangeValue(g[b-2],g[b]);break;case 38:case 42:this.$=[g[b]];break;case 39:var k=[];eval("["+a+"]").forEach(function(a){k.push(a)});this.$=k;break;case 40:case 41:g[b-2].push(g[b]);this.$=g[b-2];break;case 43:this.$=Array.isArray(g[b-2])?g[b-2]:[g[b-2]];this.$.push(g[b]);break;case 44:this.$=g[b];break;case 45:this.$=1*(g[b-2]+"."+g[b]);break;case 46:this.$=.01*g[b-1];break;case 47:this.$=e.throwError(g[b])}},table:[{2:11,3:1,4:2,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{1:[3]},{5:[1,18],9:E,10:A,11:B,14:G,15:D,16:F,17:H,18:J,19:K,20:I},e(O,[2,2],{32:[1,29]}),e(O,[2,3],{34:[1,30]}),e(O,[2,4]),{2:11,4:31,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:32,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:33,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{12:[1,34]},e(O,[2,23]),e(O,[2,24],{2:35,35:C}),e(Q,[2,42]),e(R,[2,44],{32:[1,36]}),e(O,[2,26],{27:[1,37]}),e(O,[2,27],{27:[1,38]}),e(O,[2,28],{27:[1,39]}),e([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:41,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:42,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:45,6:3,7:4,8:a,10:[1,43],11:b,12:f,15:[1,44],17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:47,6:3,7:4,8:a,10:[1,46],11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:48,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:49,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:50,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:51,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:52,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{31:[1,53]},e(R,[2,46]),{9:E,10:A,11:B,13:[1,54],14:G,15:D,16:F,17:H,18:J,19:K,20:I},e(M,[2,19],{9:E,18:J,19:K,20:I}),e(M,[2,20],{9:E,18:J,19:K,20:I}),{2:11,4:57,6:3,7:4,8:a,11:b,12:f,13:[1,55],17:g,21:h,22:56,23:10,24:k,25:l,26:p,28:[1,58],31:q,33:r,35:C},e(O,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},e(O,[2,5]),e([5,10,13,29,30],[2,6],{9:E,11:B,14:G,15:D,16:F,17:H,18:J,19:K,20:I}),e(M,[2,7],{9:E,18:J,19:K,20:I}),{2:11,4:69,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:70,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},e(S,[2,14],{9:E,11:B,17:H,18:J,19:K,20:I}),{2:11,4:71,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},e(S,[2,13],{9:E,11:B,17:H,18:J,19:K,20:I}),e([5,10,13,16,29,30],[2,12],{9:E,11:B,14:G,15:D,17:H,18:J,19:K,20:I}),e(M,[2,15],{9:E,18:J,19:K,20:I}),e(U,[2,16],{9:E,20:I}),e(U,[2,17],{9:E,20:I}),e([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:E}),e(Q,[2,43]),e(O,[2,8]),e(O,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},e(V,[2,38],{9:E,10:A,11:B,14:G,15:D,16:F,17:H,18:J,19:K,20:I}),e(V,[2,39]),e(R,[2,45]),e(O,[2,29]),e(O,[2,30]),e(O,[2,31]),e(O,[2,32]),e(O,[2,33]),e(O,[2,34]),e(O,[2,35]),e(O,[2,36]),e(O,[2,37]),e(S,[2,9],{9:E,11:B,17:H,18:J,19:K,20:I}),e(S,[2,11],{9:E,11:B,17:H,18:J,19:K,20:I}),e(S,[2,10],{9:E,11:B,17:H,18:J,19:K,20:I}),e(O,[2,22]),{2:11,4:75,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},{2:11,4:76,6:3,7:4,8:a,11:b,12:f,17:g,21:h,23:10,24:k,25:l,26:p,31:q,33:r,35:C},e(V,[2,40],{9:E,10:A,11:B,14:G,15:D,16:F,17:H,18:J,19:K,20:I}),e(V,[2,41],{9:E,10:A,11:B,14:G,15:D,16:F,17:H,18:J,19:K,20:I})],defaultActions:{18:[2,1]},parseError:function(a,b){if(b.recoverable)this.trace(a);else{var d=function(a,b){this.message=a;this.hash=b};d.prototype=Error;throw new d(a,b);}},parse:function(a){function b(a){e.length-=2*a;f.length-=a;g.length-=a}var d=this,e=[0],f=[null],g=[],h=this.table,k="",l=0,m=0,n=0,p=g.slice.call(arguments,1),q=Object.create(this.lexer),F={},t;for(t in this.yy)Object.prototype.hasOwnProperty.call(this.yy,t)&&(F[t]=this.yy[t]);q.setInput(a,F);F.lexer=q;F.parser=this;"undefined"==typeof q.yylloc&&(q.yylloc={});t=q.yylloc;g.push(t);var r=q.options&&q.options.ranges;this.parseError="function"===typeof F.parseError?F.parseError:Object.getPrototypeOf(this).parseError;for(var D=function(){var a;a=q.lex()||1;"number"!==typeof a&&(a=d.symbols_[a]||a);return a},H,v,J,u,w={},G,x;;){J=e[e.length-1];if(this.defaultActions[J])u=this.defaultActions[J];else{if(null===H||"undefined"==typeof H)H=D();u=h[J]&&h[J][H]}if("undefined"===typeof u||!u.length||!u[0]){x=function(a){for(var b=e.length-1,d=0;;){if((2).toString()in h[a])return d;if(0===a||2>b)return!1;b-=2;a=e[b];++d}};var y;u="";if(n)1!==v&&(y=x(J));else{y=x(J);x=[];for(G in h[J])this.terminals_[G]&&2<G&&x.push("'"+this.terminals_[G]+"'");u=q.showPosition?"Parse error on line "+(l+1)+":\n"+q.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[H]||H)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==H?"end of input":"'"+(this.terminals_[H]||H)+"'");this.parseError(u,{text:q.match,token:this.terminals_[H]||H,line:q.yylineno,loc:t,expected:x,recoverable:!1!==y})}if(3==n){if(1===H||1===v)throw Error(u||"Parsing halted while starting to recover from another error.");m=q.yyleng;k=q.yytext;l=q.yylineno;t=q.yylloc;H=D()}if(!1===y)throw Error(u||"Parsing halted. No suitable error recovery rule available.");b(y);v=2==H?null:H;H=2;J=e[e.length-1];u=h[J]&&h[J][2];n=3}if(u[0]instanceof Array&&1<u.length)throw Error("Parse Error: multiple actions possible at state: "+J+", token: "+H);switch(u[0]){case 1:e.push(H);f.push(q.yytext);g.push(q.yylloc);e.push(u[1]);H=null;v?(H=v,v=null):(m=q.yyleng,k=q.yytext,l=q.yylineno,t=q.yylloc,0<n&&n--);break;case 2:x=this.productions_[u[1]][1];w.$=f[f.length-x];w._$={first_line:g[g.length-(x||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(x||1)].first_column,last_column:g[g.length-1].last_column};r&&(w._$.range=[g[g.length-(x||1)].range[0],g[g.length-1].range[1]]);J=this.performAction.apply(w,[k,m,l,F,u[1],f,g].concat(p));if("undefined"!==typeof J)return J;x&&(e=e.slice(0,-2*x),f=f.slice(0,-1*x),g=g.slice(0,-1*x));e.push(this.productions_[u[1]][0]);f.push(w.$);g.push(w._$);J=h[e[e.length-2]][e[e.length-1]];e.push(J);break;case 3:return!0}}}},a=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a,b){this.yy=b||this.yy||{};this._input=a;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,d=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b);this.offset-=b;a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);d.length-1&&(this.yylineno-=d.length-1);var e=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:d?(d.length===a.length?this.yylloc.first_column:0)+a[a.length-d.length].length-d[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]);this.yyleng=this.yytext.length;return this},more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer \x3d true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var d,e;this.options.backtrack_lexer&&(e={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(e.yylloc.range=this.yylloc.range.slice(0)));if(d=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=d.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:d?d[d.length-1].length-d[d.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];d=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(d)return d;if(this._backtrack)for(var f in e)this[f]=e[f];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,d;this._more||(this.match=this.yytext="");for(var e=this._currentRules(),f=0;f<e.length;f++)if((b=this._input.match(this.rules[e[f]]))&&(!a||b[0].length>a[0].length))if(a=b,d=f,this.options.backtrack_lexer){a=this.test_match(b,e[f]);if(!1!==a)return a;if(this._backtrack)a=!1;else return!1}else if(!this.options.flex)break;return a?(a=this.test_match(a,e[d]),!1!==a?a:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(a){a=this.conditionStack.length-1-Math.abs(a||0);return 0<=a?this.conditionStack[a]:"INITIAL"},pushState:function(a){this.begin(a)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(a,b,d,e){switch(d){case 1:return 8;case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:return 26;case 7:return 26;case 8:return 25;case 9:return 21;case 10:return 31;case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}}}();e.lexer=a;d.prototype=e;e.Parser=d;return new d}();d.parser=e;d.Parser=e.Parser;d.parse=function(){return e.parse.apply(e,arguments)};"undefined"!==typeof k&&h.c[h.s]===k&&d.main(g.argv.slice(1))}).call(d,h(79)(k),h(15))},function(k,d,h){function l(d){return d&&d.__esModule?d:{"default":d}}d.__esModule=!0;d.rowLabelToIndex=d.rowIndexToLabel=d.columnLabelToIndex=d.columnIndexToLabel=d.toLabel=d.extractLabel=d.error=d.Parser=d.ERROR_VALUE=d.ERROR_REF=d.ERROR_NUM=d.ERROR_NULL=d.ERROR_NOT_AVAILABLE=d.ERROR_NAME=d.ERROR_DIV_ZERO=d.ERROR=d.SUPPORTED_FORMULAS=void 0;k=h(16);k=l(k);var g=h(10),g=l(g),e=h(1),n=l(e);h=h(9);d.SUPPORTED_FORMULAS=g["default"];d.ERROR=e.ERROR;d.ERROR_DIV_ZERO=e.ERROR_DIV_ZERO;d.ERROR_NAME=e.ERROR_NAME;d.ERROR_NOT_AVAILABLE=e.ERROR_NOT_AVAILABLE;d.ERROR_NULL=e.ERROR_NULL;d.ERROR_NUM=e.ERROR_NUM;d.ERROR_REF=e.ERROR_REF;d.ERROR_VALUE=e.ERROR_VALUE;d.Parser=k["default"];d.error=n["default"];d.extractLabel=h.extractLabel;d.toLabel=h.toLabel;d.columnIndexToLabel=h.columnIndexToLabel;d.columnLabelToIndex=h.columnLabelToIndex;d.rowIndexToLabel=h.rowIndexToLabel;d.rowLabelToIndex=h.rowLabelToIndex}])})},{}],jsonpatch:[function(p,q,r){var k=this&&this.__extends||function(d,g){function e(){this.constructor=d}for(var h in g)g.hasOwnProperty(h)&&(d[h]=g[h]);d.prototype=null===g?Object.create(g):(e.prototype=g.prototype,new e)},d=Error,h;(function(h){function g(a,b){switch(typeof a){case "undefined":case "boolean":case "string":case "number":return a===b;case "object":if(null===a)return null===b;if(A(a)){if(!A(b)||a.length!==b.length)return!1;for(var d=0,e=a.length;d<e;d++)if(!g(a[d],b[d]))return!1;return!0}e=r(b).length;if(r(a).length!==e)return!1;for(d=0;d<e;d++)if(!g(a[d],b[d]))return!1;return!0;default:return!1}}function e(a){return-1===a.indexOf("/")&&-1===a.indexOf("~")?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function l(a){for(var b=0,d=x.length;b<d;b++)if(x[b].obj===a)return x[b]}function m(a,b){for(var d=0,e=a.observers.length;d<e;d++)if(a.observers[d].callback===b)return a.observers[d].observer}function a(a){return"object"===typeof a?JSON.parse(JSON.stringify(a)):a}function b(a){for(var b,d=0,e=x.length;d<e;d++)if(x[d].obj===a.object){b=x[d];break}f(b.value,a.object,a.patches,"");a.patches.length&&p(b.value,a.patches);b=a.patches;0<b.length&&(a.patches=[],a.callback&&a.callback(b));return b}function f(b,d,g,h){for(var k=r(d),l=r(b),m=!1,n=l.length-1;0<=n;n--){var p=l[n],q=b[p];if(d.hasOwnProperty(p)){var F=d[p];"object"==typeof q&&null!=q&&"object"==typeof F&&null!=F?f(q,F,g,h+"/"+e(p)):q!=F&&g.push({op:"replace",path:h+"/"+e(p),value:a(F)})}else g.push({op:"remove",path:h+"/"+e(p)}),m=!0}if(m||k.length!=l.length)for(n=0;n<k.length;n++)p=k[n],b.hasOwnProperty(p)||g.push({op:"add",path:h+"/"+e(p),value:a(d[p])})}function p(a,b,d){for(var e=!1,f=0,g=b.length,h;f<g;){e=b[f];f++;for(var k=(e.path||"").split("/"),l=a,m=1,n=k.length,p=void 0;;){h=k[m];d&&void 0===p&&(void 0===l[h]?p=k.slice(0,m).join("/"):m==n-1&&(p=e.path),void 0!==p&&this.validator(e,f-1,a,p));m++;if(void 0===h&&m>=n){e=z[e.op].call(e,l,h,a);break}if(A(l)){if("-"===h)h=l.length;else{var q;if(q=d){a:{q=h;for(var F=0,t=q.length,r;F<t;)if(r=q.charCodeAt(F),48<=r&&57>=r)F++;else{q=!1;break a}q=!0}q=!q}if(q)throw new B("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",f-1,e.path,e);h=parseInt(h,10)}if(m>=n){if(d&&"add"===e.op&&h>l.length)throw new B("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",f-1,e.path,e);e=w[e.op].call(e,l,h,a);break}}else if(h&&-1!=h.indexOf("~")&&(h=h.replace(/~1/g,"/").replace(/~0/g,"~")),m>=n){e=y[e.op].call(e,l,h,a);break}l=l[h]}}return e}function q(a){if(void 0===a)return!0;if("array"==typeof a||"object"==typeof a)for(var b in a)if(q(a[b]))return!0;return!1}var r=function(a){if(A(a)){var b=Array(a.length);for(a=0;a<b.length;a++)b[a]=""+a;return b}if(Object.keys)return Object.keys(a);var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(d);return b},y={add:function(a,b){a[b]=this.value;return!0},remove:function(a,b){delete a[b];return!0},replace:function(a,b){a[b]=this.value;return!0},move:function(a,b,d){a={op:"_get",path:this.from};p(d,[a]);p(d,[{op:"remove",path:this.from}]);p(d,[{op:"add",path:this.path,value:a.value}]);return!0},copy:function(a,b,d){a={op:"_get",path:this.from};p(d,[a]);p(d,[{op:"add",path:this.path,value:a.value}]);return!0},test:function(a,b){return g(a[b],this.value)},_get:function(a,b){this.value=a[b]}},w={add:function(a,b){a.splice(b,0,this.value);return!0},remove:function(a,b){a.splice(b,1);return!0},replace:function(a,b){a[b]=this.value;return!0},move:y.move,copy:y.copy,test:y.test,_get:y._get},z={add:function(a){z.remove.call(this,a);for(var b in this.value)this.value.hasOwnProperty(b)&&(a[b]=this.value[b]);return!0},remove:function(a){for(var b in a)a.hasOwnProperty(b)&&y.remove.call(this,a,b);return!0},replace:function(a){p(a,[{op:"remove",path:this.path}]);p(a,[{op:"add",path:this.path,value:this.value}]);return!0},move:y.move,copy:y.copy,test:function(a){return JSON.stringify(a)===JSON.stringify(this.value)},_get:function(a){this.value=a}},x=[],C=function(){return function(a){this.observers=[];this.obj=a}}(),E=function(){return function(a,b){this.callback=a;this.observer=b}}();h.unobserve=function(a,b){b.unobserve()};h.observe=function(e,f){var g,h=l(e);h?g=m(h,f):(h=new C(e),x.push(h));if(g)return g;g={};h.value=a(e);if(f){g.callback=f;g.next=null;var k=this.intervals||[100,1E3,1E4,6E4];if(void 0===k.push)throw new d("jsonpatch.intervals must be an array");var n=0,p=function(){clearTimeout(g.next);g.next=setTimeout(function(){b(g);n=0;g.next=setTimeout(q,k[n++])},0)},q=function(){b(g);n==k.length&&(n=k.length-1);g.next=setTimeout(q,k[n++])};"undefined"!==typeof window&&(window.addEventListener?(window.addEventListener("mousedown",p),window.addEventListener("mouseup",p),window.addEventListener("keydown",p)):(document.documentElement.attachEvent("onmousedown",p),document.documentElement.attachEvent("onmouseup",p),document.documentElement.attachEvent("onkeydown",p)));g.next=setTimeout(q,k[n++])}g.patches=[];g.object=e;g.unobserve=function(){b(g);clearTimeout(g.next);a:for(var a=h,d=g,e=0,f=a.observers.length;e<f;e++)if(a.observers[e].observer===d){a.observers.splice(e,1);break a}"undefined"!==typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",p),window.removeEventListener("mouseup",p),window.removeEventListener("keydown",p)):(document.documentElement.detachEvent("onmousedown",p),document.documentElement.detachEvent("onmouseup",p),document.documentElement.detachEvent("onkeydown",p)))};h.observers.push(new E(f,g));return g};h.generate=b;var A;A=Array.isArray?Array.isArray:function(a){return a.push&&"number"===typeof a.length};h.apply=p;h.compare=function(a,b){var d=[];f(a,b,d,"");return d};var B=function(a){function b(b,d,e,f,g){a.call(this,b);this.message=b;this.name=d;this.index=e;this.operation=f;this.tree=g}k(b,a);return b}(d);h.JsonPatchError=B;h.Error=B;h.validator=function(a,b,d,e){if("object"!==typeof a||null===a||A(a))throw new B("Operation is not an object","OPERATION_NOT_AN_OBJECT",b,a,d);if(y[a.op]){if("string"!==typeof a.path)throw new B("Operation `path` property is not a string","OPERATION_PATH_INVALID",b,a,d);if("move"!==a.op&&"copy"!==a.op||"string"===typeof a.from)if("add"!==a.op&&"replace"!==a.op&&"test"!==a.op||void 0!==a.value){if(("add"===a.op||"replace"===a.op||"test"===a.op)&&q(a.value))throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",b,a,d);if(d)if("add"==a.op){var f=a.path.split("/").length;e=e.split("/").length;if(f!==e+1&&f!==e)throw new B("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",b,a,d);}else if("replace"===a.op||"remove"===a.op||"_get"===a.op){if(a.path!==e)throw new B("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",b,a,d);}else if(("move"===a.op||"copy"===a.op)&&(f=h.validate([{op:"_get",path:a.from,value:void 0}],d))&&"OPERATION_PATH_UNRESOLVABLE"===f.name)throw new B("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",b,a,d);}else throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",b,a,d);else throw new B("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",b,a,d);}else throw new B("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",b,a,d);};h.validate=function(a,b){try{if(!A(a))throw new B("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(b)b=JSON.parse(JSON.stringify(b)),p.call(this,b,a,!0);else for(var d=0;d<a.length;d++)this.validator(a[d],d)}catch(H){if(H instanceof B)return H;throw H;}}})(h||(h={}));"undefined"!==typeof r&&(r.apply=h.apply,r.observe=h.observe,r.unobserve=h.unobserve,r.generate=h.generate,r.compare=h.compare,r.validate=h.validate,r.validator=h.validator,r.JsonPatchError=h.JsonPatchError,r.Error=h.Error)},{}],moment:[function(p,q,r){(function(k,d){"object"===typeof r&&"undefined"!==typeof q?q.exports=d():k.moment=d()})(this,function(){function k(){return Ob.apply(null,arguments)}function d(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function h(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function l(a){return void 0===a}function g(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function e(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function n(a,b){var d=[],e;for(e=0;e<a.length;++e)d.push(b(a[e],e));return d}function m(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function a(a,b){for(var d in b)m(b,d)&&(a[d]=b[d]);m(b,"toString")&&(a.toString=b.toString);m(b,"valueOf")&&(a.valueOf=b.valueOf);return a}function b(a,b,d,e){return jb(a,b,d,e,!0).utc()}function f(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return a._pf}function t(a){if(null==a._isValid){var b=f(a),d=Xb.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&0>b.overflow&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&d);a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function r(d){var e=b(NaN);null!=d?a(f(e),d):f(e).userInvalidated=!0;return e}function v(a,b){var d,e,g;l(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject);l(b._i)||(a._i=b._i);l(b._f)||(a._f=b._f);l(b._l)||(a._l=b._l);l(b._strict)||(a._strict=b._strict);l(b._tzm)||(a._tzm=b._tzm);l(b._isUTC)||(a._isUTC=b._isUTC);l(b._offset)||(a._offset=b._offset);l(b._pf)||(a._pf=f(b));l(b._locale)||(a._locale=b._locale);if(0<Ab.length)for(d=0;d<Ab.length;d++)e=Ab[d],g=b[e],l(g)||(a[e]=g);return a}function y(a){v(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Bb&&(Bb=!0,k.updateOffset(this),Bb=!1)}function w(a){return a instanceof y||null!=a&&null!=a._isAMomentObject}function z(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function x(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=z(a));return b}function C(a,b,d){var e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0,h;for(h=0;h<e;h++)(d&&a[h]!==b[h]||!d&&x(a[h])!==x(b[h]))&&g++;return g+f}function E(a){!1===k.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function A(b,d){var e=!0;return a(function(){null!=k.deprecationHandler&&k.deprecationHandler(null,b);if(e){for(var a=[],f,g=0;g<arguments.length;g++){f="";if("object"===typeof arguments[g]){f+="\n["+g+"] ";for(var h in arguments[0])f+=h+": "+arguments[0][h]+", ";f=f.slice(0,-2)}else f=arguments[g];a.push(f)}E(b+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+Error().stack);e=!1}return d.apply(this,arguments)},d)}function B(a,b){null!=k.deprecationHandler&&k.deprecationHandler(a,b);$b[a]||(E(b),$b[a]=!0)}function G(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function D(b,d){var e=a({},b),f;for(f in d)m(d,f)&&(h(b[f])&&h(d[f])?(e[f]={},a(e[f],b[f]),a(e[f],d[f])):null!=d[f]?e[f]=d[f]:delete e[f]);for(f in b)m(b,f)&&!m(d,f)&&h(b[f])&&(e[f]=a({},e[f]));return e}function F(a){null!=a&&this.set(a)}function H(a,b){var d=a.toLowerCase();nb[d]=nb[d+"s"]=nb[b]=a}function J(a){return"string"===typeof a?nb[a]||nb[a.toLowerCase()]:void 0}function K(a){var b={},d,e;for(e in a)m(a,e)&&(d=J(e))&&(b[d]=a[e]);return b}function I(a){var b=[],d;for(d in a)b.push({unit:d,priority:qa[d]});b.sort(function(a,b){return a.priority-b.priority});return b}function O(a,b){return function(d){if(null!=d){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+a](d);k.updateOffset(this,b);return this}return Q(this,a)}}function Q(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function R(a,b,d){var e=""+Math.abs(a);return(0<=a?d?"+":"":"-")+Math.pow(10,Math.max(0,b-e.length)).toString().substr(1)+e}function M(a,b,d,e){var f=e;"string"===typeof e&&(f=function(){return this[e]()});a&&(eb[a]=f);b&&(eb[b[0]]=function(){return R(f.apply(this,arguments),b[1],b[2])});d&&(eb[d]=function(){return this.localeData().ordinal(f.apply(this,arguments),a)})}function S(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function U(a){var b=a.match(ac),d,e;d=0;for(e=b.length;d<e;d++)b[d]=eb[b[d]]?eb[b[d]]:S(b[d]);return function(d){var f="",g;for(g=0;g<e;g++)f+=G(b[g])?b[g].call(d,a):b[g];return f}}function V(a,b){if(!a.isValid())return a.localeData().invalidDate();b=ga(b,a.localeData());Qb[b]=Qb[b]||U(b);return Qb[b](a)}function ga(a,b){function d(a){return b.longDateFormat(a)||a}var e=5;for(Cb.lastIndex=0;0<=e&&Cb.test(a);)a=a.replace(Cb,d),Cb.lastIndex=0,--e;return a}function P(a,b,d){Rb[a]=G(b)?b:function(a,e){return a&&d?d:b}}function ua(a,b){return m(Rb,a)?Rb[a](b._strict,b._locale):new RegExp(Z(a))}function Z(a){return oa(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,d,e,f){return b||d||e||f}))}function oa(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function W(a,b){var d,e=b;"string"===typeof a&&(a=[a]);g(b)&&(e=function(a,d){d[b]=x(a)});for(d=0;d<a.length;d++)Sb[a[d]]=e}function T(a,b){W(a,function(a,d,e,f){e._w=e._w||{};b(a,e._w,e,f)})}function wa(a,b){return(new Date(Date.UTC(a,b+1,0))).getUTCDate()}function ra(a,b){var d;if(!a.isValid())return a;if("string"===typeof b)if(/^\d+$/.test(b))b=x(b);else if(b=a.localeData().monthsParse(b),!g(b))return a;d=Math.min(a.date(),wa(a.year(),b));a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,d);return a}function ia(a){return null!=a?(ra(this,a),k.updateOffset(this,!0),this):Q(this,"Month")}function la(){function a(a,b){return b.length-a.length}var d=[],e=[],f=[],g,h;for(g=0;12>g;g++)h=b([2E3,g]),d.push(this.monthsShort(h,"")),e.push(this.months(h,"")),f.push(this.months(h,"")),f.push(this.monthsShort(h,""));d.sort(a);e.sort(a);f.sort(a);for(g=0;12>g;g++)d[g]=oa(d[g]),e[g]=oa(e[g]);for(g=0;24>g;g++)f[g]=oa(f[g]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+f.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+d.join("|")+")","i")}function aa(a){return 0===a%4&&0!==a%100||0===a%400}function fa(a,b,d,e,f,g,h){b=new Date(a,b,d,e,f,g,h);100>a&&0<=a&&isFinite(b.getFullYear())&&b.setFullYear(a);return b}function pa(a){var b=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a);return b}function ha(a,b,d){d=7+b-d;return-((7+pa(a,0,d).getUTCDay()-b)%7)+d-1}function xa(a,b,d,e,f){d=(7+d-e)%7;e=ha(a,e,f);e=1+7*(b-1)+d+e;0>=e?(b=a-1,a=(aa(b)?366:365)+e):e>(aa(a)?366:365)?(b=a+1,a=e-(aa(a)?366:365)):(b=a,a=e);return{year:b,dayOfYear:a}}function sa(a,b,d){var e=ha(a.year(),b,d),e=Math.floor((a.dayOfYear()-e-1)/7)+1;1>e?(a=a.year()-1,b=e+ja(a,b,d)):e>ja(a.year(),b,d)?(b=e-ja(a.year(),b,d),a=a.year()+1):(a=a.year(),b=e);return{week:b,year:a}}function ja(a,b,d){var e=ha(a,b,d);b=ha(a+1,b,d);return((aa(a)?366:365)-e+b)/7}function Aa(a,d,e){var f,g;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;7>f;++f)g=b([2E3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(g,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(g,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(g,"").toLocaleLowerCase();if(e)d="dddd"===d?na.call(this._weekdaysParse,a):"ddd"===d?na.call(this._shortWeekdaysParse,a):na.call(this._minWeekdaysParse,a);else if("dddd"===d){d=na.call(this._weekdaysParse,a);if(-1!==d)return d;d=na.call(this._shortWeekdaysParse,a);if(-1!==d)return d;d=na.call(this._minWeekdaysParse,a)}else if("ddd"===d){d=na.call(this._shortWeekdaysParse,a);if(-1!==d)return d;d=na.call(this._weekdaysParse,a);if(-1!==d)return d;d=na.call(this._minWeekdaysParse,a)}else{d=na.call(this._minWeekdaysParse,a);if(-1!==d)return d;d=na.call(this._weekdaysParse,a);if(-1!==d)return d;d=na.call(this._shortWeekdaysParse,a)}return-1!==d?d:null}function ta(){function a(a,b){return b.length-a.length}var d=[],e=[],f=[],g=[],h,k,l,m;for(h=0;7>h;h++)k=b([2E3,1]).day(h),l=this.weekdaysMin(k,""),m=this.weekdaysShort(k,""),k=this.weekdays(k,""),d.push(l),e.push(m),f.push(k),g.push(l),g.push(m),g.push(k);d.sort(a);e.sort(a);f.sort(a);g.sort(a);for(h=0;7>h;h++)e[h]=oa(e[h]),f[h]=oa(f[h]),g[h]=oa(g[h]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+g.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+f.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+d.join("|")+")","i")}function X(){return this.hours()%12||12}function Da(a,b){M(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Ea(a,b){return b._meridiemParse}function Sa(a){return a?a.toLowerCase().replace("_","-"):a}function fb(a){var b=null;if(!ka[a]&&"undefined"!==typeof q&&q&&q.exports)try{b=Db._abbr,p("./locale/"+a),Ia(b)}catch(Uc){}return ka[a]}function Ia(a,b){var d;a&&(d=l(b)?Fa(a):$a(a,b))&&(Db=d);return Db._abbr}function $a(a,b){if(null!==b){var d=bc;b.abbr=a;if(null!=ka[a])B("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),d=ka[a]._config;else if(null!=b.parentLocale)if(null!=ka[b.parentLocale])d=ka[b.parentLocale]._config;else return ob[b.parentLocale]||(ob[b.parentLocale]=[]),ob[b.parentLocale].push({name:a,config:b}),null;ka[a]=new F(D(d,b));ob[a]&&ob[a].forEach(function(a){$a(a.name,a.config)});Ia(a);return ka[a]}delete ka[a];return null}function Fa(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Db;if(!d(a)){if(b=fb(a))return b;a=[a]}a:{b=0;for(var e,f,g,h;b<a.length;){h=Sa(a[b]).split("-");e=h.length;for(f=(f=Sa(a[b+1]))?f.split("-"):null;0<e;){if(g=fb(h.slice(0,e).join("-"))){a=g;break a}if(f&&f.length>=e&&C(h,f,!0)>=e-1)break;e--}b++}a=null}return a}function ya(a){var b;(b=a._a)&&-2===f(a).overflow&&(b=0>b[La]||11<b[La]?La:1>b[Ga]||b[Ga]>wa(b[Ba],b[La])?Ga:0>b[ma]||24<b[ma]||24===b[ma]&&(0!==b[Ca]||0!==b[Ma]||0!==b[Za])?ma:0>b[Ca]||59<b[Ca]?Ca:0>b[Ma]||59<b[Ma]?Ma:0>b[Za]||999<b[Za]?Za:-1,f(a)._overflowDayOfYear&&(b<Ba||b>Ga)&&(b=Ga),f(a)._overflowWeeks&&-1===b&&(b=kc),f(a)._overflowWeekday&&-1===b&&(b=lc),f(a).overflow=b);return a}function tb(a){var b,d;b=a._i;var e=mc.exec(b)||nc.exec(b),g,h,k,l;if(e){f(a).iso=!0;b=0;for(d=Eb.length;b<d;b++)if(Eb[b][1].exec(e[1])){h=Eb[b][0];g=!1!==Eb[b][2];break}if(null==h)a._isValid=!1;else{if(e[3]){b=0;for(d=Tb.length;b<d;b++)if(Tb[b][1].exec(e[3])){k=(e[2]||" ")+Tb[b][0];break}if(null==k){a._isValid=!1;return}}if(g||null==k){if(e[4])if(oc.exec(e[4]))l="Z";else{a._isValid=!1;return}a._f=h+(k||"")+(l||"");Qa(a)}else a._isValid=!1}}else a._isValid=!1}function Ra(a){var b,d,e,g,h={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},k;b=a._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,"");if(b=pc.exec(b)){d=b[1]?"ddd"+(5===b[1].length?", ":" "):"";e="D MMM "+(10<b[2].length?"YYYY ":"YY ");g="HH:mm"+(b[4]?":ss":"");if(b[1]){var l="Sun Mon Tue Wed Thu Fri Sat".split(" ")[(new Date(b[2])).getDay()];if(b[1].substr(0,3)!==l){f(a).weekdayMismatch=!0;a._isValid=!1;return}}switch(b[5].length){case 2:0===k?h=" +0000":(k="YXWVUTSRQPONZABCDEFGHIKLM".indexOf(b[5][1].toUpperCase())-12,h=(0>k?" -":" +")+(""+k).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:h=h[b[5]];break;default:h=h[" GMT"]}b[5]=h;a._i=b.splice(1).join("");a._f=d+e+g+" ZZ";Qa(a);f(a).rfc2822=!0}else a._isValid=!1}function Lb(a){var b=qc.exec(a._i);null!==b?a._d=new Date(+b[1]):(tb(a),!1===a._isValid&&(delete a._isValid,Ra(a),!1===a._isValid&&(delete a._isValid,k.createFromInputFallback(a))))}function Pa(a,b,d){return null!=a?a:null!=b?b:d}function hb(a){var b,d=[],e;if(!a._d){e=new Date(k.now());e=a._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()];if(a._w&&null==a._a[Ga]&&null==a._a[La]){var g,h,l,m,n,p;g=a._w;if(null!=g.GG||null!=g.W||null!=g.E){if(n=1,p=4,h=Pa(g.GG,a._a[Ba],sa(ba(),1,4).year),l=Pa(g.W,1),m=Pa(g.E,1),1>m||7<m)b=!0}else if(n=a._locale._week.dow,p=a._locale._week.doy,l=sa(ba(),n,p),h=Pa(g.gg,a._a[Ba],l.year),l=Pa(g.w,l.week),null!=g.d){if(m=g.d,0>m||6<m)b=!0}else if(null!=g.e){if(m=g.e+n,0>g.e||6<g.e)b=!0}else m=n;1>l||l>ja(h,n,p)?f(a)._overflowWeeks=!0:null!=b?f(a)._overflowWeekday=!0:(b=xa(h,l,m,n,p),a._a[Ba]=b.year,a._dayOfYear=b.dayOfYear)}if(null!=a._dayOfYear){b=Pa(a._a[Ba],e[Ba]);if(a._dayOfYear>(aa(b)?366:365)||0===a._dayOfYear)f(a)._overflowDayOfYear=!0;b=pa(b,0,a._dayOfYear);a._a[La]=b.getUTCMonth();a._a[Ga]=b.getUTCDate()}for(b=0;3>b&&null==a._a[b];++b)a._a[b]=d[b]=e[b];for(;7>b;b++)a._a[b]=d[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[ma]&&0===a._a[Ca]&&0===a._a[Ma]&&0===a._a[Za]&&(a._nextDay=!0,a._a[ma]=0);a._d=(a._useUTC?pa:fa).apply(null,d);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[ma]=24)}}function Qa(a){if(a._f===k.ISO_8601)tb(a);else if(a._f===k.RFC_2822)Ra(a);else{a._a=[];f(a).empty=!0;var b=""+a._i,d,e,g,h,l,n=b.length,p=0;g=ga(a._f,a._locale).match(ac)||[];for(d=0;d<g.length;d++){h=g[d];if(e=(b.match(ua(h,a))||[])[0])l=b.substr(0,b.indexOf(e)),0<l.length&&f(a).unusedInput.push(l),b=b.slice(b.indexOf(e)+e.length),p+=e.length;if(eb[h]){if(e?f(a).empty=!1:f(a).unusedTokens.push(h),l=a,null!=e&&m(Sb,h))Sb[h](e,l._a,l,h)}else a._strict&&!e&&f(a).unusedTokens.push(h)}f(a).charsLeftOver=n-p;0<b.length&&f(a).unusedInput.push(b);12>=a._a[ma]&&!0===f(a).bigHour&&0<a._a[ma]&&(f(a).bigHour=void 0);f(a).parsedDateParts=a._a.slice(0);f(a).meridiem=a._meridiem;b=a._a;d=ma;n=a._locale;g=a._a[ma];p=a._meridiem;null!=p&&(null!=n.meridiemHour?g=n.meridiemHour(g,p):null!=n.isPM&&((n=n.isPM(p))&&12>g&&(g+=12),n||12!==g||(g=0)));b[d]=g;hb(a);ya(a)}}function Mb(a){if(!a._d){var b=K(a._i);a._a=n([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)});hb(a)}}function ib(b){var g=b._i,h=b._f;b._locale=b._locale||Fa(b._l);if(null===g||void 0===h&&""===g)return r({nullInput:!0});"string"===typeof g&&(b._i=g=b._locale.preparse(g));if(w(g))return new y(ya(g));if(e(g))b._d=g;else if(d(h)){var k,l,m;if(0===b._f.length)f(b).invalidFormat=!0,b._d=new Date(NaN);else{for(g=0;g<b._f.length;g++)if(h=0,k=v({},b),null!=b._useUTC&&(k._useUTC=b._useUTC),k._f=b._f[g],Qa(k),t(k)&&(h+=f(k).charsLeftOver,h+=10*f(k).unusedTokens.length,f(k).score=h,null==m||h<m))m=h,l=k;a(b,l||k)}}else h?Qa(b):Wa(b);t(b)||(b._d=null);return b}function Wa(a){var b=a._i;l(b)?a._d=new Date(k.now()):e(b)?a._d=new Date(b.valueOf()):"string"===typeof b?Lb(a):d(b)?(a._a=n(b.slice(0),function(a){return parseInt(a,10)}),hb(a)):h(b)?Mb(a):g(b)?a._d=new Date(b):k.createFromInputFallback(a)}function jb(a,b,e,f,g){var k={};if(!0===e||!1===e)f=e,e=void 0;var l;if(l=h(a))a:{l=a;for(var m in l){l=!1;break a}l=!0}if(l||d(a)&&0===a.length)a=void 0;k._isAMomentObject=!0;k._useUTC=k._isUTC=g;k._l=e;k._i=a;k._f=b;k._strict=f;a=new y(ya(ib(k)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function ba(a,b,d,e){return jb(a,b,d,e,!1)}function Ya(a,b){var e,f;1===b.length&&d(b[0])&&(b=b[0]);if(!b.length)return ba();e=b[0];for(f=1;f<b.length;++f)if(!b[f].isValid()||b[f][a](e))e=b[f];return e}function mb(a){for(var b in a)if(-1===pb.indexOf(b)||null!=a[b]&&isNaN(a[b]))return!1;b=!1;for(var d=0;d<pb.length;++d)if(a[pb[d]]){if(b)return!1;parseFloat(a[pb[d]])!==x(a[pb[d]])&&(b=!0)}return!0}function Oa(a){a=K(a);var b=a.year||0,d=a.quarter||0,e=a.month||0,f=a.week||0,g=a.day||0,h=a.hour||0,k=a.minute||0,l=a.second||0,m=a.millisecond||0;this._isValid=mb(a);this._milliseconds=+m+1E3*l+6E4*k+36E5*h;this._days=+g+7*f;this._months=+e+3*d+12*b;this._data={};this._locale=Fa();this._bubble()}function ab(a){return a instanceof Oa}function L(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function rb(a,b){M(a,0,0,function(){var a=this.utcOffset(),d="+";0>a&&(a=-a,d="-");return d+R(~~(a/60),2)+b+R(~~a%60,2)})}function ea(a,b){var d=(b||"").match(a);if(null===d)return null;var d=((d[d.length-1]||[])+"").match(rc)||["-",0,0],e=+(60*d[1])+x(d[2]);return 0===e?0:"+"===d[0]?e:-e}function gb(a,b){var d,f;return b._isUTC?(d=b.clone(),f=(w(a)||e(a)?a.valueOf():ba(a).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+f),k.updateOffset(d,!1),d):ba(a).local()}function Xa(){return this.isValid()?this._isUTC&&0===this._offset:!1}function va(a,b){var d=a,e;ab(a)?d={ms:a._milliseconds,d:a._days,M:a._months}:g(a)?(d={},b?d[b]=a:d.milliseconds=a):(e=sc.exec(a))?(d="-"===e[1]?-1:1,d={y:0,d:x(e[Ga])*d,h:x(e[ma])*d,m:x(e[Ca])*d,s:x(e[Ma])*d,ms:x(L(1E3*e[Za]))*d}):(e=tc.exec(a))?(d="-"===e[1]?-1:1,d={y:Ja(e[2],d),M:Ja(e[3],d),w:Ja(e[4],d),d:Ja(e[5],d),h:Ja(e[6],d),m:Ja(e[7],d),s:Ja(e[8],d)}):null==d?d={}:"object"===typeof d&&("from"in d||"to"in d)&&(e=ba(d.from),d=ba(d.to),e.isValid()&&d.isValid()?(d=gb(d,e),e.isBefore(d)?d=sb(e,d):(d=sb(d,e),d.milliseconds=-d.milliseconds,d.months=-d.months),e=d):e={milliseconds:0,months:0},d={},d.ms=e.milliseconds,d.M=e.months);d=new Oa(d);ab(a)&&m(a,"_locale")&&(d._locale=a._locale);return d}function Ja(a,b){var d=a&&parseFloat(a.replace(",","."));return(isNaN(d)?0:d)*b}function sb(a,b){var d={milliseconds:0,months:0};d.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(d.months,"M").isAfter(b)&&--d.months;d.milliseconds=+b-+a.clone().add(d.months,"M");return d}function ub(a,b){return function(d,e){var f;null===e||isNaN(+e)||(B(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=d,d=e,e=f);f=va("string"===typeof d?+d:d,e);vb(this,f,a);return this}}function vb(a,b,d,e){var f=b._milliseconds,g=L(b._days);b=L(b._months);if(a.isValid()){e=null==e?!0:e;f&&a._d.setTime(a._d.valueOf()+f*d);if(g&&(f=Q(a,"Date")+g*d,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](f);b&&ra(a,Q(a,"Month")+b*d);e&&k.updateOffset(a,g||b)}}function wb(a){if(void 0===a)return this._locale._abbr;a=Fa(a);null!=a&&(this._locale=a);return this}function xb(){return this._locale}function bb(a,b){M(0,[a,a.length],0,b)}function yb(a,b,d,e,f){var g;if(null==a)return sa(this,e,f).year;g=ja(a,e,f);b>g&&(b=g);a=xa(a,b,d,e,f);a=pa(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function Nb(a,b){b[Za]=x(1E3*("0."+a))}function kb(a){return a}function cb(a,d,e,f){var g=Fa();d=b().set(f,d);return g[e](d,a)}function Yb(a,b,d){g(a)&&(b=a,a=void 0);a=a||"";if(null!=b)return cb(a,b,d,"month");var e=[];for(b=0;12>b;b++)e[b]=cb(a,b,d,"month");return e}function Pb(a,b,d,e){"boolean"!==typeof a&&(d=b=a,a=!1);g(b)&&(d=b,b=void 0);b=b||"";var f=Fa();a=a?f._week.dow:0;if(null!=d)return cb(b,(d+a)%7,e,"day");f=[];for(d=0;7>d;d++)f[d]=cb(b,(d+a)%7,e,"day");return f}function Zb(a,b,d,e){b=va(b,d);a._milliseconds+=e*b._milliseconds;a._days+=e*b._days;a._months+=e*b._months;return a._bubble()}function lb(a){return 0>a?Math.floor(a):Math.ceil(a)}function Ta(a){return function(){return this.as(a)}}function Ka(a){return function(){return this.isValid()?this._data[a]:NaN}}function db(a,b,d,e,f){return f.relativeTime(b||1,!!d,a,e)}function zb(){if(!this.isValid())return this.localeData().invalidDate();var a=Ub(this._milliseconds)/1E3,b=Ub(this._days),d=Ub(this._months),e,f;e=z(a/60);f=z(e/60);a%=60;e%=60;var g=z(d/12),d=d%12,h=this.asSeconds();return h?(0>h?"-":"")+"P"+(g?g+"Y":"")+(d?d+"M":"")+(b?b+"D":"")+(f||e||a?"T":"")+(f?f+"H":"")+(e?e+"M":"")+(a?a+"S":""):"P0D"}var Ob,Xb=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),d=b.length>>>0,e=0;e<d;e++)if(e in b&&a.call(this,b[e],e,b))return!0;return!1},Ab=k.momentProperties=[],Bb=!1,$b={};k.suppressDeprecationWarnings=!1;k.deprecationHandler=null;var uc=Object.keys?Object.keys:function(a){var b,d=[];for(b in a)m(a,b)&&d.push(b);return d},nb={},qa={},ac=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Cb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Qb={},eb={},cc=/\d/,za=/\d\d/,dc=/\d{3}/,Vb=/\d{4}/,Fb=/[+-]?\d{6}/,da=/\d\d?/,ec=/\d\d\d\d?/,fc=/\d\d\d\d\d\d?/,Gb=/\d{1,3}/,Wb=/\d{1,4}/,Hb=/[+-]?\d{1,6}/,vc=/\d+/,Ib=/[+-]?\d+/,wc=/Z|[+-]\d\d:?\d\d/gi,Jb=/Z|[+-]\d\d(?::?\d\d)?/gi,qb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Rb={},Sb={},Ba=0,La=1,Ga=2,ma=3,Ca=4,Ma=5,Za=6,kc=7,lc=8,na=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};M("M",["MM",2],"Mo",function(){return this.month()+1});M("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});M("MMMM",0,0,function(a){return this.localeData().months(this,a)});H("month","M");qa.month=8;P("M",da);P("MM",da,za);P("MMM",function(a,b){return b.monthsShortRegex(a)});P("MMMM",function(a,b){return b.monthsRegex(a)});W(["M","MM"],function(a,b){b[La]=x(a)-1});W(["MMM","MMMM"],function(a,b,d,e){e=d._locale.monthsParse(a,e,d._strict);null!=e?b[La]=e:f(d).invalidMonth=a});var gc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;M("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});M(0,["YY",2],0,function(){return this.year()%100});M(0,["YYYY",4],0,"year");M(0,["YYYYY",5],0,"year");M(0,["YYYYYY",6,!0],0,"year");H("year","y");qa.year=1;P("Y",Ib);P("YY",da,za);P("YYYY",Wb,Vb);P("YYYYY",Hb,Fb);P("YYYYYY",Hb,Fb);W(["YYYYY","YYYYYY"],Ba);W("YYYY",function(a,b){b[Ba]=2===a.length?k.parseTwoDigitYear(a):x(a)});W("YY",function(a,b){b[Ba]=k.parseTwoDigitYear(a)});W("Y",function(a,b){b[Ba]=parseInt(a,10)});k.parseTwoDigitYear=function(a){return x(a)+(68<x(a)?1900:2E3)};var hc=O("FullYear",!0);M("w",["ww",2],"wo","week");M("W",["WW",2],"Wo","isoWeek");H("week","w");H("isoWeek","W");qa.week=5;qa.isoWeek=5;P("w",da);P("ww",da,za);P("W",da);P("WW",da,za);T(["w","ww","W","WW"],function(a,b,d,e){b[e.substr(0,1)]=x(a)});M("d",0,"do","day");M("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});M("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});M("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});M("e",0,0,"weekday");M("E",0,0,"isoWeekday");H("day","d");H("weekday","e");H("isoWeekday","E");qa.day=11;qa.weekday=11;qa.isoWeekday=11;P("d",da);P("e",da);P("E",da);P("dd",function(a,b){return b.weekdaysMinRegex(a)});P("ddd",function(a,b){return b.weekdaysShortRegex(a)});P("dddd",function(a,b){return b.weekdaysRegex(a)});T(["dd","ddd","dddd"],function(a,b,d,e){e=d._locale.weekdaysParse(a,e,d._strict);null!=e?b.d=e:f(d).invalidWeekday=a});T(["d","e","E"],function(a,b,d,e){b[e]=x(a)});M("H",["HH",2],0,"hour");M("h",["hh",2],0,X);M("k",["kk",2],0,function(){return this.hours()||24});M("hmm",0,0,function(){return""+X.apply(this)+R(this.minutes(),2)});M("hmmss",0,0,function(){return""+X.apply(this)+R(this.minutes(),2)+R(this.seconds(),2)});M("Hmm",0,0,function(){return""+this.hours()+R(this.minutes(),2)});M("Hmmss",0,0,function(){return""+this.hours()+R(this.minutes(),2)+R(this.seconds(),2)});Da("a",!0);Da("A",!1);H("hour","h");qa.hour=13;P("a",Ea);P("A",Ea);P("H",da);P("h",da);P("k",da);P("HH",da,za);P("hh",da,za);P("kk",da,za);P("hmm",ec);P("hmmss",fc);P("Hmm",ec);P("Hmmss",fc);W(["H","HH"],ma);W(["k","kk"],function(a,b,d){a=x(a);b[ma]=24===a?0:a});W(["a","A"],function(a,b,d){d._isPm=d._locale.isPM(a);d._meridiem=a});W(["h","hh"],function(a,b,d){b[ma]=x(a);f(d).bigHour=!0});W("hmm",function(a,b,d){var e=a.length-2;b[ma]=x(a.substr(0,e));b[Ca]=x(a.substr(e));f(d).bigHour=!0});W("hmmss",function(a,b,d){var e=a.length-4,g=a.length-2;b[ma]=x(a.substr(0,e));b[Ca]=x(a.substr(e,2));b[Ma]=x(a.substr(g));f(d).bigHour=!0});W("Hmm",function(a,b,d){d=a.length-2;b[ma]=x(a.substr(0,d));b[Ca]=x(a.substr(d))});W("Hmmss",function(a,b,d){d=a.length-4;var e=a.length-2;b[ma]=x(a.substr(0,d));b[Ca]=x(a.substr(d,2));b[Ma]=x(a.substr(e))});var xc=O("Hours",!0),bc={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),meridiemParse:/[ap]\.?m?\.?/i},ka={},ob={},Db,mc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,nc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,oc=/Z|[+-]\d\d(?::?\d\d)?/,Eb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Tb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],qc=/^\/?Date\((\-?\d+)/i,pc=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;k.createFromInputFallback=A("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});k.ISO_8601=function(){};k.RFC_2822=function(){};var yc=A("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=ba.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:r()}),zc=A("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=ba.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:r()}),pb="year quarter month week day hour minute second millisecond".split(" ");rb("Z",":");rb("ZZ","");P("Z",Jb);P("ZZ",Jb);W(["Z","ZZ"],function(a,b,d){d._useUTC=!0;d._tzm=ea(Jb,a)});var rc=/([\+\-]|\d\d)/gi;k.updateOffset=function(){};var sc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,tc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;va.fn=Oa.prototype;va.invalid=function(){return va(NaN)};var Ac=ub(1,"add"),Bc=ub(-1,"subtract");k.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";k.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ic=A("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});M(0,["gg",2],0,function(){return this.weekYear()%100});M(0,["GG",2],0,function(){return this.isoWeekYear()%100});bb("gggg","weekYear");bb("ggggg","weekYear");bb("GGGG","isoWeekYear");bb("GGGGG","isoWeekYear");H("weekYear","gg");H("isoWeekYear","GG");qa.weekYear=1;qa.isoWeekYear=1;P("G",Ib);P("g",Ib);P("GG",da,za);P("gg",da,za);P("GGGG",Wb,Vb);P("gggg",Wb,Vb);P("GGGGG",Hb,Fb);P("ggggg",Hb,Fb);T(["gggg","ggggg","GGGG","GGGGG"],function(a,b,d,e){b[e.substr(0,2)]=x(a)});T(["gg","GG"],function(a,b,d,e){b[e]=k.parseTwoDigitYear(a)});M("Q",0,"Qo","quarter");H("quarter","Q");qa.quarter=7;P("Q",cc);W("Q",function(a,b){b[La]=3*(x(a)-1)});M("D",["DD",2],"Do","date");H("date","D");qa.date=9;P("D",da);P("DD",da,za);P("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient});W(["D","DD"],Ga);W("Do",function(a,b){b[Ga]=x(a.match(da)[0],10)});var jc=O("Date",!0);M("DDD",["DDDD",3],"DDDo","dayOfYear");H("dayOfYear","DDD");qa.dayOfYear=4;P("DDD",Gb);P("DDDD",dc);W(["DDD","DDDD"],function(a,b,d){d._dayOfYear=x(a)});M("m",["mm",2],0,"minute");H("minute","m");qa.minute=14;P("m",da);P("mm",da,za);W(["m","mm"],Ca);var Cc=O("Minutes",!1);M("s",["ss",2],0,"second");H("second","s");qa.second=15;P("s",da);P("ss",da,za);W(["s","ss"],Ma);var Dc=O("Seconds",!1);M("S",0,0,function(){return~~(this.millisecond()/100)});M(0,["SS",2],0,function(){return~~(this.millisecond()/10)});M(0,["SSS",3],0,"millisecond");M(0,["SSSS",4],0,function(){return 10*this.millisecond()});M(0,["SSSSS",5],0,function(){return 100*this.millisecond()});M(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});M(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});M(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});M(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});H("millisecond","ms");qa.millisecond=16;P("S",Gb,cc);P("SS",Gb,za);P("SSS",Gb,dc);var Ua;for(Ua="SSSS";9>=Ua.length;Ua+="S")P(Ua,vc);for(Ua="S";9>=Ua.length;Ua+="S")W(Ua,Nb);var Ec=O("Milliseconds",!1);M("z",0,0,"zoneAbbr");M("zz",0,0,"zoneName");var N=y.prototype;N.add=Ac;N.calendar=function(a,b){var d=a||ba(),e=gb(d,this).startOf("day"),e=k.calendarFormat(this,e)||"sameElse",f=b&&(G(b[e])?b[e].call(this,d):b[e]);return this.format(f||this.localeData().calendar(e,this,ba(d)))};N.clone=function(){return new y(this)};N.diff=function(a,b,d){var e;if(!this.isValid())return NaN;a=gb(a,this);if(!a.isValid())return NaN;e=6E4*(a.utcOffset()-this.utcOffset());b=J(b);if("year"===b||"month"===b||"quarter"===b){e=12*(a.year()-this.year())+(a.month()-this.month());var f=this.clone().add(e,"months"),g;0>a-f?(g=this.clone().add(e-1,"months"),a=(a-f)/(f-g)):(g=this.clone().add(e+1,"months"),a=(a-f)/(g-f));a=-(e+a)||0;"quarter"===b?a/=3:"year"===b&&(a/=12)}else a=this-a,a="second"===b?a/1E3:"minute"===b?a/6E4:"hour"===b?a/36E5:"day"===b?(a-e)/864E5:"week"===b?(a-e)/6048E5:a;return d?a:z(a)};N.endOf=function(a){a=J(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};N.format=function(a){a||(a=this.isUtc()?k.defaultFormatUtc:k.defaultFormat);a=V(this,a);return this.localeData().postformat(a)};N.from=function(a,b){return this.isValid()&&(w(a)&&a.isValid()||ba(a).isValid())?va({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};N.fromNow=function(a){return this.from(ba(),a)};N.to=function(a,b){return this.isValid()&&(w(a)&&a.isValid()||ba(a).isValid())?va({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};N.toNow=function(a){return this.to(ba(),a)};N.get=function(a){a=J(a);return G(this[a])?this[a]():this};N.invalidAt=function(){return f(this).overflow};N.isAfter=function(a,b){var d=w(a)?a:ba(a);if(!this.isValid()||!d.isValid())return!1;b=J(l(b)?"millisecond":b);return"millisecond"===b?this.valueOf()>d.valueOf():d.valueOf()<this.clone().startOf(b).valueOf()};N.isBefore=function(a,b){var d=w(a)?a:ba(a);if(!this.isValid()||!d.isValid())return!1;b=J(l(b)?"millisecond":b);return"millisecond"===b?this.valueOf()<d.valueOf():this.clone().endOf(b).valueOf()<d.valueOf()};N.isBetween=function(a,b,d,e){e=e||"()";return("("===e[0]?this.isAfter(a,d):!this.isBefore(a,d))&&(")"===e[1]?this.isBefore(b,d):!this.isAfter(b,d))};N.isSame=function(a,b){var d=w(a)?a:ba(a);if(!this.isValid()||!d.isValid())return!1;b=J(b||"millisecond");if("millisecond"===b)return this.valueOf()===d.valueOf();d=d.valueOf();return this.clone().startOf(b).valueOf()<=d&&d<=this.clone().endOf(b).valueOf()};N.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};N.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,b)};N.isValid=function(){return t(this)};N.lang=ic;N.locale=wb;N.localeData=xb;N.max=zc;N.min=yc;N.parsingFlags=function(){return a({},f(this))};N.set=function(a,b){if("object"===typeof a){a=K(a);for(var d=I(a),e=0;e<d.length;e++)this[d[e].unit](a[d[e].unit])}else if(a=J(a),G(this[a]))return this[a](b);return this};N.startOf=function(a){a=J(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};N.subtract=Bc;N.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};N.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};N.toDate=function(){return new Date(this.valueOf())};N.toISOString=function(){if(!this.isValid())return null;var a=this.clone().utc();return 0>a.year()||9999<a.year()?V(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):G(Date.prototype.toISOString)?this.toDate().toISOString():V(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};N.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var a="["+a+'("]',d=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+d+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};N.toJSON=function(){return this.isValid()?this.toISOString():null};N.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};N.unix=function(){return Math.floor(this.valueOf()/1E3)};N.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};N.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};N.year=hc;N.isLeapYear=function(){return aa(this.year())};N.weekYear=function(a){return yb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};N.isoWeekYear=function(a){return yb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};N.quarter=N.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};N.month=ia;N.daysInMonth=function(){return wa(this.year(),this.month())};N.week=N.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};N.isoWeek=N.isoWeeks=function(a){var b=sa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};N.weeksInYear=function(){var a=this.localeData()._week;return ja(this.year(),a.dow,a.doy)};N.isoWeeksInYear=function(){return ja(this.year(),1,4)};N.date=jc;N.day=N.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var d=this.localeData();"string"===typeof a&&(isNaN(a)?(a=d.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-b,"d")}return b};N.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};N.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=this.localeData();a="string"===typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};N.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:this.add(a-b,"d")};N.hour=N.hours=xc;N.minute=N.minutes=Cc;N.second=N.seconds=Dc;N.millisecond=N.milliseconds=Ec;N.utcOffset=function(a,b,d){var e=this._offset||0,f;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=ea(Jb,a),null===a)return this}else 16>Math.abs(a)&&!d&&(a*=60);!this._isUTC&&b&&(f=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=a;this._isUTC=!0;null!=f&&this.add(f,"m");e!==a&&(!b||this._changeInProgress?vb(this,va(a-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,k.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?e:15*-Math.round(this._d.getTimezoneOffset()/15)};N.utc=function(a){return this.utcOffset(0,a)};N.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};N.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=ea(wc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};N.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?ba(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};N.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};N.isLocal=function(){return this.isValid()?!this._isUTC:!1};N.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};N.isUtc=Xa;N.isUTC=Xa;N.zoneAbbr=function(){return this._isUTC?"UTC":""};N.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};N.dates=A("dates accessor is deprecated. Use date instead.",jc);N.months=A("months accessor is deprecated. Use month instead",ia);N.years=A("years accessor is deprecated. Use year instead",hc);N.zone=A("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});N.isDSTShifted=A("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var a={};v(a,this);a=ib(a);if(a._a){var d=a._isUTC?b(a._a):ba(a._a);this._isDSTShifted=this.isValid()&&0<C(a._a,d.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var ca=F.prototype;ca.calendar=function(a,b,d){a=this._calendar[a]||this._calendar.sameElse;return G(a)?a.call(b,d):a};ca.longDateFormat=function(a){var b=this._longDateFormat[a],d=this._longDateFormat[a.toUpperCase()];if(b||!d)return b;this._longDateFormat[a]=d.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};ca.invalidDate=function(){return this._invalidDate};ca.ordinal=function(a){return this._ordinal.replace("%d",a)};ca.preparse=kb;ca.postformat=kb;ca.relativeTime=function(a,b,d,e){var f=this._relativeTime[d];return G(f)?f(a,b,d,e):f.replace(/%d/i,a)};ca.pastFuture=function(a,b){var d=this._relativeTime[0<a?"future":"past"];return G(d)?d(b):d.replace(/%s/i,b)};ca.set=function(a){var b,d;for(d in a)b=a[d],G(b)?this[d]=b:this["_"+d]=b;this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};ca.months=function(a,b){return a?d(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||gc).test(b)?"format":"standalone"][a.month()]:d(this._months)?this._months:this._months.standalone};ca.monthsShort=function(a,b){return a?d(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[gc.test(b)?"format":"standalone"][a.month()]:d(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};ca.monthsParse=function(a,d,e){var f,g;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],f=0;12>f;++f)g=b([2E3,f]),this._shortMonthsParse[f]=this.monthsShort(g,"").toLocaleLowerCase(),this._longMonthsParse[f]=this.months(g,"").toLocaleLowerCase();if(e)d="MMM"===d?na.call(this._shortMonthsParse,a):na.call(this._longMonthsParse,a);else if("MMM"===d){d=na.call(this._shortMonthsParse,a);if(-1!==d)break a;d=na.call(this._longMonthsParse,a)}else{d=na.call(this._longMonthsParse,a);if(-1!==d)break a;d=na.call(this._shortMonthsParse,a)}d=-1!==d?d:null}return d}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(f=0;12>f;f++)if(g=b([2E3,f]),e&&!this._longMonthsParse[f]&&(this._longMonthsParse[f]=new RegExp("^"+this.months(g,"").replace(".","")+"$","i"),this._shortMonthsParse[f]=new RegExp("^"+this.monthsShort(g,"").replace(".","")+"$","i")),e||this._monthsParse[f]||(g="^"+this.months(g,"")+"|^"+this.monthsShort(g,""),this._monthsParse[f]=new RegExp(g.replace(".",""),"i")),e&&"MMMM"===d&&this._longMonthsParse[f].test(a)||e&&"MMM"===d&&this._shortMonthsParse[f].test(a)||!e&&this._monthsParse[f].test(a))return f};ca.monthsRegex=function(a){if(this._monthsParseExact)return m(this,"_monthsRegex")||la.call(this),a?this._monthsStrictRegex:this._monthsRegex;m(this,"_monthsRegex")||(this._monthsRegex=qb);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};ca.monthsShortRegex=function(a){if(this._monthsParseExact)return m(this,"_monthsRegex")||la.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;m(this,"_monthsShortRegex")||(this._monthsShortRegex=qb);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};ca.week=function(a){return sa(a,this._week.dow,this._week.doy).week};ca.firstDayOfYear=function(){return this._week.doy};ca.firstDayOfWeek=function(){return this._week.dow};ca.weekdays=function(a,b){return a?d(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:d(this._weekdays)?this._weekdays:this._weekdays.standalone};ca.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};ca.weekdaysShort=function(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort};ca.weekdaysParse=function(a,d,e){var f,g;if(this._weekdaysParseExact)return Aa.call(this,a,d,e);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(f=0;7>f;f++)if(g=b([2E3,1]).day(f),e&&!this._fullWeekdaysParse[f]&&(this._fullWeekdaysParse[f]=new RegExp("^"+this.weekdays(g,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[f]=new RegExp("^"+this.weekdaysShort(g,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[f]=new RegExp("^"+this.weekdaysMin(g,"").replace(".",".?")+"$","i")),this._weekdaysParse[f]||(g="^"+this.weekdays(g,"")+"|^"+this.weekdaysShort(g,"")+"|^"+this.weekdaysMin(g,""),this._weekdaysParse[f]=new RegExp(g.replace(".",""),"i")),e&&"dddd"===d&&this._fullWeekdaysParse[f].test(a)||e&&"ddd"===d&&this._shortWeekdaysParse[f].test(a)||e&&"dd"===d&&this._minWeekdaysParse[f].test(a)||!e&&this._weekdaysParse[f].test(a))return f};ca.weekdaysRegex=function(a){if(this._weekdaysParseExact)return m(this,"_weekdaysRegex")||ta.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;m(this,"_weekdaysRegex")||(this._weekdaysRegex=qb);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};ca.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return m(this,"_weekdaysRegex")||ta.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qb);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};ca.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return m(this,"_weekdaysRegex")||ta.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=qb);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};ca.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};ca.meridiem=function(a,b,d){return 11<a?d?"pm":"PM":d?"am":"AM"};Ia("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,b=1===x(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});k.lang=A("moment.lang is deprecated. Use moment.locale instead.",Ia);k.langData=A("moment.langData is deprecated. Use moment.localeData instead.",Fa);var Na=Math.abs,Fc=Ta("ms"),Gc=Ta("s"),Hc=Ta("m"),Ic=Ta("h"),Jc=Ta("d"),Kc=Ta("w"),Lc=Ta("M"),Mc=Ta("y"),Nc=Ka("milliseconds"),Oc=Ka("seconds"),Pc=Ka("minutes"),Qc=Ka("hours"),Rc=Ka("days"),Sc=Ka("months"),Tc=Ka("years"),Va=Math.round,Ha={ss:44,s:45,m:45,h:22,d:26,M:11},Ub=Math.abs,Y=Oa.prototype;Y.isValid=function(){return this._isValid};Y.abs=function(){var a=this._data;this._milliseconds=Na(this._milliseconds);this._days=Na(this._days);this._months=Na(this._months);a.milliseconds=Na(a.milliseconds);a.seconds=Na(a.seconds);a.minutes=Na(a.minutes);a.hours=Na(a.hours);a.months=Na(a.months);a.years=Na(a.years);return this};Y.add=function(a,b){return Zb(this,a,b,1)};Y.subtract=function(a,b){return Zb(this,a,b,-1)};Y.as=function(a){if(!this.isValid())return NaN;var b,d=this._milliseconds;a=J(a);if("month"===a||"year"===a)return b=this._days+d/864E5,b=this._months+4800*b/146097,"month"===a?b:b/12;b=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return b/7+d/6048E5;case "day":return b+d/864E5;case "hour":return 24*b+d/36E5;case "minute":return 1440*b+d/6E4;case "second":return 86400*b+d/1E3;case "millisecond":return Math.floor(864E5*b)+d;default:throw Error("Unknown unit "+a);}};Y.asMilliseconds=Fc;Y.asSeconds=Gc;Y.asMinutes=Hc;Y.asHours=Ic;Y.asDays=Jc;Y.asWeeks=Kc;Y.asMonths=Lc;Y.asYears=Mc;Y.valueOf=function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*x(this._months/12):NaN};Y._bubble=function(){var a=this._milliseconds,b=this._days,d=this._months,e=this._data;0<=a&&0<=b&&0<=d||0>=a&&0>=b&&0>=d||(a+=864E5*lb(146097*d/4800+b),d=b=0);e.milliseconds=a%1E3;a=z(a/1E3);e.seconds=a%60;a=z(a/60);e.minutes=a%60;a=z(a/60);e.hours=a%24;b+=z(a/24);a=z(4800*b/146097);d+=a;b-=lb(146097*a/4800);a=z(d/12);e.days=b;e.months=d%12;e.years=a;return this};Y.get=function(a){a=J(a);return this.isValid()?this[a+"s"]():NaN};Y.milliseconds=Nc;Y.seconds=Oc;Y.minutes=Pc;Y.hours=Qc;Y.days=Rc;Y.weeks=function(){return z(this.days()/7)};Y.months=Sc;Y.years=Tc;Y.humanize=function(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),d;d=!a;var e=va(this).abs(),f=Va(e.as("s")),g=Va(e.as("m")),h=Va(e.as("h")),k=Va(e.as("d")),l=Va(e.as("M")),e=Va(e.as("y")),f=f<=Ha.ss&&["s",f]||f<Ha.s&&["ss",f]||1>=g&&["m"]||g<Ha.m&&["mm",g]||1>=h&&["h"]||h<Ha.h&&["hh",h]||1>=k&&["d"]||k<Ha.d&&["dd",k]||1>=l&&["M"]||l<Ha.M&&["MM",l]||1>=e&&["y"]||["yy",e];f[2]=d;f[3]=0<+this;f[4]=b;d=db.apply(null,f);a&&(d=b.pastFuture(+this,d));return b.postformat(d)};Y.toISOString=zb;Y.toString=zb;Y.toJSON=zb;Y.locale=wb;Y.localeData=xb;Y.toIsoString=A("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",zb);Y.lang=ic;M("X",0,0,"unix");M("x",0,0,"valueOf");P("x",Ib);P("X",/[+-]?\d+(\.\d{1,3})?/);W("X",function(a,b,d){d._d=new Date(1E3*parseFloat(a,10))});W("x",function(a,b,d){d._d=new Date(x(a))});k.version="2.18.1";Ob=ba;k.fn=N;k.min=function(){var a=[].slice.call(arguments,0);return Ya("isBefore",a)};k.max=function(){var a=[].slice.call(arguments,0);return Ya("isAfter",a)};k.now=function(){return Date.now?Date.now():+new Date};k.utc=b;k.unix=function(a){return ba(1E3*a)};k.months=function(a,b){return Yb(a,b,"months")};k.isDate=e;k.locale=Ia;k.invalid=r;k.duration=va;k.isMoment=w;k.weekdays=function(a,b,d){return Pb(a,b,d,"weekdays")};k.parseZone=function(){return ba.apply(null,arguments).parseZone()};k.localeData=Fa;k.isDuration=ab;k.monthsShort=function(a,b){return Yb(a,b,"monthsShort")};k.weekdaysMin=function(a,b,d){return Pb(a,b,d,"weekdaysMin")};k.defineLocale=$a;k.updateLocale=function(a,b){if(null!=b){var d;d=bc;null!=ka[a]&&(d=ka[a]._config);b=D(d,b);d=new F(b);d.parentLocale=ka[a];ka[a]=d;Ia(a)}else null!=ka[a]&&(null!=ka[a].parentLocale?ka[a]=ka[a].parentLocale:null!=ka[a]&&delete ka[a]);return ka[a]};k.locales=function(){return uc(ka)};k.weekdaysShort=function(a,b,d){return Pb(a,b,d,"weekdaysShort")};k.normalizeUnits=J;k.relativeTimeRounding=function(a){return void 0===a?Va:"function"===typeof a?(Va=a,!0):!1};k.relativeTimeThreshold=function(a,b){if(void 0===Ha[a])return!1;if(void 0===b)return Ha[a];Ha[a]=b;"s"===a&&(Ha.ss=b-1);return!0};k.calendarFormat=function(a,b){var d=a.diff(b,"days",!0);return-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse"};k.prototype=N;return k})},{}],numbro:[function(p,q,r){(function(){function k(a){this._value=a}function d(a){return 0===a?1:Math.floor(Math.log(Math.abs(a))/Math.LN10)+1}function h(a){var b,d="";for(b=0;b<a;b++)d+="0";return d}function l(a,b,d,e){var f=Math.pow(10,b);if(-1<a.toString().indexOf("e")){var g,k;d=a.toString();f=d.split("e")[0];a=d.split("e")[1];d=f.split(".")[0];g=f.split(".")[1]||"";0<+a?d=d+g+h(a-g.length):(f=0>+d?"-0":"0",0<b&&(f+="."),k=h(-1*a-1),d=(k+Math.abs(d)+g).substr(0,b),d=f+d);0<+a&&0<b&&(d+="."+h(b));b=d;"-"===b.charAt(0)&&0<=+b&&(b=b.substr(1))}else b=(d(a+"e+"+b)/f).toFixed(b);e&&(e=new RegExp("0{1,"+e+"}$"),b=b.replace(e,""));return b}function g(a,b,d,e){var f=d,g=f.indexOf("$"),h=f.indexOf("("),k=f.indexOf("+"),l=f.indexOf("-"),m="",p="";-1===f.indexOf("$")?"infix"===x[E].currency.position?(p=b,x[E].currency.spaceSeparated&&(p=" "+p+" ")):x[E].currency.spaceSeparated&&(m=" "):-1<f.indexOf(" $")?(m=" ",f=f.replace(" $","")):-1<f.indexOf("$ ")?(m=" ",f=f.replace("$ ","")):f=f.replace("$","");a=n(a._value,f,e,p);if(-1===d.indexOf("$"))switch(x[E].currency.position){case "postfix":-1<a.indexOf(")")?(a=a.split(""),a.splice(-1,0,m+b),a=a.join("")):a=a+m+b;break;case "infix":break;case "prefix":-1<a.indexOf("(")||-1<a.indexOf("-")?(a=a.split(""),d=Math.max(h,l)+1,a.splice(d,0,b+m),a=a.join("")):a=b+m+a;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]');}else if(1>=g)if(-1<a.indexOf("(")||-1<a.indexOf("+")||-1<a.indexOf("-")){a=a.split("");d=1;if(g<h||g<k||g<l)d=0;a.splice(d,0,b+m);a=a.join("")}else a=b+m+a;else-1<a.indexOf(")")?(a=a.split(""),a.splice(-1,0,m+b),a=a.join("")):a=a+m+b;return a}function e(a,b,d){var e=b[0],f,g,h,k=Math.abs(a);if(k>=d){for(f=1;f<b.length;++f)if(g=Math.pow(d,f),h=Math.pow(d,f+1),k>=g&&k<h){e=b[f];a/=g;break}e===b[0]&&(a/=Math.pow(d,b.length-1),e=b[b.length-1])}return{value:a,suffix:e}}function n(a,b,f,g){var k=!1,m=!1,n=!1,p="",q,r,t,F,D,v="",u,w="";u=Math.abs(a);var J,y,H,K,B,C="",G=!1,aa=!1,fa;if(0===a&&null!==A)return A;if(!isFinite(a))return""+a;if(0===b.indexOf("{")){B=b.indexOf("}");if(-1===B)throw Error('Format should also contain a "}"');K=b.slice(1,B);b=b.slice(B+1)}else K="";if(b.indexOf("}")===b.length-1&&b.length){fa=b.indexOf("{");if(-1===fa)throw Error('Format should also contain a "{"');B=b.slice(fa+1,-1);b=b.slice(0,fa+1)}else B="";fa=-1===b.indexOf(".")?b.match(/([0-9]+).*/):b.match(/([0-9]+)\..*/);fa=null===fa?-1:fa[1].length;-1!==b.indexOf("-")&&(G=!0);-1<b.indexOf("(")?(k=!0,b=b.slice(1,-1)):-1<b.indexOf("+")&&(m=!0,b=b.replace(/\+/g,""));if(-1<b.indexOf("a")){H=b.split(".")[0].match(/[0-9]+/g)||["0"];H=parseInt(H[0],10);q=0<=b.indexOf("aK");r=0<=b.indexOf("aM");t=0<=b.indexOf("aB");F=0<=b.indexOf("aT");D=q||r||t||F;-1<b.indexOf(" a")?(p=" ",b=b.replace(" a","")):b=b.replace("a","");J=d(a);y=J%3;y=0===y?3:y;H&&0!==u&&(y=3*~~((Math.min(H,J)-y)/3),u/=Math.pow(10,y));if(J!==H)if(u>=Math.pow(10,12)&&!D||F)p+=x[E].abbreviations.trillion,a/=Math.pow(10,12);else if(u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!D||t)p+=x[E].abbreviations.billion,a/=Math.pow(10,9);else if(u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!D||r)p+=x[E].abbreviations.million,a/=Math.pow(10,6);else if(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!D||q)p+=x[E].abbreviations.thousand,a/=Math.pow(10,3);u=d(a);H&&u<H&&-1===b.indexOf(".")&&(b=b+"[.]"+h(H-u))}for(H=0;H<z.length;++H)if(u=z[H],-1<b.indexOf(u.marker)){-1<b.indexOf(" "+u.marker)&&(v=" ");b=b.replace(v+u.marker,"");u=e(a,u.suffixes,u.scale);a=u.value;v+=u.suffix;break}-1<b.indexOf("o")&&(-1<b.indexOf(" o")?(w=" ",b=b.replace(" o","")):b=b.replace("o",""),x[E].ordinal&&(w+=x[E].ordinal(a)));-1<b.indexOf("[.]")&&(n=!0,b=b.replace("[.]","."));H=b.split(".")[1];u=b.indexOf(",");H?(-1!==H.indexOf("*")?(C=a.toString(),H=C.split("."),1<H.length&&(C=l(a,H[1].length,f))):-1<H.indexOf("[")?(H=H.replace("]",""),H=H.split("["),C=l(a,H[0].length+H[1].length,f,H[1].length)):C=l(a,H.length,f),H=C.split("."),f=H[0],C=1<H.length&&H[1].length?(g?p+g:x[E].delimiters.decimal)+H[1]:"",n&&0===Number(C.slice(1))&&(C="")):f=l(a,0,f);-1<f.indexOf("-")&&(f=f.slice(1),aa=!0);f.length<fa&&(f=h(fa-f.length)+f);-1<u&&(f=f.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+x[E].delimiters.thousands));0===b.indexOf(".")&&(f="");n=b.indexOf("(");b=b.indexOf("-");return K+(n<b?(k&&aa?"(":"")+(G&&aa||!k&&aa?"-":""):(G&&aa||!k&&aa?"-":"")+(k&&aa?"(":""))+(!aa&&m&&0!==a?"+":"")+f+C+(w?w:"")+(p&&!g?p:"")+(v?v:"")+(k&&aa?")":"")+B}function m(a){E=a;(a=x[a].defaults)&&a.format&&f.defaultFormat(a.format);a&&a.currencyFormat&&f.defaultCurrencyFormat(a.currencyFormat)}function a(a){a=a.toString().split(".");return 2>a.length?1:Math.pow(10,a[1].length)}function b(){return Array.prototype.slice.call(arguments).reduce(function(b,d){var e=a(b),f=a(d);return e>f?e:f},-Infinity)}var f,t="B KiB MiB GiB TiB PiB EiB ZiB YiB".split(" "),r="B KB MB GB TB PB EB ZB YB".split(" "),v={scale:1024,suffixes:r,marker:"bd"},y={scale:1024,suffixes:t,marker:"b"},w={scale:1E3,suffixes:r,marker:"d"},z=[v,y,w],x={},C=x,E="en-US",A=null,B="0,0",G="0$",D="undefined"!==typeof q&&q.exports;f=function(a){a=f.isNumbro(a)?a.value():"string"===typeof a||"number"===typeof a?f.fn.unformat(a):NaN;return new k(Number(a))};f.version="1.10.1";f.isNumbro=function(a){return a instanceof k};f.setLanguage=function(a,b){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var d=a,e=a.split("-")[0],f=null;C[d]||(Object.keys(C).forEach(function(a){f||a.split("-")[0]!==e||(f=a)}),d=f||b||"en-US");m(d)};f.setCulture=function(a,b){var d=a,e=a.split("-")[1],f=null;x[d]||(e&&Object.keys(x).forEach(function(a){f||a.split("-")[1]!==e||(f=a)}),d=f||b||"en-US");m(d)};f.language=function(a,b){console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead");if(!a)return E;if(a&&!b){if(!C[a])throw Error("Unknown language : "+a);m(a)}if(b||!C[a])x[a]=b;return f};f.culture=function(a,b){if(!a)return E;if(a&&!b){if(!x[a])throw Error("Unknown culture : "+a);m(a)}if(b||!x[a])x[a]=b;return f};f.languageData=function(a){console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead");if(!a)return C[E];if(!C[a])throw Error("Unknown language : "+a);return C[a]};f.cultureData=function(a){if(!a)return x[E];if(!x[a])throw Error("Unknown culture : "+a);return x[a]};f.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}});f.languages=function(){console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead");return C};f.cultures=function(){return x};f.zeroFormat=function(a){A="string"===typeof a?a:null};f.defaultFormat=function(a){B="string"===typeof a?a:"0.0"};f.defaultCurrencyFormat=function(a){G="string"===typeof a?a:"0$"};f.validate=function(a,b){var d,e,g,h,k;"string"!==typeof a&&(a+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",a));a=a.trim();a=a.replace(/^[+-]?/,"");if(a.match(/^\d+$/))return!0;if(""===a)return!1;try{e=f.cultureData(b)}catch(R){e=f.cultureData(f.culture())}g=e.currency.symbol;h=e.abbreviations;d=e.delimiters.decimal;e="."===e.delimiters.thousands?"\\.":e.delimiters.thousands;k=a.match(/^[^\d\.\,]+/);if(null!==k&&(a=a.substr(1),k[0]!==g))return!1;k=a.match(/[^\d]+$/);if(null!==k&&(a=a.slice(0,-1),k[0]!==h.thousand&&k[0]!==h.million&&k[0]!==h.billion&&k[0]!==h.trillion))return!1;g=new RegExp(e+"{2}");return a.match(/[^\d.,]/g)||(d=a.split(d),2<d.length)?!1:2>d.length?!!d[0].match(/^\d+.*\d$/)&&!d[0].match(g):""===d[0]?!d[0].match(g)&&!!d[1].match(/^\d+$/):1===d[0].length?!!d[0].match(/^\d+$/)&&!d[0].match(g)&&!!d[1].match(/^\d+$/):!!d[0].match(/^\d+.*\d$/)&&!d[0].match(g)&&!!d[1].match(/^\d+$/)};f.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");f.loadCulturesInNode()};f.loadCulturesInNode=function(){var a=p("./languages"),b;for(b in a)b&&f.culture(b,a[b])};"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof a)throw new TypeError(a+" is not a function");var d,e,f=this.length>>>0,g=!1;1<arguments.length&&(e=b,g=!0);for(d=0;f>d;++d)this.hasOwnProperty(d)&&(g?e=a(e,this[d],d,this):(e=this[d],g=!0));if(!g)throw new TypeError("Reduce of empty array with no initial value");return e});f.fn=k.prototype={clone:function(){return f(this)},format:function(a,b){var d=a?a:B,e=void 0!==b?b:Math.round,f=d.replace(/\{[^\{\}]*\}/g,"");if(-1<f.indexOf("$"))e=g(this,x[E].currency.symbol,d,e);else if(-1<f.indexOf("%")){var f=d,d="",h=100*this._value;-1<f.indexOf(" %")?(d=" ",f=f.replace(" %","")):f=f.replace("%","");e=n(h,f,e);-1<e.indexOf(")")?(e=e.split(""),e.splice(-1,0,d+"%"),e=e.join("")):e=e+d+"%"}else-1<f.indexOf(":")?(e=Math.floor(this._value/60/60),d=Math.floor((this._value-3600*e)/60),f=Math.round(this._value-3600*e-60*d),e=e+":"+(10>d?"0"+d:d)+":"+(10>f?"0"+f:f)):e=n(this._value,d,e);return e},formatCurrency:function(a,b){return g(this,x[E].currency.symbol,a?a:G,void 0!==b?b:Math.round)},formatForeignCurrency:function(a,b,d){return g(this,a,b?b:G,void 0!==d?d:Math.round)},unformat:function(a){if("number"===typeof a)return a;if("string"===typeof a){var b=a,d,e,f,g,h=!1,k;if(-1<a.indexOf(":"))a=a.split(":"),b=0,3===a.length?(b+=3600*Number(a[0]),b+=60*Number(a[1]),b+=Number(a[2])):2===a.length&&(b+=60*Number(a[0]),b+=Number(a[1])),this._value=Number(b);else if(a===A)this._value=0;else{"."!==x[E].delimiters.decimal&&(a=a.replace(/\./g,"").replace(x[E].delimiters.decimal,"."));d=new RegExp("[^a-zA-Z]"+x[E].abbreviations.thousand+"(?:\\)|(\\"+x[E].currency.symbol+")?(?:\\))?)?$");e=new RegExp("[^a-zA-Z]"+x[E].abbreviations.million+"(?:\\)|(\\"+x[E].currency.symbol+")?(?:\\))?)?$");f=new RegExp("[^a-zA-Z]"+x[E].abbreviations.billion+"(?:\\)|(\\"+x[E].currency.symbol+")?(?:\\))?)?$");g=new RegExp("[^a-zA-Z]"+x[E].abbreviations.trillion+"(?:\\)|(\\"+x[E].currency.symbol+")?(?:\\))?)?$");for(k=1;k<t.length&&!h;++k)-1<a.indexOf(t[k])?h=Math.pow(1024,k):-1<a.indexOf(r[k])&&(h=Math.pow(1E3,k));k=a.replace(/[^0-9\.]+/g,"");""===k?this._value=NaN:(this._value=(h?h:1)*(b.match(d)?Math.pow(10,3):1)*(b.match(e)?Math.pow(10,6):1)*(b.match(f)?Math.pow(10,9):1)*(b.match(g)?Math.pow(10,12):1)*(-1<a.indexOf("%")?.01:1)*((a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1)*Number(k),this._value=h?Math.ceil(this._value):this._value)}a=this._value;return isNaN(a)?void 0:a}},binaryByteUnits:function(){return e(this._value,y.suffixes,y.scale).suffix},byteUnits:function(){return e(this._value,v.suffixes,v.scale).suffix},decimalByteUnits:function(){return e(this._value,w.suffixes,w.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){this._value=Number(a);return this},add:function(a){var d=b.call(null,this._value,a);this._value=[this._value,a].reduce(function(a,b){return a+d*b},0)/d;return this},subtract:function(a){var d=b.call(null,this._value,a);this._value=[a].reduce(function(a,b){return a-d*b},this._value*d)/d;return this},multiply:function(a){this._value=[this._value,a].reduce(function(a,d){var e=b(a,d);return e=a*e*d*e/(e*e)},1);return this},divide:function(a){this._value=[this._value,a].reduce(function(a,d){var e=b(a,d);return a*e/(d*e)});return this},difference:function(a){return Math.abs(f(this._value).subtract(a).value())}};"undefined"!==typeof process&&void 0===process.browser&&process.title&&(-1!==process.title.indexOf("node")||0<process.title.indexOf("meteor-tool")||"grunt"===process.title||"gulp"===process.title)&&"undefined"!==typeof p&&f.loadCulturesInNode();D?q.exports=f:"undefined"===typeof ender&&(this.numbro=f)}).call("undefined"===typeof window?this:window)},{languages:1}],pikaday:[function(p,q,r){(function(k,d){var h;if("object"===typeof r){try{h=p("moment")}catch(l){}q.exports=d(h)}else k.Pikaday=d(k.moment)})(this,function(k){var d="function"===typeof k,h=!!window.addEventListener,l=window.document,g=window.setTimeout,e=function(a,b,d,e){h?a.addEventListener(b,d,!!e):a.attachEvent("on"+b,d)},n=function(a,b,d,e){h?a.removeEventListener(b,d,!!e):a.detachEvent("on"+b,d)},m=function(a,b,d){var e;l.createEvent?(e=l.createEvent("HTMLEvents"),e.initEvent(b,!0,!1),e=y(e,d),a.dispatchEvent(e)):l.createEventObject&&(e=l.createEventObject(),e=y(e,d),a.fireEvent("on"+b,e))},a=function(a,b){return-1!==(" "+a.className+" ").indexOf(" "+b+" ")},b=function(a){return/Array/.test(Object.prototype.toString.call(a))},f=function(a){return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},p=function(a,b){return[31,0===a%4&&0!==a%100||0===a%400?29:28,31,30,31,30,31,31,30,31,30,31][b]},q=function(a){f(a)&&a.setHours(0,0,0,0)},r=function(a,b){return a.getTime()===b.getTime()},y=function(a,d,e){var g,h;for(g in d)if((h=void 0!==a[g])&&"object"===typeof d[g]&&null!==d[g]&&void 0===d[g].nodeName)f(d[g])?e&&(a[g]=new Date(d[g].getTime())):b(d[g])?e&&(a[g]=d[g].slice(0)):a[g]=y({},d[g],e);else if(e||!h)a[g]=d[g];return a},w=function(a){0>a.month&&(a.year-=Math.ceil(Math.abs(a.month)/12),a.month+=12);11<a.month&&(a.year+=Math.floor(Math.abs(a.month)/12),a.month-=12);return a},z={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:"January February March April May June July August September October November December".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" ")},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},x=function(a,b,d){for(b+=a.firstDay;7<=b;)b-=7;return d?a.i18n.weekdaysShort[b]:a.i18n.weekdays[b]},C=function(a){var b=[],d="false";if(a.isEmpty)if(a.showDaysInNextAndPreviousMonths)b.push("is-outside-current-month");else return'\x3ctd class\x3d"is-empty"\x3e\x3c/td\x3e';a.isDisabled&&b.push("is-disabled");a.isToday&&b.push("is-today");a.isSelected&&(b.push("is-selected"),d="true");a.isInRange&&b.push("is-inrange");a.isStartRange&&b.push("is-startrange");a.isEndRange&&b.push("is-endrange");return'\x3ctd data-day\x3d"'+a.day+'" class\x3d"'+b.join(" ")+'" aria-selected\x3d"'+d+'"\x3e\x3cbutton class\x3d"pika-button pika-day" type\x3d"button" data-pika-year\x3d"'+a.year+'" data-pika-month\x3d"'+a.month+'" data-pika-day\x3d"'+a.day+'"\x3e'+a.day+"\x3c/button\x3e\x3c/td\x3e"},E=function(a,b,d){var e=new Date(d,0,1);return'\x3ctd class\x3d"pika-week"\x3e'+Math.ceil(((new Date(d,b,a)-e)/864E5+e.getDay()+1)/7)+"\x3c/td\x3e"},A=function(a,b){return"\x3ctr\x3e"+(b?a.reverse():a).join("")+"\x3c/tr\x3e"},B=function(a,d,e,f,g,h){var k,l,m,n=a._o,p=e===n.minYear,q=e===n.maxYear;h='\x3cdiv id\x3d"'+h+'" class\x3d"pika-title" role\x3d"heading" aria-live\x3d"assertive"\x3e';var r=!0,t=!0;m=[];for(k=0;12>k;k++)m.push('\x3coption value\x3d"'+(e===g?k-d:12+k-d)+'"'+(k===f?' selected\x3d"selected"':"")+(p&&k<n.minMonth||q&&k>n.maxMonth?'disabled\x3d"disabled"':"")+"\x3e"+n.i18n.months[k]+"\x3c/option\x3e");g='\x3cdiv class\x3d"pika-label"\x3e'+n.i18n.months[f]+'\x3cselect class\x3d"pika-select pika-select-month" tabindex\x3d"-1"\x3e'+m.join("")+"\x3c/select\x3e\x3c/div\x3e";b(n.yearRange)?(k=n.yearRange[0],l=n.yearRange[1]+1):(k=e-n.yearRange,l=1+e+n.yearRange);for(m=[];k<l&&k<=n.maxYear;k++)k>=n.minYear&&m.push('\x3coption value\x3d"'+k+'"'+(k===e?' selected\x3d"selected"':"")+"\x3e"+k+"\x3c/option\x3e");e='\x3cdiv class\x3d"pika-label"\x3e'+e+n.yearSuffix+'\x3cselect class\x3d"pika-select pika-select-year" tabindex\x3d"-1"\x3e'+m.join("")+"\x3c/select\x3e\x3c/div\x3e";h=n.showMonthAfterYear?h+(e+g):h+(g+e);p&&(0===f||n.minMonth>=f)&&(r=!1);q&&(11===f||n.maxMonth<=f)&&(t=!1);0===d&&(h+='\x3cbutton class\x3d"pika-prev'+(r?"":" is-disabled")+'" type\x3d"button"\x3e'+n.i18n.previousMonth+"\x3c/button\x3e");d===a._o.numberOfMonths-1&&(h+='\x3cbutton class\x3d"pika-next'+(t?"":" is-disabled")+'" type\x3d"button"\x3e'+n.i18n.nextMonth+"\x3c/button\x3e");return h+"\x3c/div\x3e"},G=function(b){var m=this,n=m.config(b);m._onMouseDown=function(b){if(m._v){b=b||window.event;var d=b.target||b.srcElement;if(d)if(a(d,"is-disabled")||(!a(d,"pika-button")||a(d,"is-empty")||a(d.parentNode,"is-disabled")?a(d,"pika-prev")?m.prevMonth():a(d,"pika-next")&&m.nextMonth():(m.setDate(new Date(d.getAttribute("data-pika-year"),d.getAttribute("data-pika-month"),d.getAttribute("data-pika-day"))),n.bound&&g(function(){m.hide();n.field&&n.field.blur()},100))),a(d,"pika-select"))m._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1}};m._onChange=function(b){b=b||window.event;(b=b.target||b.srcElement)&&(a(b,"pika-select-month")?m.gotoMonth(b.value):a(b,"pika-select-year")&&m.gotoYear(b.value))};m._onKeyChange=function(a){a=a||window.event;if(m.isVisible())switch(a.keyCode){case 13:case 27:n.field.blur();break;case 37:a.preventDefault();m.adjustDate("subtract",1);break;case 38:m.adjustDate("subtract",7);break;case 39:m.adjustDate("add",1);break;case 40:m.adjustDate("add",7)}};m._onInputChange=function(a){a.firedBy!==m&&(a=d?(a=k(n.field.value,n.format,n.formatStrict))&&a.isValid()?a.toDate():null:new Date(Date.parse(n.field.value)),f(a)&&m.setDate(a),m._v||m.show())};m._onInputFocus=function(){m.show()};m._onInputClick=function(){m.show()};m._onInputBlur=function(){var b=l.activeElement;do if(a(b,"pika-single"))return;while(b=b.parentNode);m._c||(m._b=g(function(){m.hide()},50));m._c=!1};m._onClick=function(b){b=b||window.event;var d=b=b.target||b.srcElement;if(b){h||!a(b,"pika-select")||b.onchange||(b.setAttribute("onchange","return;"),e(b,"change",m._onChange));do if(a(d,"pika-single")||d===n.trigger)return;while(d=d.parentNode);m._v&&b!==n.trigger&&d!==n.trigger&&m.hide()}};m.el=l.createElement("div");m.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:"");e(m.el,"mousedown",m._onMouseDown,!0);e(m.el,"touchend",m._onMouseDown,!0);e(m.el,"change",m._onChange);e(l,"keydown",m._onKeyChange);n.field&&(n.container?n.container.appendChild(m.el):n.bound?l.body.appendChild(m.el):n.field.parentNode.insertBefore(m.el,n.field.nextSibling),e(n.field,"change",m._onInputChange),n.defaultDate||(n.defaultDate=d&&n.field.value?k(n.field.value,n.format).toDate():new Date(Date.parse(n.field.value)),n.setDefaultDate=!0));b=n.defaultDate;f(b)?n.setDefaultDate?m.setDate(b,!0):m.gotoDate(b):m.gotoDate(new Date);n.bound?(this.hide(),m.el.className+=" is-bound",e(n.trigger,"click",m._onInputClick),e(n.trigger,"focus",m._onInputFocus),e(n.trigger,"blur",m._onInputBlur)):this.show()};G.prototype={config:function(a){this._o||(this._o=y({},z,!0));a=y(this._o,a,!0);a.isRTL=!!a.isRTL;a.field=a.field&&a.field.nodeName?a.field:null;a.theme="string"===typeof a.theme&&a.theme?a.theme:null;a.bound=!!(void 0!==a.bound?a.field&&a.bound:a.field);a.trigger=a.trigger&&a.trigger.nodeName?a.trigger:a.field;a.disableWeekends=!!a.disableWeekends;a.disableDayFn="function"===typeof a.disableDayFn?a.disableDayFn:null;var d=parseInt(a.numberOfMonths,10)||1;a.numberOfMonths=4<d?4:d;f(a.minDate)||(a.minDate=!1);f(a.maxDate)||(a.maxDate=!1);a.minDate&&a.maxDate&&a.maxDate<a.minDate&&(a.maxDate=a.minDate=!1);a.minDate&&this.setMinDate(a.minDate);a.maxDate&&this.setMaxDate(a.maxDate);b(a.yearRange)?(d=(new Date).getFullYear()-10,a.yearRange[0]=parseInt(a.yearRange[0],10)||d,a.yearRange[1]=parseInt(a.yearRange[1],10)||d):(a.yearRange=Math.abs(parseInt(a.yearRange,10))||z.yearRange,100<a.yearRange&&(a.yearRange=100));return a},toString:function(a){return f(this._d)?d?k(this._d).format(a||this._o.format):this._d.toDateString():""},getMoment:function(){return d?k(this._d):null},setMoment:function(a,b){d&&k.isMoment(a)&&this.setDate(a.toDate(),b)},getDate:function(){return f(this._d)?new Date(this._d.getTime()):new Date},setDate:function(a,b){if(!a)return this._d=null,this._o.field&&(this._o.field.value="",m(this._o.field,"change",{firedBy:this})),this.draw();"string"===typeof a&&(a=new Date(Date.parse(a)));if(f(a)){var d=this._o.minDate,e=this._o.maxDate;f(d)&&a<d?a=d:f(e)&&a>e&&(a=e);this._d=new Date(a.getTime());q(this._d);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString(),m(this._o.field,"change",{firedBy:this}));b||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(a){var b=!0;if(f(a)){if(this.calendars){var b=new Date(this.calendars[0].year,this.calendars[0].month,1),d=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),e=a.getTime();d.setMonth(d.getMonth()+1);d.setDate(d.getDate()-1);b=e<b.getTime()||d.getTime()<e}b&&(this.calendars=[{month:a.getMonth(),year:a.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths));this.adjustCalendars()}},adjustDate:function(a,b){var e=this.getDate(),f=864E5*parseInt(b),g;"add"===a?g=new Date(e.valueOf()+f):"subtract"===a&&(g=new Date(e.valueOf()-f));d&&("add"===a?g=k(e).add(b,"days").toDate():"subtract"===a&&(g=k(e).subtract(b,"days").toDate()));this.setDate(g)},adjustCalendars:function(){this.calendars[0]=w(this.calendars[0]);for(var a=1;a<this._o.numberOfMonths;a++)this.calendars[a]=w({month:this.calendars[0].month+a,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(a){isNaN(a)||(this.calendars[0].month=parseInt(a,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(a){isNaN(a)||(this.calendars[0].year=parseInt(a,10),this.adjustCalendars())},setMinDate:function(a){a instanceof Date?(q(a),this._o.minDate=a,this._o.minYear=a.getFullYear(),this._o.minMonth=a.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange);this.draw()},setMaxDate:function(a){a instanceof Date?(q(a),this._o.maxDate=a,this._o.maxYear=a.getFullYear(),this._o.maxMonth=a.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange);this.draw()},setStartRange:function(a){this._o.startRange=a},setEndRange:function(a){this._o.endRange=a},draw:function(a){if(this._v||a){var b=this._o,d=b.minYear,e=b.maxYear,f=b.minMonth,h=b.maxMonth;a="";this._y<=d&&(this._y=d,!isNaN(f)&&this._m<f&&(this._m=f));this._y>=e&&(this._y=e,!isNaN(h)&&this._m>h&&(this._m=h));d="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(e=0;e<b.numberOfMonths;e++)a+='\x3cdiv class\x3d"pika-lendar"\x3e'+B(this,e,this.calendars[e].year,this.calendars[e].month,this.calendars[0].year,d)+this.render(this.calendars[e].year,this.calendars[e].month,d)+"\x3c/div\x3e";this.el.innerHTML=a;b.bound&&"hidden"!==b.field.type&&g(function(){b.trigger.focus()},1);if("function"===typeof this._o.onDraw)this._o.onDraw(this);b.bound&&b.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var a,b,d,e,f,g,h,k,m;if(!this._o.container){this.el.style.position="absolute";b=a=this._o.trigger;d=this.el.offsetWidth;e=this.el.offsetHeight;f=window.innerWidth||l.documentElement.clientWidth;g=window.innerHeight||l.documentElement.clientHeight;h=window.pageYOffset||l.body.scrollTop||l.documentElement.scrollTop;if("function"===typeof a.getBoundingClientRect)b=a.getBoundingClientRect(),k=b.left+window.pageXOffset,m=b.bottom+window.pageYOffset;else for(k=b.offsetLeft,m=b.offsetTop+b.offsetHeight;b=b.offsetParent;)k+=b.offsetLeft,m+=b.offsetTop;if(this._o.reposition&&k+d>f||-1<this._o.position.indexOf("right")&&0<k-d+a.offsetWidth)k=k-d+a.offsetWidth;if(this._o.reposition&&m+e>g+h||-1<this._o.position.indexOf("top")&&0<m-e-a.offsetHeight)m=m-e-a.offsetHeight;this.el.style.left=k+"px";this.el.style.top=m+"px"}},render:function(a,b,d){var e=this._o,g=new Date,h=p(a,b),k=(new Date(a,b,1)).getDay(),l=[],m=[];q(g);0<e.firstDay&&(k-=e.firstDay,0>k&&(k+=7));for(var n=0===b?11:b-1,t=11===b?0:b+1,u=0===b?a-1:a,v=11===b?a+1:a,w=p(u,n),y=h+k,z=y;7<z;)z-=7;for(var y=y+(7-z),D=z=0;z<y;z++){var B=new Date(a,b,1+(z-k)),F=f(this._d)?r(B,this._d):!1,G=r(B,g),H=z<k||z>=h+k,ra=1+(z-k),ia=b,la=a,aa=e.startRange&&r(e.startRange,B),fa=e.endRange&&r(e.endRange,B),pa=e.startRange&&e.endRange&&e.startRange<B&&B<e.endRange,ha;!(ha=e.minDate&&B<e.minDate||e.maxDate&&B>e.maxDate)&&(ha=e.disableWeekends)&&(ha=B.getDay(),ha=0===ha||6===ha);B=ha||e.disableDayFn&&e.disableDayFn(B);H&&(z<k?(ra=w+ra,ia=n,la=u):(ra-=h,ia=t,la=v));m.push(C({day:ra,month:ia,year:la,isSelected:F,isToday:G,isDisabled:B,isEmpty:H,isStartRange:aa,isEndRange:fa,isInRange:pa,showDaysInNextAndPreviousMonths:e.showDaysInNextAndPreviousMonths}));7===++D&&(e.showWeekNumber&&m.unshift(E(z-k,b,a)),l.push(A(m,e.isRTL)),m=[],D=0)}b=[];e.showWeekNumber&&b.push("\x3cth\x3e\x3c/th\x3e");for(a=0;7>a;a++)b.push('\x3cth scope\x3d"col"\x3e\x3cabbr title\x3d"'+x(e,a)+'"\x3e'+x(e,a,!0)+"\x3c/abbr\x3e\x3c/th\x3e");e="\x3cthead\x3e\x3ctr\x3e"+(e.isRTL?b.reverse():b).join("")+"\x3c/tr\x3e\x3c/thead\x3e";return'\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"pika-table" role\x3d"grid" aria-labelledby\x3d"'+d+'"\x3e'+e+("\x3ctbody\x3e"+l.join("")+"\x3c/tbody\x3e")+"\x3c/table\x3e"},isVisible:function(){return this._v},show:function(){if(!this.isVisible()){var a=this.el,b;b=(" "+a.className+" ").replace(" is-hidden "," ");b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");a.className=b;this._v=!0;this.draw();this._o.bound&&(e(l,"click",this._onClick),this.adjustPosition());"function"===typeof this._o.onOpen&&this._o.onOpen.call(this)}},hide:function(){var b=this._v;if(!1!==b){this._o.bound&&n(l,"click",this._onClick);this.el.style.position="static";this.el.style.left="auto";this.el.style.top="auto";var d=this.el;a(d,"is-hidden")||(d.className=""===d.className?"is-hidden":d.className+" is-hidden");this._v=!1;void 0!==b&&"function"===typeof this._o.onClose&&this._o.onClose.call(this)}},destroy:function(){this.hide();n(this.el,"mousedown",this._onMouseDown,!0);n(this.el,"touchend",this._onMouseDown,!0);n(this.el,"change",this._onChange);this._o.field&&(n(this._o.field,"change",this._onInputChange),this._o.bound&&(n(this._o.trigger,"click",this._onInputClick),n(this._o.trigger,"focus",this._onInputFocus),n(this._o.trigger,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};return G})},{moment:"moment"}],zeroclipboard:[function(p,q,r){(function(k,d){var h=k.document,l=k.navigator,g=k.setTimeout,e=k.clearTimeout,n=k.setInterval,m=k.clearInterval,a=k.getComputedStyle,b=k.encodeURIComponent,f=k.ActiveXObject,p=k.Error,r=k.Number.parseInt||k.parseInt,v=k.Number.parseFloat||k.parseFloat,y=k.Number.isNaN||k.isNaN,w=k.Date.now,z=k.Object.keys,x=k.Object.prototype.hasOwnProperty,C=k.Array.prototype.slice,E=function(){var a=function(a){return a};if("function"===typeof k.wrap&&"function"===typeof k.unwrap)try{var b=h.createElement("div"),d=k.unwrap(b);1===b.nodeType&&d&&1===d.nodeType&&(a=k.unwrap)}catch(lb){}return a}(),A=function(a){return C.call(a,0)},B=function(){var a,b,e,f,g,h=A(arguments),k=h[0]||{};a=1;for(b=h.length;a<b;a++)if(null!=(e=h[a]))for(f in e)x.call(e,f)&&(g=e[f],k!==g&&g!==d&&(k[f]=g));return k},G=function(a){var b,d,e;if("object"!==typeof a||null==a||"number"===typeof a.nodeType)b=a;else if("number"===typeof a.length)for(b=[],d=0,e=a.length;d<e;d++)x.call(a,d)&&(b[d]=G(a[d]));else for(d in b={},a)x.call(a,d)&&(b[d]=G(a[d]));return b},D=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument)){do{if(a===b)return!0;a=a.parentNode}while(a)}return!1},F=function(a){var b;"string"===typeof a&&a&&(a.split("#")[0].split("?"),b=a.slice(0,a.lastIndexOf("/")+1));return b},H=function(){var a,b,e;if(h.currentScript&&(a=h.currentScript.src))return a;b=h.getElementsByTagName("script");if(1===b.length)return b[0].src||d;if("readyState"in(b[0]||document.createElement("script")))for(e=b.length;e--;)if("interactive"===b[e].readyState&&(a=b[e].src))return a;if("loading"===h.readyState&&(a=b[b.length-1].src))return a;var f;try{throw new p;}catch(Ka){b=Ka}if(b&&!(f=b.sourceURL||b.fileName)){f=b.stack;var g;"string"===typeof f&&f&&((b=f.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&b[1]?g=b[1]:(b=f.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&b[1]&&(g=b[1]));f=g}return(a=f)?a:d},J=null==k.opener&&(!!k.top&&k!=k.top||!!k.parent&&k!=k.parent),K="html"===h.documentElement.nodeName,I={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},O,Q={},R,M,S={},U=null,V=0,ga=0,P={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}},ua="flash-unavailable flash-degraded flash-overdue version-mismatch config-mismatch clipboard-error".split(" "),Z="flash-sandboxed flash-disabled flash-outdated flash-insecure flash-unavailable flash-degraded flash-deactivated flash-overdue".split(" "),oa=new RegExp("^flash-("+Z.map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),W=new RegExp("^flash-("+Z.filter(function(a){return"flash-disabled"!==a}).map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),T={swfPath:function(){var a;if(!(a=F(H()))){var b,e,f=h.getElementsByTagName("script");for(a=f.length;a--;){if(!(e=f[a].src)){b=null;break}e=F(e);if(null==b)b=e;else if(b!==e){b=null;break}}a=b||d}return(a||"")+"ZeroClipboard.swf"}(),trustedDomains:k.location.host?[k.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3E4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},wa=function(a){"object"!==typeof a||!a||"length"in a||z(a).forEach(function(b){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(b))T[b]=a[b];else if(null==I.bridge)if("containerId"===b||"swfObjectId"===b){var d=a[b];if("string"===typeof d&&d&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(d))T[b]=a[b];else throw Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");}else T[b]=a[b]});if("string"===typeof a&&a){if(x.call(T,a))return T[a]}else return G(T)},ra=function(){Oa();for(var a=["userAgent","platform","appName","appVersion"],b={},d=0,e=a.length;d<e;d++)a[d]in l&&(b[a[d]]=l[a[d]]);var a=B(b,{isSupported:ia()}),b=["bridge"],d={},f;for(f in I)-1===b.indexOf(f)&&(d[f]=I[f]);return{browser:a,flash:d,zeroclipboard:{version:L.version,config:L.config()}}},ia=function(){return!!(h.addEventListener&&k.Object.keys&&k.Array.prototype.map)},la=function(){return!!(I.sandboxed||I.disabled||I.outdated||I.unavailable||I.degraded||I.deactivated)},aa=function(a,b){var e,f,g,h={};"string"===typeof a&&a?g=a.toLowerCase().split(/\s+/):"object"!==typeof a||!a||"length"in a||"undefined"!==typeof b||z(a).forEach(function(b){var d=a[b];if("function"===typeof d)L.on(b,d)});if(g&&g.length&&b){e=0;for(f=g.length;e<f;e++)a=g[e].replace(/^on/,""),h[a]=!0,Q[a]||(Q[a]=[]),Q[a].push(b);h.ready&&I.ready&&L.emit({type:"ready"});if(h.error){ia()||L.emit({type:"error",name:"browser-unsupported"});e=0;for(f=Z.length;e<f;e++)if(!0===I[Z[e].replace(/^flash-/,"")]){L.emit({type:"error",name:Z[e]});break}O!==d&&L.version!==O&&L.emit({type:"error",name:"version-mismatch",jsVersion:L.version,swfVersion:O})}}return L},fa=function(a,b){var d,e,f,g,h;0===arguments.length?g=z(Q):"string"===typeof a&&a?g=a.toLowerCase().split(/\s+/):"object"!==typeof a||!a||"length"in a||"undefined"!==typeof b||z(a).forEach(function(b){var d=a[b];"function"===typeof d&&L.off(b,d)});if(g&&g.length)for(d=0,e=g.length;d<e;d++)if(a=g[d].replace(/^on/,""),(h=Q[a])&&h.length)if(b)for(f=h.indexOf(b);-1!==f;)h.splice(f,1),f=h.indexOf(b,f);else h.length=0;return L},pa=function(a){return"string"===typeof a&&a?G(Q[a])||null:G(Q)},ha=function(a){var b,d;if(a=fb(a)){var e;e=a;var f=e.target||R||null,g="swf"===e._source;delete e._source;switch(e.type){case "error":!(f="flash-sandboxed"===e.name)&&(f=null,!1===J||e&&"error"===e.type&&e.name&&-1!==ua.indexOf(e.name))&&(f=!1);"boolean"===typeof f&&(I.sandboxed=f);"browser-unsupported"===e.name?B(I,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):-1!==Z.indexOf(e.name)?B(I,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,insecure:"flash-insecure"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(O=e.swfVersion,B(I,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}));Ya();break;case "ready":O=e.swfVersion;f=!0===I.deactivated;B(I,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:f,ready:!f});Ya();break;case "beforecopy":M=f;break;case "copy":var l,m,f=e.relatedTarget;!S["text/html"]&&!S["text/plain"]&&f&&(m=f.value||f.outerHTML||f.innerHTML)&&(l=f.value||f.textContent||f.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l),m!==l&&e.clipboardData.setData("text/html",m)):!S["text/plain"]&&e.target&&(l=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l));break;case "aftercopy":Fa(e);L.clearData();if(l=f){var n;try{n=h.activeElement}catch(Bb){n=null}l=f!==n}l&&f.focus&&f.focus();break;case "_mouseover":L.focus(f);!0===T.bubbleEvents&&g&&(f&&f!==e.relatedTarget&&!D(e.relatedTarget,f)&&ya(B({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),ya(B({},e,{type:"mouseover"})));break;case "_mouseout":L.blur();!0===T.bubbleEvents&&g&&(f&&f!==e.relatedTarget&&!D(e.relatedTarget,f)&&ya(B({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),ya(B({},e,{type:"mouseout"})));break;case "_mousedown":ib(f,T.activeClass);!0===T.bubbleEvents&&g&&ya(B({},e,{type:e.type.slice(1)}));break;case "_mouseup":Wa(f,T.activeClass);!0===T.bubbleEvents&&g&&ya(B({},e,{type:e.type.slice(1)}));break;case "_click":M=null;!0===T.bubbleEvents&&g&&ya(B({},e,{type:e.type.slice(1)}));break;case "_mousemove":!0===T.bubbleEvents&&g&&ya(B({},e,{type:e.type.slice(1)}))}e=/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0;if(!e){if("ready"===a.type&&!0===I.overdue)return L.emit({type:"error",name:"flash-overdue"});e=B({},a);if("object"===typeof e&&e&&e.type&&(f=Ia(e),(l=(Q["*"]||[]).concat(Q[e.type]||[]))&&l.length)){var p,q;m=0;for(n=l.length;m<n;m++)g=l[m],p=this,"string"===typeof g&&"function"===typeof k[g]&&(g=k[g]),"object"===typeof g&&g&&"function"===typeof g.handleEvent&&(p=g,g=g.handleEvent),"function"===typeof g&&(q=B({},e),$a(g,p,[q],f))}if("copy"===a.type){b={};a={};if("object"===typeof S&&S){for(d in S)if(d&&x.call(S,d)&&"string"===typeof S[d]&&S[d])switch(d.toLowerCase()){case "text/plain":case "text":case "air:text":case "flash:text":b.text=S[d];a.text=d;break;case "text/html":case "html":case "air:html":case "flash:html":b.html=S[d];a.html=d;break;case "application/rtf":case "text/rtf":case "rtf":case "richtext":case "air:rtf":case "flash:rtf":b.rtf=S[d],a.rtf=d}d={data:b,formatMap:a}}else d=void 0;b=d.data;U=d.formatMap}return b}}},xa=function(){var a=T.swfPath||"",b=a.slice(0,2),a=a.slice(0,a.indexOf("://")+1);return"\\\\"===b?"file:":"//"===b||""===a?k.location.protocol:a},sa=function(){var a;a=I.sandboxed;ia()?(Oa(),"boolean"!==typeof I.ready&&(I.ready=!1),I.sandboxed!==a&&!0===I.sandboxed?(I.ready=!1,L.emit({type:"error",name:"flash-sandboxed"})):L.isFlashUnusable()||null!==I.bridge||((a=xa())&&a!==k.location.protocol?L.emit({type:"error",name:"flash-insecure"}):(a=T.flashLoadTimeout,"number"===typeof a&&0<=a&&(V=g(function(){"boolean"!==typeof I.deactivated&&(I.deactivated=!0);!0===I.deactivated&&L.emit({type:"error",name:"flash-deactivated"})},a)),I.overdue=!1,Pa()))):(I.ready=!1,L.emit({type:"error",name:"browser-unsupported"}))},ja=function(){L.clearData();L.blur();L.emit("destroy");hb();L.off()},Aa=function(a,b){var d;if("object"===typeof a&&a&&"undefined"===typeof b)d=a,L.clearData();else if("string"===typeof a&&a)d={},d[a]=b;else return;for(var e in d)if("string"===typeof e&&e&&x.call(d,e)&&"string"===typeof d[e]&&d[e]){var f=e,g=d[e],h=/(\r\n|\r|\n)/g;if("string"===typeof g&&!0===T.fixLineEndings){var k=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;l&&(k.test(l.appVersion||"")||k.test(l.platform||"")||-1!==(l.userAgent||"").indexOf("Windows"))?/((^|[^\r])\n|\r([^\n]|$))/.test(g)&&(g=g.replace(h,"\r\n")):/\r/.test(g)&&(g=g.replace(h,"\n"))}S[f]=g}},ta=function(a){if("undefined"===typeof a){if(S)for(var b in S)x.call(S,b)&&delete S[b];U=null}else"string"===typeof a&&x.call(S,a)&&delete S[a]},X=function(a){if("undefined"===typeof a)return G(S);if("string"===typeof a&&x.call(S,a))return S[a]},Da=function(a){if(a&&1===a.nodeType){R&&(Wa(R,T.activeClass),R!==a&&Wa(R,T.hoverClass));R=a;ib(a,T.hoverClass);var b=a.getAttribute("title")||T.title;if("string"===typeof b&&b){var d=Ra(I.bridge);d&&d.setAttribute("title",b)}a=!0===T.forceHandCursor||"pointer"===jb(a,"cursor");!0===I.ready&&(I.bridge&&"function"===typeof I.bridge.setHandCursor?I.bridge.setHandCursor(a):I.ready=!1);var e;R&&(e=Ra(I.bridge))&&(a=ba(R),B(e.style,{width:a.width+"px",height:a.height+"px",top:a.top+"px",left:a.left+"px",zIndex:""+mb(T.zIndex)}))}},Ea=function(){var a=Ra(I.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px");R&&(Wa(R,T.hoverClass),Wa(R,T.activeClass),R=null)},Sa=function(){return R||null},fb=function(a){var b;"string"===typeof a&&a?(b=a,a={}):"object"===typeof a&&a&&"string"===typeof a.type&&a.type&&(b=a.type);if(b){b=b.toLowerCase();!a.target&&(/^(copy|aftercopy|_click)$/.test(b)||"error"===b&&"clipboard-error"===a.name)&&(a.target=M);B(a,{type:b,target:a.target||R||null,relatedTarget:a.relatedTarget||null,currentTarget:I&&I.bridge||null,timeStamp:a.timeStamp||w()||null});b=P[a.type];"error"===a.type&&a.name&&b&&(b=b[a.name]);b&&(a.message=b);"ready"===a.type&&B(a,{target:null,version:I.version});"error"===a.type&&(oa.test(a.name)&&B(a,{target:null,minimumVersion:"11.0.0"}),W.test(a.name)&&B(a,{version:I.version}),"flash-insecure"===a.name&&B(a,{pageProtocol:k.location.protocol,swfProtocol:xa()}));"copy"===a.type&&(a.clipboardData={setData:L.setData,clearData:L.clearData});if("aftercopy"===a.type&&(b=U,"object"===typeof a&&a&&"object"===typeof b&&b)){var e={},f;for(f in a)if(x.call(a,f))if("errors"===f){e[f]=a[f]?a[f].slice():[];for(var g=0,l=e[f].length;g<l;g++)e[f][g].format=b[e[f][g].format]}else if("success"!==f&&"data"!==f)e[f]=a[f];else{e[f]={};var g=a[f],m;for(m in g)m&&x.call(g,m)&&x.call(b,m)&&(e[f][b[m]]=g[m])}a=e}a.target&&!a.relatedTarget&&(f=a,m=(m=(m=a.target)&&m.getAttribute&&m.getAttribute("data-clipboard-target"))?h.getElementById(m):null,f.relatedTarget=m);if((f=a)&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(f.type)){m=f.target;a="_mouseover"===f.type&&f.relatedTarget?f.relatedTarget:d;b="_mouseout"===f.type&&f.relatedTarget?f.relatedTarget:d;var g=ba(m),e=g.left+("number"===typeof f._stageX?f._stageX:0),g=g.top+("number"===typeof f._stageY?f._stageY:0),l=e-(h.body.scrollLeft+h.documentElement.scrollLeft),n=g-(h.body.scrollTop+h.documentElement.scrollTop),p=(k.screenLeft||k.screenX||0)+l,q=(k.screenTop||k.screenY||0)+n,r="number"===typeof f.movementX?f.movementX:0,t="number"===typeof f.movementY?f.movementY:0;delete f._stageX;delete f._stageY;B(f,{srcElement:m,fromElement:a,toElement:b,screenX:p,screenY:q,pageX:e,pageY:g,clientX:l,clientY:n,x:l,y:n,movementX:r,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return f}},Ia=function(a){return!/^(?:(?:before)?copy|destroy)$/.test(a&&"string"===typeof a.type&&a.type||"")},$a=function(a,b,d,e){e?g(function(){a.apply(b,d)},0):a.apply(b,d)},Fa=function(a){if(a.errors&&0<a.errors.length){var b=G(a);B(b,{type:"error",name:"clipboard-error"});delete b.success;g(function(){L.emit(b)},0)}},ya=function(a){if(a&&"string"===typeof a.type&&a){var b,d=a.target||null;b=d&&d.ownerDocument||h;a=B({view:b.defaultView||k,canBubble:!0,cancelable:!0,detail:"click"===a.type?1:0,button:"number"===typeof a.which?a.which-1:"number"===typeof a.button?a.button:b.createEvent?0:1},a);d&&b.createEvent&&d.dispatchEvent&&(a=[a.type,a.canBubble,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget],b=b.createEvent("MouseEvents"),b.initMouseEvent&&(b.initMouseEvent.apply(b,a),b._source="js",d.dispatchEvent(b)))}},tb=function(){var b=T.flashLoadTimeout;if("number"===typeof b&&0<=b){var d=T.swfObjectId+"_fallbackContent";ga=n(function(){var b;var e=h.getElementById(d);if(e)if(b=a(e,null)){var f=0<v(b.height),g=0<v(b.width),k=0<=v(b.top),l=0<=v(b.left),m=f&&g&&k&&l,e=m?null:ba(e);b="none"!==b.display&&"collapse"!==b.visibility&&(m||!!e&&(f||0<e.height)&&(g||0<e.width)&&(k||0<=e.top)&&(l||0<=e.left))}else b=!1;else b=!1;b&&(Ya(),I.deactivated=null,L.emit({type:"error",name:"swf-not-found"}))},Math.min(1E3,b/10))}},Ra=function(a){for(a=a&&a.parentNode;a&&"OBJECT"===a.nodeName&&a.parentNode;)a=a.parentNode;return a||null},Lb=function(a){return"string"===typeof a&&a?a.replace(/["&'<>]/g,function(a){switch(a){case '"':return"\x26quot;";case "\x26":return"\x26amp;";case "'":return"\x26apos;";case "\x3c":return"\x26lt;";case "\x3e":return"\x26gt;";default:return a}}):a},Pa=function(){var a,d=I.bridge,e=Ra(d);if(!d){var d=Mb(k.location.host,T),f="never"===d?"none":"all",g,e=B({jsVersion:L.version},T),l,m,n,p="",q=[];e.trustedDomains&&("string"===typeof e.trustedDomains?g=[e.trustedDomains]:"object"===typeof e.trustedDomains&&"length"in e.trustedDomains&&(g=e.trustedDomains));if(g&&g.length)for(l=0,m=g.length;l<m;l++)if(x.call(g,l)&&g[l]&&"string"===typeof g[l]&&(n=Qa(g[l]))){if("*"===n){q.length=0;q.push(n);break}q.push.apply(q,[n,"//"+n,k.location.protocol+"//"+n])}q.length&&(p+="trustedOrigins\x3d"+b(q.join(",")));!0===e.forceEnhancedClipboard&&(p+=(p?"\x26":"")+"forceEnhancedClipboard\x3dtrue");"string"===typeof e.swfObjectId&&e.swfObjectId&&(p+=(p?"\x26":"")+"swfObjectId\x3d"+b(e.swfObjectId));"string"===typeof e.jsVersion&&e.jsVersion&&(p+=(p?"\x26":"")+"jsVersion\x3d"+b(e.jsVersion));g=p;e=T.swfPath;l=null==T||T&&!0===T.cacheBust?(-1===T.swfPath.indexOf("?")?"?":"\x26")+"noCache\x3d"+w():"";l=e+l;K&&(l=Lb(l));e=h.createElement("div");e.id=T.containerId;e.className=T.containerClass;e.style.position="absolute";e.style.left="0px";e.style.top="-9999px";e.style.width="1px";e.style.height="1px";e.style.zIndex=""+mb(T.zIndex);m=h.createElement("div");e.appendChild(m);h.body.appendChild(e);n=h.createElement("div");p="activex"===I.pluginType;n.innerHTML='\x3cobject id\x3d"'+T.swfObjectId+'" name\x3d"'+T.swfObjectId+'" width\x3d"100%" height\x3d"100%" '+(p?'classid\x3d"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type\x3d"application/x-shockwave-flash" data\x3d"'+l+'"')+"\x3e"+(p?'\x3cparam name\x3d"movie" value\x3d"'+l+'"/\x3e':"")+'\x3cparam name\x3d"allowScriptAccess" value\x3d"'+d+'"/\x3e\x3cparam name\x3d"allowNetworking" value\x3d"'+f+'"/\x3e\x3cparam name\x3d"menu" value\x3d"false"/\x3e\x3cparam name\x3d"wmode" value\x3d"transparent"/\x3e\x3cparam name\x3d"flashvars" value\x3d"'+g+'"/\x3e\x3cdiv id\x3d"'+T.swfObjectId+'_fallbackContent"\x3e\x26nbsp;\x3c/div\x3e\x3c/object\x3e';d=n.firstChild;E(d).ZeroClipboard=L;e.replaceChild(d,m);tb()}d||((d=h[T.swfObjectId])&&(a=d.length)&&(d=d[a-1]),!d&&e&&(d=e.firstChild));I.bridge=d||null;return d},hb=function(){var a=I.bridge;if(a){var b=Ra(a);b&&("activex"===I.pluginType&&"readyState"in a?(a.style.display="none",function lb(){if(4===a.readyState){for(var d in a)"function"===typeof a[d]&&(a[d]=null);a.parentNode&&a.parentNode.removeChild(a);b.parentNode&&b.parentNode.removeChild(b)}else g(lb,10)}()):(a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b)));Ya();I.ready=null;I.bridge=null;I.deactivated=null;I.insecure=null;O=d}},Qa=function(a){if(null==a||""===a)return null;a=a.replace(/^\s+|\s+$/g,"");if(""===a)return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var d=a.indexOf("/");return(a=-1===d?a:-1===b||0===d?null:a.slice(0,d))&&".swf"===a.slice(-4).toLowerCase()?null:a||null},Mb=function(){return function(a,b){var d=Qa(b.swfPath);null===d&&(d=a);var e=b.trustedDomains,f,g,h,k=[];"string"===typeof e&&(e=[e]);if("object"===typeof e&&e&&"number"===typeof e.length)for(f=0,g=e.length;f<g;f++)if(x.call(e,f)&&(h=Qa(e[f]))){if("*"===h){k.length=0;k.push("*");break}-1===k.indexOf(h)&&k.push(h)}e=k.length;if(0<e){if(1===e&&"*"===k[0])return"always";if(-1!==k.indexOf(a))return 1===e&&a===d?"sameDomain":"always"}return"never"}}(),ib=function(a,b){var d,e,f,g=[];"string"===typeof b&&b&&(g=b.split(/\s+/));if(a&&1===a.nodeType&&0<g.length){f=(" "+(a.className||"")+" ").replace(/[\t\r\n\f]/g," ");d=0;for(e=g.length;d<e;d++)-1===f.indexOf(" "+g[d]+" ")&&(f+=g[d]+" ");f=f.replace(/^\s+|\s+$/g,"");f!==a.className&&(a.className=f)}return a},Wa=function(a,b){var d,e,f,g=[];"string"===typeof b&&b&&(g=b.split(/\s+/));if(a&&1===a.nodeType&&0<g.length&&a.className){f=(" "+a.className+" ").replace(/[\t\r\n\f]/g," ");d=0;for(e=g.length;d<e;d++)f=f.replace(" "+g[d]+" "," ");f=f.replace(/^\s+|\s+$/g,"");f!==a.className&&(a.className=f)}return a},jb=function(b,d){var e=a(b,null).getPropertyValue(d);return"cursor"!==d||e&&"auto"!==e||"A"!==b.nodeName?e:"pointer"},ba=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){a=a.getBoundingClientRect();var d=k.pageXOffset,e=k.pageYOffset,f=h.documentElement.clientLeft||0,g=h.documentElement.clientTop||0,l=0,m=0;if("relative"===jb(h.body,"position"))var m=h.body.getBoundingClientRect(),n=h.documentElement.getBoundingClientRect(),l=m.left-n.left||0,m=m.top-n.top||0;b.left=a.left+d-f-l;b.top=a.top+e-g-m;b.width="width"in a?a.width:a.right-a.left;b.height="height"in a?a.height:a.bottom-a.top}return b},Ya=function(){e(V);V=0;m(ga);ga=0},mb=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;"number"!==typeof a||y(a)?"string"===typeof a&&(b=mb(r(a,10))):b=a;return"number"===typeof b?b:"auto"},Oa=function(a){var b,d,e,g=I.sandboxed,h=null;a=!0===a;if(!1===J)h=!1;else{try{d=k.frameElement||null}catch(db){e={name:db.name,message:db.message}}if(d&&1===d.nodeType&&"IFRAME"===d.nodeName)try{h=d.hasAttribute("sandbox")}catch(db){h=null}else{try{b=document.domain||null}catch(db){b=null}if(null===b||e&&"SecurityError"===e.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase()))h=!0}}I.sandboxed=h;g===h||a||ab(f);return h},ab=function(a){function b(a){a=a.match(/[\d]+/g);a.length=3;return a.join(".")}function d(a){a&&(f=!0,a.version&&(k=b(a.version)),!k&&a.description&&(k=b(a.description)),a.filename&&(a=a.filename,h=!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||"chrome.plugin"===a.slice(-13))))}var e,f=!1,g=!1,h=!1,k="";if(l.plugins&&l.plugins.length)a=l.plugins["Shockwave Flash"],d(a),l.plugins["Shockwave Flash 2.0"]&&(f=!0,k="2.0.0.11");else if(l.mimeTypes&&l.mimeTypes.length)a=(a=l.mimeTypes["application/x-shockwave-flash"])&&a.enabledPlugin,d(a);else if("undefined"!==typeof a){g=!0;try{e=new a("ShockwaveFlash.ShockwaveFlash.7"),f=!0,k=b(e.GetVariable("$version"))}catch(Ob){try{e=new a("ShockwaveFlash.ShockwaveFlash.6"),f=!0,k="6.0.21"}catch(Xb){try{e=new a("ShockwaveFlash.ShockwaveFlash"),f=!0,k=b(e.GetVariable("$version"))}catch(Ab){g=!1}}}}I.disabled=!0!==f;I.outdated=k&&v(k)<v("11.0.0");I.version=k||"0.0.0";I.pluginType=h?"pepper":g?"activex":f?"netscape":"unknown"};ab(f);Oa(!0);var L=function(){if(!(this instanceof L))return new L;"function"===typeof L._createClient&&L._createClient.apply(this,A(arguments))};L.version="2.3.0";L.config=function(){return wa.apply(this,A(arguments))};L.state=function(){return ra.apply(this,A(arguments))};L.isFlashUnusable=function(){return la.apply(this,A(arguments))};L.on=function(){return aa.apply(this,A(arguments))};L.off=function(){return fa.apply(this,A(arguments))};L.handlers=function(){return pa.apply(this,A(arguments))};L.emit=function(){return ha.apply(this,A(arguments))};L.create=function(){return sa.apply(this,A(arguments))};L.destroy=function(){return ja.apply(this,A(arguments))};L.setData=function(){return Aa.apply(this,A(arguments))};L.clearData=function(){return ta.apply(this,A(arguments))};L.getData=function(){return X.apply(this,A(arguments))};L.focus=L.activate=function(){return Da.apply(this,A(arguments))};L.blur=L.deactivate=function(){return Ea.apply(this,A(arguments))};L.activeElement=function(){return Sa.apply(this,A(arguments))};var rb=0,ea={},gb=0,Xa={},va={};B(T,{autoActivate:!0});var Ja=function(a){var b,d=this;d.id=""+rb++;b={instance:d,elements:[],handlers:{},coreWildcardHandler:function(a){return d.emit(a)}};ea[d.id]=b;a&&d.clip(a);L.on("*",b.coreWildcardHandler);L.on("destroy",function(){d.destroy()});L.create()},sb=function(a,b){var e,f,g,h={},k=this,l=(e=ea[k.id])&&e.handlers;if(!e)throw Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");"string"===typeof a&&a?g=a.toLowerCase().split(/\s+/):"object"!==typeof a||!a||"length"in a||"undefined"!==typeof b||z(a).forEach(function(b){var d=a[b];if("function"===typeof d)k.on(b,d)});if(g&&g.length&&b){e=0;for(f=g.length;e<f;e++)a=g[e].replace(/^on/,""),h[a]=!0,l[a]||(l[a]=[]),l[a].push(b);h.ready&&I.ready&&this.emit({type:"ready",client:this});if(h.error){e=0;for(f=Z.length;e<f;e++)if(I[Z[e].replace(/^flash-/,"")]){this.emit({type:"error",name:Z[e],client:this});break}O!==d&&L.version!==O&&this.emit({type:"error",name:"version-mismatch",jsVersion:L.version,swfVersion:O})}}return k},ub=function(a,b){var d,e,f,g,h,k=this,l=(d=ea[k.id])&&d.handlers;if(!l)return k;0===arguments.length?g=z(l):"string"===typeof a&&a?g=a.split(/\s+/):"object"!==typeof a||!a||"length"in a||"undefined"!==typeof b||z(a).forEach(function(b){var d=a[b];"function"===typeof d&&k.off(b,d)});if(g&&g.length)for(d=0,e=g.length;d<e;d++)if(a=g[d].toLowerCase().replace(/^on/,""),(h=l[a])&&h.length)if(b)for(f=h.indexOf(b);-1!==f;)h.splice(f,1),f=h.indexOf(b,f);else h.length=0;return k},vb=function(a){var b=null,d=ea[this.id]&&ea[this.id].handlers;d&&(b="string"===typeof a&&a?d[a]?d[a].slice(0):[]:G(d));return b},wb=function(a){var b;var d=a;if(!d||!d.type||d.client&&d.client!==this)b=!1;else{var e=(b=ea[this.id])&&b.elements,f=!!e&&0<e.length,g=!d.target||f&&-1!==e.indexOf(d.target),e=d.relatedTarget&&f&&-1!==e.indexOf(d.relatedTarget),d=d.client&&d.client===this;b=b&&(g||e||d)?!0:!1}if(b&&("object"===typeof a&&a&&"string"===typeof a.type&&a.type&&(a=B({},a)),a=B({},fb(a),{client:this}),g=ea[this.id],"object"===typeof a&&a&&a.type&&g&&(b=Ia(a),(g=(g&&g.handlers["*"]||[]).concat(g&&g.handlers[a.type]||[]))&&g.length)))for(var h,l,d=0,e=g.length;d<e;d++)f=g[d],h=this,"string"===typeof f&&"function"===typeof k[f]&&(f=k[f]),"object"===typeof f&&f&&"function"===typeof f.handleEvent&&(h=f,f=f.handleEvent),"function"===typeof f&&(l=B({},a),$a(f,h,[l],b));return this},xb=function(a){if(!ea[this.id])throw Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");a=kb(a);for(var b=0;b<a.length;b++)if(x.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===Xa[a[b].zcClippingId].indexOf(this.id)&&Xa[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+gb++,Xa[a[b].zcClippingId]=[this.id],!0===T.autoActivate&&cb(a[b]));var d=ea[this.id]&&ea[this.id].elements;-1===d.indexOf(a[b])&&d.push(a[b])}return this},bb=function(a){var b=ea[this.id];if(!b)return this;var b=b.elements,d;a="undefined"===typeof a?b.slice(0):kb(a);for(var e=a.length;e--;)if(x.call(a,e)&&a[e]&&1===a[e].nodeType){for(d=0;-1!==(d=b.indexOf(a[e],d));)b.splice(d,1);var f=Xa[a[e].zcClippingId];if(f){for(d=0;-1!==(d=f.indexOf(this.id,d));)f.splice(d,1);if(0===f.length){if(!0===T.autoActivate&&(d=a[e])&&1===d.nodeType&&(f=va[d.zcClippingId],"object"===typeof f&&f)){for(var g,h,k=["move","leave","enter","out","over"],l=0,m=k.length;l<m;l++)g="mouse"+k[l],h=f[g],"function"===typeof h&&d.removeEventListener(g,h,!1);delete va[d.zcClippingId]}delete a[e].zcClippingId}}}return this},yb=function(){var a=ea[this.id];return a&&a.elements?a.elements.slice(0):[]},Nb=function(){var a=ea[this.id];a&&(this.unclip(),this.off(),L.off("*",a.coreWildcardHandler),delete ea[this.id])},kb=function(a){"string"===typeof a&&(a=[]);return"number"!==typeof a.length?[a]:a},cb=function(a){if(a&&1===a.nodeType){var b=function(a){if(a||(a=k.event))"js"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source},d=function(d){if(d||(d=k.event))b(d),L.focus(a)};a.addEventListener("mouseover",d,!1);a.addEventListener("mouseout",b,!1);a.addEventListener("mouseenter",b,!1);a.addEventListener("mouseleave",b,!1);a.addEventListener("mousemove",b,!1);va[a.zcClippingId]={mouseover:d,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}};L._createClient=function(){Ja.apply(this,A(arguments))};L.prototype.on=function(){return sb.apply(this,A(arguments))};L.prototype.off=function(){return ub.apply(this,A(arguments))};L.prototype.handlers=function(){return vb.apply(this,A(arguments))};L.prototype.emit=function(){return wb.apply(this,A(arguments))};L.prototype.clip=function(){return xb.apply(this,A(arguments))};L.prototype.unclip=function(){return bb.apply(this,A(arguments))};L.prototype.elements=function(){return yb.apply(this,A(arguments))};L.prototype.destroy=function(){return Nb.apply(this,A(arguments))};L.prototype.setText=function(a){if(!ea[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");L.setData("text/plain",a);return this};L.prototype.setHtml=function(a){if(!ea[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");L.setData("text/html",a);return this};L.prototype.setRichText=function(a){if(!ea[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");L.setData("application/rtf",a);return this};L.prototype.setData=function(){if(!ea[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");L.setData.apply(this,A(arguments));return this};L.prototype.clearData=function(){if(!ea[this.id])throw Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");L.clearData.apply(this,A(arguments));return this};L.prototype.getData=function(){if(!ea[this.id])throw Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return L.getData.apply(this,A(arguments))};"object"===typeof q&&q&&"object"===typeof q.exports&&q.exports?q.exports=L:k.ZeroClipboard=L})(function(){return this||window}())},{}]},{},[141,64,66,67,65,68,111,112,113,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,100,101,102,103,104,106,107,108,109,110,114,115,116,117,135,136,137,138,120,121,122,123,124,125,32,36,33,34,41,35,37,38,39,40,142,143,144,145,146,217,218,211,212,213,147,148,149,150,151,152,154,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,198,199,200,201,202,203,204,205,206,207,208,209,210,214,215,216,219,220,222,223,224,225,226])(141)});