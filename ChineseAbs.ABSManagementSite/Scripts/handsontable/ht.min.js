!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Handsontable=a()}}(function(){var define,module,exports;return function a(b,c,d){function g(h,i){if(!c[h]){if(!b[h]){var j="function"==typeof require&&require;if(!i&&j)return j(h,!0);if(e)return e(h,!0);if(f[h]&&void 0!==window[f[h]])return window[f[h]];var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var l=c[h]={exports:{}};b[h][0].call(l.exports,function(a){var c=b[h][1][a];return g(c||a)},l,l.exports,a,b,c,d)}return c[h].exports}for(var e="function"==typeof require&&require,f=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","numbro":"numbro","pikaday":"Pikaday","hot-formula-parser":"formulaParser"}')||{},h=0;h<d.length;h++)g(d[h]);return g}({1:[function(a,b,c){},{}],2:[function(a,b,c){window.jQuery&&function(a){a.fn.handsontable=function(a){var b,c,d,e,f,g=this.first(),h=g.data("handsontable");if("string"!=typeof a)return f=a||{},h?h.updateSettings(f):(h=new Handsontable.Core(g[0],f),g.data("handsontable",h),h.init()),g;if(d=[],arguments.length>1)for(b=1,c=arguments.length;b<c;b++)d.push(arguments[b]);if(h){if(void 0===h[a])throw new Error("Handsontable do not provide action: "+a);e=h[a].apply(h,d),"destroy"===a&&g.removeData()}return e}}(window.jQuery)},{}],3:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableBorder:{get:function(){return w}},__esModule:{value:!0}});var d,e,f,g,h,i,j=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},k=j.getComputedStyle,l=j.getTrimmingContainer,m=j.innerWidth,n=j.innerHeight,o=j.offset,p=j.outerHeight,q=j.outerWidth,r=((e=a("helpers/dom/event"))&&e.__esModule&&e||{default:e}).stopImmediatePropagation,s=((f=a("helpers/browser"))&&f.__esModule&&f||{default:f}).isMobileBrowser,t=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).EventManager,u=((h=a("cell/coords"))&&h.__esModule&&h||{default:h}).WalkontableCellCoords,w=((i=a("overlay/_base.js"))&&i.__esModule,function(b,c){c&&(this.eventManager=new t(b),this.instance=b,this.wot=b,this.settings=c,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(c),this.registerListeners())});$traceurRuntime.createClass(w,{registerListeners:function(){var a=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return a.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return a.onMouseUp()});for(var b=this,c=function(c,d){b.eventManager.addEventListener(b.main.childNodes[c],"mouseenter",function(b){return a.onMouseEnter(b,a.main.childNodes[c])})},d=0,e=this.main.childNodes.length;d<e;d++)c(d,e)},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDown=!1},onMouseEnter:function(a,b){function e(a){return a.clientY<Math.floor(d.top)||(a.clientY>Math.ceil(d.top+d.height)||(a.clientX<Math.floor(d.left)||(a.clientX>Math.ceil(d.left+d.width)||void 0)))}function f(a){e(a)&&(c.eventManager.removeEventListener(document.body,"mousemove",f),b.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){a.preventDefault(),r(a);var c=this,d=b.getBoundingClientRect();b.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",f)}},createBorders:function(a){this.main=document.createElement("div");var b=["top","left","bottom","right","corner"],c=this.main.style;c.position="absolute",c.top=0,c.left=0;for(var d=0;d<5;d++){var e=b[d],f=document.createElement("div");f.className="wtBorder "+(this.settings.className||""),this.settings[e]&&this.settings[e].hide&&(f.className+=" hidden"),c=f.style,c.backgroundColor=this.settings[e]&&this.settings[e].color?this.settings[e].color:a.border.color,c.height=this.settings[e]&&this.settings[e].width?this.settings[e].width+"px":a.border.width+"px",c.width=this.settings[e]&&this.settings[e].width?this.settings[e].width+"px":a.border.width+"px",this.main.appendChild(f)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),s()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var a=10,b=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var c={position:"absolute",height:b+"px",width:b+"px","border-radius":parseInt(b/1.5,10)+"px"};for(var d in c)c.hasOwnProperty(d)&&(this.selectionHandles.styles.bottomRightHitArea[d]=c[d],this.selectionHandles.styles.topLeftHitArea[d]=c[d]);var e={position:"absolute",height:a+"px",width:a+"px","border-radius":parseInt(a/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var f in e)e.hasOwnProperty(f)&&(this.selectionHandles.styles.bottomRight[f]=e[f],this.selectionHandles.styles.topLeft[f]=e[f]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function(a,b){return!(!this.wot.selections.area.cellRange||a==this.wot.selections.area.cellRange.to.row&&b==this.wot.selections.area.cellRange.to.col)},updateMultipleSelectionHandlesPosition:function(a,b,c,d,e,f){var g=parseInt(this.selectionHandles.styles.topLeft.width,10),h=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(c-g,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(d-g,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(c-h/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(d-h/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(c+f,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(d+e,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(c+f-h/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(d+e-h/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(a,b)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),a==this.wot.wtSettings.getSetting("fixedRowsTop")||b==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},appear:function(a){if(!this.disabled){var b,c,d,e,f,g,h,i,j,r,t,v,w,x,y,z,A,C;C=this.wot.wtTable.getRenderedRowsCount();for(var D=0;D<C;D++){var E=this.wot.wtTable.rowFilter.renderedToSource(D);if(E>=a[0]&&E<=a[2]){w=E;break}}for(var F=C-1;F>=0;F--){var G=this.wot.wtTable.rowFilter.renderedToSource(F);if(G>=a[0]&&G<=a[2]){y=G;break}}C=this.wot.wtTable.getRenderedColumnsCount();for(var H=0;H<C;H++){var I=this.wot.wtTable.columnFilter.renderedToSource(H);if(I>=a[1]&&I<=a[3]){x=I;break}}for(var J=C-1;J>=0;J--){var K=this.wot.wtTable.columnFilter.renderedToSource(J);if(K>=a[1]&&K<=a[3]){z=K;break}}if(void 0===w||void 0===x)return void this.disappear();b=w!==y||x!==z,c=this.wot.wtTable.getCell(new u(w,x)),d=b?this.wot.wtTable.getCell(new u(y,z)):c,e=o(c),f=b?o(d):e,g=o(this.wot.wtTable.TABLE),i=e.top,t=f.top+p(d)-i,r=e.left,v=f.left+q(d)-r,h=i-g.top-1,j=r-g.left-1;var L=k(c);parseInt(L.borderTopWidth,10)>0&&(h+=1,t=t>0?t-1:0),parseInt(L.borderLeftWidth,10)>0&&(j+=1,v=v>0?v-1:0),this.topStyle.top=h+"px",this.topStyle.left=j+"px",this.topStyle.width=v+"px",this.topStyle.display="block",this.leftStyle.top=h+"px",this.leftStyle.left=j+"px",this.leftStyle.height=t+"px",this.leftStyle.display="block";var M=Math.floor(this.settings.border.width/2);this.bottomStyle.top=h+t-M+"px",this.bottomStyle.left=j+"px",this.bottomStyle.width=v+"px",this.bottomStyle.display="block",this.rightStyle.top=h+"px",this.rightStyle.left=j+v-M+"px",this.rightStyle.height=t+1+"px",this.rightStyle.display="block",s()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(y,z)?this.cornerStyle.display="none":(this.cornerStyle.top=h+t-4+"px",this.cornerStyle.left=j+v-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",A=l(this.wot.wtTable.TABLE),z===this.wot.getSetting("totalColumns")-1&&d.offsetLeft+q(d)+parseInt(this.cornerDefaultStyle.width)/2>=m(A)&&(this.cornerStyle.left=Math.floor(j+v-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0),y===this.wot.getSetting("totalRows")-1&&d.offsetTop+p(d)+parseInt(this.cornerDefaultStyle.height)/2>=n(A)&&(this.cornerStyle.top=Math.floor(h+t-3-parseInt(this.cornerDefaultStyle.height)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"),s()&&this.updateMultipleSelectionHandlesPosition(w,x,h,j,v,t)}},disappear:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",s()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},hasSetting:function(a){return"function"==typeof a?a():!!a}},{}),window.WalkontableBorder=w},{"cell/coords":6,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/dom/event":48,"overlay/_base.js":12}],4:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableViewportColumnsCalculator:{get:function(){return e}},__esModule:{value:!0}});var d=new WeakMap,e=function(b,c,e,f,g,h,i){var j=void 0!==arguments[7]?arguments[7]:function(a){return a};d.set(this,{viewportWidth:b,scrollOffset:c,totalColumns:e,columnWidthFn:f,overrideFn:g,onlyFullyVisible:h,stretchingColumnWidthFn:j}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=i,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()},f=e;$traceurRuntime.createClass(e,{calculate:function(){for(var e,a=0,b=!0,c=[],f=d.get(this),g=f.onlyFullyVisible,h=f.overrideFn,i=f.scrollOffset,j=f.totalColumns,k=f.viewportWidth,l=0;l<j;l++){e=this._getColumnWidth(l),a<=i&&!g&&(this.startColumn=l);var m=i>0?k+1:k;if(a>=i&&a+e<=i+m&&(null==this.startColumn&&(this.startColumn=l),this.endColumn=l),c.push(a),a+=e,g||(this.endColumn=l),a>=i+k){b=!1;break}}if(this.endColumn===j-1&&b)for(this.startColumn=this.endColumn;this.startColumn>0;){var n=c[this.endColumn]+e-c[this.startColumn-1];if((n<=k||!g)&&this.startColumn--,n>k)break}null!==this.startColumn&&h&&h(this),this.startPosition=c[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(a){if("none"!==this.stretch){this.totalTargetWidth=a;for(var b=d.get(this),c=b.totalColumns,e=0,f=0;f<c;f++){var g=this._getColumnWidth(f),h=b.stretchingColumnWidthFn(void 0,f);"number"==typeof h?a-=h:e+=g}var i=a-e;if("all"===this.stretch&&i>0)this.stretchAllRatio=a/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&a!==1/0){var j=this._getColumnWidth(c-1),k=i+j;this.stretchLastWidth=k>=0?k:j}}},getStretchedColumnWidth:function(a,b){var c=null;return"all"===this.stretch&&0!==this.stretchAllRatio?c=this._getStretchedAllColumnWidth(a,b):"last"===this.stretch&&0!==this.stretchLastWidth&&(c=this._getStretchedLastColumnWidth(a)),c},_getStretchedAllColumnWidth:function(a,b){var c=0,e=d.get(this),f=e.totalColumns;if(!this.stretchAllColumnsWidth[a]){var g=Math.round(b*this.stretchAllRatio),h=e.stretchingColumnWidthFn(g,a);this.stretchAllColumnsWidth[a]=void 0===h?g:isNaN(h)?this._getColumnWidth(a):h}if(this.stretchAllColumnsWidth.length===f&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)c+=this.stretchAllColumnsWidth[i];c!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-c)}return this.stretchAllColumnsWidth[a]},_getStretchedLastColumnWidth:function(a){return a===d.get(this).totalColumns-1?this.stretchLastWidth:null},_getColumnWidth:function(a){var b=d.get(this).columnWidthFn(a);return void 0===b&&(b=f.DEFAULT_WIDTH),b}},{get DEFAULT_WIDTH(){return 50}}),window.WalkontableViewportColumnsCalculator=e},{}],5:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableViewportRowsCalculator:{get:function(){return e}},__esModule:{value:!0}});var d=new WeakMap,e=function(b,c,e,f,g,h,i){d.set(this,{viewportHeight:b,scrollOffset:c,totalRows:e,rowHeightFn:f,overrideFn:g,onlyFullyVisible:h,horizontalScrollbarHeight:i}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()},f=e;$traceurRuntime.createClass(e,{calculate:function(){for(var a=0,b=!0,c=[],e=d.get(this),g=e.onlyFullyVisible,h=e.overrideFn,i=e.rowHeightFn,j=e.scrollOffset,k=e.totalRows,l=e.viewportHeight,m=e.horizontalScrollbarHeight||0,n=0;n<k;n++){var o=i(n);if(void 0===o&&(o=f.DEFAULT_HEIGHT),a<=j&&!g&&(this.startRow=n),a>=j&&a+o<=j+l-m&&(null===this.startRow&&(this.startRow=n),this.endRow=n),c.push(a),a+=o,g||(this.endRow=n),a>=j+l-m){b=!1;break}}if(this.endRow===k-1&&b)for(this.startRow=this.endRow;this.startRow>0;){var p=c[this.endRow]+o-c[this.startRow-1];if((p<=l-m||!g)&&this.startRow--,p>=l-m)break}null!==this.startRow&&h&&h(this),this.startPosition=c[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}}),window.WalkontableViewportRowsCalculator=e},{}],6:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableCellCoords:{get:function(){return d}},__esModule:{value:!0}});var d=function(b,c){void 0!==b&&void 0!==c?(this.row=b,this.col=c):(this.row=null,this.col=null)};$traceurRuntime.createClass(d,{isValid:function(a){return!(this.row<0||this.col<0)&&!(this.row>=a.getSetting("totalRows")||this.col>=a.getSetting("totalColumns"))},isEqual:function(a){return a===this||this.row===a.row&&this.col===a.col},isSouthEastOf:function(a){return this.row>=a.row&&this.col>=a.col},isNorthWestOf:function(a){return this.row<=a.row&&this.col<=a.col},isSouthWestOf:function(a){return this.row>=a.row&&this.col<=a.col},isNorthEastOf:function(a){return this.row<=a.row&&this.col>=a.col}},{}),window.WalkontableCellCoords=d},{}],7:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableCellRange:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("cell/coords"))&&d.__esModule&&d||{default:d}).WalkontableCellCoords,f=function(b,c,d){this.highlight=b,this.from=c,this.to=d},g=f;$traceurRuntime.createClass(f,{isValid:function(a){return this.from.isValid(a)&&this.to.isValid(a)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(a){var b=a,c=b.row,d=b.col,e=this.getTopLeftCorner(),f=this.getBottomRightCorner();return e.row<=c&&f.row>=c&&e.col<=d&&f.col>=d},includesRange:function(a){return this.includes(a.getTopLeftCorner())&&this.includes(a.getBottomRightCorner())},isEqual:function(a){return Math.min(this.from.row,this.to.row)==Math.min(a.from.row,a.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(a.from.row,a.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(a.from.col,a.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(a.from.col,a.to.col)},overlaps:function(a){return a.isSouthEastOf(this.getTopLeftCorner())&&a.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(a){return this.getTopLeftCorner().isSouthEastOf(a)||this.getBottomRightCorner().isSouthEastOf(a)},isNorthWestOf:function(a){return this.getTopLeftCorner().isNorthWestOf(a)||this.getBottomRightCorner().isNorthWestOf(a)},expand:function(a){var b=this.getTopLeftCorner(),c=this.getBottomRightCorner();return(a.row<b.row||a.col<b.col||a.row>c.row||a.col>c.col)&&(this.from=new e(Math.min(b.row,a.row),Math.min(b.col,a.col)),this.to=new e(Math.max(c.row,a.row),Math.max(c.col,a.col)),!0)},expandByRange:function(a){if(this.includesRange(a)||!this.overlaps(a))return!1;var b=this.getTopLeftCorner(),c=this.getBottomRightCorner(),h=(this.getTopRightCorner(),this.getBottomLeftCorner(),a.getTopLeftCorner()),i=a.getBottomRightCorner(),j=Math.min(b.row,h.row),k=Math.min(b.col,h.col),l=Math.max(c.row,i.row),m=Math.max(c.col,i.col),n=new e(j,k),o=new e(l,m),p=new g(n,n,o).isCorner(this.from,a),q=a.isEqual(new g(n,n,o));return p&&!q&&(this.from.col>n.col&&(n.col=m,o.col=k),this.from.row>n.row&&(n.row=l,o.row=j)),this.from=n,this.to=o,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(a){var b,c,d,e;switch(a){case"NW-SE":b=[this.getTopLeftCorner(),this.getBottomRightCorner()],this.from=b[0],this.to=b[1];break;case"NE-SW":c=[this.getTopRightCorner(),this.getBottomLeftCorner()],this.from=c[0],this.to=c[1];break;case"SE-NW":d=[this.getBottomRightCorner(),this.getTopLeftCorner()],this.from=d[0],this.to=d[1];break;case"SW-NE":e=[this.getBottomLeftCorner(),this.getTopRightCorner()],this.from=e[0],this.to=e[1]}},getTopLeftCorner:function(){return new e(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new e(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new e(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new e(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(a,b){return!!(b&&b.includes(a)&&(this.getTopLeftCorner().isEqual(new e(b.from.row,b.from.col))||this.getTopRightCorner().isEqual(new e(b.from.row,b.to.col))||this.getBottomLeftCorner().isEqual(new e(b.to.row,b.from.col))||this.getBottomRightCorner().isEqual(new e(b.to.row,b.to.col))))||(a.isEqual(this.getTopLeftCorner())||a.isEqual(this.getTopRightCorner())||a.isEqual(this.getBottomLeftCorner())||a.isEqual(this.getBottomRightCorner()))},getOppositeCorner:function(a,b){if(!(a instanceof e))return!1;if(b&&b.includes(a)){if(this.getTopLeftCorner().isEqual(new e(b.from.row,b.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new e(b.from.row,b.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new e(b.to.row,b.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new e(b.to.row,b.to.col)))return this.getTopLeftCorner()}return a.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():a.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():a.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():a.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(a){if(!this.includesRange(a))return[];var b={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},c={top:Math.min(a.from.row,a.to.row),bottom:Math.max(a.from.row,a.to.row),left:Math.min(a.from.col,a.to.col),right:Math.max(a.from.col,a.to.col)},d=[];return b.top==c.top&&d.push("top"),b.right==c.right&&d.push("right"),b.bottom==c.bottom&&d.push("bottom"),b.left==c.left&&d.push("left"),d},getInner:function(){for(var a=this.getTopLeftCorner(),b=this.getBottomRightCorner(),c=[],d=a.row;d<=b.row;d++)for(var f=a.col;f<=b.col;f++)this.from.row===d&&this.from.col===f||this.to.row===d&&this.to.col===f||c.push(new e(d,f));return c},getAll:function(){for(var a=this.getTopLeftCorner(),b=this.getBottomRightCorner(),c=[],d=a.row;d<=b.row;d++)for(var f=a.col;f<=b.col;f++)a.row===d&&a.col===f?c.push(a):b.row===d&&b.col===f?c.push(b):c.push(new e(d,f));return c},forAll:function(a){for(var b=this.getTopLeftCorner(),c=this.getBottomRightCorner(),d=b.row;d<=c.row;d++)for(var e=b.col;e<=c.col;e++){var f=a(d,e);if(!1===f)return}}},{}),window.WalkontableCellRange=f},{"cell/coords":6}],8:[function(a,b,c){"use strict";Object.defineProperties(c,{Walkontable:{get:function(){return L}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},s=r.addClass,t=r.fastInnerText,u=r.isVisible,v=r.removeClass,w=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).objectEach,x=(f=a("helpers/string"))&&f.__esModule&&f||{default:f},y=x.toUpperCaseFirst,z=x.randomString,A=((g=a("event"))&&g.__esModule&&g||{default:g}).WalkontableEvent,B=((h=a("overlays"))&&h.__esModule&&h||{default:h}).WalkontableOverlays,C=((i=a("scroll"))&&i.__esModule&&i||{default:i}).WalkontableScroll,D=((j=a("settings"))&&j.__esModule&&j||{default:j}).WalkontableSettings,E=((k=a("table"))&&k.__esModule&&k||{default:k}).WalkontableTable,F=((l=a("viewport"))&&l.__esModule&&l||{default:l}).WalkontableViewport,L=((m=a("overlay/_base.js"))&&m.__esModule,(n=a("overlay/top.js"))&&n.__esModule,(o=a("overlay/left.js"))&&o.__esModule,(p=a("overlay/debug.js"))&&p.__esModule,(q=a("overlay/topLeftCorner.js"))&&q.__esModule,function(b){var c=[];if(this.guid="wt_"+z(),b.cloneSource?(this.cloneSource=b.cloneSource,this.cloneOverlay=b.cloneOverlay,this.wtSettings=b.cloneSource.wtSettings,this.wtTable=new E(this,b.table,b.wtRootElement),this.wtScroll=new C(this),this.wtViewport=b.cloneSource.wtViewport,this.wtEvent=new A(this),this.selections=this.cloneSource.selections):(this.wtSettings=new D(this,b),this.wtTable=new E(this,b.table),this.wtScroll=new C(this),this.wtViewport=new F(this),this.wtEvent=new A(this),this.selections=this.getSetting("selections"),this.wtOverlays=new B(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var d=0,e=this.wtTable.THEAD.childNodes[0].childNodes.length;d<e;d++)c.push(this.wtTable.THEAD.childNodes[0].childNodes[d].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(a,b){t(b,c[a])}])}this.drawn=!1,this.drawInterrupted=!1});$traceurRuntime.createClass(L,{draw:function(){var a=void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,a||u(this.wtTable.TABLE)?this.wtTable.draw(a):this.drawInterrupted=!0,this},getCell:function(a){if(void 0===arguments[1]||!arguments[1])return this.wtTable.getCell(a);var c=this.wtSettings.getSetting("totalRows"),d=this.wtSettings.getSetting("fixedRowsTop"),e=this.wtSettings.getSetting("fixedRowsBottom"),f=this.wtSettings.getSetting("fixedColumnsLeft");if(a.row<d&&a.col<f)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(a);if(a.row<d)return this.wtOverlays.topOverlay.clone.wtTable.getCell(a);if(a.col<f&&a.row>=c-e){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(a)}else{if(a.col<f)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(a);if(a.row<c&&a.row>c-e&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(a)}return this.wtTable.getCell(a)},update:function(a,b){return this.wtSettings.update(a,b)},scrollVertical:function(a){return this.wtOverlays.topOverlay.scrollTo(a),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(a){return this.wtOverlays.leftOverlay.scrollTo(a),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(a){return this.wtScroll.scrollViewport(a),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},isOverlayName:function(a){return!!this.cloneOverlay&&this.cloneOverlay.type===a},exportSettingsAsClassNames:function(){var a=this,b={rowHeaders:["array"],columnHeaders:["array"]},c=[],d=[];w(b,function(b,e){b.indexOf("array")>-1&&a.getSetting(e).length&&d.push("ht"+y(e)),c.push("ht"+y(e))}),v(this.wtTable.wtRootElement.parentNode,c),s(this.wtTable.wtRootElement.parentNode,d)},getSetting:function(a,b,c,d,e){return this.wtSettings.getSetting(a,b,c,d,e)},hasSetting:function(a){return this.wtSettings.has(a)},destroy:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{}),window.Walkontable=L},{event:9,"helpers/dom/element":47,"helpers/object":53,"helpers/string":55,"overlay/_base.js":12,"overlay/debug.js":13,"overlay/left.js":14,"overlay/top.js":15,"overlay/topLeftCorner.js":16,overlays:17,scroll:18,settings:20,table:21,viewport:23}],9:[function(a,b,c){"use strict";function p(a){var b=this,c=o(a);this.instance=a;var d=[null,null];this.dblClickTimeout=[null,null];var g,e=function(a){var c=document.activeElement,e=m(l,a.realTarget),f=a.realTarget;if(f!==c&&e(0)!==c&&e(1)!==c){var g=b.parentCell(f);j(f,"corner")?b.instance.getSetting("onCellCornerMouseDown",a,f):g.TD&&b.instance.hasSetting("onCellMouseDown")&&b.instance.getSetting("onCellMouseDown",a,g.coords,g.TD,b.instance),2!==a.button&&g.TD&&(d[0]=g.TD,clearTimeout(b.dblClickTimeout[0]),b.dblClickTimeout[0]=setTimeout(function(){d[0]=null},1e3))}},f=function(a){b.instance.touchMoving=!0},h=function(a){c.addEventListener(this,"touchmove",f),b.checkIfTouchMove=setTimeout(function(){if(!0===b.instance.touchMoving)return b.instance.touchMoving=void 0,void c.removeEventListener("touchmove",f,!1);e(a)},30)},p=function(a){var c,d,e;b.instance.hasSetting("onCellMouseOver")&&(c=b.instance.wtTable.TABLE,d=i(a.realTarget,["TD","TH"],c),e=b.instance.cloneSource||b.instance,d&&d!==e.lastMouseOver&&k(d,c)&&(e.lastMouseOver=d,b.instance.getSetting("onCellMouseOver",a,b.instance.wtTable.getCoords(d),d,b.instance)))},q=function(a){var c,d,e;b.instance.hasSetting("onCellMouseOut")&&(c=b.instance.wtTable.TABLE,d=i(a.realTarget,["TD","TH"],c),e=i(a.relatedTarget,["TD","TH"],c),d&&d!==e&&k(d,c)&&b.instance.getSetting("onCellMouseOut",a,b.instance.wtTable.getCoords(d),d,b.instance))},r=function(a){if(2!==a.button){var c=b.parentCell(a.realTarget);c.TD===d[0]&&c.TD===d[1]?(j(a.realTarget,"corner")?b.instance.getSetting("onCellCornerDblClick",a,c.coords,c.TD,b.instance):b.instance.getSetting("onCellDblClick",a,c.coords,c.TD,b.instance),d[0]=null,d[1]=null):c.TD===d[0]?(b.instance.getSetting("onCellMouseUp",a,c.coords,c.TD,b.instance),d[1]=c.TD,clearTimeout(b.dblClickTimeout[1]),b.dblClickTimeout[1]=setTimeout(function(){d[1]=null},500)):c.TD&&b.instance.hasSetting("onCellMouseUp")&&b.instance.getSetting("onCellMouseUp",a,c.coords,c.TD,b.instance)}},s=function(a){clearTimeout(g),a.preventDefault(),r(a)};if(c.addEventListener(this.instance.wtTable.holder,"mousedown",e),c.addEventListener(this.instance.wtTable.TABLE,"mouseover",p),c.addEventListener(this.instance.wtTable.TABLE,"mouseout",q),c.addEventListener(this.instance.wtTable.holder,"mouseup",r),this.instance.wtTable.holder.parentNode.parentNode&&n()&&!b.instance.wtTable.isWorkingOnClone()){var t="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");c.addEventListener(this.instance.wtTable.holder,"touchstart",function(a){b.instance.touchApplied=!0,k(a.target,t)&&h.call(a.target,a)}),c.addEventListener(this.instance.wtTable.holder,"touchend",function(a){b.instance.touchApplied=!1,k(a.target,t)&&s.call(a.target,a)}),b.instance.momentumScrolling||(b.instance.momentumScrolling={}),c.addEventListener(this.instance.wtTable.holder,"scroll",function(a){clearTimeout(b.instance.momentumScrolling._timeout),b.instance.momentumScrolling.ongoing||b.instance.getSetting("onBeforeTouchScroll"),b.instance.momentumScrolling.ongoing=!0,b.instance.momentumScrolling._timeout=setTimeout(function(){b.instance.touchApplied||(b.instance.momentumScrolling.ongoing=!1,b.instance.getSetting("onAfterMomentumScroll"))},200)})}c.addEventListener(window,"resize",function(){"none"!==b.instance.getSetting("stretchH")&&b.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),c.destroy()}}Object.defineProperties(c,{WalkontableEvent:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g,h=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},i=h.closestDown,j=h.hasClass,k=h.isChildOf,l=h.getParent,m=((e=a("helpers/function"))&&e.__esModule&&e||{default:e}).partial,n=((f=a("helpers/browser"))&&f.__esModule&&f||{default:f}).isMobileBrowser,o=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).eventManager;p.prototype.parentCell=function(a){var b={},c=this.instance.wtTable.TABLE,d=i(a,["TD","TH"],c);return d?(b.coords=this.instance.wtTable.getCoords(d),b.TD=d):j(a,"wtBorder")&&j(a,"current")?(b.coords=this.instance.selections.current.cellRange.highlight,b.TD=this.instance.wtTable.getCell(b.coords)):j(a,"wtBorder")&&j(a,"area")&&this.instance.selections.area.cellRange&&(b.coords=this.instance.selections.area.cellRange.to,b.TD=this.instance.wtTable.getCell(b.coords)),b},window.WalkontableEvent=p},{eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/function":50}],10:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableColumnFilter:{get:function(){return d}},__esModule:{value:!0}});var d=function(b,c,d){this.offset=b,this.total=c,this.countTH=d};$traceurRuntime.createClass(d,{offsetted:function(a){return a+this.offset},unOffsetted:function(a){return a-this.offset},renderedToSource:function(a){return this.offsetted(a)},sourceToRendered:function(a){return this.unOffsetted(a)},offsettedTH:function(a){return a-this.countTH},unOffsettedTH:function(a){return a+this.countTH},visibleRowHeadedColumnToSourceColumn:function(a){return this.renderedToSource(this.offsettedTH(a))},sourceColumnToVisibleRowHeadedColumn:function(a){return this.unOffsettedTH(this.sourceToRendered(a))}},{}),window.WalkontableColumnFilter=d},{}],11:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableRowFilter:{get:function(){return d}},__esModule:{value:!0}});var d=function(b,c,d){this.offset=b,this.total=c,this.countTH=d};$traceurRuntime.createClass(d,{offsetted:function(a){return a+this.offset},unOffsetted:function(a){return a-this.offset},renderedToSource:function(a){return this.offsetted(a)},sourceToRendered:function(a){return this.unOffsetted(a)},offsettedTH:function(a){return a-this.countTH},unOffsettedTH:function(a){return a+this.countTH},visibleColHeadedRowToSourceRow:function(a){return this.renderedToSource(this.offsettedTH(a))},sourceRowToVisibleColHeadedRow:function(a){return this.unOffsettedTH(this.sourceToRendered(a))}},{}),window.WalkontableRowFilter=d},{}],12:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableOverlay:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},i=h.getScrollableElement,j=h.getTrimmingContainer,k=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).defineGetter,l=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,m=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).eventManager,n={},o=function(b){k(this,"wot",b,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=j(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()},p=o;$traceurRuntime.createClass(o,{updateStateOfRendering:function(){var a=this.needFullRender;this.needFullRender=this.shouldBeRendered();var b=a!==this.needFullRender;return b&&!this.needFullRender&&this.reset(),b},shouldBeRendered:function(){return!0},updateTrimmingContainer:function(){this.trimmingContainer=j(this.hider.parentNode.parentNode)},updateMainScrollableElement:function(){this.mainTableScrollableElement=i(this.wot.wtTable.TABLE)},makeClone:function(a){if(-1===p.CLONE_TYPES.indexOf(a))throw new Error('Clone type "'+a+'" is not supported.');var b=document.createElement("DIV"),c=document.createElement("TABLE");b.className="ht_clone_"+a+" handsontable",b.style.position="absolute",b.style.top=0,b.style.left=0,b.style.overflow="hidden",c.className=this.wot.wtTable.TABLE.className,b.appendChild(c),this.type=a,this.wot.wtTable.wtRootElement.parentNode.appendChild(b);var d=this.wot.getSetting("preventOverflow");return!0===d||"horizontal"===d&&this.type===p.CLONE_TOP||"vertical"===d&&this.type===p.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=i(this.wot.wtTable.TABLE),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:c})},refresh:function(){var a=void 0!==arguments[0]&&arguments[0],b=this.shouldBeRendered();this.clone&&(this.needFullRender||b)&&this.clone.draw(a),this.needFullRender=b},reset:function(){if(this.clone){var a=this.clone.wtTable.holder,b=this.clone.wtTable.hider,c=a.style,d=b.style,e=a.parentNode.style;l([c,d,e],function(a){a.width="",a.height=""})}},destroy:function(){m(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[p.CLONE_TOP,p.CLONE_BOTTOM,p.CLONE_LEFT,p.CLONE_TOP_LEFT_CORNER,p.CLONE_BOTTOM_LEFT_CORNER,p.CLONE_DEBUG]},registerOverlay:function(a,b){if(-1===p.CLONE_TYPES.indexOf(a))throw new Error("Unsupported overlay ("+a+").");n[a]=b},createOverlay:function(a,b){return new n[a](b)},isOverlayTypeOf:function(a,b){return!(!a||!n[b])&&a instanceof n[b]}}),window.WalkontableOverlay=o},{eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/object":53}],13:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableDebugOverlay:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,g=((e=a("_base"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,h=function(b){$traceurRuntime.superConstructor(i).call(this,b),this.clone=this.makeClone(g.CLONE_DEBUG),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",f(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},i=h;$traceurRuntime.createClass(h,{},{},g),window.WalkontableDebugOverlay=h,g.registerOverlay(g.CLONE_DEBUG,h)},{_base:12,"helpers/dom/element":47}],14:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableLeftOverlay:{get:function(){return r}},__esModule:{value:!0}});var d,e,f=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.addClass,h=f.getScrollbarWidth,i=f.getScrollLeft,j=f.getWindowScrollTop,k=f.hasClass,l=f.outerWidth,m=f.innerHeight,n=f.removeClass,o=f.setOverlayPosition,p=f.resetCssTransform,q=((e=a("_base"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,r=function(b){$traceurRuntime.superConstructor(s).call(this,b),this.clone=this.makeClone(q.CLONE_LEFT)},s=r;$traceurRuntime.createClass(r,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b=0,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||c&&"horizontal"===c)b=this.getScrollPosition(),p(a);else{var g,h,d=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(d.left),f=Math.ceil(d.right);h=this.wot.wtTable.hider.style.top,h=""===h?0:h,g=e<0&&f-a.offsetWidth>0?-e:0,b=g,g+="px",o(a,g,h)}this.adjustHeaderBordersPosition(b),this.adjustElementsSize()}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(a,j()):this.mainTableScrollableElement.scrollLeft=a},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(a,b){for(var c=0,d=this.wot.wtSettings.defaultColumnWidth;a<b;)c+=this.wot.wtTable.getStretchedColumnWidth(a)||d,a++;return c},adjustElementsSize:function(){var a=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||a)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var f,a=this.wot.wtTable.holder,b=a.clientHeight===a.offsetHeight?0:h(),c=this.clone.wtTable.holder.parentNode,d=c.style,e=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"vertical"===e){var g=this.wot.wtViewport.getWorkspaceHeight()-b;g=Math.min(g,m(this.wot.wtTable.wtRootElement)),d.height=g+"px"}else d.height="";this.clone.wtTable.holder.style.height=d.height,f=l(this.clone.wtTable.TABLE),d.width=(0===f?f:f+4)+"px"},adjustRootChildrenSize:function(){var a=h();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===a&&(a=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==a)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""},scrollTo:function(a,b){var c=this.getTableParentOffset(),d=this.wot.cloneSource?this.wot.cloneSource:this.wot,e=d.wtTable.holder,f=0;b&&e.offsetWidth!==e.clientWidth&&(f=h()),b?(c+=this.sumCellSizes(0,a+1),c-=this.wot.wtViewport.getViewportWidth()):c+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),a),c+=f,this.setScrollPosition(c)},getTableParentOffset:function(){var a=this.wot.getSetting("preventOverflow"),b=0;return a||this.trimmingContainer!==window||(b=this.wot.wtTable.holderOffset.left),b},getScrollPosition:function(){return i(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(a){var b=this.wot.wtTable.holder.parentNode,c=this.wot.getSetting("rowHeaders"),d=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?n(b,"emptyRows"):g(b,"emptyRows"),d&&!c.length)g(b,"innerBorderLeft");else if(!d&&c.length){var f=k(b,"innerBorderLeft");a?g(b,"innerBorderLeft"):n(b,"innerBorderLeft"),(!f&&a||f&&!a)&&this.wot.wtOverlays.adjustElementsSize()}}},{},q),window.WalkontableLeftOverlay=r,q.registerOverlay(q.CLONE_LEFT,r)},{_base:12,"helpers/dom/element":47}],15:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableTopOverlay:{get:function(){return r}},__esModule:{value:!0}});var d,e,f=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.addClass,h=f.getScrollbarWidth,i=f.getScrollTop,j=f.getWindowScrollLeft,k=f.hasClass,l=f.outerHeight,m=f.innerWidth,n=f.removeClass,o=f.setOverlayPosition,p=f.resetCssTransform,q=((e=a("_base"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,r=function(b){$traceurRuntime.superConstructor(s).call(this,b),this.clone=this.makeClone(q.CLONE_TOP)},s=r;$traceurRuntime.createClass(r,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b=0,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||c&&"vertical"===c)b=this.getScrollPosition(),p(a);else{var g,h,d=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(d.top),f=Math.ceil(d.bottom);g=this.wot.wtTable.hider.style.left,g=""===g?0:g,h=e<0&&f-a.offsetHeight>0?-e:0,b=h,h+="px",o(a,g,h)}this.adjustHeaderBordersPosition(b),this.adjustElementsSize()}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(j(),a):this.mainTableScrollableElement.scrollTop=a},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(a,b){for(var c=0,d=this.wot.wtSettings.settings.defaultRowHeight;a<b;){var e=this.wot.wtTable.getRowHeight(a);c+=void 0===e?d:e,a++}return c},adjustElementsSize:function(){var a=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||a)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var f,a=this.wot.wtTable.holder,b=a.clientWidth===a.offsetWidth?0:h(),c=this.clone.wtTable.holder.parentNode,d=c.style,e=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"horizontal"===e){var g=this.wot.wtViewport.getWorkspaceWidth()-b;g=Math.min(g,m(this.wot.wtTable.wtRootElement)),d.width=g+"px"}else d.width="";this.clone.wtTable.holder.style.width=d.width,f=l(this.clone.wtTable.TABLE),d.height=(0===f?f:f+4)+"px"},adjustRootChildrenSize:function(){var a=h();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===a&&(a=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==a)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(a,b){var c=this.getTableParentOffset(),d=this.wot.cloneSource?this.wot.cloneSource:this.wot,e=d.wtTable.holder,f=0;if(b&&e.offsetHeight!==e.clientHeight&&(f=h()),b){var g=this.wot.getSetting("fixedRowsBottom"),j=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));c+=this.sumCellSizes(0,a+1),c-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(j-g,j),c+=1}else c+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),a);c+=f,this.setScrollPosition(c)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return i(this.mainTableScrollableElement)},redrawSelectionBorders:function(a){if(a&&a.cellRange){var b=a.getBorder(this.wot);if(b){var c=a.getCorners();b.disappear(),b.appear(c)}}},redrawAllSelectionsBorders:function(){var a=this.wot.selections;this.redrawSelectionBorders(a.current),this.redrawSelectionBorders(a.area),this.redrawSelectionBorders(a.fill),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()},adjustHeaderBordersPosition:function(a){var b=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?n(b,"emptyColumns"):g(b,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var d=k(b,"innerBorderTop");a||0===this.wot.getSetting("totalRows")?g(b,"innerBorderTop"):n(b,"innerBorderTop"),(!d&&a||d&&!a)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var e=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(e)for(var f=0;f<e.length;f++)e[f].style["border-left-width"]=0}}},{},q),window.WalkontableTopOverlay=r,q.registerOverlay(q.CLONE_TOP,r)},{_base:12,"helpers/dom/element":47}],16:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableTopLeftCornerOverlay:{get:function(){return l}},__esModule:{value:!0}});var d,e,f=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.outerHeight,h=f.outerWidth,i=f.setOverlayPosition,j=f.resetCssTransform,k=((e=a("_base"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,l=function(b){$traceurRuntime.superConstructor(m).call(this,b),this.clone=this.makeClone(k.CLONE_TOP_LEFT_CORNER)},m=l;$traceurRuntime.createClass(l,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b=g(this.clone.wtTable.TABLE),c=h(this.clone.wtTable.TABLE),d=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var e=this.wot.wtTable.hider.getBoundingClientRect(),f=Math.ceil(e.top),k=Math.ceil(e.left),l=Math.ceil(e.bottom),m=Math.ceil(e.right),n="0",o="0";d&&"vertical"!==d||k<0&&m-a.offsetWidth>0&&(n=-k+"px"),d&&"horizontal"!==d||f<0&&l-a.offsetHeight>0&&(o=-f+"px"),i(a,n,o)}else j(a);a.style.height=(0===b?b:b+4)+"px",a.style.width=(0===c?c:c+4)+"px"}}},{},k),window.WalkontableTopLeftCornerOverlay=l,k.registerOverlay(k.CLONE_TOP_LEFT_CORNER,l)},{_base:12,"helpers/dom/element":47}],17:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableOverlays:{get:function(){return r}},__esModule:{value:!0}});var d,e,f,g,h,i=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},j=i.getScrollableElement,k=i.getScrollbarWidth,l=i.getScrollLeft,m=i.getScrollTop,n=((e=a("helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,o=((f=a("helpers/unicode"))&&f.__esModule&&f||{default:f}).isKey,p=((g=a("helpers/browser"))&&g.__esModule&&g||{default:g}).isMobileBrowser,q=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).EventManager,r=function(b){this.wot=b,this.instance=this.wot,this.eventManager=new q(this.wot),this.wot.update("scrollbarWidth",k()),this.wot.update("scrollbarHeight",k()),this.scrollableElement=j(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()};$traceurRuntime.createClass(r,{prepareOverlays:function(){var a=!1;return this.topOverlay?a=this.topOverlay.updateStateOfRendering()||a:this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot),"undefined"==typeof WalkontableBottomOverlay&&(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),"undefined"==typeof WalkontableBottomLeftCornerOverlay&&(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?a=this.bottomOverlay.updateStateOfRendering()||a:this.bottomOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot),this.leftOverlay?a=this.leftOverlay.updateStateOfRendering()||a:this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?a=this.topLeftCornerOverlay.updateStateOfRendering()||a:this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?a=this.bottomLeftCornerOverlay.updateStateOfRendering()||a:this.bottomLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot)),a},refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}},registerListeners:function(){var a=this,b=this.topOverlay.mainTableScrollableElement,c=this.leftOverlay.mainTableScrollableElement,d=[];for(d.push([document.documentElement,"keydown",function(b){return a.onKeyDown(b)}]),d.push([document.documentElement,"keyup",function(){return a.onKeyUp()}]),d.push([document,"visibilitychange",function(){return a.onKeyUp()}]),d.push([b,"scroll",function(b){return a.onTableScroll(b)}]),b!==c&&d.push([c,"scroll",function(b){return a.onTableScroll(b)}]),this.topOverlay.needFullRender&&(d.push([this.topOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),d.push([this.topOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}])),this.bottomOverlay.needFullRender&&(d.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),d.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}])),this.leftOverlay.needFullRender&&(d.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(b){return a.onTableScroll(b)}]),d.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&d.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&d.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(b){return a.onTableScroll(b)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&d.push([window,"wheel",function(b){var c,d=b.wheelDeltaY||b.deltaY,e=b.wheelDeltaX||b.deltaX;a.topOverlay.clone.wtTable.holder.contains(b.realTarget)?c="top":a.bottomOverlay.clone&&a.bottomOverlay.clone.wtTable.holder.contains(b.realTarget)?c="bottom":a.leftOverlay.clone.wtTable.holder.contains(b.realTarget)?c="left":a.topLeftCornerOverlay&&a.topLeftCornerOverlay.clone&&a.topLeftCornerOverlay.clone.wtTable.holder.contains(b.realTarget)?c="topLeft":a.bottomLeftCornerOverlay&&a.bottomLeftCornerOverlay.clone&&a.bottomLeftCornerOverlay.clone.wtTable.holder.contains(b.realTarget)&&(c="bottomLeft"),("top"==c&&0!==d||"left"==c&&0!==e||"bottom"==c&&0!==d||("topLeft"===c||"bottomLeft"===c)&&(0!==d||0!==e))&&b.preventDefault()}]);d.length;){var e=d.pop();this.eventManager.addEventListener(e[0],e[1],e[2]),this.registeredListeners.push(e)}},deregisterListeners:function(){for(;this.registeredListeners.length;){var a=this.registeredListeners.pop();this.eventManager.removeEventListener(a[0],a[1],a[2])}},onTableScroll:function(a){if(!p()){var b=this.leftOverlay.mainTableScrollableElement,c=this.topOverlay.mainTableScrollableElement,d=a.target;this.keyPressed&&(c!==window&&d!==window&&!a.target.contains(c)||b!==window&&d!==window&&!a.target.contains(b))||("scroll"===a.type?this.syncScrollPositions(a):this.translateMouseWheelToScroll(a))}},onKeyDown:function(a){this.keyPressed=o(a.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(a){var b=this.topOverlay.clone.wtTable.holder,c=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,d=this.leftOverlay.clone.wtTable.holder,e=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,f=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,g=-.2,h=a.wheelDeltaY||-1*a.deltaY,i=a.wheelDeltaX||-1*a.deltaX,j=null,k={type:"wheel"},l=a.target,m=null;for(1===a.deltaMode&&(h*=120,i*=120);l!=document&&null!=l;){if(l.className.indexOf("wtHolder")>-1){j=l;break}l=l.parentNode}return k.target=j,j===e||j===f?(this.syncScrollPositions(k,g*i,"x"),this.syncScrollPositions(k,g*h,"y")):(j===b||j===c?m=h:j===d&&(m=i),this.syncScrollPositions(k,g*m)),!1},syncScrollPositions:function(a){var b=void 0!==arguments[1]?arguments[1]:null,c=void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var i,j,k,n,o,d=this.leftOverlay.mainTableScrollableElement,e=this.topOverlay.mainTableScrollableElement,f=a.target,g=0,h=!1,p=!1,q=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(i=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(o=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(j=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(k=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(n=this.bottomLeftCornerOverlay.clone.wtTable.holder),f===document&&(f=window),f===d||f===e?(g=l(q?this.scrollableElement:f),this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=g,h=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(i&&i.scrollLeft!==g&&(null==b&&this.pendingScrollCallbacks.top.left++,i.scrollLeft=g,p=d!==window),o&&o.scrollLeft!==g&&(null==b&&this.pendingScrollCallbacks.bottom.left++,o.scrollLeft=g,p=d!==window)),g=m(f),this.verticalScrolling=!0,this.overlayScrollPositions.master.top=g,h=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:j&&j.scrollTop!==g&&(null==b&&this.pendingScrollCallbacks.left.top++,j.scrollTop=g,p=e!==window)):f===o?(g=l(f),this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=g,h=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==b&&this.pendingScrollCallbacks.master.left++,d.scrollLeft=g,i&&i.scrollLeft!==g&&(null==b&&this.pendingScrollCallbacks.top.left++,i.scrollLeft=g,p=e!==window)),null!==b&&(h=!0,e.scrollTop+=b)):f===i?(g=l(f),this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=g,h=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==b&&this.pendingScrollCallbacks.master.left++,d.scrollLeft=g),null!==b&&(h=!0,e.scrollTop+=b),o&&o.scrollLeft!==g&&(null==b&&this.pendingScrollCallbacks.bottom.left++,o.scrollLeft=g,p=e!==window)):f===j?(g=m(f),this.overlayScrollPositions.left.top!==g&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=g,h=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==b&&this.pendingScrollCallbacks.master.top++,e.scrollTop=g)),null!==b&&(h=!0,e.scrollLeft+=b)):f!==k&&f!==n||null!==b&&(h=!0,"x"===c?e.scrollLeft+=b:"y"===c&&(e.scrollTop+=b)),!this.keyPressed&&h&&"scroll"===a.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),p&&(this.delegatedScrollCallback=!0))}},syncScrollWithMaster:function(){var a=this.topOverlay.mainTableScrollableElement,b=a,c=b.scrollLeft,d=b.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=c),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=c),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=d)},updateMainScrollableElements:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=j(this.wot.wtTable.TABLE),this.registerListeners()},destroy:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0},refresh:function(){var a=void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var b=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,c=b.clientWidth,d=b.clientHeight;c===this.spreaderLastSize.width&&d===this.spreaderLastSize.height||(this.spreaderLastSize.width=c,this.spreaderLastSize.height=d,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(a),this.leftOverlay.refresh(a),this.topOverlay.refresh(a),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(a),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(a),this.debug&&this.debug.refresh(a)},adjustElementsSize:function(){var a=void 0!==arguments[0]&&arguments[0],b=this.wot.getSetting("totalColumns"),c=this.wot.getSetting("totalRows"),d=this.wot.wtViewport.getRowHeaderWidth(),e=this.wot.wtViewport.getColumnHeaderHeight(),f=this.wot.wtTable.hider.style;f.width=d+this.leftOverlay.sumCellSizes(0,b)+"px",f.height=e+this.topOverlay.sumCellSizes(0,c)+1+"px",this.topOverlay.adjustElementsSize(a),this.leftOverlay.adjustElementsSize(a),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(a)},applyToDOM:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()},getParentOverlay:function(a){if(!a)return null;var b=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],c=null;return n(b,function(b,d){b&&b.clone&&b.clone.wtTable.TABLE.contains(a)&&(c=b.clone)}),c}},{}),window.WalkontableOverlays=r},{eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/dom/element":47,"helpers/unicode":56}],18:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableScroll:{get:function(){return o}},__esModule:{value:!0}});var d,e,f=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.innerHeight,h=f.innerWidth,i=f.getScrollLeft,j=f.getScrollTop,k=f.offset,l=(e=a("helpers/number"))&&e.__esModule&&e||{default:e},m=l.rangeEach,n=l.rangeEachReverse,o=function(b){this.wot=b,this.instance=b};$traceurRuntime.createClass(o,{scrollViewport:function(a){if(this.wot.drawn){var b=this._getVariables(),c=b.topOverlay,d=b.leftOverlay,e=b.totalRows,f=b.totalColumns,g=b.fixedRowsTop,h=b.fixedRowsBottom,i=b.fixedColumnsLeft;if(a.row<0||a.row>Math.max(e-1,0))throw new Error("row "+a.row+" does not exist");if(a.col<0||a.col>Math.max(f-1,0))throw new Error("column "+a.col+" does not exist");a.row>=g&&a.row<this.getFirstVisibleRow()?c.scrollTo(a.row):a.row>this.getLastVisibleRow()&&a.row<e-h&&c.scrollTo(a.row,!0),a.col>=i&&a.col<this.getFirstVisibleColumn()?d.scrollTo(a.col):a.col>this.getLastVisibleColumn()&&d.scrollTo(a.col,!0)}},getFirstVisibleRow:function(){var a=this._getVariables(),b=a.topOverlay,c=a.wtTable,d=a.wtViewport,e=a.totalRows,f=a.fixedRowsTop,h=c.getFirstVisibleRow();if(b.mainTableScrollableElement===window){var i=k(c.wtRootElement),l=g(c.hider),m=g(window),o=j(window);if(i.top+l-m<=o){var p=d.getColumnHeaderHeight();p+=b.sumCellSizes(0,f),n(e,1,function(a){if(p+=b.sumCellSizes(a-1,a),i.top+l-p<=o)return h=a,!1})}}return h},getLastVisibleRow:function(){var a=this._getVariables(),b=a.topOverlay,c=a.wtTable,d=a.wtViewport,e=a.totalRows,f=c.getLastVisibleRow();if(b.mainTableScrollableElement===window){var h=k(c.wtRootElement),i=g(window),l=j(window);if(h.top>l){var n=d.getColumnHeaderHeight();m(1,e,function(a){if(n+=b.sumCellSizes(a-1,a),h.top+n-l>=i)return f=a-2,!1})}}return f},getFirstVisibleColumn:function(){var a=this._getVariables(),b=a.leftOverlay,c=a.wtTable,d=a.wtViewport,e=a.totalColumns,g=(a.fixedColumnsLeft,c.getFirstVisibleColumn());if(b.mainTableScrollableElement===window){var j=k(c.wtRootElement),l=h(c.hider),m=h(window),o=i(window);if(j.left+l-m<=o){var p=d.getRowHeaderWidth();n(e,1,function(a){if(p+=b.sumCellSizes(a-1,a),j.left+l-p<=o)return g=a,!1})}}return g},getLastVisibleColumn:function(){var a=this._getVariables(),b=a.leftOverlay,c=a.wtTable,d=a.wtViewport,e=a.totalColumns,f=c.getLastVisibleColumn();if(b.mainTableScrollableElement===window){var g=k(c.wtRootElement),j=h(window),l=i(window);if(g.left>l){var n=d.getRowHeaderWidth();m(1,e,function(a){if(n+=b.sumCellSizes(a-1,a),g.left+n-l>=j)return f=a-2,!1})}}return f},_getVariables:function(){var a=this.wot;return{topOverlay:a.wtOverlays.topOverlay,leftOverlay:a.wtOverlays.leftOverlay,wtTable:a.wtTable,wtViewport:a.wtViewport,totalRows:a.getSetting("totalRows"),totalColumns:a.getSetting("totalColumns"),fixedRowsTop:a.getSetting("fixedRowsTop"),fixedRowsBottom:a.getSetting("fixedRowsBottom"),fixedColumnsLeft:a.getSetting("fixedColumnsLeft")}}},{}),window.WalkontableScroll=o},{"helpers/dom/element":47,"helpers/number":52}],19:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableSelection:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,i=((e=a("border"))&&e.__esModule&&e||{default:e}).WalkontableBorder,j=((f=a("cell/coords"))&&f.__esModule&&f||{default:f}).WalkontableCellCoords,k=((g=a("cell/range"))&&g.__esModule&&g||{default:g}).WalkontableCellRange,l=function(b,c){this.settings=b,this.cellRange=c||null,this.instanceBorders={}};$traceurRuntime.createClass(l,{getBorder:function(a){if(this.instanceBorders[a.guid])return this.instanceBorders[a.guid];this.instanceBorders[a.guid]=new i(a,this.settings)},isEmpty:function(){return null===this.cellRange},add:function(a){this.isEmpty()?this.cellRange=new k(a,a,a):this.cellRange.expand(a)},replace:function(a,b){if(!this.isEmpty()){if(this.cellRange.from.isEqual(a))return this.cellRange.from=b,!0;if(this.cellRange.to.isEqual(a))return this.cellRange.to=b,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var a=this.cellRange.getTopLeftCorner(),b=this.cellRange.getBottomRightCorner();return[a.row,a.col,b.row,b.col]},addClassAtCoords:function(a,b,c,d){var e=a.wtTable.getCell(new j(b,c));"object"==typeof e&&h(e,d)},draw:function(a){if(this.isEmpty()){if(this.settings.border){var b=this.getBorder(a);b&&b.disappear()}}else{for(var f,g,i,c=a.wtTable.getRenderedRowsCount(),d=a.wtTable.getRenderedColumnsCount(),e=this.getCorners(),j=0;j<d;j++)if((g=a.wtTable.columnFilter.renderedToSource(j))>=e[1]&&g<=e[3]&&(i=a.wtTable.getColumnHeader(g))){var k=[];this.settings.highlightHeaderClassName&&k.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&k.push(this.settings.highlightColumnClassName),h(i,k)}for(var l=0;l<c;l++){if((f=a.wtTable.rowFilter.renderedToSource(l))>=e[0]&&f<=e[2]&&(i=a.wtTable.getRowHeader(f))){var m=[];this.settings.highlightHeaderClassName&&m.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&m.push(this.settings.highlightRowClassName),h(i,m)}for(var n=0;n<d;n++)g=a.wtTable.columnFilter.renderedToSource(n),f>=e[0]&&f<=e[2]&&g>=e[1]&&g<=e[3]?this.settings.className&&this.addClassAtCoords(a,f,g,this.settings.className):f>=e[0]&&f<=e[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(a,f,g,this.settings.highlightRowClassName):g>=e[1]&&g<=e[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(a,f,g,this.settings.highlightColumnClassName)}if(a.getSetting("onBeforeDrawBorders",e,this.settings.className),this.settings.border){var o=this.getBorder(a);o&&o.appear(e)}}}},{}),window.WalkontableSelection=l},{border:3,"cell/coords":6,"cell/range":7,"helpers/dom/element":47}],20:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableSettings:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).fastInnerText,f=function(b,c){var d=this;this.wot=b,this.instance=b,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(a,b,c){var f=d.getSetting("data",a,b);e(c,void 0===f||null===f?"":f)},columnWidth:function(a){},rowHeight:function(a){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(a){return a},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var f in this.defaults)if(this.defaults.hasOwnProperty(f))if(void 0!==c[f])this.settings[f]=c[f];else{if(void 0===this.defaults[f])throw new Error('A required setting "'+f+'" was not provided');this.settings[f]=this.defaults[f]}};$traceurRuntime.createClass(f,{update:function(a,b){if(void 0===b)for(var c in a)a.hasOwnProperty(c)&&(this.settings[c]=a[c]);else this.settings[a]=b;return this.wot},getSetting:function(a,b,c,d,e){return"function"==typeof this.settings[a]?this.settings[a](b,c,d,e):void 0!==b&&Array.isArray(this.settings[a])?this.settings[a][b]:this.settings[a]},has:function(a){return!!this.settings[a]}},{}),window.WalkontableSettings=f},{"helpers/dom/element":47}],21:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableTable:{get:function(){return A}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},l=k.getStyle,m=k.getTrimmingContainer,n=k.hasClass,o=k.index,p=k.offset,q=k.removeClass,r=k.removeTextNodes,s=k.overlayContainsElement,t=k.closest,u=((e=a("helpers/function"))&&e.__esModule&&e||{default:e}).isFunction,v=((f=a("cell/coords"))&&f.__esModule&&f||{default:f}).WalkontableCellCoords,x=((g=a("cell/range"))&&g.__esModule,((h=a("filter/column"))&&h.__esModule&&h||{default:h}).WalkontableColumnFilter),y=((i=a("filter/row"))&&i.__esModule&&i||{default:i}).WalkontableRowFilter,z=((j=a("tableRenderer"))&&j.__esModule&&j||{default:j}).WalkontableTableRenderer,A=function(b,c){var d=this;this.wot=b,this.instance=this.wot,this.TABLE=c,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,r(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var e=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return d._modifyRowHeaderWidth(e)}};$traceurRuntime.createClass(A,{fixTableDomTree:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))},createSpreader:function(a){var c,b=a.parentNode;return b&&1===b.nodeType&&n(b,"wtHolder")||(c=document.createElement("div"),c.className="wtSpreader",b&&b.insertBefore(c,a),c.appendChild(a)),c.style.position="relative",c},createHider:function(a){var c,b=a.parentNode;return b&&1===b.nodeType&&n(b,"wtHolder")||(c=document.createElement("div"),c.className="wtHider",b&&b.insertBefore(c,a),c.appendChild(a)),c},createHolder:function(a){var c,b=a.parentNode;return b&&1===b.nodeType&&n(b,"wtHolder")||(c=document.createElement("div"),c.style.position="relative",c.className="wtHolder",b&&b.insertBefore(c,a),this.isWorkingOnClone()||(c.parentNode.className+="ht_master handsontable"),c.appendChild(a)),c},alignOverlaysWithTrimmingContainer:function(){var a=m(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",a===window){var b=this.wot.getSetting("preventOverflow");b||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=l(a,"width"),this.holder.style.height=l(a,"height"),this.holder.style.overflow=""},isWorkingOnClone:function(){return!!this.wot.cloneSource},draw:function(a){var b=this.wot,c=b.wtOverlays,d=b.wtViewport,e=this.instance.getSetting("totalRows"),f=this.wot.getSetting("rowHeaders").length,g=this.wot.getSetting("columnHeaders").length,h=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=p(this.holder),a=d.createRenderCalculators(a),f&&!this.wot.getSetting("fixedColumnsLeft"))){var i=c.leftOverlay.getScrollPosition(),j=this.correctHeaderWidth;this.correctHeaderWidth=i>0,j!==this.correctHeaderWidth&&(a=!1)}if(this.isWorkingOnClone()||(h=c.prepareOverlays()),a)this.isWorkingOnClone()||d.createVisibleCalculators(),c&&c.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=p(this.TABLE);var k;k=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?0:WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?Math.max(e-this.wot.getSetting("fixedRowsBottom"),0):d.rowsRenderCalculator.startRow;var l;l=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?0:d.columnsRenderCalculator.startColumn,this.rowFilter=new y(k,e,g),this.columnFilter=new x(l,this.wot.getSetting("totalColumns"),f),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(a),this.isWorkingOnClone()||(c.topOverlay.resetFixedPosition(),c.bottomOverlay.clone&&c.bottomOverlay.resetFixedPosition(),c.leftOverlay.resetFixedPosition(),c.topLeftCornerOverlay&&c.topLeftCornerOverlay.resetFixedPosition(),c.bottomLeftCornerOverlay&&c.bottomLeftCornerOverlay.clone&&c.bottomLeftCornerOverlay.resetFixedPosition()),h&&c.syncScrollWithMaster(),this.wot.drawn=!0,this},_doDraw:function(){new z(this).render()},removeClassFromCells:function(a){for(var b=this.TABLE.querySelectorAll("."+a),c=0,d=b.length;c<d;c++)q(b[c],a)},refreshSelections:function(a){if(this.wot.selections){var b=this.wot.selections.length;if(a)for(var c=0;c<b;c++)this.wot.selections[c].settings.className&&this.removeClassFromCells(this.wot.selections[c].settings.className),this.wot.selections[c].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[c].settings.highlightHeaderClassName),this.wot.selections[c].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[c].settings.highlightRowClassName),this.wot.selections[c].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[c].settings.highlightColumnClassName);for(var d=0;d<b;d++)this.wot.selections[d].draw(this.wot,a)}},getCell:function(a){if(this.isRowBeforeRenderedRows(a.row))return-1;if(this.isRowAfterRenderedRows(a.row))return-2;var b=this.TBODY.childNodes[this.rowFilter.sourceToRendered(a.row)];return b?b.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(a.col)]:void 0},getColumnHeader:function(a){var b=void 0!==arguments[1]?arguments[1]:0,c=this.THEAD.childNodes[b];if(c)return c.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(a)]},getRowHeader:function(a){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var b=this.TBODY.childNodes[this.rowFilter.sourceToRendered(a)];return b?b.childNodes[0]:void 0},getCoords:function(a){"TD"!==a.nodeName&&"TH"!==a.nodeName&&(a=t(a,["TD","TH"]));var b=a.parentNode,c=b.parentNode,d=o(b),e=a.cellIndex;return s(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,a)||s(WalkontableOverlay.CLONE_TOP,a)?"THEAD"===c.nodeName&&(d-=c.childNodes.length):d=c===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(d):this.rowFilter.renderedToSource(d),e=s(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,a)||s(WalkontableOverlay.CLONE_LEFT,a)?this.columnFilter.offsettedTH(e):this.columnFilter.visibleRowHeadedColumnToSourceColumn(e),new v(d,e)},getTrForRow:function(a){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(a)]},getFirstRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function(a){return this.rowFilter&&this.rowFilter.sourceToRendered(a)<0&&a>=0},isRowAfterViewport:function(a){return this.rowFilter&&this.rowFilter.sourceToRendered(a)>this.getLastVisibleRow()},isRowAfterRenderedRows:function(a){return this.rowFilter&&this.rowFilter.sourceToRendered(a)>this.getLastRenderedRow()},isColumnBeforeViewport:function(a){return this.columnFilter&&this.columnFilter.sourceToRendered(a)<0&&a>=0},isColumnAfterViewport:function(a){return this.columnFilter&&this.columnFilter.sourceToRendered(a)>this.getLastVisibleColumn()},isLastRowFullyVisible:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var a=this.wot.wtViewport.columnsRenderCalculator.count,b=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG))a=b;else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),b);return a},getRenderedRowsCount:function(){var a=this.wot.wtViewport.rowsRenderCalculator.count,b=this.wot.getSetting("totalRows");return this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)?a=b:this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?a=Math.min(this.wot.getSetting("fixedRowsTop"),b):(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(a=Math.min(this.wot.getSetting("fixedRowsBottom"),b)),a},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function(a){var b=this.wot.wtSettings.settings.rowHeight(a),c=this.wot.wtViewport.oversizedRows[a];return void 0!==c&&(b=void 0===b?c:Math.max(b,c)),b},getColumnHeaderHeight:function(a){var b=this.wot.wtSettings.settings.defaultRowHeight,c=this.wot.wtViewport.oversizedColumnHeaders[a];return void 0!==c&&(b=b?Math.max(b,c):c),b},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function(a){var b=this.wot.wtSettings.settings.columnWidth;return"function"==typeof b?b=b(a):"object"==typeof b&&(b=b[a]),b||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function(a){var b=this.getColumnWidth(a),c=null==b?this.instance.wtSettings.settings.defaultColumnWidth:b,d=this.wot.wtViewport.columnsRenderCalculator;if(d){var e=d.getStretchedColumnWidth(a,c);e&&(c=e)}return c},_modifyRowHeaderWidth:function(a){var b=u(a)?a():null;return Array.isArray(b)?(b=$traceurRuntime.spread(b),b[b.length-1]=this._correctRowHeaderWidth(b[b.length-1])):b=this._correctRowHeaderWidth(b),b},_correctRowHeaderWidth:function(a){return"number"!=typeof a&&(a=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&a++,a}},{}),window.WalkontableTable=A},{"cell/coords":6,"cell/range":7,"filter/column":10,"filter/row":11,"helpers/dom/element":47,"helpers/function":50,tableRenderer:22}],22:[function(a,b,c){"use strict";function n(a,b){var c=document.createElement("TH");return b.insertBefore(c,a),b.removeChild(a),c}function o(a,b){var c=document.createElement("TD");return b.insertBefore(c,a),b.removeChild(a),c}Object.defineProperties(c,{WalkontableTableRenderer:{get:function(){return m}},__esModule:{value:!0}});var d,e=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},f=e.addClass,g=e.empty,h=e.getScrollbarWidth,i=e.hasClass,j=e.innerHeight,k=e.outerWidth,l=!1,m=function(b){this.wtTable=b,this.wot=b.instance,this.instance=b.instance,this.rowFilter=b.rowFilter,this.columnFilter=b.columnFilter,this.TABLE=b.TABLE,this.THEAD=b.THEAD,this.TBODY=b.TBODY,this.COLGROUP=b.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0};$traceurRuntime.createClass(m,{render:function(){if(!this.wtTable.isWorkingOnClone()){var a={};if(this.wot.getSetting("beforeDraw",!0,a),!0===a.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var f,b=this.wtTable.getRenderedColumnsCount(),c=this.wtTable.getRenderedRowsCount(),d=this.wot.getSetting("totalColumns"),e=this.wot.getSetting("totalRows"),g=!1;if((WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),d>=0&&(this.adjustAvailableNodes(),g=!0,this.renderColumnHeaders(),this.renderRows(e,c,b),this.wtTable.isWorkingOnClone()||(f=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(b),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),g||this.adjustAvailableNodes(),this.removeRedundantRows(c),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var h=k(this.wtTable.hider),i=k(this.wtTable.TABLE);if(0!==h&&i!==h&&this.adjustColumnWidths(b),f!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var j=this.wtTable.getFirstRenderedColumn(),l=this.wtTable.getLastRenderedColumn(),m=this.wot.getSetting("defaultColumnWidth"),n=this.wot.getSetting("rowHeaderWidth");if(null!=(n=this.instance.getSetting("onModifyRowHeaderWidth",n)))for(var o=0;o<this.rowHeaderCount;o++){var p=Array.isArray(n)?n[o]:n;p=null==p?m:p,this.COLGROUP.childNodes[o].style.width=p+"px"}for(var q=j;q<l;q++){var r=this.wtTable.getStretchedColumnWidth(q),s=this.columnFilter.sourceToRendered(q);this.COLGROUP.childNodes[s+this.rowHeaderCount].style.width=r+"px"}}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(a,b,c){for(var e,f=0,g=this.rowFilter.renderedToSource(f),h=this.wtTable.isWorkingOnClone();g<a&&g>=0&&(!l&&f>1e3&&(l=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===b||f!==b);){if(e=this.getOrCreateTrForRow(f,e),this.renderRowHeaders(g,e),this.adjustColumns(e,c+this.rowHeaderCount),this.renderCells(g,e,c),h&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.resetOversizedRow(g),e.firstChild){var i=this.wot.wtTable.getRowHeight(g);i?(i--,e.firstChild.style.height=i+"px"):e.firstChild.style.height=""}f++,g=this.rowFilter.renderedToSource(f)}},resetOversizedRow:function(a){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[a]&&(this.wot.wtViewport.oversizedRows[a]=void 0)},markOversizedRows:function(){if(!this.wot.getSetting("externalRowCalculator")){var d,e,f,g,h,a=this.instance.wtTable.TBODY.childNodes.length,b=a*this.instance.wtSettings.settings.defaultRowHeight,c=j(this.instance.wtTable.TBODY)-1;this.instance.getSetting("totalRows");if(b!==c||this.instance.getSetting("fixedRowsBottom"))for(;a;)a--,f=this.instance.wtTable.rowFilter.renderedToSource(a),d=this.instance.wtTable.getRowHeight(f),g=this.instance.wtTable.getTrForRow(f),h=g.querySelector("th"),e=h?j(h):j(g)-1,(!d&&this.instance.wtSettings.settings.defaultRowHeight<e||d<e)&&(this.instance.wtViewport.oversizedRows[f]=++e)}},markOversizedColumnHeaders:function(){var a=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[a]&&!this.wtTable.isWorkingOnClone()){for(var b=this.wtTable.getRenderedColumnsCount(),c=0;c<this.columnHeaderCount;c++)for(var d=-1*this.rowHeaderCount;d<b;d++)this.markIfOversizedColumnHeader(d);this.wot.wtViewport.hasOversizedColumnHeadersMarked[a]=!0}},adjustColumnHeaderHeights:function(){for(var a=this.wot.getSetting("columnHeaders"),b=this.wot.wtTable.THEAD.childNodes,c=this.wot.wtViewport.oversizedColumnHeaders,d=0,e=a.length;d<e;d++)if(c[d]){if(!b[d]||0===b[d].childNodes.length)return;b[d].childNodes[0].style.height=c[d]+"px"}},markIfOversizedColumnHeader:function(a){for(var e,f,g,b=this.wot.wtTable.columnFilter.renderedToSource(a),c=this.columnHeaderCount,d=this.wot.wtSettings.settings.defaultRowHeight,h=this.wot.getSetting("columnHeaderHeight")||[];c;)c--,e=this.wot.wtTable.getColumnHeaderHeight(c),(f=this.wot.wtTable.getColumnHeader(b,c))&&(g=j(f),(!e&&d<g||e<g)&&(this.wot.wtViewport.oversizedColumnHeaders[c]=g),Array.isArray(h)?null!=h[c]&&(this.wot.wtViewport.oversizedColumnHeaders[c]=h[c]):isNaN(h)||(this.wot.wtViewport.oversizedColumnHeaders[c]=h),this.wot.wtViewport.oversizedColumnHeaders[c]<(h[c]||h)&&(this.wot.wtViewport.oversizedColumnHeaders[c]=h[c]||h))},renderCells:function(a,b,c){for(var d,e,f=0;f<c;f++)e=this.columnFilter.renderedToSource(f),d=0===f?b.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:d.nextSibling,"TH"==d.nodeName&&(d=o(d,b)),i(d,"hide")||(d.className=""),d.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(a,e,d);return d},adjustColumnWidths:function(a){var b=0,c=this.wot.cloneSource?this.wot.cloneSource:this.wot,d=c.wtTable.holder,e=this.wot.getSetting("defaultColumnWidth"),f=this.wot.getSetting("rowHeaderWidth");if(d.offsetHeight<d.scrollHeight&&(b=h()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-b),null!=(f=this.instance.getSetting("onModifyRowHeaderWidth",f)))for(var g=0;g<this.rowHeaderCount;g++){var i=Array.isArray(f)?f[g]:f;i=null==i?e:i,this.COLGROUP.childNodes[g].style.width=i+"px"}for(var j=0;j<a;j++){var k=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(j));this.COLGROUP.childNodes[j+this.rowHeaderCount].style.width=k+"px"}},appendToTbody:function(a){this.TBODY.appendChild(a),this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(a,b){var c;return a>=this.wtTable.tbodyChildrenLength?(c=this.createRow(),this.appendToTbody(c)):c=0===a?this.TBODY.firstChild:b.nextSibling,c.className&&c.removeAttribute("class"),c},createRow:function(){for(var a=document.createElement("TR"),b=0;b<this.rowHeaderCount;b++)a.appendChild(document.createElement("TH"));return a},renderRowHeader:function(a,b,c){c.className="",c.removeAttribute("style"),this.rowHeaders[b](a,c,b)},renderRowHeaders:function(a,b){for(var c=b.firstChild,d=0;d<this.rowHeaderCount;d++)c?"TD"==c.nodeName&&(c=n(c,b)):(c=document.createElement("TH"),b.appendChild(c)),this.renderRowHeader(a,d,c),c=c.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups(),this.adjustThead()},renderColumnHeaders:function(){if(this.columnHeaderCount)for(var a=this.wtTable.getRenderedColumnsCount(),b=0;b<this.columnHeaderCount;b++)for(var c=this.getTrForColumnHeaders(b),d=-1*this.rowHeaderCount;d<a;d++){var e=this.columnFilter.renderedToSource(d);this.renderColumnHeader(b,e,c.childNodes[d+this.rowHeaderCount])}},adjustColGroups:function(){for(var a=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<a+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>a+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&f(this.COLGROUP.childNodes[0],"rowHeader")},adjustThead:function(){var a=this.wtTable.getRenderedColumnsCount(),b=this.THEAD.firstChild;if(this.columnHeaders.length){for(var c=0,d=this.columnHeaders.length;c<d;c++){for(b=this.THEAD.childNodes[c],b||(b=document.createElement("TR"),this.THEAD.appendChild(b)),this.theadChildrenLength=b.childNodes.length;this.theadChildrenLength<a+this.rowHeaderCount;)b.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>a+this.rowHeaderCount;)b.removeChild(b.lastChild),this.theadChildrenLength--}var e=this.THEAD.childNodes.length;if(e>this.columnHeaders.length)for(var f=this.columnHeaders.length;f<e;f++)this.THEAD.removeChild(this.THEAD.lastChild)}else b&&g(b)},getTrForColumnHeaders:function(a){return this.THEAD.childNodes[a]},renderColumnHeader:function(a,b,c){return c.className="",c.removeAttribute("style"),this.columnHeaders[a](b,c,a)},adjustColumns:function(a,b){for(var c=a.childNodes.length;c<b;){var d=document.createElement("TD");a.appendChild(d),c++}for(;c>b;)a.removeChild(a.lastChild),c--},removeRedundantColumns:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{}),window.WalkontableTableRenderer=m},{"helpers/dom/element":47}],23:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableViewport:{get:function(){return v}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},l=k.getScrollbarWidth,n=(k.getScrollTop,k.getStyle),o=k.offset,p=k.outerHeight,q=k.outerWidth,r=((f=a("helpers/object"))&&f.__esModule&&f||{default:f}).objectEach,s=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).EventManager,t=((h=a("calculator/viewportColumns"))&&h.__esModule&&h||{default:h}).WalkontableViewportColumnsCalculator,u=((i=a("calculator/viewportRows"))&&i.__esModule&&i||{default:i}).WalkontableViewportRowsCalculator,v=function(b){var c=this;this.wot=b,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new s(this.wot),this.eventManager.addEventListener(window,"resize",function(){c.clientHeight=c.getWorkspaceHeight()})};$traceurRuntime.createClass(v,{getWorkspaceHeight:function(){var b,a=this.instance.wtOverlays.topOverlay.trimmingContainer,c=0;return a===window?c=document.documentElement.clientHeight:(b=p(a),c=b>0&&a.clientHeight>0?a.clientHeight:1/0),c},getWorkspaceWidth:function(){var a,d,b=this.wot.getSetting("totalColumns"),c=this.instance.wtOverlays.leftOverlay.trimmingContainer,e=this.wot.getSetting("stretchH"),f=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?q(this.instance.wtTable.wtRootElement):(a=j.freezeOverlays?Math.min(f-this.getWorkspaceOffset().left,f):Math.min(this.getContainerFillWidth(),f-this.getWorkspaceOffset().left,f),c===window&&b>0&&this.sumColumnWidths(0,b-1)>a?document.documentElement.clientWidth:c===window||"scroll"!=(d=n(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=d&&"auto"!=d?"none"!==e&&e?a:Math.max(a,q(this.instance.wtTable.TABLE)):Math.max(a,c.clientWidth))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(a,b){for(var c=0;a<b;)c+=this.wot.wtTable.getColumnWidth(a),a++;return c},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var b,c,a=this.instance.wtTable.holder;return c=document.createElement("div"),c.style.width="100%",c.style.height="1px",a.appendChild(c),b=c.offsetWidth,this.containerWidth=b,a.removeChild(c),b},getWorkspaceOffset:function(){return o(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return p(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return q(this.wot.wtTable.TABLE)||q(this.wot.wtTable.TBODY)||q(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=p(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var b,a=this.getWorkspaceHeight();return a===1/0?a:(b=this.getColumnHeaderHeight(),b>0&&(a-=b),a)},getRowHeaderWidth:function(){var a=this.instance.getSetting("rowHeaderWidth"),b=this.instance.getSetting("rowHeaders");if(a){this.rowHeaderWidth=0;for(var c=0,d=b.length;c<d;c++)this.rowHeaderWidth+=a[c]||a}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(b.length){var e=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var f=0,g=b.length;f<g;f++)e?(this.rowHeaderWidth+=q(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth},getViewportWidth:function(){var b,a=this.getWorkspaceWidth();return a===1/0?a:(b=this.getRowHeaderWidth(),b>0?a-b:a)},createRowsCalculator:function(){var c,d,e,f,g,h,i,a=void 0!==arguments[0]&&arguments[0],b=this;return this.rowHeaderWidth=NaN,c=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),d=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),d<0&&(d=0),e=this.wot.getSetting("fixedRowsTop"),g=this.wot.getSetting("fixedRowsBottom"),i=this.wot.getSetting("totalRows"),e&&(h=this.wot.wtOverlays.topOverlay.sumCellSizes(0,e),d+=h,c-=h),g&&this.wot.wtOverlays.bottomOverlay.clone&&(h=this.wot.wtOverlays.bottomOverlay.sumCellSizes(i-g,i),c-=h),f=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:l(),new u(c,d,this.wot.getSetting("totalRows"),function(a){return b.wot.wtTable.getRowHeight(a)},a?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,a,f)},createColumnsCalculator:function(){var d,e,a=void 0!==arguments[0]&&arguments[0],b=this,c=this.getViewportWidth();if(this.columnHeaderHeight=NaN,d=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),d<0&&(d=0),e=this.wot.getSetting("fixedColumnsLeft")){var f=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,e);d+=f,c-=f}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(c-=l()),new t(c,d,this.wot.getSetting("totalColumns"),function(a){return b.wot.wtTable.getColumnWidth(a)},a?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,a,this.wot.getSetting("stretchH"),function(a,c){return b.wot.getSetting("onBeforeStretchingColumnWidth",a,c)})},createRenderCalculators:function(){var a=void 0!==arguments[0]&&arguments[0];if(a){var b=this.createRowsCalculator(!0),c=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(b)&&this.areAllProposedVisibleColumnsAlreadyRendered(c)||(a=!1)}return a||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,a},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(a){return!!this.rowsVisibleCalculator&&(!(a.startRow<this.rowsRenderCalculator.startRow||a.startRow===this.rowsRenderCalculator.startRow&&a.startRow>0)&&!(a.endRow>this.rowsRenderCalculator.endRow||a.endRow===this.rowsRenderCalculator.endRow&&a.endRow<this.wot.getSetting("totalRows")-1))},areAllProposedVisibleColumnsAlreadyRendered:function(a){return!!this.columnsVisibleCalculator&&(!(a.startColumn<this.columnsRenderCalculator.startColumn||a.startColumn===this.columnsRenderCalculator.startColumn&&a.startColumn>0)&&!(a.endColumn>this.columnsRenderCalculator.endColumn||a.endColumn===this.columnsRenderCalculator.endColumn&&a.endColumn<this.wot.getSetting("totalColumns")-1))},resetHasOversizedColumnHeadersMarked:function(){r(this.hasOversizedColumnHeadersMarked,function(a,b,c){c[b]=void 0})}},{}),window.WalkontableViewport=v},{browser:24,"calculator/viewportColumns":4,"calculator/viewportRows":5,eventManager:42,"helpers/dom/element":47,"helpers/object":53}],24:[function(a,b,c){"use strict";function B(a,b){var c=new B.Core(a,b||{});return c.init(),c}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;b.exports=B,B.utils={},(d=a("shims/runtime"))&&d.__esModule,(e=a("es6collections"))&&e.__esModule;var C=((f=a("pluginHooks"))&&f.__esModule&&f||{default:f}).Hooks,D=((g=a("numbro"))&&g.__esModule&&g||{default:g}).default,E=((h=a("moment"))&&h.__esModule&&h||{default:h}).default;"object"==typeof window&&(void 0===window.numbro&&(window.numbro=D),void 0===window.moment&&(window.moment=E)),B.hooks||(B.hooks=new C),B.utils.Hooks=C,(i=a("core"))&&i.__esModule,(j=a("renderers/_cellDecorator"))&&j.__esModule,(k=a("cellTypes"))&&k.__esModule,(l=a("plugins/jqueryHandsontable"))&&l.__esModule;var F=(m=a("helpers/array"))&&m.__esModule&&m||{default:m},G=(n=a("helpers/browser"))&&n.__esModule&&n||{default:n},H=(o=a("helpers/data"))&&o.__esModule&&o||{default:o},I=(p=a("helpers/date"))&&p.__esModule&&p||{default:p},J=(q=a("helpers/feature"))&&q.__esModule&&q||{default:q},K=(r=a("helpers/function"))&&r.__esModule&&r||{default:r},L=(s=a("helpers/mixed"))&&s.__esModule&&s||{default:s},M=(t=a("helpers/number"))&&t.__esModule&&t||{default:t},N=(u=a("helpers/object"))&&u.__esModule&&u||{default:u},O=(v=a("helpers/setting"))&&v.__esModule&&v||{default:v},P=(w=a("helpers/string"))&&w.__esModule&&w||{default:w},Q=(x=a("helpers/unicode"))&&x.__esModule&&x||{default:x},R=(y=a("helpers/dom/element"))&&y.__esModule&&y||{default:y},S=(z=a("helpers/dom/event"))&&z.__esModule&&z||{default:z},T=[F,G,H,I,J,K,L,M,N,O,P,Q],U=[R,S];B.buildDate="Mon Apr 03 2017 15:02:25 GMT+0200 (CEST)",B.packageName="handsontable-pro",B.version="1.10.2";var V="0.31.2";/^@@/.test(V)||(B.baseVersion=V),B.plugins={};var W=((A=a("plugins"))&&A.__esModule&&A||{default:A}).registerPlugin;B.plugins.registerPlugin=W,B.helper={},B.dom={},B.Dom=B.dom,F.arrayEach(T,function(a){F.arrayEach(Object.getOwnPropertyNames(a),function(b){"_"!==b.charAt(0)&&(B.helper[b]=a[b])})}),F.arrayEach(U,function(a){F.arrayEach(Object.getOwnPropertyNames(a),function(b){"_"!==b.charAt(0)&&(B.dom[b]=a[b])})})},{cellTypes:25,core:26,es6collections:"es6collections","helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/date":46,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"helpers/unicode":56,moment:"moment",numbro:"numbro",pluginHooks:61,plugins:62,"plugins/jqueryHandsontable":2,"renderers/_cellDecorator":119,"shims/runtime":126}],25:[function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=((d=a("helpers/browser"))&&d.__esModule&&d||{default:d}).isMobileBrowser,C=((e=a("editors"))&&e.__esModule&&e||{default:e}).getEditorConstructor,D=((f=a("renderers"))&&f.__esModule&&f||{default:f}).getRenderer,Y=((g=a("editors/autocompleteEditor"))&&g.__esModule,(h=a("editors/checkboxEditor"))&&h.__esModule,(i=a("editors/dateEditor"))&&i.__esModule,(j=a("editors/dropdownEditor"))&&j.__esModule,(k=a("editors/handsontableEditor"))&&k.__esModule,(l=a("editors/mobileTextEditor"))&&l.__esModule,(m=a("editors/numericEditor"))&&m.__esModule,(n=a("editors/passwordEditor"))&&n.__esModule,(o=a("editors/selectEditor"))&&o.__esModule,(p=a("editors/textEditor"))&&p.__esModule,(q=a("renderers/autocompleteRenderer"))&&q.__esModule,(r=a("renderers/checkboxRenderer"))&&r.__esModule,(s=a("renderers/htmlRenderer"))&&s.__esModule,(t=a("renderers/numericRenderer"))&&t.__esModule,(u=a("renderers/passwordRenderer"))&&u.__esModule,(v=a("renderers/textRenderer"))&&v.__esModule,(w=a("validators/autocompleteValidator"))&&w.__esModule,(x=a("validators/dateValidator"))&&x.__esModule,(y=a("validators/timeValidator"))&&y.__esModule,(z=a("validators/numericValidator"))&&z.__esModule,((A=a("browser"))&&A.__esModule&&A||{default:A}).default);Y.AutocompleteCell={editor:C("autocomplete"),renderer:D("autocomplete"),validator:Y.AutocompleteValidator},Y.CheckboxCell={editor:C("checkbox"),renderer:D("checkbox")},Y.TextCell={editor:C(B()?"mobile":"text"),renderer:D("text")},Y.NumericCell={editor:C("numeric"),renderer:D("numeric"),validator:Y.NumericValidator,dataType:"number"},Y.DateCell={editor:C("date"),validator:Y.DateValidator,renderer:D("autocomplete")},Y.TimeCell={editor:C("text"),validator:Y.TimeValidator,renderer:D("text")},Y.HandsontableCell={editor:C("handsontable"),renderer:D("autocomplete")},Y.PasswordCell={editor:C("password"),renderer:D("password"),copyable:!1},Y.DropdownCell={editor:C("dropdown"),renderer:D("autocomplete"),validator:Y.AutocompleteValidator},Y.cellTypes={text:Y.TextCell,date:Y.DateCell,time:Y.TimeCell,numeric:Y.NumericCell,checkbox:Y.CheckboxCell,autocomplete:Y.AutocompleteCell,handsontable:Y.HandsontableCell,password:Y.PasswordCell,dropdown:Y.DropdownCell},Y.cellLookup={validator:{numeric:Y.NumericValidator,autocomplete:Y.AutocompleteValidator}}},{browser:24,editors:30,"editors/autocompleteEditor":32,"editors/checkboxEditor":33,"editors/dateEditor":34,"editors/dropdownEditor":35,"editors/handsontableEditor":36,"editors/mobileTextEditor":37,"editors/numericEditor":38,"editors/passwordEditor":39,"editors/selectEditor":40,"editors/textEditor":41,"helpers/browser":44,renderers:118,"renderers/autocompleteRenderer":120,"renderers/checkboxRenderer":121,"renderers/htmlRenderer":122,"renderers/numericRenderer":123,"renderers/passwordRenderer":124,"renderers/textRenderer":125,"validators/autocompleteValidator":135,"validators/dateValidator":136,"validators/numericValidator":137,"validators/timeValidator":138}],26:[function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,B=((e=a("numbro"))&&e.__esModule&&e||{default:e}).default,C=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},D=C.addClass,E=C.empty,F=C.isChildOfWebComponentTable,G=C.removeClass,H=((g=a("helpers/setting"))&&g.__esModule&&g||{default:g}).columnFactory,I=((h=a("helpers/function"))&&h.__esModule&&h||{default:h}).isFunction,J=(i=a("helpers/mixed"))&&i.__esModule&&i||{default:i},K=J.isDefined,L=J.isUndefined,M=((j=a("helpers/browser"))&&j.__esModule&&j||{default:j}).isMobileBrowser,N=((k=a("dataMap"))&&k.__esModule&&k||{default:k}).DataMap,O=((l=a("editorManager"))&&l.__esModule&&l||{default:l}).EditorManager,P=((m=a("eventManager"))&&m.__esModule&&m||{default:m}).eventManager,Q=(n=a("helpers/object"))&&n.__esModule&&n||{default:n},R=Q.deepClone,S=Q.duckSchema,T=Q.extend,U=Q.isObject,V=Q.isObjectEquals,W=Q.deepObjectSize,X=Q.createObjectPropListener,Y=(o=a("helpers/array"))&&o.__esModule&&o||{default:o},Z=Y.arrayFlatten,$=Y.arrayMap,_=((p=a("plugins"))&&p.__esModule&&p||{default:p}).getPlugin,aa=((q=a("renderers"))&&q.__esModule&&q||{default:q}).getRenderer,ba=((r=a("helpers/string"))&&r.__esModule&&r||{default:r}).randomString,ca=((s=a("helpers/number"))&&s.__esModule&&s||{default:s}).rangeEach,da=((t=a("tableView"))&&t.__esModule&&t||{default:t}).TableView,ea=((u=a("dataSource"))&&u.__esModule&&u||{default:u}).DataSource,fa=(v=a("helpers/data"))&&v.__esModule&&v||{default:v},ga=fa.translateRowsToColumns,ha=fa.cellMethodLookupFactory,ia=fa.spreadsheetColumnLabel,ja=((w=a("utils/recordTranslator"))&&w.__esModule&&w||{default:w}).getTranslator,ka=((x=a("3rdparty/walkontable/src/cell/coords"))&&x.__esModule&&x||{default:x}).WalkontableCellCoords,la=((y=a("3rdparty/walkontable/src/cell/range"))&&y.__esModule&&y||{default:y}).WalkontableCellRange,ma=((z=a("3rdparty/walkontable/src/calculator/viewportColumns"))&&z.__esModule&&z||{default:z}).WalkontableViewportColumnsCalculator;A.activeGuid=null,A.Core=function(b,c){function n(){var a=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,a=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(a){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==a&&(a=!0,this.onQueueEmpty(this.valid))}}}function o(a,b,c){function m(){var d;a.length&&(d=A.hooks.run(j,"beforeChange",a,b),I(d)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===d&&a.splice(0,a.length)),c()}var d=new n;d.onQueueEmpty=m;for(var f=a.length-1;f>=0;f--)if(null===a[f])a.splice(f,1);else{var g=a[f][0],h=e.propToCol(a[f][1]),i=j.getCellMeta(g,h);if("numeric"===i.type&&"string"==typeof a[f][3]&&a[f][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(a[f][3])||i.format)){var k=a[f][3].length;L(i.language)?B.culture("en-US"):a[f][3].indexOf(".")===k-3&&-1===a[f][3].indexOf(",")?B.culture("en-US"):B.culture(i.language);B.cultureData(B.culture()).delimiters;B.validate(a[f][3])&&!isNaN(a[f][3])?a[f][3]=parseFloat(a[f][3]):a[f][3]=B().unformat(a[f][3])||a[f][3]}j.getCellValidator(i)&&(d.addValidatorToQueue(),j.validateCell(a[f][3],i,function(b,c){return function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");if(!1===e&&!1===c.allowInvalid){a.splice(b,1),c.valid=!0;var f=j.getCell(c.row,c.col);G(f,j.getSettings().invalidCellClassName),--b}d.removeValidatorFormQueue()}}(f,i),b))}d.checkIfQueueIsEmpty()}function p(a,b){var c=a.length-1;if(!(c<0)){for(;0<=c;c--){var f=!1;if(null!==a[c]){if(null!=a[c][2]||null!=a[c][3]){if(d.settings.allowInsertRow)for(;a[c][0]>j.countRows()-1;){var i=e.createRow(void 0,void 0,b);if(0===i){f=!0;break}}if(!f){if("array"===j.dataType&&(!d.settings.columns||0===d.settings.columns.length)&&d.settings.allowInsertColumn)for(;e.propToCol(a[c][1])>j.countCols()-1;)e.createCol(void 0,void 0,b);e.set(a[c][0],a[c][1],a[c][3])}}}else a.splice(c,1)}j.forceFullRender=!0,g.adjustRowsAndCols(),A.hooks.run(j,"beforeChangeRender",a,b),h.refreshBorders(null,!0),j.view.wt.wtOverlays.adjustElementsSize(),A.hooks.run(j,"afterChange",a,b||"edit");var k=j.getActiveEditor();k&&K(k.refreshValue)&&k.refreshValue()}}function q(a,b,c){return"object"==typeof a?a:[[a,b,c]]}function r(a){if(a.hasOwnProperty("type")){var b,c={};if("object"==typeof a.type)b=a.type;else if("string"==typeof a.type&&void 0===(b=A.cellTypes[a.type]))throw new Error('You declared cell type "'+a.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var d in b)b.hasOwnProperty(d)&&!a.hasOwnProperty(d)&&(c[d]=b[d]);return c}}function t(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var d,e,f,g,h,i,j=this,k=function(){},l=P(j),m=ja(j);T(k.prototype,na.prototype),T(k.prototype,c),T(k.prototype,r(c)),this.rootElement=b,this.isHotTableEnv=F(this.rootElement),A.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.renderCall=!1,b.insertBefore(this.container,b.firstChild),this.guid="ht_"+ba(),f=new ea(j),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),d={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new k,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},g={alter:function(a,b,c,f,i){function l(a,b,c,d){var e=function(){var a;return"array"===d?a=[]:"object"===d&&(a={}),a},f=$(new Array(c),function(){return e()});f.unshift(b,0),a.splice.apply(a,f)}var k;switch(c=c||1,a){case"insert_row":var n=j.countSourceRows();if(j.getSettings().maxRows===n)return;b=K(b)?b:n,k=e.createRow(b,c,f),l(d.cellSettings,b,c,"array"),k&&(h.isSelected()&&d.selRange.from.row>=b?(d.selRange.from.row=d.selRange.from.row+k,h.transformEnd(k,0)):h.refreshBorders());break;case"insert_col":k=e.createCol(b,c,f);for(var o=0,p=j.countSourceRows();o<p;o++)d.cellSettings[o]&&l(d.cellSettings[o],b,c);if(k){if(Array.isArray(j.getSettings().colHeaders)){var q=[b,0];q.length+=k,Array.prototype.splice.apply(j.getSettings().colHeaders,q)}h.isSelected()&&d.selRange.from.col>=b?(d.selRange.from.col=d.selRange.from.col+k,h.transformEnd(0,k)):h.refreshBorders()}break;case"remove_row":e.removeRow(b,c,f),d.cellSettings.splice(b,c);var r=j.countRows(),s=j.getSettings().fixedRowsTop;s>=b+1&&(j.getSettings().fixedRowsTop-=Math.min(c,s-b));var t=j.getSettings().fixedRowsBottom;t&&b>=r-t&&(j.getSettings().fixedRowsBottom-=Math.min(c,t)),g.adjustRowsAndCols(),h.refreshBorders();break;case"remove_col":var u=m.toPhysicalColumn(b);e.removeCol(b,c,f);for(var v=0,w=j.countSourceRows();v<w;v++)d.cellSettings[v]&&d.cellSettings[v].splice(u,c);var x=j.getSettings().fixedColumnsLeft;x>=b+1&&(j.getSettings().fixedColumnsLeft-=Math.min(c,x-b)),Array.isArray(j.getSettings().colHeaders)&&(void 0===u&&(u=-1),j.getSettings().colHeaders.splice(u,c)),g.adjustRowsAndCols(),h.refreshBorders();break;default:throw new Error('There is no such action "'+a+'"')}i||g.adjustRowsAndCols()},adjustRowsAndCols:function(){if(d.settings.minRows){var a=j.countRows();if(a<d.settings.minRows)for(var b=0,c=d.settings.minRows;b<c-a;b++)e.createRow(j.countRows(),1,"auto")}if(d.settings.minSpareRows){var f=j.countEmptyRows(!0);if(f<d.settings.minSpareRows)for(;f<d.settings.minSpareRows&&j.countSourceRows()<d.settings.maxRows;f++)e.createRow(j.countRows(),1,"auto")}var g;if((d.settings.minCols||d.settings.minSpareCols)&&(g=j.countEmptyCols(!0)),d.settings.minCols&&!d.settings.columns&&j.countCols()<d.settings.minCols)for(;j.countCols()<d.settings.minCols;g++)e.createCol(j.countCols(),1,"auto");if(d.settings.minSpareCols&&!d.settings.columns&&"array"===j.dataType&&g<d.settings.minSpareCols)for(;g<d.settings.minSpareCols&&j.countCols()<d.settings.maxCols;g++)e.createCol(j.countCols(),1,"auto");var i=j.countRows(),k=j.countCols();if(0!==i&&0!==k||h.deselect(),h.isSelected()){var l=!1,m=d.selRange.from.row,n=d.selRange.from.col,o=d.selRange.to.row,p=d.selRange.to.col;m>i-1?(m=i-1,l=!0,o>m&&(o=m)):o>i-1&&(o=i-1,l=!0,m>o&&(m=o)),n>k-1?(n=k-1,l=!0,p>n&&(p=n)):p>k-1&&(p=k-1,l=!0,n>p&&(n=p)),l&&j.selectCell(m,n,o,p)}j.view&&j.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(a,b,c,e,f,g,h){var i,k,l,m,n=[],o={};if(0===(k=b.length))return!1;var p,q,r,s;null===c||c.row,null===c||c.col;switch(f){case"shift_down":for(p=c?c.col-a.col+1:0,q=c?c.row-a.row+1:0,b=ga(b),l=0,m=b.length,r=Math.max(m,p);l<r;l++)if(l<m){for(i=0,k=b[l].length;i<q-k;i++)b[l].push(b[l][i%k]);b[l].unshift(a.col+l,a.row,0),j.spliceCol.apply(j,b[l])}else b[l%m][0]=a.col+l,j.spliceCol.apply(j,b[l%m]);break;case"shift_right":for(p=c?c.col-a.col+1:0,q=c?c.row-a.row+1:0,i=0,k=b.length,s=Math.max(k,q);i<s;i++)if(i<k){for(l=0,m=b[i].length;l<p-m;l++)b[i].push(b[i][l%m]);b[i].unshift(a.row+i,a.col,0),j.spliceRow.apply(j,b[i])}else b[i%k][0]=a.row+i,j.spliceRow.apply(j,b[i%k]);break;case"overwrite":default:o.row=a.row,o.col=a.col;var y,u={row:c&&a?c.row-a.row+1:1,col:c&&a?c.col-a.col+1:1},v=0,w=0,x=!0,z=function(c){var d=void 0!==arguments[1]?arguments[1]:null,e=b[c%b.length];return null!==d?e[d%e.length]:e},A=b.length,B=c?c.row-a.row+1:0;for(k=c?B:Math.max(A,B),i=0;i<k&&!(c&&o.row>c.row&&B>A||!d.settings.allowInsertRow&&o.row>j.countRows()-1||o.row>=d.settings.maxRows);i++){var C=i-v,D=z(C).length,E=c?c.col-a.col+1:0;if(m=c?E:Math.max(D,E),o.col=a.col,y=j.getCellMeta(o.row,o.col),"CopyPaste.paste"!==e&&"Autofill.autofill"!==e||!y.skipRowOnPaste){for(w=0,l=0;l<m&&!(c&&o.col>c.col&&E>D||!d.settings.allowInsertColumn&&o.col>j.countCols()-1||o.col>=d.settings.maxCols);l++)if(y=j.getCellMeta(o.row,o.col),"CopyPaste.paste"!==e&&"Autofill.fill"!==e||!y.skipColumnOnPaste)if(y.readOnly)o.col++;else{var F=l-w,G=z(C,F),H=j.getDataAtCell(o.row,o.col),I={row:C,col:F};if("Autofill.fill"===e){var J=j.runHooks("beforeAutofillInsidePopulate",I,g,b,h,{},u);J&&(G=L(J.value)?G:J.value)}if(null!==G&&"object"==typeof G)if(null===H||"object"!=typeof H)x=!1;else{var K=S(H[0]||H),M=S(G[0]||G);V(K,M)?G=R(G):x=!1}else null!==H&&"object"==typeof H&&(x=!1);x&&n.push([o.row,o.col,G]),x=!0,o.col++}else w++,o.col++,m++;o.row++}else v++,o.row++,k++}j.setDataAtCell(n,null,null,e||"populateFromArray")}}},this.selection=h={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(){var a=void 0!==arguments[0]&&arguments[0],b=void 0!==arguments[1]&&arguments[1],c=void 0!==arguments[2]&&arguments[2];j.selection.selectedHeader.rows=a,j.selection.selectedHeader.cols=b,j.selection.selectedHeader.corner=c},begin:function(){j.selection.inProgress=!0},finish:function(){var a=j.getSelected();A.hooks.run(j,"afterSelectionEnd",a[0],a[1],a[2],a[3]),A.hooks.run(j,"afterSelectionEndByProp",a[0],j.colToProp(a[1]),a[2],j.colToProp(a[3])),j.selection.inProgress=!1},isInProgress:function(){return j.selection.inProgress},setRangeStart:function(a,b){A.hooks.run(j,"beforeSetRangeStart",a),d.selRange=new la(a,a,a),h.setRangeEnd(a,null,b)},setRangeStartOnly:function(a){A.hooks.run(j,"beforeSetRangeStartOnly",a),d.selRange=new la(a,a,a)},setRangeEnd:function(a,b,c){if(null!==d.selRange){var f,g=!1,i=!0,k=j.view.wt.wtTable.getFirstVisibleRow(),l=j.view.wt.wtTable.getFirstVisibleColumn(),m={row:null,col:null};A.hooks.run(j,"beforeSetRangeEnd",a),j.selection.begin(),m.row=a.row<0?k:a.row,m.col=a.col<0?l:a.col,d.selRange.to=new ka(m.row,m.col),d.settings.multiSelect||(d.selRange.from=a),j.view.wt.selections.current.clear(),f=j.getCellMeta(d.selRange.highlight.row,d.selRange.highlight.col).disableVisualSelection,"string"==typeof f&&(f=[f]),(!1===f||Array.isArray(f)&&-1===f.indexOf("current"))&&j.view.wt.selections.current.add(d.selRange.highlight),j.view.wt.selections.area.clear(),(!1===f||Array.isArray(f)&&-1===f.indexOf("area"))&&h.isMultiple()&&(j.view.wt.selections.area.add(d.selRange.from),j.view.wt.selections.area.add(d.selRange.to)),(d.settings.currentHeaderClassName||d.settings.currentRowClassName||d.settings.currentColClassName)&&(j.view.wt.selections.highlight.clear(),j.view.wt.selections.highlight.add(d.selRange.from),j.view.wt.selections.highlight.add(d.selRange.to));var n=X("value");A.hooks.run(j,"afterSelection",d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col,n),A.hooks.run(j,"afterSelectionByProp",d.selRange.from.row,e.colToProp(d.selRange.from.col),d.selRange.to.row,e.colToProp(d.selRange.to.col),n),(0===d.selRange.from.row&&d.selRange.to.row===j.countRows()-1&&j.countRows()>1||0===d.selRange.from.col&&d.selRange.to.col===j.countCols()-1&&j.countCols()>1)&&(g=!0),(a.row<0||a.col<0)&&(i=!1),n.isTouched()&&(b=!n.value),!1!==b&&!g&&i&&(d.selRange.from&&!h.isMultiple()?j.view.scrollViewport(d.selRange.from):j.view.scrollViewport(a)),h.selectedHeader.rows&&h.selectedHeader.cols?D(j.rootElement,["ht__selection--rows","ht__selection--columns"]):h.selectedHeader.rows?(G(j.rootElement,"ht__selection--columns"),D(j.rootElement,"ht__selection--rows")):h.selectedHeader.cols?(G(j.rootElement,"ht__selection--rows"),D(j.rootElement,"ht__selection--columns")):G(j.rootElement,["ht__selection--rows","ht__selection--columns"]),h.refreshBorders(null,c)}},refreshBorders:function(a,b){b||i.destroyEditor(a),j.view.render(),h.isSelected()&&!b&&i.prepareEditor()},isMultiple:function(){var a=!(d.selRange.to.col===d.selRange.from.col&&d.selRange.to.row===d.selRange.from.row),b=A.hooks.run(j,"afterIsMultipleSelection",a);if(a)return b},transformStart:function(a,b,c,e){var k,l,m,n,f=new ka(a,b),g=0,i=0;j.runHooks("modifyTransformStart",f),k=j.countRows(),l=j.countCols(),n=j.getSettings().fixedRowsBottom,d.selRange.highlight.row+a>k-1?c&&d.settings.minSpareRows>0&&!(n&&d.selRange.highlight.row>=k-n-1)?(j.alter("insert_row",k),k=j.countRows()):d.settings.autoWrapCol&&(f.row=1-k,f.col=d.selRange.highlight.col+f.col==l-1?1-l:1):d.settings.autoWrapCol&&d.selRange.highlight.row+f.row<0&&d.selRange.highlight.col+f.col>=0&&(f.row=k-1,f.col=d.selRange.highlight.col+f.col==0?l-1:-1),d.selRange.highlight.col+f.col>l-1?c&&d.settings.minSpareCols>0?(j.alter("insert_col",l),l=j.countCols()):d.settings.autoWrapRow&&(f.row=d.selRange.highlight.row+f.row==k-1?1-k:1,f.col=1-l):d.settings.autoWrapRow&&d.selRange.highlight.col+f.col<0&&d.selRange.highlight.row+f.row>=0&&(f.row=d.selRange.highlight.row+f.row==0?k-1:-1,f.col=l-1),m=new ka(d.selRange.highlight.row+f.row,d.selRange.highlight.col+f.col),m.row<0?(g=-1,m.row=0):m.row>0&&m.row>=k&&(g=1,m.row=k-1),m.col<0?(i=-1,m.col=0):m.col>0&&m.col>=l&&(i=1,m.col=l-1),j.runHooks("afterModifyTransformStart",m,g,i),h.setRangeStart(m,e)},transformEnd:function(a,b){var g,i,k,c=new ka(a,b),e=0,f=0;j.runHooks("modifyTransformEnd",c),g=j.countRows(),i=j.countCols(),k=new ka(d.selRange.to.row+c.row,d.selRange.to.col+c.col),k.row<0?(e=-1,k.row=0):k.row>0&&k.row>=g&&(e=1,k.row=g-1),k.col<0?(f=-1,k.col=0):k.col>0&&k.col>=i&&(f=1,k.col=i-1),j.runHooks("afterModifyTransformEnd",k,e,f),h.setRangeEnd(k,!0)},isSelected:function(){return null!==d.selRange},inInSelection:function(a){return!!h.isSelected()&&d.selRange.includes(a)},deselect:function(){h.isSelected()&&(j.selection.inProgress=!1,d.selRange=null,j.view.wt.selections.current.clear(),j.view.wt.selections.area.clear(),(d.settings.currentHeaderClassName||d.settings.currentRowClassName||d.settings.currentColClassName)&&j.view.wt.selections.highlight.clear(),i.destroyEditor(),h.refreshBorders(),G(j.rootElement,["ht__selection--rows","ht__selection--columns"]),A.hooks.run(j,"afterDeselect"))},selectAll:function(){d.settings.multiSelect&&(h.setSelectedHeaders(!0,!0,!0),h.setRangeStart(new ka(0,0)),h.setRangeEnd(new ka(j.countRows()-1,j.countCols()-1),!1))},empty:function(){if(h.isSelected()){var c,e,a=d.selRange.getTopLeftCorner(),b=d.selRange.getBottomRightCorner(),f=[];for(c=a.row;c<=b.row;c++)for(e=a.col;e<=b.col;e++)j.getCellMeta(c,e).readOnly||f.push([c,e,""]);j.setDataAtCell(f)}}},this.init=function(){f.setData(d.settings.data),A.hooks.run(j,"beforeInit"),M()&&D(j.rootElement,"mobile"),this.updateSettings(d.settings,!0),this.view=new da(this),i=new O(j,d,h,e),this.forceFullRender=!0,A.hooks.run(j,"init"),this.view.render(),"object"==typeof d.firstRun&&(A.hooks.run(j,"afterChange",d.firstRun[0],d.firstRun[1]),d.firstRun=!1),A.hooks.run(j,"afterInit")},this.validateCell=function(a,b,c,d){function f(a){var d=b.visualCol,e=b.visualRow,f=j.getCell(e,d,!0);f&&"TH"!=f.nodeName&&j.view.wt.wtSettings.settings.cellRenderer(e,d,f),c(a)}var e=j.getCellValidator(b);"[object RegExp]"===Object.prototype.toString.call(e)&&(e=function(a){return function(b,c){c(a.test(b))}}(e)),I(e)?(a=A.hooks.run(j,"beforeValidate",a,b.visualRow,b.prop,d),j._registerTimeout(setTimeout(function(){e.call(b,a,function(c){c=A.hooks.run(j,"afterValidate",c,a,b.visualRow,b.prop,d),b.valid=c,f(c),A.hooks.run(j,"postAfterValidate",c,a,b.visualRow,b.prop,d)})},0))):j._registerTimeout(setTimeout(function(){b.valid=!0,f(b.valid)},0))},this.setDataAtCell=function(a,b,c,d){var h,i,l,g=q(a,b,c),k=[];for(h=0,i=g.length;h<i;h++){if("object"!=typeof g[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof g[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=e.colToProp(g[h][1]),k.push([g[h][0],l,f.getAtCell(m.toPhysicalRow(g[h][0]),g[h][1]),g[h][2]])}d||"object"!=typeof a||(d=b),j.runHooks("afterSetDataAtCell",k,d),o(k,d,function(){p(k,d)})},this.setDataAtRowProp=function(a,b,c,d){var g,h,e=q(a,b,c),i=[];for(g=0,h=e.length;g<h;g++)i.push([e[g][0],e[g][1],f.getAtCell(m.toPhysicalRow(e[g][0]),e[g][1]),e[g][2]]);d||"object"!=typeof a||(d=b),j.runHooks("afterSetDataAtRowProp",i,d),o(i,d,function(){p(i,d)})},this.listen=function(){A.activeGuid=j.guid},this.unlisten=function(){A.activeGuid=null},this.isListening=function(){return A.activeGuid===j.guid},this.destroyEditor=function(a){h.refreshBorders(a)},this.populateFromArray=function(a,b,c,d,e,f,h,i,j){var k;if("object"!=typeof c||"object"!=typeof c[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return k="number"==typeof d?new ka(d,e):null,g.populateFromArray(new ka(a,b),c,k,f,h,i,j)},this.spliceCol=function(a,b,c){return e.spliceCol.apply(e,arguments)},this.spliceRow=function(a,b,c){return e.spliceRow.apply(e,arguments)},this.getSelected=function(){if(h.isSelected())return[d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col]},this.getSelectedRange=function(){if(h.isSelected())return d.selRange},this.render=function(){j.view&&(j.renderCall=!0,j.forceFullRender=!0,h.refreshBorders(null,!0))},this.loadData=function(a){function n(){d.cellSettings.length=0}if(Array.isArray(d.settings.dataSchema)?j.dataType="array":I(d.settings.dataSchema)?j.dataType="function":j.dataType="object",e&&e.destroy(),e=new N(j,d,k),"object"==typeof a&&null!==a)a.push&&a.splice||(a=[a]);else{if(null!==a)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof a+" given)");a=[];var b,c=0,h=0,i=e.getSchema();for(c=0,h=d.settings.startRows;c<h;c++)if("object"!==j.dataType&&"function"!==j.dataType||!d.settings.dataSchema)if("array"===j.dataType)b=R(i[0]),a.push(b);else{b=[];for(var l=0,m=d.settings.startCols;l<m;l++)b.push(null);a.push(b)}else b=R(i),a.push(b)}d.isPopulated=!1,k.prototype.data=a,Array.isArray(a[0])&&(j.dataType="array"),e.dataSource=a,f.data=a,f.dataType=j.dataType,f.colToProp=e.colToProp.bind(e),f.propToCol=e.propToCol.bind(e),n(),g.adjustRowsAndCols(),A.hooks.run(j,"afterLoadData",d.firstRun),d.firstRun?d.firstRun=[null,"loadData"]:(A.hooks.run(j,"afterChange",null,"loadData"),j.render()),d.isPopulated=!0},this.getData=function(a,b,c,d){return L(a)?e.getAll():e.getRange(new ka(a,b),new ka(c,d),e.DESTINATION_RENDERER)},this.getCopyableText=function(a,b,c,d){return e.getCopyableText(new ka(a,b),new ka(c,d))},this.getCopyableData=function(a,b){return e.getCopyable(a,e.colToProp(b))},this.getSchema=function(){return e.getSchema()},this.updateSettings=function(a,b){var f,i,l,c=!1;if(K(a.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(K(a.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(f in a)"data"!==f&&(A.hooks.getRegistered().indexOf(f)>-1?(I(a[f])||Array.isArray(a[f]))&&(a[f].initialHook=!0,j.addHook(f,a[f])):!b&&a.hasOwnProperty(f)&&(k.prototype[f]=a[f]));void 0===a.data&&void 0===d.settings.data?j.loadData(null):void 0!==a.data?j.loadData(a.data):void 0!==a.columns&&e.createMap(),l=j.countCols();var m=a.columns||k.prototype.columns;if(m&&I(m)&&(l=j.countSourceCols(),c=!0),void 0===a.cell&&void 0===a.cells&&void 0===a.columns||(d.cellSettings.length=0),l>0){var n,o;for(f=0,i=0;f<l;f++)c&&!m(f)||(d.columnSettings[i]=H(k,d.columnsSettingConflicts),n=d.columnSettings[i].prototype,m&&(o=c?m(f):m[i])&&(T(n,o),T(n,r(o))),i++)}if(K(a.cell))for(var p in a.cell)if(a.cell.hasOwnProperty(p)){var q=a.cell[p];j.setCellMetaObject(q.row,q.col,q)}A.hooks.run(j,"afterCellMetaReset"),K(a.className)&&(k.prototype.className&&G(j.rootElement,k.prototype.className),a.className&&D(j.rootElement,a.className));var s=j.rootElement.style.height;""!==s&&(s=parseInt(j.rootElement.style.height,10));var t=a.height;if(I(t)&&(t=t()),b){j.rootElement.getAttribute("style")&&j.rootElement.setAttribute("data-initialstyle",j.rootElement.getAttribute("style"))}if(null===t){var v=j.rootElement.getAttribute("data-initialstyle");v&&(v.indexOf("height")>-1||v.indexOf("overflow")>-1)?j.rootElement.setAttribute("style",v):(j.rootElement.style.height="",j.rootElement.style.overflow="")}else void 0!==t&&(j.rootElement.style.height=t+"px",j.rootElement.style.overflow="hidden");if(void 0!==a.width){var w=a.width;I(w)&&(w=w()),j.rootElement.style.width=w+"px"}b||(e.clearLengthCache(),j.view&&j.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),A.hooks.run(j,"afterUpdateSettings")),g.adjustRowsAndCols(),j.view&&!d.firstRun&&(j.forceFullRender=!0,h.refreshBorders(null,!0)),b||!j.view||""!==s&&""!==t&&void 0!==t||s===t||j.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var a=j.getSelected();if(k.prototype.getValue){if(I(k.prototype.getValue))return k.prototype.getValue.call(j);if(a)return j.getData()[a[0]][k.prototype.getValue]}else if(a)return j.getDataAtCell(a[0],a[1])},this.getSettings=function(){return d.settings},this.clear=function(){h.selectAll(),h.empty()},this.alter=function(a,b,c,d,e){g.alter(a,b,c,d,e)},this.getCell=function(a,b,c){return j.view.getCellAtCoords(new ka(a,b),c)},this.getCoords=function(a){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,a)},this.colToProp=function(a){return e.colToProp(a)},this.propToCol=function(a){return e.propToCol(a)},this.toVisualRow=function(a){return m.toVisualRow(a)},this.toVisualColumn=function(a){return m.toVisualColumn(a)},this.toPhysicalRow=function(a){return m.toPhysicalRow(a)},this.toPhysicalColumn=function(a){return m.toPhysicalColumn(a)},this.getDataAtCell=function(a,b){return e.get(a,e.colToProp(b))},this.getDataAtRowProp=function(a,b){return e.get(a,b)},this.getDataAtCol=function(a){var b=[];return b.concat.apply(b,e.getRange(new ka(0,a),new ka(d.settings.data.length-1,a),e.DESTINATION_RENDERER))},this.getDataAtProp=function(a){var c,b=[];return c=e.getRange(new ka(0,e.propToCol(a)),new ka(d.settings.data.length-1,e.propToCol(a)),e.DESTINATION_RENDERER),b.concat.apply(b,c)},this.getSourceData=function(a,b,c,d){return void 0===a?f.getData():f.getByRange(new ka(a,b),new ka(c,d))},this.getSourceDataArray=function(a,b,c,d){return void 0===a?f.getData(!0):f.getByRange(new ka(a,b),new ka(c,d),!0)},this.getSourceDataAtCol=function(a){return f.getAtColumn(a)},this.getSourceDataAtRow=function(a){return f.getAtRow(a)},this.getSourceDataAtCell=function(a,b){return f.getAtCell(a,b)},this.getDataAtRow=function(a){return e.getRange(new ka(a,0),new ka(a,this.countCols()-1),e.DESTINATION_RENDERER)[0]},this.getDataType=function(a,b,c,d){var e=this,f=null,g=null;void 0===a&&(a=0,c=this.countRows(),b=0,d=this.countCols()),void 0===c&&(c=a),void 0===d&&(d=b);var h="mixed";return ca(Math.min(a,c),Math.max(a,c),function(a){var c=!0;return ca(Math.min(b,d),Math.max(b,d),function(b){var d=e.getCellMeta(a,b);return g=d.type,f?c=f===g:f=g,c}),h=c?g:"mixed",c}),h},this.removeCellMeta=function(a,b,c){void 0!=j.getCellMeta(a,b)[c]&&delete d.cellSettings[a][b][c]},this.spliceCellsMeta=function(a,b){for(var c,e=[],f=2;f<arguments.length;f++)e[f-2]=arguments[f];(c=d.cellSettings).splice.apply(c,$traceurRuntime.spread([a,b],e))},this.setCellMetaObject=function(a,b,c){if("object"==typeof c)for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];this.setCellMeta(a,b,d,e)}},this.setCellMeta=function(a,b,c,e){var f;f=m.toPhysical(a,b),a=f[0],b=f[1],d.cellSettings[a]||(d.cellSettings[a]=[]),d.cellSettings[a][b]||(d.cellSettings[a][b]=new d.columnSettings[b]),d.cellSettings[a][b][c]=e,A.hooks.run(j,"afterSetCellMeta",a,b,c,e)},this.getCellsMeta=function(){return Z(d.cellSettings)},this.getCellMeta=function(a,b){var c,g,f=e.colToProp(b),h=a,i=b;if(c=m.toPhysical(a,b),a=c[0],b=c[1],d.columnSettings[b]||(d.columnSettings[b]=H(k,d.columnsSettingConflicts)),d.cellSettings[a]||(d.cellSettings[a]=[]),d.cellSettings[a][b]||(d.cellSettings[a][b]=new d.columnSettings[b]),g=d.cellSettings[a][b],g.row=a,g.col=b,g.visualRow=h,g.visualCol=i,g.prop=f,g.instance=j,A.hooks.run(j,"beforeGetCellMeta",a,b,g),T(g,r(g)),g.cells){var l=g.cells.call(g,a,b,f);l&&(T(g,l),T(g,r(l)))}return A.hooks.run(j,"afterGetCellMeta",a,b,g),g},this.getCellMetaAtRow=function(a){return d.cellSettings[a]},this.isColumnModificationAllowed=function(){return!("object"===j.dataType||j.getSettings().columns)};var s=ha("renderer");this.getCellRenderer=function(a,b){var c=s.call(this,a,b);return aa(c)},this.getCellEditor=ha("editor"),this.getCellValidator=ha("validator"),this.validateCells=function(a){var b=new n;a&&(b.onQueueEmpty=a);for(var c=j.countRows()-1;c>=0;){for(var d=j.countCols()-1;d>=0;)b.addValidatorToQueue(),j.validateCell(j.getDataAtCell(c,d),j.getCellMeta(c,d),function(a){if("boolean"!=typeof a)throw new Error("Validation error: result is not boolean");!1===a&&(b.valid=!1),b.removeValidatorFormQueue()},"validateCells"),d--;c--}b.checkIfQueueIsEmpty()},this.getRowHeader=function(a){var b=d.settings.rowHeaders;return void 0!==a&&(a=A.hooks.run(j,"modifyRowHeader",a)),void 0===a?(b=[],ca(j.countRows()-1,function(a){b.push(j.getRowHeader(a))})):Array.isArray(b)&&void 0!==b[a]?b=b[a]:I(b)?b=b(a):b&&"string"!=typeof b&&"number"!=typeof b&&(b=a+1),b},this.hasRowHeaders=function(){return!!d.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==d.settings.colHeaders&&null!==d.settings.colHeaders)return!!d.settings.colHeaders;for(var a=0,b=j.countCols();a<b;a++)if(j.getColHeader(a))return!0;return!1},this.getColHeader=function(a){var b=d.settings.columns&&I(d.settings.columns),c=d.settings.colHeaders;if(void 0===(a=A.hooks.run(j,"modifyColHeader",a))){for(var e=[],f=b?j.countSourceCols():j.countCols(),g=0;g<f;g++)e.push(j.getColHeader(g));c=e}else{var h=function(a){for(var b=[],c=j.countSourceCols(),d=0;d<c;d++)I(j.getSettings().columns)&&j.getSettings().columns(d)&&b.push(d);return b[a]},i=a;a=A.hooks.run(j,"modifyCol",a);var k=h(a);d.settings.columns&&I(d.settings.columns)&&d.settings.columns(k)&&d.settings.columns(k).title?c=d.settings.columns(k).title:d.settings.columns&&d.settings.columns[a]&&d.settings.columns[a].title?c=d.settings.columns[a].title:Array.isArray(d.settings.colHeaders)&&void 0!==d.settings.colHeaders[a]?c=d.settings.colHeaders[a]:I(d.settings.colHeaders)?c=d.settings.colHeaders(a):d.settings.colHeaders&&"string"!=typeof d.settings.colHeaders&&"number"!=typeof d.settings.colHeaders&&(c=ia(i))}return c},this._getColWidthFromSettings=function(a){var b=j.getCellMeta(0,a),c=b.width;if(void 0!==c&&c!==d.settings.width||(c=b.colWidths),void 0!==c&&null!==c){switch(typeof c){case"object":c=c[a];break;case"function":c=c(a)}"string"==typeof c&&(c=parseInt(c,10))}return c},this.getColWidth=function(a){var b=j._getColWidthFromSettings(a);return b=A.hooks.run(j,"modifyColWidth",b,a),void 0===b&&(b=ma.DEFAULT_WIDTH),b},this._getRowHeightFromSettings=function(a){var b=d.settings.rowHeights;if(void 0!==b&&null!==b){switch(typeof b){case"object":b=b[a];break;case"function":b=b(a)}"string"==typeof b&&(b=parseInt(b,10))}return b},this.getRowHeight=function(a){var b=j._getRowHeightFromSettings(a);return b=A.hooks.run(j,"modifyRowHeight",b,a)},this.countSourceRows=function(){return A.hooks.run(j,"modifySourceLength")||(j.getSourceData()?j.getSourceData().length:0)},this.countSourceCols=function(){var b=j.getSourceData()&&j.getSourceData()[0]?j.getSourceData()[0]:[];return U(b)?W(b):b.length||0},this.countRows=function(){return e.getLength()},this.countCols=function(){var a=!1,b=0;if("array"===j.dataType&&(a=d.settings.data&&d.settings.data[0]&&d.settings.data[0].length),a&&(b=d.settings.data[0].length),d.settings.columns){if(I(d.settings.columns))if("array"===j.dataType){for(var f=0,g=0;g<b;g++)d.settings.columns(g)&&f++;b=f}else"object"!==j.dataType&&"function"!==j.dataType||(b=e.colToPropCache.length);else b=d.settings.columns.length}else"object"!==j.dataType&&"function"!==j.dataType||(b=e.colToPropCache.length);return b},this.rowOffset=function(){return j.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return j.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return j.view.wt.drawn?j.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return j.view.wt.drawn?j.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return j.view.wt.drawn?j.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return j.view.wt.drawn?j.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(a){for(var d,b=j.countRows()-1,c=0;b>=0;){if(d=A.hooks.run(this,"modifyRow",b),j.isEmptyRow(d))c++;else if(a)break;b--}return c},this.countEmptyCols=function(a){if(j.countRows()<1)return 0;for(var b=j.countCols()-1,c=0;b>=0;){if(j.isEmptyCol(b))c++;else if(a)break;b--}return c},this.isEmptyRow=function(a){return d.settings.isEmptyRow.call(j,a)},this.isEmptyCol=function(a){return d.settings.isEmptyCol.call(j,a)},this.selectCell=function(a,b,c,e,f,g){var i;if(g=L(g)||!0===g,"number"!=typeof a||a<0||a>=j.countRows())return!1;if("number"!=typeof b||b<0||b>=j.countCols())return!1;if(K(c)){if("number"!=typeof c||c<0||c>=j.countRows())return!1;if("number"!=typeof e||e<0||e>=j.countCols())return!1}return i=new ka(a,b),d.selRange=new la(i,i,i),g&&j.listen(),L(c)?h.setRangeEnd(d.selRange.from,f):h.setRangeEnd(new ka(c,e),f),j.selection.finish(),!0},this.selectCellByProp=function(a,b,c,d,f){return arguments[1]=e.propToCol(arguments[1]),K(arguments[3])&&(arguments[3]=e.propToCol(arguments[3])),j.selectCell.apply(j,arguments)},this.deselectCell=function(){h.deselect()},this.scrollViewportTo=function(a,b){var c=void 0!==arguments[2]&&arguments[2],d=void 0!==arguments[3]&&arguments[3];if(void 0!==a&&(a<0||a>=j.countRows()))return!1;if(void 0!==b&&(b<0||b>=j.countCols()))return!1;var e=!1;return void 0!==a&&void 0!==b&&(j.view.wt.wtOverlays.topOverlay.scrollTo(a,c),j.view.wt.wtOverlays.leftOverlay.scrollTo(b,d),e=!0),"number"==typeof a&&"number"!=typeof b&&(j.view.wt.wtOverlays.topOverlay.scrollTo(a,c),e=!0),"number"==typeof b&&"number"!=typeof a&&(j.view.wt.wtOverlays.leftOverlay.scrollTo(b,d),e=!0),e},this.destroy=function(){j._clearTimeouts(),j.view&&j.view.destroy(),f&&f.destroy(),f=null,E(j.rootElement),l.destroy(),A.hooks.run(j,"afterDestroy"),A.hooks.destroy(j);for(var a in j)j.hasOwnProperty(a)&&(I(j[a])?j[a]=t:"guid"!==a&&(j[a]=null));e&&e.destroy(),e=null,d=null,g=null,h=null,i=null,j=null,k=null},this.getActiveEditor=function(){return i.getActiveEditor()},this.getPlugin=function(a){return _(this,a)},this.getInstance=function(){return j},this.addHook=function(a,b){A.hooks.add(a,b,j)},this.hasHook=function(a){return A.hooks.has(a,j)},this.addHookOnce=function(a,b){A.hooks.once(a,b,j)},this.removeHook=function(a,b){A.hooks.remove(a,b,j)},this.runHooks=function(a,b,c,d,e,f,g){return A.hooks.run(j,a,b,c,d,e,f,g)},this.timeouts=[],this._registerTimeout=function(a){this.timeouts.push(a)},this._clearTimeouts=function(){for(var a=0,b=this.timeouts.length;a<b;a++)clearTimeout(this.timeouts[a])},this.version=A.version,A.hooks.run(j,"construct")};var na=function(){};na.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(a){var b,c,d,e;for(b=0,c=this.countCols();b<c;b++)if(""!==(d=this.getDataAtCell(a,b))&&null!==d&&K(d))return"object"==typeof d&&(e=this.getCellMeta(a,b),V(this.getSchema()[e.prop],d));return!0},isEmptyCol:function(a){var b,c,d;for(b=0,c=this.countRows();b<c;b++)if(""!==(d=this.getDataAtCell(b,a))&&null!==d&&K(d))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},A.DefaultSettings=na},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,browser:24,dataMap:27,dataSource:28,editorManager:29,eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/dom/element":47,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,numbro:"numbro",plugins:62,renderers:118,tableView:127,"utils/recordTranslator":132}],27:[function(a,b,c){"use strict";function D(a,b,c){var d=this;this.instance=a,this.priv=b,this.GridSettings=c,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.dataSource&&this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=A.create(function(){return d.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(a){return d.onSkipLengthCache(a)}),this.onSkipLengthCache(500)}Object.defineProperties(c,{DataMap:{get:function(){return D}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,n=((e=a("SheetClip"))&&e.__esModule&&e||{default:e}).default,o=((f=a("helpers/data"))&&f.__esModule&&f||{default:f}).cellMethodLookupFactory,p=((g=a("helpers/setting"))&&g.__esModule&&g||{default:g}).columnFactory,q=(h=a("helpers/object"))&&h.__esModule&&h||{default:h},r=q.createObjectPropListener,s=q.duckSchema,t=q.deepExtend,u=q.deepClone,v=q.isObject,w=q.deepObjectSize,x=(i=a("helpers/array"))&&i.__esModule&&i||{default:i},y=x.extendArray,z=x.to2dArray,A=((j=a("utils/interval"))&&j.__esModule&&j||{default:j}).Interval,B=((k=a("helpers/number"))&&k.__esModule&&k||{default:k}).rangeEach,C=((l=a("multiMap"))&&l.__esModule&&l||{default:l}).MultiMap;D.prototype.DESTINATION_RENDERER=1,D.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,D.prototype.recursiveDuckSchema=function(a){return s(a)},D.prototype.recursiveDuckColumns=function(a,b,c){var d,e;if(void 0===b&&(b=0,c=""),"object"==typeof a&&!Array.isArray(a))for(e in a)a.hasOwnProperty(e)&&(null===a[e]?(d=c+e,this.colToPropCache.push(d),this.propToColCache.set(d,b),b++):b=this.recursiveDuckColumns(a[e],b,e+"."));return b},D.prototype.createMap=function(){var a,b=this.getSchema();if(void 0===b)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new C;var c=this.instance.getSettings().columns;if(c){var d=c.length,e=0,f=!1,g=w(b);for("function"==typeof c&&(d=g>0?g:this.instance.countSourceCols(),f=!0),a=0;a<d;a++){var h=f?c(a):c[a];if(v(h)){if(void 0!==h.data){var i=f?e:a;this.colToPropCache[i]=h.data,this.propToColCache.set(h.data,i)}e++}}}else this.recursiveDuckColumns(b)},D.prototype.colToProp=function(a){return a=m.hooks.run(this.instance,"modifyCol",a),this.colToPropCache&&void 0!==this.colToPropCache[a]?this.colToPropCache[a]:a},D.prototype.propToCol=function(a){var b;return b=void 0===this.propToColCache.get(a)?a:this.propToColCache.get(a),b=m.hooks.run(this.instance,"unmodifyCol",b)},D.prototype.getSchema=function(){var a=this.instance.getSettings().dataSchema;return a?"function"==typeof a?a():a:this.duckSchema},D.prototype.createRow=function(a,b,c){var d,g,e=this.instance.countCols(),f=0;b||(b=1),("number"!=typeof a||a>=this.instance.countSourceRows())&&(a=this.instance.countSourceRows()),m.hooks.run(this.instance,"beforeCreateRow",a,b,c),g=a;for(var h=this.instance.getSettings().maxRows;f<b&&this.instance.countSourceRows()<h;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?d=u(this.getSchema()):(d=[],B(e-1,function(){return d.push(null)})):"function"===this.instance.dataType?d=this.instance.getSettings().dataSchema(a):(d={},t(d,this.getSchema())),a===this.instance.countSourceRows()?this.dataSource.push(d):this.spliceData(a,0,d),f++,g++;return m.hooks.run(this.instance,"afterCreateRow",a,f,c),this.instance.forceFullRender=!0,f},D.prototype.createCol=function(a,b,c){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var f,h,d=this.instance.countSourceRows(),e=this.dataSource,g=0;b||(b=1),("number"!=typeof a||a>=this.instance.countCols())&&(a=this.instance.countCols()),m.hooks.run(this.instance,"beforeCreateCol",a,b,c),h=a;for(var i=this.instance.getSettings().maxCols;g<b&&this.instance.countCols()<i;){if(f=p(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof a||a>=this.instance.countCols()){if(d>0)for(var j=0;j<d;j++)void 0===e[j]&&(e[j]=[]),e[j].push(null);else e.push([null]);this.priv.columnSettings.push(f)}else{for(var j=0;j<d;j++)e[j].splice(h,0,null);this.priv.columnSettings.splice(h,0,f)}g++,h++}return m.hooks.run(this.instance,"afterCreateCol",a,g,c),this.instance.forceFullRender=!0,g},D.prototype.removeRow=function(a,b,c){b||(b=1),"number"!=typeof a&&(a=-b),b=m.hooks.run(this.instance,"modifyRemovedAmount",b,a),a=(this.instance.countSourceRows()+a)%this.instance.countSourceRows();var d=this.physicalRowsToLogical(a,b);if(!1!==m.hooks.run(this.instance,"beforeRemoveRow",a,b,d,c)){var g,f=this.dataSource;g=this.filterData(a,b),g&&(f.length=0,Array.prototype.push.apply(f,g)),m.hooks.run(this.instance,"afterRemoveRow",a,b,d,c),this.instance.forceFullRender=!0}},D.prototype.removeCol=function(a,b,c){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");b||(b=1),"number"!=typeof a&&(a=-b),a=(this.instance.countCols()+a)%this.instance.countCols();var d=this.physicalColumnsToLogical(a,b),e=d.slice(0).sort(function(a,b){return b-a});if(!1!==m.hooks.run(this.instance,"beforeRemoveCol",a,b,d,c)){for(var g=!0,h=e.length,i=this.dataSource,j=0;j<h;j++)g&&d[0]!==d[j]-j&&(g=!1);if(g)for(var k=0,l=this.instance.countSourceRows();k<l;k++)i[k].splice(d[0],b);else{for(var n=0,o=this.instance.countSourceRows();n<o;n++)for(var p=0;p<h;p++)i[n].splice(e[p],1);for(var q=0;q<h;q++)this.priv.columnSettings.splice(d[q],1)}m.hooks.run(this.instance,"afterRemoveCol",a,b,d,c),this.instance.forceFullRender=!0}},D.prototype.spliceCol=function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getDataAtCol(a),f=e.slice(b,b+c),g=e.slice(b+c);y(d,g);for(var h=0;h<c;)d.push(null),h++;return z(d),this.instance.populateFromArray(b,a,d,null,null,"spliceCol"),f},D.prototype.spliceRow=function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getSourceDataAtRow(a),f=e.slice(b,b+c),g=e.slice(b+c);y(d,g);for(var h=0;h<c;)d.push(null),h++;return this.instance.populateFromArray(a,b,[d],null,null,"spliceRow"),f},D.prototype.spliceData=function(a,b,c){!1!==m.hooks.run(this.instance,"beforeDataSplice",a,b,c)&&this.dataSource.splice(a,b,c)},D.prototype.filterData=function(a,b){var c=this.physicalRowsToLogical(a,b);if(!1!==m.hooks.run(this.instance,"beforeDataFilter",a,b,c))return this.dataSource.filter(function(a,b){return-1==c.indexOf(b)})},D.prototype.get=function(a,b){a=m.hooks.run(this.instance,"modifyRow",a);var c=this.dataSource[a],d=m.hooks.run(this.instance,"modifyRowData",a);c=isNaN(d)?d:c;var e=null;if(c&&c.hasOwnProperty&&c.hasOwnProperty(b))e=c[b];else if("string"==typeof b&&b.indexOf(".")>-1){var f=b.split("."),g=c;if(!g)return null;for(var h=0,i=f.length;h<i;h++)if(void 0===(g=g[f[h]]))return null;e=g}else"function"==typeof b&&(e=b(this.dataSource.slice(a,a+1)[0]));if(m.hooks.has("modifyData",this.instance)){var j=r(e);m.hooks.run(this.instance,"modifyData",a,this.propToCol(b),j,"get"),j.isTouched()&&(e=j.value)}return e};var E=o("copyable",!1);D.prototype.getCopyable=function(a,b){return E.call(this.instance,a,this.propToCol(b))?this.get(a,b):""},D.prototype.set=function(a,b,c,d){a=m.hooks.run(this.instance,"modifyRow",a,d||"datamapGet");var e=this.dataSource[a],f=m.hooks.run(this.instance,"modifyRowData",a);if(e=isNaN(f)?f:e,m.hooks.has("modifyData",this.instance)){var g=r(c);m.hooks.run(this.instance,"modifyData",a,this.propToCol(b),g,"set"),g.isTouched()&&(c=g.value)}if(e&&e.hasOwnProperty&&e.hasOwnProperty(b))e[b]=c;else if("string"==typeof b&&b.indexOf(".")>-1){for(var h=b.split("."),i=e,j=0,k=h.length-1;j<k;j++)void 0===i[h[j]]&&(i[h[j]]={}),i=i[h[j]];i[h[j]]=c}else"function"==typeof b?b(this.dataSource.slice(a,a+1)[0],c):e[b]=c},D.prototype.physicalRowsToLogical=function(a,b){for(var g,c=this.instance.countSourceRows(),d=(c+a)%c,e=[],f=b;d<c&&f;)g=m.hooks.run(this.instance,"modifyRow",d),e.push(g),f--,d++;return e},D.prototype.physicalColumnsToLogical=function(a,b){for(var c=this.instance.countCols(),d=(c+a)%c,e=[],f=b;d<c&&f;){var g=m.hooks.run(this.instance,"modifyCol",d);e.push(g),f--,d++}return e},D.prototype.clear=function(){for(var a=0;a<this.instance.countSourceRows();a++)for(var b=0;b<this.instance.countCols();b++)this.set(a,this.colToProp(b),"")},D.prototype.clearLengthCache=function(){this.cachedLength=null},D.prototype.getLength=function(){var b,a=this,c=this.instance.getSettings().maxRows;b=c<0||0===c?0:c||1/0;var d=this.instance.countSourceRows();if(m.hooks.has("modifyRow",this.instance)){var e=this.skipCache;this.interval.start(),d!==this.latestSourceRowsCount&&(e=!0),this.latestSourceRowsCount=d,null===this.cachedLength||e?(B(d-1,function(b){null===(b=m.hooks.run(a.instance,"modifyRow",b))&&--d}),this.cachedLength=d):d=this.cachedLength}else this.interval.stop();return Math.min(d,b)},D.prototype.getAll=function(){var a={row:0,col:0},b=this.instance.getSettings().maxRows;if(0===b)return[];var c={row:Math.min(Math.max(b-1,0),Math.max(this.instance.countSourceRows()-1,0)),col:Math.max(this.instance.countCols()-1,0)};return a.row-c.row!=0||this.instance.countSourceRows()?this.getRange(a,c,D.prototype.DESTINATION_RENDERER):[]},D.prototype.getRange=function(a,b,c){var d,e,f,g,i,h=[],j=c===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(e=Math.max(a.row,b.row),g=Math.max(a.col,b.col),d=Math.min(a.row,b.row);d<=e;d++){i=[];var k=m.hooks.run(this.instance,"modifyRow",d);for(f=Math.min(a.col,b.col);f<=g&&null!==k;f++)i.push(j.call(this,d,this.colToProp(f)));null!==k&&h.push(i)}return h},D.prototype.getText=function(a,b){return n.stringify(this.getRange(a,b,this.DESTINATION_RENDERER))},D.prototype.getCopyableText=function(a,b){return n.stringify(this.getRange(a,b,this.DESTINATION_CLIPBOARD_GENERATOR))},D.prototype.onSkipLengthCache=function(a){var b=this;this.skipCache=!0,setTimeout(function(){b.skipCache=!1},a)},D.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null}},{SheetClip:"SheetClip",browser:24,"helpers/array":43,"helpers/data":45,"helpers/number":52,"helpers/object":53,"helpers/setting":54,multiMap:60,"utils/interval":131}],28:[function(a,b,c){"use strict";Object.defineProperties(c,{DataSource:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("helpers/object"))&&d.__esModule&&d||{default:d}).getProperty,h=((e=a("helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,i=((f=a("helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,j=function(b){var c=void 0!==arguments[1]?arguments[1]:[];this.hot=b,this.data=c,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}};$traceurRuntime.createClass(j,{getData:function(){var a=void 0!==arguments[0]&&arguments[0],b=this.data;return a&&(b=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),b},setData:function(a){this.data=a},getAtColumn:function(a){var b=this,c=[];return h(this.data,function(d){var e=b.colToProp(a);d="string"==typeof e?g(d,e):d[e],c.push(d)}),c},getAtRow:function(a){return this.data[a]},getAtCell:function(a,b){var c=null,d=this.hot.runHooks("modifyRowData",a),e=isNaN(d)?d:this.data[a];if(e){var f=this.colToProp(b);c="string"==typeof f?g(e,f):"function"==typeof f?f(this.data.slice(a,a+1)[0]):e[f]}return c},getByRange:function(a,b){var c=void 0!==arguments[2]&&arguments[2],d=this,e=Math.min(a.row,b.row),f=Math.min(a.col,b.col),g=Math.max(a.row,b.row),h=Math.max(a.col,b.col),j=[];return i(e,g,function(a){var e,b=d.getAtRow(a);"array"===d.dataType?e=b.slice(f,h+1):"object"===d.dataType&&(e=c?[]:{},i(f,h,function(a){var f=d.colToProp(a);c?e.push(b[f]):e[f]=b[f]})),j.push(e)}),j},countRows:function(){return Array.isArray(this.data)?this.data.length:0},countColumns:function(){var a=0;return Array.isArray(this.data)&&("array"===this.dataType?a=this.data[0].length:"object"===this.dataType&&(a=Object.keys(this.data[0]).length)),a},destroy:function(){this.data=null,this.hot=null}},{})},{"helpers/array":43,"helpers/number":52,"helpers/object":53}],29:[function(a,b,c){"use strict";function v(a,b,c){function h(a){c.setSelectedHeaders(!1,!1,!1);var d="function"==typeof b.settings.enterMoves?b.settings.enterMoves(event):b.settings.enterMoves;a?c.transformStart(-d.row,-d.col):c.transformStart(d.row,d.col,!0)}function i(a){a?(c.selectedHeader.cols&&c.setSelectedHeaders(c.selectedHeader.rows,!1,!1),c.transformEnd(-1,0)):(c.setSelectedHeaders(!1,!1,!1),c.transformStart(-1,0))}function l(a){a?c.transformEnd(1,0):(c.setSelectedHeaders(!1,!1,!1),c.transformStart(1,0))}function p(a){a?c.transformEnd(0,1):(c.setSelectedHeaders(!1,!1,!1),c.transformStart(0,1))}function t(a){a?(c.selectedHeader.rows&&c.setSelectedHeaders(!1,c.selectedHeader.cols,!1),c.transformEnd(0,-1)):(c.setSelectedHeaders(!1,!1,!1),c.transformStart(0,-1))}function v(f){var u,v;if(a.isListening()&&(j.hooks.run(a,"beforeKeyDown",f),!e&&!s(f)&&(b.lastKeyCode=f.keyCode,c.isSelected()))){if(u=(f.ctrlKey||f.metaKey)&&!f.altKey,g&&!g.isWaiting()&&!(n(f.keyCode)||o(f.keyCode)||u||d.isEditorOpened()))return void d.openEditor("",f);switch(v=f.shiftKey?c.setRangeEnd:c.setRangeStart,f.keyCode){case m.A:!d.isEditorOpened()&&u&&(c.selectAll(),f.preventDefault(),q(f));break;case m.ARROW_UP:d.isEditorOpened()&&!g.isWaiting()&&d.closeEditorAndSaveChanges(u),i(f.shiftKey),f.preventDefault(),q(f);break;case m.ARROW_DOWN:d.isEditorOpened()&&!g.isWaiting()&&d.closeEditorAndSaveChanges(u),l(f.shiftKey),f.preventDefault(),q(f);break;case m.ARROW_RIGHT:d.isEditorOpened()&&!g.isWaiting()&&d.closeEditorAndSaveChanges(u),p(f.shiftKey),f.preventDefault(),q(f);break;case m.ARROW_LEFT:d.isEditorOpened()&&!g.isWaiting()&&d.closeEditorAndSaveChanges(u),t(f.shiftKey),f.preventDefault(),q(f);break;case m.TAB:c.setSelectedHeaders(!1,!1,!1);var w="function"==typeof b.settings.tabMoves?b.settings.tabMoves(f):b.settings.tabMoves;f.shiftKey?c.transformStart(-w.row,-w.col):c.transformStart(w.row,w.col,!0),f.preventDefault(),q(f);break;case m.BACKSPACE:case m.DELETE:c.empty(f),d.prepareEditor(),f.preventDefault();break;case m.F2:d.openEditor(null,f),g&&g.enableFullEditMode(),f.preventDefault();break;case m.ENTER:d.isEditorOpened()?(g&&g.state!==j.EditorState.WAITING&&d.closeEditorAndSaveChanges(u),h(f.shiftKey)):a.getSettings().enterBeginsEditing?(d.openEditor(null,f),g&&g.enableFullEditMode()):h(f.shiftKey),f.preventDefault(),r(f);break;case m.ESCAPE:d.isEditorOpened()&&d.closeEditorAndRestoreOriginalValue(u),f.preventDefault();break;case m.HOME:c.setSelectedHeaders(!1,!1,!1),v(f.ctrlKey||f.metaKey?new k(0,b.selRange.from.col):new k(b.selRange.from.row,0)),f.preventDefault(),q(f);break;case m.END:c.setSelectedHeaders(!1,!1,!1),v(f.ctrlKey||f.metaKey?new k(a.countRows()-1,b.selRange.from.col):new k(b.selRange.from.row,a.countCols()-1)),f.preventDefault(),q(f);break;case m.PAGE_UP:c.setSelectedHeaders(!1,!1,!1),c.transformStart(-a.countVisibleRows(),0),f.preventDefault(),q(f);break;case m.PAGE_DOWN:c.setSelectedHeaders(!1,!1,!1),c.transformStart(a.countVisibleRows(),0),f.preventDefault(),q(f)}}}function w(){function b(a,b,c){"TD"==c.nodeName&&(d.openEditor(),g&&g.enableFullEditMode())}a.addHook("afterDocumentKeyDown",v),f.addEventListener(document.documentElement,"keydown",function(b){e||a.runHooks("afterDocumentKeyDown",b)}),a.view.wt.update("onCellDblClick",b),a.addHook("afterDestroy",function(){e=!0})}var f,g,d=this,e=!1;f=u(a),this.destroyEditor=function(a){this.closeEditor(a)},this.getActiveEditor=function(){return g},this.prepareEditor=function(){var c,e,f,h,i,k,l;if(g&&g.isWaiting())return void this.closeEditor(!1,!1,function(a){a&&d.prepareEditor()});c=b.selRange.highlight.row,e=b.selRange.highlight.col,f=a.colToProp(e),h=a.getCell(c,e),i=a.getSourceDataAtCell(a.runHooks("modifyRow",c),e),k=a.getCellMeta(c,e),l=a.getCellEditor(k),l?(g=j.editors.getEditor(l,a),g.prepare(c,e,f,h,i,k)):g=void 0},this.isEditorOpened=function(){return g&&g.isOpened()},this.openEditor=function(a,b){g&&!g.cellProperties.readOnly?g.beginEditing(a,b):g&&g.cellProperties.readOnly&&b&&b.keyCode===m.ENTER&&h()},this.closeEditor=function(a,b,c){g?g.finishEditing(a,b,c):c&&c(!1)},this.closeEditorAndSaveChanges=function(a){return this.closeEditor(!1,a)},this.closeEditorAndRestoreOriginalValue=function(a){return this.closeEditor(!0,a)},w()}Object.defineProperties(c,{EditorManager:{get:function(){return v}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=((e=a("3rdparty/walkontable/src/cell/coords"))&&e.__esModule&&e||{default:e}).WalkontableCellCoords,l=(f=a("helpers/unicode"))&&f.__esModule&&f||{default:f},m=l.KEY_CODES,n=l.isMetaKey,o=l.isCtrlKey,p=(g=a("helpers/dom/event"))&&g.__esModule&&g||{default:g},q=p.stopPropagation,r=p.stopImmediatePropagation,s=p.isImmediatePropagationStopped,u=((h=a("editors"))&&h.__esModule,((i=a("eventManager"))&&i.__esModule&&i||{default:i}).eventManager);j.EditorManager=v},{"3rdparty/walkontable/src/cell/coords":6,browser:24,editors:30,eventManager:42,"helpers/dom/event":48,"helpers/unicode":56}],30:[function(a,b,c){"use strict";function j(a){var b,c;c={},b=a,this.getConstructor=function(){return a},this.getInstance=function(a){return a.guid in c||(c[a.guid]=new b(a)),c[a.guid]},f.hooks.add("afterDestroy",function(){c={}})}function k(a,b){var c=new j(b);"string"==typeof a&&(h[a]=c,f.editors[g(a)+"Editor"]=b),i.set(b,c)}function l(a,b){var c;if("function"==typeof a)i.get(a)||k(null,a),c=i.get(a);else{if("string"!=typeof a)throw Error('Only strings and functions can be passed as "editor" parameter ');c=h[a]}if(!c)throw Error('No editor registered under name "'+a+'"');return c.getInstance(b)}function m(a){var b;if("string"!=typeof a)throw Error('Only strings and functions can be passed as "editor" parameter ');if(!(b=h[a]))throw Error('No editor registered under name "'+a+'"');return b.getConstructor()}function n(a){return!!h[a]}Object.defineProperties(c,{registerEditor:{get:function(){return k}},getEditor:{get:function(){return l}},hasEditor:{get:function(){return n}},getEditorConstructor:{get:function(){return m}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("helpers/string"))&&e.__esModule&&e||{default:e}).toUpperCaseFirst,h={},i=new WeakMap;f.editors=f.editors||{},f.editors.registerEditor=k,f.editors.getEditor=l},{browser:24,"helpers/string":55}],31:[function(a,b,c){"use strict";function j(a){this.instance=a,this.state=g.EditorState.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}Object.defineProperties(c,{BaseEditor:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=((e=a("helpers/mixed"))&&e.__esModule&&e||{default:e}).stringify,i=((f=a("3rdparty/walkontable/src/cell/coords"))&&f.__esModule&&f||{default:f}).WalkontableCellCoords;g.editors=g.editors||{},g.editors.BaseEditor=j,g.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},j.prototype._fireCallbacks=function(a){this._closeCallback&&(this._closeCallback(a),this._closeCallback=null)},j.prototype.init=function(){},j.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},j.prototype.setValue=function(a){throw Error("Editor setValue() method unimplemented")},j.prototype.open=function(){throw Error("Editor open() method unimplemented")},j.prototype.close=function(){throw Error("Editor close() method unimplemented")},j.prototype.prepare=function(a,b,c,d,e,f){this.TD=d,this.row=a,this.col=b,this.prop=c,this.originalValue=e,this.cellProperties=f;var h=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body&&!h?document.activeElement.blur():h&&document.body.focus(),this.state=g.EditorState.VIRGIN},j.prototype.extend=function(){function b(){a.apply(this,arguments)}function c(a,b){function c(){}return c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a}var a=this.constructor;return c(b,a)},j.prototype.saveValue=function(a,b){var c,d;b?(c=this.instance.getSelected(),c[0]>c[2]&&(d=c[0],c[0]=c[2],c[2]=d),c[1]>c[3]&&(d=c[1],c[1]=c[3],c[3]=d)):c=[this.row,this.col,null,null],this.instance.populateFromArray(c[0],c[1],a,c[2],c[3],"edit")},j.prototype.beginEditing=function(a,b){this.state==g.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new i(this.row,this.col)),this.instance.view.render(),this.state=g.EditorState.EDITING,a="string"==typeof a?a:this.originalValue,this.setValue(h(a)),this.open(b),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},j.prototype.finishEditing=function(a,b,c){var e,d=this;if(c){var f=this._closeCallback;this._closeCallback=function(a){f&&f(a),c(a),d.instance.view.render()}}if(!this.isWaiting()){if(this.state==g.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){d._fireCallbacks(!0)},0));if(this.state==g.EditorState.EDITING){if(a)return this.cancelChanges(),void this.instance.view.render();var h=this.getValue();e=this.instance.getSettings().trimWhitespace?[["string"==typeof h?String.prototype.trim.call(h||""):h]]:[[h]],this.state=g.EditorState.WAITING,this.saveValue(e,b),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(a){d.state=g.EditorState.FINISHED,d.discardEditor(a)}):(this.state=g.EditorState.FINISHED,this.discardEditor(!0))}}},j.prototype.cancelChanges=function(){this.state=g.EditorState.FINISHED,this.discardEditor()},j.prototype.discardEditor=function(a){this.state===g.EditorState.FINISHED&&(!1===a&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=g.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.EditorState.VIRGIN,this._fireCallbacks(!0)))},j.prototype.enableFullEditMode=function(){this._fullEditMode=!0},j.prototype.isInFullEditMode=function(){return this._fullEditMode},j.prototype.isOpened=function(){return this._opened},j.prototype.isWaiting=function(){return this.state===g.EditorState.WAITING},j.prototype.checkEditorSection=function(){var a=this.instance.countRows(),b="";return this.row<this.instance.getSettings().fixedRowsTop?b=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=a-this.instance.getSettings().fixedRowsBottom?b=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(b="left"),b}},{"3rdparty/walkontable/src/cell/coords":6,browser:24,"helpers/mixed":51}],32:[function(a,b,c){"use strict";function H(a){G=!1;var b=this.getActiveEditor();if(m(a.keyCode)||a.keyCode===l.BACKSPACE||a.keyCode===l.DELETE||a.keyCode===l.INSERT){var c=0;if(a.keyCode===l.C&&(a.ctrlKey||a.metaKey))return;b.isOpened()||(c+=10),b.htEditor&&b.instance._registerTimeout(setTimeout(function(){b.queryChoices(b.TEXTAREA.value),G=!0},c))}}Object.defineProperties(c,{AutocompleteEditor:{get:function(){return F}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=(d=a("helpers/unicode"))&&d.__esModule&&d||{default:d},l=k.KEY_CODES,m=k.isPrintableChar,n=((e=a("helpers/mixed"))&&e.__esModule&&e||{default:e}).stringify,o=((f=a("helpers/string"))&&f.__esModule&&f||{default:f}).stripTags,p=(g=a("helpers/array"))&&g.__esModule&&g||{default:g},q=p.pivot,s=(p.arrayFilter,p.arrayMap),t=(h=a("helpers/dom/element"))&&h.__esModule&&h||{default:h},u=t.addClass,v=t.getCaretPosition,w=t.getScrollbarWidth,x=t.getSelectionEndPosition,y=t.outerWidth,z=t.outerHeight,A=t.offset,B=t.getTrimmingContainer,C=t.setCaretPosition,D=((i=a("editors"))&&i.__esModule&&i||{default:i}).registerEditor,E=((j=a("handsontableEditor"))&&j.__esModule&&j||{default:j}).HandsontableEditor,F=E.prototype.extend();F.prototype.init=function(){E.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},F.prototype.createElements=function(){E.prototype.createElements.apply(this,arguments),u(this.htContainer,"autocompleteEditor"),u(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var G=!1;F.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",H),E.prototype.prepare.apply(this,arguments)},F.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",E.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var a=this.htEditor.getInstance(),b=this,c=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),a.updateSettings({colWidths:c?[y(this.TEXTAREA)-2]:void 0,width:c?y(this.TEXTAREA)+w()+2:void 0,afterRenderer:function(a,c,d,e,f,g){var k,l,h=b.cellProperties,i=h.filteringCaseSensitive,j=h.allowHtml;f=n(f),f&&!j&&-1!==(k=!0===i?f.indexOf(this.query):f.toLowerCase().indexOf(b.query.toLowerCase()))&&(l=f.substr(k,b.query.length),f=f.replace(l,"<strong>"+l+"</strong>")),a.innerHTML=f},autoColumnSize:!0,modifyColWidth:function(a,b){var d=this.getPlugin("autoColumnSize").widths;return d[b]&&(a=d[b]),c?a:a+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=w()+2+"px",G&&(G=!1),b.instance._registerTimeout(setTimeout(function(){b.queryChoices(b.TEXTAREA.value)},0))},F.prototype.close=function(){E.prototype.close.apply(this,arguments)},F.prototype.queryChoices=function(a){var b=this;this.query=a;var c=this.cellProperties,d=c.source,g=(c.filter,c.filteringCaseSensitive,c.allowHtml),h=function(a){return s(a,function(a){return o(a)})};"function"==typeof d?d.call(this.cellProperties,a,function(a){b.updateChoicesList(g?a:h(a))}):Array.isArray(d)?this.updateChoicesList(g?d:h(d)):this.updateChoicesList([])},F.prototype.updateChoicesList=function(a){var b=v(this.TEXTAREA),c=x(this.TEXTAREA),d=this.cellProperties.sortByRelevance,e=this.cellProperties.filter,f=null,g=null;d&&(f=F.sortByRelevance(this.getValue(),a,this.cellProperties.filteringCaseSensitive));var i=Array.isArray(f)?f.length:0;if(!1===e)i&&(g=f[0]);else{for(var j=[],k=0,l=a.length;k<l&&!(d&&i<=k);k++)i?j.push(a[f[k]]):j.push(a[k]);g=0,a=j}this.choices=a,this.htEditor.loadData(q([a])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(g),this.instance.listen(),this.TEXTAREA.focus(),C(this.TEXTAREA,b,b===c?void 0:c)},F.prototype.flipDropdownIfNeeded=function(){var a=A(this.TEXTAREA),b=z(this.TEXTAREA),c=this.getDropdownHeight(),d=B(this.instance.view.wt.wtTable.TABLE),e=d.scrollTop,f=z(this.instance.view.wt.wtTable.THEAD),g={row:0,col:0};d!==window&&(g=A(d));var h=a.top-g.top-f+e,i=d.scrollHeight-h-f-b,j=c>i&&h>i;return j?this.flipDropdown(c):this.unflipDropdown(),this.limitDropdownIfNeeded(j?h:i,c),j},F.prototype.limitDropdownIfNeeded=function(a,b){if(b>a){var c=0,d=0,e=0,f=null;do{e=this.htEditor.getRowHeight(d)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,c+=e,d++}while(c<a);f=c-e,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+b-f+"px"),this.setDropdownHeight(c-e)}},F.prototype.flipDropdown=function(a){var b=this.htEditor.rootElement.style;b.position="absolute",b.top=-a+"px",this.htEditor.flipped=!0},F.prototype.unflipDropdown=function(){var a=this.htEditor.rootElement.style;"absolute"===a.position&&(a.position="",a.top=""),this.htEditor.flipped=void 0},F.prototype.updateDropdownHeight=function(){var a=this.htEditor.getColWidth(0)+w()+2,b=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:b?void 0:a}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},F.prototype.setDropdownHeight=function(a){this.htEditor.updateSettings({height:a})},F.prototype.finishEditing=function(a){a||this.instance.removeHook("beforeKeyDown",H),E.prototype.finishEditing.apply(this,arguments)},F.prototype.highlightBestMatchingChoice=function(a){"number"==typeof a?this.htEditor.selectCell(a,0):this.htEditor.deselectCell()},F.sortByRelevance=function(a,b,c){var e,g,h,j,d=[],f=a.length,i=[],k=b.length;if(0===f){for(j=0;j<k;j++)i.push(j);return i}for(j=0;j<k;j++)e=o(n(b[j])),-1!=(g=c?e.indexOf(a):e.toLowerCase().indexOf(a.toLowerCase()))&&(h=e.length-g-f,d.push({baseIndex:j,index:g,charsLeft:h,value:e}));for(d.sort(function(a,b){return-1===b.index?-1:-1===a.index?1:a.index<b.index?-1:b.index<a.index?1:a.index===b.index?a.charsLeft<b.charsLeft?-1:a.charsLeft>b.charsLeft?1:0:void 0}),j=0,k=d.length;j<k;j++)i.push(d[j].baseIndex);return i},F.prototype.getDropdownHeight=function(){var a=this.htEditor.getInstance().getRowHeight(0)||23,b=this.cellProperties.visibleRows;return this.choices.length>=b?b*a:this.choices.length*a+8},F.prototype.allowKeyEventPropagation=function(a){var b={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},c=!1;return a===l.ARROW_DOWN&&b.row>0&&b.row<this.htEditor.countRows()-1&&(c=!0),a===l.ARROW_UP&&b.row>-1&&(c=!0),c},F.prototype.discardEditor=function(a){E.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},D("autocomplete",F)},{editors:30,handsontableEditor:36,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/string":55,"helpers/unicode":56}],33:[function(a,b,c){"use strict";Object.defineProperties(c,{CheckboxEditor:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("editors"))&&d.__esModule&&d||{default:d}).registerEditor,h=((e=a("_baseEditor"))&&e.__esModule&&e||{default:e}).BaseEditor,i=((f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f}).hasClass,j=function(){$traceurRuntime.superConstructor(k).apply(this,arguments)},k=j;$traceurRuntime.createClass(j,{beginEditing:function(a,b){if(void 0===b){var c=this.TD.querySelector('input[type="checkbox"]');i(c,"htBadValue")||c.click()}},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},h),g("checkbox",j)},{_baseEditor:31,editors:30,"helpers/dom/element":47}],34:[function(a,b,c){"use strict";Object.defineProperties(c,{DateEditor:{get:function(){return B}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,o=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},p=o.addClass,q=o.outerHeight,r=((f=a("helpers/object"))&&f.__esModule&&f||{default:f}).deepExtend,s=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).EventManager,t=(h=a("editors"))&&h.__esModule&&h||{default:h},v=(t.getEditor,t.registerEditor),w=((i=a("helpers/unicode"))&&i.__esModule&&i||{default:i}).isMetaKey,x=((j=a("helpers/dom/event"))&&j.__esModule&&j||{default:j}).stopPropagation,y=((k=a("textEditor"))&&k.__esModule&&k||{default:k}).TextEditor,z=((l=a("moment"))&&l.__esModule&&l||{default:l}).default,A=((m=a("pikaday"))&&m.__esModule&&m||{default:m}).default,B=function(b){this.$datePicker=null,this.datePicker=null,this.datePickerStyle=null,this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,$traceurRuntime.superConstructor(C).call(this,b)},C=B;$traceurRuntime.createClass(B,{init:function(){var a=this;if("function"!=typeof z)throw new Error("You need to include moment.js to your project.");if("function"!=typeof A)throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,C.prototype,"init").call(this),this.instance.addHook("afterDestroy",function(){a.parentDestroyed=!0,a.destroyElements()})},createElements:function(){$traceurRuntime.superGet(this,C.prototype,"createElements").call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,p(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new A(this.getDatePickerConfig()),new s(this).addEventListener(this.datePicker,"mousedown",function(a){return x(a)}),this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(a,b,c,d,e,f){this._opened=!1,$traceurRuntime.superGet(this,C.prototype,"prepare").call(this,a,b,c,d,e,f)},open:function(){var a=void 0!==arguments[0]?arguments[0]:null;$traceurRuntime.superGet(this,C.prototype,"open").call(this),this.showDatepicker(a)},close:function(){var a=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){a.instance.selection.refreshBorders()},0)),$traceurRuntime.superGet(this,C.prototype,"close").call(this)},finishEditing:function(){var a=void 0!==arguments[0]&&arguments[0],b=void 0!==arguments[1]&&arguments[1];if(a){var c=this.originalValue;void 0!==c&&this.setValue(c)}this.hideDatepicker(),$traceurRuntime.superGet(this,C.prototype,"finishEditing").call(this,a,b)},showDatepicker:function(a){this.$datePicker.config(this.getDatePickerConfig());var e,b=this.TD.getBoundingClientRect(),c=this.cellProperties.dateFormat||this.defaultDateFormat,d=this.$datePicker.config(),f=this.instance.view.isMouseDown(),g=!!a&&w(a.keyCode);this.datePickerStyle.top=window.pageYOffset+b.top+q(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+b.left+"px",this.$datePicker._onInputFocus=function(){},d.format=c,this.originalValue?(e=this.originalValue,z(e,c,!0).isValid()&&this.$datePicker.setMoment(z(e,c),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),g||f||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,d.defaultDate=e,z(e,c,!0).isValid()&&this.$datePicker.setMoment(z(e,c),!0),g||f||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none",this.$datePicker.hide()},getDatePickerConfig:function(){var a=this,b=this.TEXTAREA,c={};this.cellProperties&&this.cellProperties.datePickerConfig&&r(c,this.cellProperties.datePickerConfig);var d=c.onSelect,e=c.onClose;return c.field=b,c.trigger=b,c.container=this.datePicker,c.bound=!1,c.format=c.format||this.defaultDateFormat,c.reposition=c.reposition||!1,c.onSelect=function(b){isNaN(b.getTime())||(b=z(b).format(a.cellProperties.dateFormat||a.defaultDateFormat)),a.setValue(b),a.hideDatepicker(),d&&d()},c.onClose=function(){a.parentDestroyed||a.finishEditing(!1),e&&e()},c}},{},y),n.editors=n.editors||{},n.editors.DateEditor=B,v("date",B)},{browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,moment:"moment",pikaday:"pikaday",textEditor:41}],35:[function(a,b,c){"use strict";Object.defineProperties(c,{DropdownEditor:{get:function(){return m}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=(e=a("editors"))&&e.__esModule&&e||{default:e},j=(h.getEditor,h.registerEditor),l=(h.getEditorConstructor,((f=a("autocompleteEditor"))&&f.__esModule&&f||{default:f}).AutocompleteEditor),m=function(){$traceurRuntime.superConstructor(n).apply(this,arguments)},n=m;$traceurRuntime.createClass(m,{prepare:function(a,b,c,d,e,f){$traceurRuntime.superGet(this,n.prototype,"prepare").call(this,a,b,c,d,e,f),this.cellProperties.filter=!1,this.cellProperties.strict=!0}},{},l),g.hooks.add("beforeValidate",function(a,b,c,d){var e=this.getCellMeta(b,this.propToCol(c));e.editor===g.editors.DropdownEditor&&void 0===e.strict&&(e.filter=!1,e.strict=!0)}),j("dropdown",m)},{autocompleteEditor:32,browser:24,editors:30}],36:[function(a,b,c){"use strict";Object.defineProperties(c,{HandsontableEditor:{get:function(){return v}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,l=((e=a("helpers/unicode"))&&e.__esModule&&e||{default:e}).KEY_CODES,m=((f=a("helpers/object"))&&f.__esModule&&f||{default:f}).extend,n=((g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g}).setCaretPosition,o=(h=a("helpers/dom/event"))&&h.__esModule&&h||{default:h},p=o.stopImmediatePropagation,q=o.isImmediatePropagationStopped,r=(i=a("editors"))&&i.__esModule&&i||{default:i},t=(r.getEditor,r.registerEditor),u=((j=a("textEditor"))&&j.__esModule&&j||{default:j}).TextEditor,v=u.prototype.extend();v.prototype.createElements=function(){u.prototype.createElements.apply(this,arguments);var a=document.createElement("DIV");a.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(a),this.htContainer=a,this.assignHooks()},v.prototype.prepare=function(a,b,c,d,e,f){u.prototype.prepare.apply(this,arguments);var g=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(){var a=this.getValue();void 0!==a&&g.setValue(a),g.instance.destroyEditor()}};this.cellProperties.handsontable&&m(h,f.handsontable),this.htOptions=h};var w=function(a){if(!q(a)){var d,b=this.getActiveEditor(),c=b.htEditor.getInstance();if(a.keyCode==l.ARROW_DOWN)if(c.getSelected()||c.flipped){if(c.getSelected())if(c.flipped)d=c.getSelected()[0]+1;else if(!c.flipped){var e=c.getSelected()[0],f=c.countRows()-1;d=Math.min(f,e+1)}}else d=0;else if(a.keyCode==l.ARROW_UP)if(!c.getSelected()&&c.flipped)d=c.countRows()-1;else if(c.getSelected())if(c.flipped){var e=c.getSelected()[0];d=Math.max(0,e-1)}else{var e=c.getSelected()[0];d=e-1}void 0!==d&&(d<0||c.flipped&&d>c.countRows()-1?c.deselectCell():c.selectCell(d,0),c.getData().length&&(a.preventDefault(),p(a),b.instance.listen(),b.TEXTAREA.focus()))}};v.prototype.open=function(){this.instance.addHook("beforeKeyDown",w),u.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new k(this.htContainer,this.htOptions),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),n(this.TEXTAREA,0,this.TEXTAREA.value.length)},v.prototype.close=function(){this.instance.removeHook("beforeKeyDown",w),this.instance.listen(),u.prototype.close.apply(this,arguments)},v.prototype.focus=function(){this.instance.listen(),u.prototype.focus.apply(this,arguments)},v.prototype.beginEditing=function(a){var b=this.instance.getSettings().onBeginEditing;b&&!1===b()||u.prototype.beginEditing.apply(this,arguments)},v.prototype.finishEditing=function(a,b){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var c=this.htEditor.getInstance().getValue();void 0!==c&&this.setValue(c)}return u.prototype.finishEditing.apply(this,arguments)},v.prototype.assignHooks=function(){var a=this;this.instance.addHook("afterDestroy",function(){a.htEditor&&a.htEditor.destroy()})},t("handsontable",v)},{browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,textEditor:41}],37:[function(a,b,c){"use strict";Object.defineProperties(c,{MobileTextEditor:{get:function(){return F}},__esModule:{value:!0}});var d,e,f,g,h,i,j,l=((d=a("browser"))&&d.__esModule,((e=a("helpers/unicode"))&&e.__esModule&&e||{default:e}).KEY_CODES),m=(f=a("helpers/dom/event"))&&f.__esModule&&f||{default:f},n=m.stopImmediatePropagation,o=m.isImmediatePropagationStopped,p=(g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g},q=p.addClass,r=p.getScrollLeft,s=p.getScrollTop,t=p.hasClass,u=p.isChildOf,v=p.offset,w=p.outerHeight,x=p.outerWidth,y=p.removeClass,z=p.setCaretPosition,A=(h=a("editors"))&&h.__esModule&&h||{default:h},C=(A.getEditor,A.registerEditor),D=((i=a("_baseEditor"))&&i.__esModule&&i||{default:i}).BaseEditor,E=((j=a("eventManager"))&&j.__esModule&&j||{default:j}).eventManager,F=D.prototype.extend(),G={},H=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var a in this.controls)this.controls.hasOwnProperty(a)&&this.positionControls.appendChild(this.controls[a])};F.prototype.valueChanged=function(){return this.initValue!=this.getValue()},F.prototype.init=function(){var a=this;this.eventManager=E(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){a.destroy()})},F.prototype.getValue=function(){return this.TEXTAREA.value},F.prototype.setValue=function(a){this.initValue=a,this.TEXTAREA.value=a},F.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),q(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),H.call(this),document.body.appendChild(this.editorContainer)},F.prototype.onBeforeKeyDown=function(a){var b=this,c=b.getActiveEditor();if(a.target===c.TEXTAREA&&!o(a))switch(a.keyCode){case l.ENTER:c.close(),a.preventDefault();break;case l.BACKSPACE:n(a)}},F.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),q(this.editorContainer,"active"),y(this.cellPointer,"hidden"),this.updateEditorPosition()},F.prototype.focus=function(){this.TEXTAREA.focus(),z(this.TEXTAREA,this.TEXTAREA.value.length)},F.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),y(this.editorContainer,"active")},F.prototype.scrollToView=function(){var a=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(a)},F.prototype.hideCellPointer=function(){t(this.cellPointer,"hidden")||q(this.cellPointer,"hidden")},F.prototype.updateEditorPosition=function(a,b){if(a&&b)a=parseInt(a,10),b=parseInt(b,10),this.editorContainer.style.top=b+"px",this.editorContainer.style.left=a+"px";else{var c=this.instance.getSelected(),d=this.instance.getCell(c[0],c[1]);if(G.cellPointer||(G.cellPointer={height:w(this.cellPointer),width:x(this.cellPointer)}),G.editorContainer||(G.editorContainer={width:x(this.editorContainer)}),void 0!==d){var e=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:r(this.instance.view.wt.wtOverlays.leftOverlay.holder),f=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:s(this.instance.view.wt.wtOverlays.topOverlay.holder),g=v(d),h=x(d),i={x:e,y:f};this.editorContainer.style.top=parseInt(g.top+w(d)-i.y+G.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-G.editorContainer.width/2,10)+"px",g.left+h/2>parseInt(this.editorContainer.style.left,10)+G.editorContainer.width?this.editorContainer.style.left=window.innerWidth-G.editorContainer.width+"px":g.left+h/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(g.left-G.cellPointer.width/2-v(this.editorContainer).left+h/2-i.x,10)+"px"}}},F.prototype.updateEditorData=function(){var a=this.instance.getSelected(),b=this.instance.getDataAtCell(a[0],a[1]);this.row=a[0],this.col=a[1],this.setValue(b),this.updateEditorPosition()},F.prototype.prepareAndSave=function(){var a;if(!this.valueChanged())return!0;a=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(a)},F.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(b){a.prepareAndSave(),a.instance.selection.transformStart(0,-1,null,!0),a.updateEditorData(),b.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(b){a.prepareAndSave(),a.instance.selection.transformStart(0,1,null,!0),a.updateEditorData(),b.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(b){a.prepareAndSave(),a.instance.selection.transformStart(-1,0,null,!0),a.updateEditorData(),b.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(b){a.prepareAndSave(),a.instance.selection.transformStart(1,0,null,!0),a.updateEditorData(),b.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(b){if(1==b.touches.length){var c=b.touches[0],d={x:a.editorContainer.offsetLeft,y:a.editorContainer.offsetTop},e={x:c.pageX-d.x,y:c.pageY-d.y};a.eventManager.addEventListener(this,"touchmove",function(b){var c=b.touches[0];a.updateEditorPosition(c.pageX-e.x,c.pageY-e.y),a.hideCellPointer(),b.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(b){u(b.target,a.editorContainer)||u(b.target,a.instance.rootElement)||a.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(b){a.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&a.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(b){a.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&a.hideCellPointer()})},F.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},C("mobile",F)},{_baseEditor:31,browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],38:[function(a,b,c){"use strict";Object.defineProperties(c,{NumericEditor:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("numbro"))&&d.__esModule&&d||{default:d}).default,h=((e=a("editors"))&&e.__esModule&&e||{default:e}).registerEditor,i=((f=a("textEditor"))&&f.__esModule&&f||{default:f}).TextEditor,j=function(){$traceurRuntime.superConstructor(k).apply(this,arguments)},k=j;$traceurRuntime.createClass(j,{beginEditing:function(a){if(void 0===a&&this.originalValue){void 0!==this.cellProperties.language&&g.culture(this.cellProperties.language);var b=g.cultureData().delimiters.decimal;a=(""+this.originalValue).replace(".",b)}$traceurRuntime.superGet(this,k.prototype,"beginEditing").call(this,a)}},{},i),h("numeric",j)},{editors:30,numbro:"numbro",textEditor:41}],39:[function(a,b,c){"use strict";Object.defineProperties(c,{PasswordEditor:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,i=((d=a("browser"))&&d.__esModule,((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).empty),j=(f=a("editors"))&&f.__esModule&&f||{default:f},l=(j.getEditor,j.registerEditor),m=((g=a("textEditor"))&&g.__esModule&&g||{default:g}).TextEditor,n=function(){$traceurRuntime.superConstructor(o).apply(this,arguments)},o=n;$traceurRuntime.createClass(n,{createElements:function(){$traceurRuntime.superGet(this,o.prototype,"createElements").call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,i(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},m),l("password",n)},{browser:24,editors:30,"helpers/dom/element":47,textEditor:41}],40:[function(a,b,c){"use strict";Object.defineProperties(c,{SelectEditor:{get:function(){return B}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},l=k.addClass,m=k.empty,n=k.fastInnerHTML,o=k.getComputedStyle,p=k.getCssTransform,q=k.getScrollableElement,r=k.offset,s=k.outerHeight,t=k.outerWidth,u=k.resetCssTransform,v=((f=a("helpers/dom/event"))&&f.__esModule&&f||{default:f}).stopImmediatePropagation,w=((g=a("helpers/unicode"))&&g.__esModule&&g||{default:g}).KEY_CODES,x=(h=a("editors"))&&h.__esModule&&h||{default:h},z=(x.getEditor,x.registerEditor),A=((i=a("_baseEditor"))&&i.__esModule&&i||{default:i}).BaseEditor,B=A.prototype.extend();B.prototype.init=function(){this.select=document.createElement("SELECT"),l(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},B.prototype.registerHooks=function(){var a=this;this.instance.addHook("afterScrollHorizontally",function(){return a.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return a.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return a.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return a.refreshDimensions()})},B.prototype.prepare=function(){A.prototype.prepare.apply(this,arguments);var b,a=this.cellProperties.selectOptions;b="function"==typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a),m(this.select);for(var c in b)if(b.hasOwnProperty(c)){var d=document.createElement("OPTION");d.value=c,n(d,b[c]),this.select.appendChild(d)}},B.prototype.prepareOptions=function(a){var b={};if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b[a[c]]=a[c];else"object"==typeof a&&(b=a);return b},B.prototype.getValue=function(){return this.select.value},B.prototype.setValue=function(a){this.select.value=a};var C=function(a){var b=this,c=b.getActiveEditor();switch(a.keyCode){case w.ARROW_UP:var d=c.select.selectedIndex-1;d>=0&&(c.select[d].selected=!0),v(a),a.preventDefault();break;case w.ARROW_DOWN:var e=c.select.selectedIndex+1;e<=c.select.length-1&&(c.select[e].selected=!0),v(a),a.preventDefault()}};B.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",C)},B.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",C)},B.prototype.focus=function(){this.select.focus()},B.prototype.refreshValue=function(){var a=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=a,this.setValue(a),this.refreshDimensions()},B.prototype.refreshDimensions=function(){if(this.state===j.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close();var i,a=t(this.TD)+1,b=s(this.TD)+1,c=r(this.TD),d=r(this.instance.rootElement),e=q(this.TD),f=c.top-d.top-1-(e.scrollTop||0),g=c.left-d.left-1-(e.scrollLeft||0),h=this.checkEditorSection(),k=this.instance.getSettings();k.rowHeaders,k.colHeaders;switch(h){case"top":i=p(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":i=p(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":i=p(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":i=p(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":i=p(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(f+=1),0===this.instance.getSelected()[1]&&(g+=1);var n=this.select.style;i&&-1!=i?n[i[0]]=i[1]:u(this.select);var v=o(this.TD);parseInt(v.borderTopWidth,10)>0&&(b-=1),parseInt(v.borderLeftWidth,10)>0&&(a-=1),n.height=b+"px",n.minWidth=a+"px",n.top=f+"px",n.left=g+"px",n.margin="0px"}},B.prototype.getEditedCell=function(){var b,a=this.checkEditorSection();switch(a){case"top":b=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":b=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":b=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:b=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=b&&-2!=b?b:void 0},z("select",B)},{_baseEditor:31,browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],41:[function(a,b,c){"use strict";Object.defineProperties(c,{TextEditor:{get:function(){return K}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,m=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},n=m.addClass,o=m.getCaretPosition,p=m.getComputedStyle,q=m.getCssTransform,r=m.getScrollableElement,s=m.getScrollbarWidth,t=m.innerWidth,u=m.offset,v=m.resetCssTransform,w=m.setCaretPosition,x=m.hasVerticalScrollbar,y=m.hasHorizontalScrollbar,z=((f=a("autoResize"))&&f.__esModule&&f||{default:f}).default,A=((g=a("_baseEditor"))&&g.__esModule&&g||{default:g}).BaseEditor,B=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).eventManager,C=(i=a("editors"))&&i.__esModule&&i||{default:i},E=(C.getEditor,C.registerEditor),F=((j=a("helpers/unicode"))&&j.__esModule&&j||{default:j}).KEY_CODES,G=(k=a("helpers/dom/event"))&&k.__esModule&&k||{default:k},H=G.stopPropagation,I=G.stopImmediatePropagation,J=G.isImmediatePropagationStopped,K=A.prototype.extend();K.prototype.init=function(){var a=this;this.createElements(),this.eventManager=B(this),this.bindEvents(),this.autoResize=z(),this.instance.addHook("afterDestroy",function(){a.destroy()})},K.prototype.getValue=function(){return this.TEXTAREA.value},K.prototype.setValue=function(a){this.TEXTAREA.value=a};var L=function(b){var e,c=this,d=c.getActiveEditor();if(e=(b.ctrlKey||b.metaKey)&&!b.altKey,b.target===d.TEXTAREA&&!J(b)){if(17===b.keyCode||224===b.keyCode||91===b.keyCode||93===b.keyCode)return void I(b);switch(b.keyCode){case F.ARROW_RIGHT:case F.ARROW_LEFT:d.isInFullEditMode()&&(!d.isWaiting()&&!d.allowKeyEventPropagation||!d.isWaiting()&&d.allowKeyEventPropagation&&!d.allowKeyEventPropagation(b.keyCode))&&I(b);break;case F.ARROW_UP:case F.ARROW_DOWN:d.isInFullEditMode()&&(!d.isWaiting()&&!d.allowKeyEventPropagation||!d.isWaiting()&&d.allowKeyEventPropagation&&!d.allowKeyEventPropagation(b.keyCode))&&I(b);break;case F.ENTER:var f=d.instance.getSelected(),g=!(f[0]===f[2]&&f[1]===f[3]);if(e&&!g||b.altKey){if(d.isOpened()){var h=o(d.TEXTAREA),i=d.getValue(),j=i.slice(0,h)+"\n"+i.slice(h);d.setValue(j),w(d.TEXTAREA,h+1)}else d.beginEditing(d.originalValue+"\n");I(b)}b.preventDefault();break;case F.A:case F.X:case F.C:case F.V:e&&I(b);break;case F.BACKSPACE:case F.DELETE:case F.HOME:case F.END:I(b)}-1===[F.ARROW_UP,F.ARROW_RIGHT,F.ARROW_DOWN,F.ARROW_LEFT].indexOf(b.keyCode)&&d.autoResize.resize(String.fromCharCode(b.keyCode))}};K.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",L)},K.prototype.close=function(a){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",L)},K.prototype.focus=function(){this.TEXTAREA.focus(),w(this.TEXTAREA,this.TEXTAREA.value.length)},K.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),n(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),n(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var a=this;this.instance._registerTimeout(setTimeout(function(){a.refreshDimensions()},0))},K.prototype.getEditedCell=function(){var b,a=this.checkEditorSection();switch(a){case"top":b=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":b=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":b=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":b=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":b=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:b=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=b&&-2!=b?b:void 0},K.prototype.refreshValue=function(){var a=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=a,this.setValue(a),this.refreshDimensions()},K.prototype.refreshDimensions=function(){if(this.state===l.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close(!0);var n,a=u(this.TD),b=u(this.instance.rootElement),c=r(this.TD),d=this.instance.countRows(),e=a.top===b.top?0:1,f=a.top-b.top-e-(c.scrollTop||0),g=a.left-b.left-1-(c.scrollLeft||0),h=this.instance.getSettings(),j=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),k=this.checkEditorSection(),m=this.TD.style.backgroundColor;switch(k){case"top":n=q(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=q(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=q(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=q(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=q(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(j&&0===this.instance.getSelected()[0]||h.fixedRowsBottom&&this.instance.getSelected()[0]===d-h.fixedRowsBottom)&&(f+=1),0===this.instance.getSelected()[1]&&(g+=1),n&&-1!=n?this.textareaParentStyle[n[0]]=n[1]:v(this.TEXTAREA_PARENT),this.textareaParentStyle.top=f+"px",this.textareaParentStyle.left=g+"px";var o=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,w=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,z=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),A=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),B=s(),C=this.TD.offsetTop+o-A,D=this.TD.offsetLeft+w-z,E=t(this.TD)-8,F=x(c)?B:0,G=y(c)?B:0,H=this.instance.view.maximumVisibleElementWidth(D)-9-F,I=this.TD.scrollHeight+1,J=Math.max(this.instance.view.maximumVisibleElementHeight(C)-G,23),K=p(this.TD);this.TEXTAREA.style.fontSize=K.fontSize,this.TEXTAREA.style.fontFamily=K.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=m||p(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,J),maxHeight:J,minWidth:Math.min(E,H),maxWidth:H},!0),this.textareaParentStyle.display="block"}},K.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){H(a)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){H(a)}),this.instance.addHook("afterScrollHorizontally",function(){a.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){a.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){a.refreshDimensions(),a.focus()}),this.instance.addHook("afterRowResize",function(){a.refreshDimensions(),a.focus()}),this.instance.addHook("afterDestroy",function(){a.eventManager.destroy()})},K.prototype.destroy=function(){this.eventManager.destroy()},E("text",K)},{_baseEditor:31,autoResize:"autoResize",browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],42:[function(a,b,c){"use strict";function o(a,b){var d,e,f,g,i,n,c="HOT-TABLE";if(b.isTargetWebComponent=!1,b.realTarget=b.target,n=b.stopImmediatePropagation,b.stopImmediatePropagation=function(){n.apply(this),m(this)},!h.eventManager.isHotTableEnv)return b;for(b=j(b),i=b.path?b.path.length:0;i--;){if(b.path[i].nodeName===c)d=!0;else if(d&&b.path[i].shadowRoot){g=b.path[i];break}0!==i||g||(g=b.path[i])}return g||(g=b.target),b.isTargetWebComponent=!0,l()?b.realTarget=b.srcElement||b.toElement:(a instanceof h.Core||a instanceof Walkontable)&&(a instanceof h.Core?e=a.view?a.view.wt.wtTable.TABLE:null:a instanceof Walkontable&&(e=a.wtTable.TABLE.parentNode.parentNode),f=k(b.target,[c],e),b.realTarget=f?e.querySelector(c)||b.target:b.target),Object.defineProperty(b,"target",{get:function(){return j(g)},enumerable:!0,configurable:!0}),b}function p(a){return new n(a)}Object.defineProperties(c,{EventManager:{get:function(){return n}},eventManager:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,i=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},j=i.polymerWrap,k=i.closest,l=((f=a("helpers/feature"))&&f.__esModule&&f||{default:f}).isWebComponentSupportedNatively,m=((g=a("helpers/dom/event"))&&g.__esModule&&g||{default:g}).stopImmediatePropagation,n=function(){var b=void 0!==arguments[0]?arguments[0]:null;this.context=b||this,this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(n,{addEventListener:function(a,b,c){function f(a){a=o(e,a),c.call(this,a)}var d=this,e=this.context;return this.context.eventListeners.push({element:a,event:b,callback:c,callbackProxy:f}),window.addEventListener?a.addEventListener(b,f,!1):a.attachEvent("on"+b,f),h.countEventManagerListeners++,function(){d.removeEventListener(a,b,c)}},removeEventListener:function(a,b,c){for(var e,d=this.context.eventListeners.length;d--;)if(e=this.context.eventListeners[d],e.event==b&&e.element==a){if(c&&c!=e.callback)continue;this.context.eventListeners.splice(d,1),e.element.removeEventListener?e.element.removeEventListener(e.event,e.callbackProxy,!1):e.element.detachEvent("on"+e.event,e.callbackProxy),h.countEventManagerListeners--}},clearEvents:function(){if(this.context)for(var a=this.context.eventListeners.length;a--;){var b=this.context.eventListeners[a];b&&this.removeEventListener(b.element,b.event,b.callback)}},clear:function(){this.clearEvents()},destroy:function(){this.clearEvents(),this.context=null},fireEvent:function(a,b){var d,c={bubbles:!0,cancelable:"mousemove"!==b,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(d=document.createEvent("MouseEvents"),d.initMouseEvent(b,c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget||document.body.parentNode)):d=document.createEventObject(),a.dispatchEvent?a.dispatchEvent(d):a.fireEvent("on"+b,d)}},{}),h.countEventManagerListeners=0,h.eventManager=p},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49}],43:[function(a,b,c){"use strict";function d(a){for(var b=0,c=a.length;b<c;)a[b]=[a[b]],b++}function e(a,b){for(var c=0,d=b.length;c<d;)a.push(b[c]),c++}function f(a){var b=[];if(!a||0===a.length||!a[0]||0===a[0].length)return b;for(var c=a.length,d=a[0].length,e=0;e<c;e++)for(var f=0;f<d;f++)b[f]||(b[f]=[]),b[f][e]=a[e][f];return b}function g(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function h(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[++e]=g)}return f}function i(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];f[++e]=b(g,c,a)}return f}function j(a,b){for(var c=-1,d=a.length;++c<d&&!1!==b(a[c],c,a););return a}function k(a){return g(a,function(a,b){return a+b},0)}function l(a){return g(a,function(a,b){return a>b?a:b},Array.isArray(a)?a[0]:void 0)}function m(a){return g(a,function(a,b){return a<b?a:b},Array.isArray(a)?a[0]:void 0)}function n(a){return a.length?k(a)/a.length:0}function o(a){return g(a,function(a,b){return a.concat(Array.isArray(b)?o(b):b)},[])}function p(a){var b=[];return j(a,function(a){-1===b.indexOf(a)&&b.push(a)}),b}function q(a,b,c){if(null==a)throw new TypeError('"array" is null or not defined');var d=Object(a),e=d.length>>>0;if(0===e)return!1;for(var f=0|c,g=Math.max(f>=0?f:e-Math.abs(f),0);g<e;){if(d[g]===b)return!0;g++}return!1}Object.defineProperties(c,{to2dArray:{get:function(){return d}},extendArray:{get:function(){return e}},pivot:{get:function(){return f}},arrayReduce:{get:function(){return g}},arrayFilter:{get:function(){return h}},arrayMap:{get:function(){return i}},arrayEach:{get:function(){return j}},arraySum:{get:function(){return k}},arrayMax:{get:function(){return l}},arrayMin:{get:function(){return m}},arrayAvg:{get:function(){return n}},arrayFlatten:{get:function(){return o}},arrayUnique:{get:function(){return p}},arrayIncludes:{get:function(){return q}},__esModule:{value:!0}})},{}],44:[function(a,b,c){"use strict";function e(){return d}function g(){return f}function i(){return h}function k(){return j}function l(a){return a||(a=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)}Object.defineProperties(c,{isIE8:{get:function(){return e}},isIE9:{get:function(){return g}},isSafari:{get:function(){return i}},isChrome:{get:function(){return k}},isMobileBrowser:{get:function(){return l}},__esModule:{value:!0}});var d=!document.createTextNode("test").textContent,f=!!document.documentMode,h=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),j=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},{}],45:[function(a,b,c){"use strict";function j(a){for(var d,b=a+1,c="";b>0;)d=(b-1)%i,c=String.fromCharCode(65+d)+c,b=parseInt((b-d)/i,10);return c}function k(a){var b=0;if(a)for(var c=0,d=a.length-1;c<a.length;c+=1,d-=1)b+=Math.pow(i,d)*(h.indexOf(a[c])+1);return--b}function l(){var d,e,a=void 0!==arguments[0]?arguments[0]:100,b=void 0!==arguments[1]?arguments[1]:4,c=[];for(d=0;d<a;d++){var f=[];for(e=0;e<b;e++)f.push(j(e)+(d+1));c.push(f)}return c}function m(){var d,e,a=void 0!==arguments[0]?arguments[0]:100,b=void 0!==arguments[1]?arguments[1]:4,c=[];for(d=0;d<a;d++){var f={};for(e=0;e<b;e++)f["prop"+e]=j(e)+(d+1);c.push(f)}return c}function n(a,b){for(var d,c=[],e=0;e<a;e++){d=[];for(var f=0;f<b;f++)d.push("");c.push(d)}return c}function o(a){var b,c,d,e,f=[],g=0;for(b=0,c=a.length;b<c;b++)for(d=0,e=a[b].length;d<e;d++)d==g&&(f.push([]),g++),f[d].push(a[b][d]);return f}function p(a,b){function c(a){var b=f.cellTypes[a];if(void 0===b)throw new Error('You declared cell type "'+a+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return b}return b=void 0===b||b,function(e,f){return function d(e){if(e){if(e.hasOwnProperty(a)&&void 0!==e[a])return e[a];if(e.hasOwnProperty("type")&&e.type){var f;if("string"!=typeof e.type)throw new Error("Cell type must be a string ");if(f=c(e.type),f.hasOwnProperty(a))return f[a];if(b)return}return d(g(e))}}("number"==typeof e?this.getCellMeta(e,f):e)}}Object.defineProperties(c,{spreadsheetColumnLabel:{get:function(){return j}},spreadsheetColumnIndex:{get:function(){return k}},createSpreadsheetData:{get:function(){return l}},createSpreadsheetObjectData:{get:function(){return m}},createEmptySpreadsheetData:{get:function(){return n}},translateRowsToColumns:{get:function(){return o}},cellMethodLookupFactory:{get:function(){return p}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("object"))&&e.__esModule&&e||{default:e}).getPrototypeOf,h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=h.length},{browser:24,object:53}],46:[function(a,b,c){"use strict";function d(a){var b=new Date(a);return isNaN(new Date(a+"T00:00").getDate())?b:new Date(b.getTime()+6e4*b.getTimezoneOffset())}Object.defineProperties(c,{getNormalizedDate:{get:function(){return d}},__esModule:{value:!0}})},{}],47:[function(a,b,c){"use strict";function k(a){for(var b=void 0!==arguments[1]?arguments[1]:0,c=-1,d=null;null!=a;){if(c===b){d=a;break}a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a=a.host:(c++,a=a.parentNode)}return d}function l(a,b,c){for(;null!=a&&a!==c;){if(a.nodeType===Node.ELEMENT_NODE&&(b.indexOf(a.nodeName)>-1||b.indexOf(a)>-1))return a;a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode}return null}function m(a,b,c){for(var d=[];a&&(a=l(a,b,c))&&(!c||c.contains(a));)d.push(a),a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode;var e=d.length;return e?d[e-1]:null}function n(a,b){var c=a.parentNode,d=[];for("string"==typeof b?d=Array.prototype.slice.call(document.querySelectorAll(b),0):d.push(b);null!=c;){if(d.indexOf(c)>-1)return!0;c=c.parentNode}return!1}function o(a){function e(a){return a.nodeType===Node.ELEMENT_NODE&&a.nodeName===b.toUpperCase()}var d,b="hot-table",c=!1;for(d=p(a);null!=d;){if(e(d)){c=!0;break}if(d.host&&d.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(c=e(d.host))break;d=d.host}d=d.parentNode}return c}function p(a){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(a):a}function q(a){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(a):a}function r(a){var b=0;if(a.previousSibling)for(;a=a.previousSibling;)++b;return b}function s(a,b){var c=document.querySelector(".ht_clone_"+a);return c?c.contains(b):null}function x(a){var b=0,c=[];if(!a||!a.length)return c;for(;a[b];)c.push(a[b]),b++;return c}function A(a,b){return u(a,b)}function B(a,b){return v(a,b)}function C(a,b){return w(a,b)}function D(a,b){if(3===a.nodeType)b.removeChild(a);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName)>-1)for(var c=a.childNodes,d=c.length-1;d>=0;d--)D(c[d],a)}function E(a){for(var b;b=a.lastChild;)a.removeChild(b)}function G(a,b){F.test(b)?a.innerHTML=b:I(a,b)}function I(a,b){var c=a.firstChild;c&&3===c.nodeType&&null===c.nextSibling?H?c.textContent=b:c.data=b:(E(a),a.appendChild(document.createTextNode(b)))}function J(a){for(var b=a;q(b)!==document.documentElement;){if(null===b)return!1;if(b.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(b.host){if(b.host.impl)return J(b.host.impl);if(b.host)return J(b.host);throw new Error("Lost in Web Components world")}return!1}if("none"===b.style.display)return!1;b=b.parentNode}return!0}function K(a){var b,c,d,e,f;if(e=document.documentElement,j()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName)return f=a.getBoundingClientRect(),{top:f.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||0),left:f.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)};for(b=a.offsetLeft,c=a.offsetTop,d=a;(a=a.offsetParent)&&a!==document.body;)b+=a.offsetLeft,c+=a.offsetTop,d=a;return d&&"fixed"===d.style.position&&(b+=window.pageXOffset||e.scrollLeft,c+=window.pageYOffset||e.scrollTop),{left:b,top:c}}function L(){var a=window.scrollY;return void 0===a&&(a=document.documentElement.scrollTop),a}function M(){var a=window.scrollX;return void 0===a&&(a=document.documentElement.scrollLeft),a}function N(a){return a===window?L():a.scrollTop}function O(a){return a===window?M():a.scrollLeft}function P(a){for(var d,e,f,b=a.parentNode,c=["auto","scroll"],g="",h="",i="",j="";b&&b.style&&document.body!==b;){if(d=b.style.overflow,e=b.style.overflowX,f=b.style.overflowY,"scroll"==d||"scroll"==e||"scroll"==f)return b;if(window.getComputedStyle&&(g=window.getComputedStyle(b),h=g.getPropertyValue("overflow"),i=g.getPropertyValue("overflow-y"),j=g.getPropertyValue("overflow-x"),"scroll"===h||"scroll"===j||"scroll"===i))return b;if(b.clientHeight<=b.scrollHeight&&(-1!==c.indexOf(f)||-1!==c.indexOf(d)||-1!==c.indexOf(h)||-1!==c.indexOf(i)))return b;if(b.clientWidth<=b.scrollWidth&&(-1!==c.indexOf(e)||-1!==c.indexOf(d)||-1!==c.indexOf(h)||-1!==c.indexOf(j)))return b;b=b.parentNode}return window}function Q(a){for(var b=a.parentNode;b&&b.style&&document.body!==b;){if("visible"!==b.style.overflow&&""!==b.style.overflow)return b;if(window.getComputedStyle){var c=window.getComputedStyle(b);if("visible"!==c.getPropertyValue("overflow")&&""!==c.getPropertyValue("overflow"))return b}b=b.parentNode}return window}function R(a,b){if(a){if(a!==window){var d,c=a.style[b];return""!==c&&void 0!==c?c:(d=S(a),""!==d[b]&&void 0!==d[b]?d[b]:void 0)}if("width"===b)return window.innerWidth+"px";if("height"===b)return window.innerHeight+"px"}}function S(a){return a.currentStyle||document.defaultView.getComputedStyle(a)}function T(a){return a.offsetWidth}function U(a){return j()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName?a.offsetHeight+a.firstChild.offsetHeight:a.offsetHeight}function V(a){return a.clientHeight||a.innerHeight}function W(a){return a.clientWidth||a.innerWidth}function X(a,b,c){window.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function Y(a,b,c){window.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)}function Z(a){if(a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();if(null==b)return 0;var c=a.createTextRange(),d=c.duplicate();return c.moveToBookmark(b.getBookmark()),d.setEndPoint("EndToStart",c),d.text.length}return 0}function $(a){if(a.selectionEnd)return a.selectionEnd;if(document.selection){var b=document.selection.createRange();if(null==b)return 0;return a.createTextRange().text.indexOf(b.text)+b.text.length}}function _(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(a=document.selection.createRange().text),a}function aa(a,b,c){if(void 0===c&&(c=b),a.setSelectionRange){a.focus();try{a.setSelectionRange(b,c)}catch(f){var d=a.parentNode,e=d.style.display;d.style.display="block",a.setSelectionRange(b,c),d.style.display=e}}else if(a.createTextRange){var f=a.createTextRange();f.collapse(!0),f.moveEnd("character",c),f.moveStart("character",b),f.select()}}function ca(){var a=document.createElement("div");a.style.height="200px",a.style.width="100%";var b=document.createElement("div");b.style.boxSizing="content-box",b.style.height="150px",b.style.left="0px",b.style.overflow="hidden",b.style.position="absolute",b.style.top="0px",b.style.width="200px",b.style.visibility="hidden",b.appendChild(a),(document.body||document.documentElement).appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";var d=a.offsetWidth;return c==d&&(d=b.clientWidth),(document.body||document.documentElement).removeChild(b),c-d}function da(){return void 0===ba&&(ba=ca()),ba}function ea(a){return a.offsetWidth!==a.clientWidth}function fa(a){return a.offsetHeight!==a.clientHeight}function ga(a,b,c){g()||h()?(a.style.top=c,a.style.left=b):i()?a.style["-webkit-transform"]="translate3d("+b+","+c+",0)":a.style.transform="translate3d("+b+","+c+",0)"}function ha(a){var b;return a.style.transform&&""!==(b=a.style.transform)?["transform",b]:a.style["-webkit-transform"]&&""!==(b=a.style["-webkit-transform"])?["-webkit-transform",b]:-1}function ia(a){a.style.transform&&""!==a.style.transform?a.style.transform="":a.style["-webkit-transform"]&&""!==a.style["-webkit-transform"]&&(a.style["-webkit-transform"]="")}function ja(a){var b=["INPUT","SELECT","TEXTAREA"];return a&&(b.indexOf(a.nodeName)>-1||"true"===a.contentEditable)}function ka(a){return ja(a)&&-1==a.className.indexOf("handsontableInput")&&-1==a.className.indexOf("copyPaste")}Object.defineProperties(c,{getParent:{get:function(){return k}},closest:{get:function(){return l}},closestDown:{get:function(){return m}},isChildOf:{get:function(){return n}},isChildOfWebComponentTable:{get:function(){return o}},polymerWrap:{get:function(){return p}},polymerUnwrap:{get:function(){return q}},index:{get:function(){return r}},overlayContainsElement:{get:function(){return s}},hasClass:{get:function(){return A}},addClass:{get:function(){return B}},removeClass:{get:function(){return C}},removeTextNodes:{get:function(){return D}},empty:{get:function(){return E}},HTML_CHARACTERS:{get:function(){return F}},fastInnerHTML:{get:function(){return G}},fastInnerText:{get:function(){return I}},isVisible:{get:function(){return J}},offset:{get:function(){return K}},getWindowScrollTop:{get:function(){return L}},getWindowScrollLeft:{get:function(){return M}},getScrollTop:{get:function(){return N}},getScrollLeft:{get:function(){return O}},getScrollableElement:{get:function(){return P}},getTrimmingContainer:{get:function(){return Q}},getStyle:{get:function(){return R}},getComputedStyle:{get:function(){return S}},outerWidth:{get:function(){return T}},outerHeight:{get:function(){return U}},innerHeight:{get:function(){return V}},innerWidth:{get:function(){return W}},addEvent:{get:function(){return X}},removeEvent:{get:function(){return Y}},getCaretPosition:{get:function(){return Z}},getSelectionEndPosition:{get:function(){return $}},getSelectionText:{get:function(){return _}},setCaretPosition:{get:function(){return aa}},getScrollbarWidth:{get:function(){return da}},hasVerticalScrollbar:{get:function(){return ea}},hasHorizontalScrollbar:{get:function(){return fa}},setOverlayPosition:{get:function(){return ga}},getCssTransform:{get:function(){return ha}},resetCssTransform:{get:function(){return ia}},isInput:{get:function(){return ja}},isOutsideInput:{get:function(){return ka}},__esModule:{value:!0}});var d,e,u,v,w,f=(d=a("../browser"))&&d.__esModule&&d||{default:d},g=f.isIE8,h=f.isIE9,i=f.isSafari,j=((e=a("../feature"))&&e.__esModule&&e||{default:e}).hasCaptionProblem,t=!!document.documentElement.classList;if(t){var y=function(){var a=document.createElement("div");return a.classList.add("test","test2"),a.classList.contains("test2")}();u=function(b,c){return""!==c&&b.classList.contains(c)},v=function(b,c){var d=0;if("string"==typeof c&&(c=c.split(" ")),c=x(c),y)b.classList.add.apply(b.classList,c);else for(;c&&c[d];)b.classList.add(c[d]),d++},w=function(b,c){var d=0;if("string"==typeof c&&(c=c.split(" ")),c=x(c),y)b.classList.remove.apply(b.classList,c);else for(;c&&c[d];)b.classList.remove(c[d]),d++}}else{var z=function(b){return new RegExp("(\\s|^)"+b+"(\\s|$)")};u=function(b,c){return!!b.className.match(z(c))},v=function(b,c){var d=0,e=b.className;if("string"==typeof c&&(c=c.split(" ")),""===e)e=c.join(" ");else for(;c&&c[d];)z(c[d]).test(e)||(e+=" "+c[d]),d++;b.className=e},w=function(b,c){var d=0,e=b.className;for("string"==typeof c&&(c=c.split(" "));c&&c[d];)e=e.replace(z(c[d])," ").trim(),d++;b.className!==e&&(b.className=e)}}var ba,F=/(<(.*)>|&(.*);)/,H=!!document.createTextNode("test").textContent},{"../browser":44,"../feature":49}],48:[function(a,b,c){"use strict";function h(a){a.isImmediatePropagationEnabled=!1,a.cancelBubble=!0}function i(a){return!1===a.isImmediatePropagationEnabled}function j(a){"function"==typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function k(a){return a.pageX?a.pageX:a.clientX+g()}function l(a){return a.pageY?a.pageY:a.clientY+f()}function m(a){return 2===a.button}function n(a){return 0===a.button}Object.defineProperties(c,{stopImmediatePropagation:{get:function(){return h}},isImmediatePropagationStopped:{get:function(){return i}},stopPropagation:{get:function(){return j}},pageX:{get:function(){return k}},pageY:{get:function(){return l}},isRightClick:{get:function(){return m}},isLeftClick:{get:function(){return n}},__esModule:{value:!0}});var d,e=(d=a("element"))&&d.__esModule&&d||{default:d},f=e.getWindowScrollTop,g=e.getWindowScrollLeft},{element:47}],49:[function(a,b,c){"use strict";function i(a){return f.call(window,a)}function j(a){g.call(window,a)}function k(){return"ontouchstart"in window}function l(){var a=document.createElement("div");return!(!a.createShadowRoot||!a.createShadowRoot.toString().match(/\[native code\]/))}function n(){var a=document.createElement("TABLE");a.style.borderSpacing=0,a.style.borderWidth=0,a.style.padding=0;var b=document.createElement("TBODY");a.appendChild(b),b.appendChild(document.createElement("TR")),b.firstChild.appendChild(document.createElement("TD")),b.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var c=document.createElement("CAPTION");c.innerHTML="c<br>c<br>c<br>c",c.style.padding=0,c.style.margin=0,a.insertBefore(c,b),document.body.appendChild(a),m=a.offsetHeight<2*a.lastChild.offsetHeight,document.body.removeChild(a)}function o(){return void 0===m&&n(),m}function q(a){var b=void 0!==arguments[1]?arguments[1]:{};return p||(p="object"==typeof Intl?new Intl.Collator(a,b).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return(a+"").localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}Object.defineProperties(c,{requestAnimationFrame:{get:function(){return i}},cancelAnimationFrame:{get:function(){return j}},isTouchSupported:{get:function(){return k}},isWebComponentSupportedNatively:{get:function(){return l}},hasCaptionProblem:{get:function(){return o}},getComparisonFunction:{get:function(){return q}},__esModule:{value:!0}});for(var d=0,e=["ms","moz","webkit","o"],f=window.requestAnimationFrame,g=window.cancelAnimationFrame,h=0;h<e.length&&!f;++h)f=window[e[h]+"RequestAnimationFrame"],g=window[e[h]+"CancelAnimationFrame"]||window[e[h]+"CancelRequestAnimationFrame"];f||(f=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-d)),e=window.setTimeout(function(){a(b+c)},c);return d=b+c,e}),g||(g=function(a){clearTimeout(a)});var m,p},{}],50:[function(a,b,c){"use strict";function f(a){return"function"==typeof a}function g(a,b){return function(){return a.apply(b,arguments)}}function h(a){function f(){var f=this,g=arguments,h=Date.now(),i=!1;d.lastCallThrottled=!0,c||(c=h,i=!0);var j=b-(h-c);return i?(d.lastCallThrottled=!1,a.apply(this,g)):(e&&clearTimeout(e),e=setTimeout(function(){d.lastCallThrottled=!1,a.apply(f,g),c=0,e=void 0},j)),d}var b=void 0!==arguments[1]?arguments[1]:200,c=0,d={lastCallThrottled:!0},e=null;return f}function i(a){function f(){e=c}function g(){return e?(e--,a.apply(this,arguments)):d.apply(this,arguments)}var b=void 0!==arguments[1]?arguments[1]:200,c=void 0!==arguments[2]?arguments[2]:10,d=h(a,b),e=c;return g.clearHits=f,g}function j(a){function e(){var e=this,f=arguments;return c&&clearTimeout(c),c=setTimeout(function(){d=a.apply(e,f)},b),d}var d,b=void 0!==arguments[1]?arguments[1]:200,c=null;return e}function k(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=a,d=c[0],f=Array.prototype.slice.call(c,1);return function(){return e(f,function(a,b){return b(a)},d.apply(this,arguments))}}function l(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];return a.apply(this,b.concat(d))}}function m(a){function c(d){return function(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];var h=d.concat(f);return h.length>=b?a.apply(this,h):c(h)}}var b=a.length;return c([])}function n(a){function c(d){return function(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];var h=d.concat(f.reverse());return h.length>=b?a.apply(this,h):c(h)}}var b=a.length;return c([])}Object.defineProperties(c,{isFunction:{get:function(){return f}},proxy:{get:function(){return g}},throttle:{get:function(){return h}},throttleAfterHits:{get:function(){return i}},debounce:{get:function(){return j}},pipe:{get:function(){return k}},partial:{get:function(){return l}},curry:{get:function(){return m}},curryRight:{get:function(){return n}},__esModule:{value:!0}});var d,e=((d=a("array"))&&d.__esModule&&d||{default:d}).arrayReduce},{array:43}],51:[function(a,b,c){"use strict";function d(a){switch(typeof a){case"string":case"number":return a+"";case"object":return null===a?"":a.toString();case"undefined":return"";default:return a.toString()}}function e(a){return void 0!==a}function f(a){return void 0===a}function g(a){return null===a||""===a||f(a)}Object.defineProperties(c,{stringify:{get:function(){return d}},isDefined:{get:function(){return e}},isUndefined:{get:function(){return f}},isEmpty:{get:function(){return g}},__esModule:{value:!0}})},{}],52:[function(a,b,c){"use strict";function d(a){var b=typeof a;return"number"==b?!isNaN(a)&&isFinite(a):"string"==b?!!a.length&&(1==a.length?/\d/.test(a):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(a)):"object"==b&&!(!a||"number"!=typeof a.valueOf()||a instanceof Date)}function e(a,b,c){var d=-1;for("function"==typeof b?(c=b,b=a):d=a-1;++d<=b&&!1!==c(d););}function f(a,b,c){var d=a+1;for("function"==typeof b&&(c=b,b=0);--d>=b&&!1!==c(d););}function g(a,b){return b=parseInt(b.toString().replace("%",""),10),b=parseInt(a*b/100)}Object.defineProperties(c,{isNumeric:{get:function(){return d}},rangeEach:{get:function(){return e}},rangeEachReverse:{get:function(){return f}},valueAccordingPercent:{get:function(){return g}},__esModule:{value:!0}})},{}],53:[function(a,b,c){"use strict";function f(a){var b;return Array.isArray(a)?b=[]:(b={},q(a,function(a,c){"__children"!==c&&(a&&"object"==typeof a&&!Array.isArray(a)?b[c]=f(a):Array.isArray(a)?a.length&&"object"==typeof a[0]&&!Array.isArray(a[0])?b[c]=[f(a[0])]:b[c]=[]:b[c]=null)})),b}function g(a,b){return b.prototype.constructor=b,a.prototype=new b,a.prototype.constructor=a,a}function h(a,b){return q(b,function(b,c){a[c]=b}),a}function i(a,b){q(b,function(c,d){b[d]&&"object"==typeof b[d]?(a[d]||(Array.isArray(b[d])?a[d]=[]:"[object Date]"===Object.prototype.toString.call(b[d])?a[d]=b[d]:a[d]={}),i(a[d],b[d])):a[d]=b[d]})}function j(a){return"object"==typeof a?JSON.parse(JSON.stringify(a)):a}function k(a){var b={};return q(a,function(a,c){b[c]=a}),b}function l(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return a.MIXINS||(a.MIXINS=[]),e(b,function(b){a.MIXINS.push(b.MIXIN_NAME),q(b,function(b,c){if(void 0!==a.prototype[c])throw new Error("Mixin conflict. Property '"+c+"' already exist and cannot be overwritten.");if("function"==typeof b)a.prototype[c]=b;else{var d=function(b,c){b="_"+b;var d=function(a){return(Array.isArray(a)||n(a))&&(a=j(a)),a};return function(){return void 0===this[b]&&(this[b]=d(c)),this[b]}},e=function(b){return b="_"+b,function(a){this[b]=a}};Object.defineProperty(a.prototype,c,{get:d(c,b),set:e(c),configurable:!0})}})}),a}function m(a,b){return JSON.stringify(a)===JSON.stringify(b)}function n(a){return"[object Object]"==Object.prototype.toString.call(a)}function o(a){var b;if("object"==typeof a.__proto__)b=a.__proto__;else{var c,d=a.constructor;"function"==typeof a.constructor&&(c=d,delete a.constructor&&(d=a.constructor,a.constructor=c)),b=d?d.prototype:null}return b}function p(a,b,c,d){d.value=c,d.writable=!1!==d.writable,d.enumerable=!1!==d.enumerable,d.configurable=!1!==d.configurable,Object.defineProperty(a,b,d)}function q(a,b){for(var c in a)if((!a.hasOwnProperty||a.hasOwnProperty&&a.hasOwnProperty(c))&&!1===b(a[c],c,a))break;return a}function r(a,b){var c=b.split("."),d=a;return q(c,function(a){if(void 0===(d=d[a]))return d=void 0,!1}),d}function s(a){if(!n(a))return 0;var b=function(a){var c=0;return n(a)?q(a,function(a){c+=b(a)}):c++,c};return b(a)}function t(a){var c,b=void 0!==arguments[1]?arguments[1]:"value",d="_"+b,e=(c={},Object.defineProperty(c,"_touched",{value:!1,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(c,d,{value:a,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(c,"isTouched",{value:function(){return this._touched},configurable:!0,enumerable:!0,writable:!0}),c);return Object.defineProperty(e,b,{get:function(){return this[d]},set:function(a){this._touched=!0,this[d]=a},enumerable:!0,configurable:!0}),e}Object.defineProperties(c,{duckSchema:{get:function(){return f}},inherit:{get:function(){return g}},extend:{get:function(){return h}},deepExtend:{get:function(){return i}},deepClone:{get:function(){return j}},clone:{get:function(){return k}},mixin:{get:function(){return l}},isObjectEquals:{get:function(){return m}},isObject:{get:function(){return n}},getPrototypeOf:{get:function(){return o}},defineGetter:{get:function(){return p}},objectEach:{get:function(){return q}},getProperty:{get:function(){return r}},deepObjectSize:{get:function(){return s}},createObjectPropListener:{get:function(){return t}},__esModule:{value:!0}});var d,e=((d=a("array"))&&d.__esModule&&d||{default:d}).arrayEach},{array:43}],54:[function(a,b,c){"use strict";function f(a,b){function c(){}e(c,a);for(var d=0,f=b.length;d<f;d++)c.prototype[b[d]]=void 0;return c}Object.defineProperties(c,{columnFactory:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("object"))&&d.__esModule&&d||{default:d}).inherit},{object:53}],55:[function(a,b,c){"use strict";function h(a){return a[0].toUpperCase()+a.substr(1)}function i(a,b){var c=!0;return g(b.length-1,function(d){if(a.charAt(d)!==b.charAt(d))return c=!1,!1}),c}function j(a,b){var c=!0,d=b.length-1,e=a.length-1;return g(d,function(f){var g=e-f,h=d-f;if(a.charAt(g)!==b.charAt(h))return c=!1,!1}),c}function k(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var c=[],d=a.length;d--;){var e=f(a[d]).toLowerCase();-1===c.indexOf(e)&&c.push(e)}return 1===c.length}function l(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()}function m(a){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(a)}function n(a){var b=void 0!==arguments[1]?arguments[1]:{};return(a+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(a,c){return"\\"===a.charAt(0)?a.substr(1,a.length-1):void 0===b[c]?"":b[c]})}function o(a,b){var c=void 0!==arguments[2]?arguments[2]:" ";if(a+="",a.length>=b)return a;c=String(c),c.length||(c=" ");var e=b-a.length,f=Math.ceil(e/c.length),h="";return g(f,function(a){h+=c}),(h=h.slice(0,e))+a}function q(a){return a+="",a.replace(p,"")}Object.defineProperties(c,{toUpperCaseFirst:{get:function(){return h}},startsWith:{get:function(){return i}},endsWith:{get:function(){return j}},equalsIgnoreCase:{get:function(){return k}},randomString:{get:function(){return l}},isPercentValue:{get:function(){return m}},substitute:{get:function(){return n}},padStart:{get:function(){return o}},stripTags:{get:function(){return q}},__esModule:{value:!0}});var d,e,f=((d=a("mixed"))&&d.__esModule&&d||{default:d}).stringify,g=((e=a("number"))&&e.__esModule&&e||{default:e}).rangeEach,p=/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi},{mixed:51,number:52}],56:[function(a,b,c){"use strict";function g(a){return 32==a||a>=48&&a<=57||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222||a>=226||a>=65&&a<=90}function h(a){return-1!==[f.ARROW_DOWN,f.ARROW_UP,f.ARROW_LEFT,f.ARROW_RIGHT,f.HOME,f.END,f.DELETE,f.BACKSPACE,f.F1,f.F2,f.F3,f.F4,f.F5,f.F6,f.F7,f.F8,f.F9,f.F10,f.F11,f.F12,f.TAB,f.PAGE_DOWN,f.PAGE_UP,f.ENTER,f.ESCAPE,f.SHIFT,f.CAPS_LOCK,f.ALT].indexOf(a)}function i(a){return-1!==[f.CONTROL_LEFT,224,f.COMMAND_LEFT,f.COMMAND_RIGHT].indexOf(a)}function j(a,b){var c=b.split("|"),d=!1;return e(c,function(b){if(a===f[b])return d=!0,!1}),d}Object.defineProperties(c,{KEY_CODES:{get:function(){return f}},isPrintableChar:{get:function(){return g}},isMetaKey:{get:function(){return h}},isCtrlKey:{get:function(){return i}},isKey:{get:function(){return j}},__esModule:{value:!0}});var d,e=((d=a("array"))&&d.__esModule&&d||{default:d}).arrayEach,f={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},{array:43}],57:[function(a,b,c){"use strict";Object.defineProperties(c,{arrayMapper:{get:function(){return q}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,i=(e=a("helpers/array"))&&e.__esModule&&e||{default:e},k=(i.arrayEach,i.arrayReduce),l=i.arrayMap,m=i.arrayMax,n=((f=a("helpers/object"))&&f.__esModule&&f||{default:f}).defineGetter,o=((g=a("helpers/number"))&&g.__esModule&&g||{default:g}).rangeEach,q={_arrayMap:[],getValueByIndex:function(a){var b;return void 0===(b=this._arrayMap[a])?null:b},getIndexByValue:function(a){var b;return-1===(b=this._arrayMap.indexOf(a))?null:b},insertItems:function(a){var b=void 0!==arguments[1]?arguments[1]:1,c=this,d=m(this._arrayMap)+1,e=[];return o(b-1,function(b){e.push(c._arrayMap.splice(a+b,0,d+b))}),e},removeItems:function(a){var b=void 0!==arguments[1]?arguments[1]:1,c=this,d=[];if(Array.isArray(a)){var e=[].concat(this._arrayMap);a.sort(function(a,b){return b-a}),d=k(a,function(a,b){return c._arrayMap.splice(b,1),a.concat(e.slice(b,b+1))},[])}else d=this._arrayMap.splice(a,b);return d},unshiftItems:function(a){function d(a){return k(c,function(b,c){return a>c&&b++,b},0)}var b=void 0!==arguments[1]?arguments[1]:1,c=this.removeItems(a,b);this._arrayMap=l(this._arrayMap,function(a,b){var c=d(a);return c&&(a-=c),a})},shiftItems:function(a){var b=void 0!==arguments[1]?arguments[1]:1,c=this;this._arrayMap=l(this._arrayMap,function(c){return c>=a&&(c+=b),c}),o(b-1,function(b){c._arrayMap.splice(a+b,0,a+b)})},clearMap:function(){this._arrayMap.length=0}};n(q,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1}),h.utils.arrayMapper=q},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53}],58:[function(a,b,c){"use strict";Object.defineProperties(c,{localHooks:{get:function(){return k}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=((e=a("helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,i=((f=a("helpers/object"))&&f.__esModule&&f||{default:f}).defineGetter,k={_localHooks:Object.create(null),addLocalHook:function(a,b){this._localHooks[a]||(this._localHooks[a]=[]),this._localHooks[a].push(b)},runLocalHooks:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=this;this._localHooks[a]&&h(this._localHooks[a],function(a){return a.apply(d,b)})},clearLocalHooks:function(){this._localHooks={}}};i(k,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),g.utils.localHooks=k},{browser:24,"helpers/array":43,"helpers/object":53}],59:[function(a,b,c){"use strict";var d;Object.defineProperties(c,{stateSaver:{get:function(){return p}},__esModule:{value:!0}});var e,f,g,h=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,j=((f=a("helpers/array"))&&f.__esModule,((g=a("helpers/object"))&&g.__esModule&&g||{default:g}).defineGetter),l="state_",m="_states",n=function(a,b){return a[m][l+b]},o=function(a,b,c){a[m][l+b]=c},p=(d={},Object.defineProperty(d,m,{value:{},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"getCachedState",{value:function(a){return n(this,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setCachedState",{value:function(a,b){o(this,a,b)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"saveState",{value:function(a){o(this,a,this.getState())},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"restoreState",{value:function(a){this.setState(n(this,a))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"hasSavedState",{value:function(a){return void 0!==n(this,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"clearState",{value:function(a){o(this,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"clearStates",{value:function(){this[m]={}},configurable:!0,enumerable:!0,writable:!0}),d);j(p,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1}),h.utils.stateSaver=p},{browser:24,"helpers/array":43,"helpers/object":53}],60:[function(a,b,c){"use strict";function d(){function b(a){return null!==a&&!d(a)&&("string"==typeof a||"number"==typeof a)}function c(a){return null!==a&&("object"==typeof a||"function"==typeof a)}function d(a){return a!==a}var a={arrayMap:[],weakMap:new WeakMap};return{get:function(d){return b(d)?a.arrayMap[d]:c(d)?a.weakMap.get(d):void 0},set:function(d,e){if(b(d))a.arrayMap[d]=e;else{if(!c(d))throw new Error("Invalid key type");a.weakMap.set(d,e)}},delete:function(d){b(d)?delete a.arrayMap[d]:c(d)&&a.weakMap.delete(d)}}}Object.defineProperties(c,{MultiMap:{get:function(){return d}},__esModule:{value:!0}}),window.MultiMap=d},{}],61:[function(a,b,c){"use strict";Object.defineProperties(c,{Hooks:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","beforeValueRender","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing"],g=((d=a("helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,h=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).objectEach,i=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(i,{createEmptyBucket:function(){var a=Object.create(null);return g(f,function(b){return a[b]=[]}),a},getBucket:function(){var a=void 0!==arguments[0]?arguments[0]:null;return a?(a.pluginHookBucket||(a.pluginHookBucket=this.createEmptyBucket()),a.pluginHookBucket):this.globalBucket},add:function(a,b){var c=void 0!==arguments[2]?arguments[2]:null,d=this;if(Array.isArray(b))g(b,function(b){return d.add(a,b,c)});else{var e=this.getBucket(c);if(void 0===e[a]&&(this.register(a),e[a]=[]),b.skip=!1,-1===e[a].indexOf(b)){var f=!1;b.initialHook&&g(e[a],function(c,d){if(c.initialHook)return e[a][d]=b,f=!0,!1}),f||e[a].push(b)}}return this},once:function(a,b){var c=void 0!==arguments[2]?arguments[2]:null,d=this;Array.isArray(b)?g(b,function(b){return d.once(a,b,c)}):(b.runOnce=!0,this.add(a,b,c))},remove:function(a,b){var c=void 0!==arguments[2]?arguments[2]:null,d=this.getBucket(c);return void 0!==d[a]&&d[a].indexOf(b)>=0&&(b.skip=!0,!0)},has:function(a){var b=void 0!==arguments[1]?arguments[1]:null,c=this.getBucket(b);return!(void 0===c[a]||!c[a].length)},run:function(a,b,c,d,e,f,g,h){var i=this.globalBucket[b],j=-1,k=i?i.length:0;if(k)for(;++j<k;)if(i[j]&&!i[j].skip){var l=i[j].call(a,c,d,e,f,g,h);void 0!==l&&(c=l),i[j]&&i[j].runOnce&&this.remove(b,i[j])}var m=this.getBucket(a)[b],n=-1,o=m?m.length:0;if(o)for(;++n<o;)if(m[n]&&!m[n].skip){var p=m[n].call(a,c,d,e,f,g,h);void 0!==p&&(c=p),m[n]&&m[n].runOnce&&this.remove(b,m[n],a)}return c},destroy:function(){var a=void 0!==arguments[0]?arguments[0]:null;h(this.getBucket(a),function(a,b,c){return c[b].length=0})},register:function(a){this.isRegistered(a)||f.push(a)},deregister:function(a){this.isRegistered(a)&&f.splice(f.indexOf(a),1)},isRegistered:function(a){return f.indexOf(a)>=0},getRegistered:function(){return f}},{})},{"helpers/array":43,"helpers/object":53}],62:[function(a,b,c){"use strict";function k(a,b){a=i(a),g.plugins[a]=b,g.hooks.add("construct",function(){var c;j.has(this)||j.set(this,{}),c=j.get(this),c[a]||(c[a]=new b(this))}),g.hooks.add("afterDestroy",function(){if(j.has(this)){var a=j.get(this);h(a,function(a){return a.destroy()}),j.delete(this)}})}function l(a,b){if("string"!=typeof b)throw Error('Only strings can be passed as "plugin" parameter');var c=i(b);if(j.has(a)&&j.get(a)[c])return j.get(a)[c]}function m(a){return j.has(a)?Object.keys(j.get(a)):[]}function n(a,b){var c=null;return j.has(a)&&h(j.get(a),function(a,d){a===b&&(c=d)}),c}Object.defineProperties(c,{registerPlugin:{get:function(){return k}},getPlugin:{get:function(){return l}},getRegistredPluginNames:{get:function(){return m}},getPluginName:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).objectEach,i=((f=a("helpers/string"))&&f.__esModule&&f||{default:f}).toUpperCaseFirst,j=new WeakMap},{browser:24,"helpers/object":53,"helpers/string":55}],63:[function(a,b,c){"use strict";Object.defineProperties(c,{default:{get:function(){return w}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=(e=a("helpers/object"))&&e.__esModule&&e||{default:e},k=j.defineGetter,l=j.objectEach,m=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,n=(g=a("utils/recordTranslator"))&&g.__esModule&&g||{default:g},p=(n.registerIdentity,n.getTranslator),q=(h=a("plugins"))&&h.__esModule&&h||{default:h},r=q.getRegistredPluginNames,s=q.getPluginName,t=new WeakMap,u=null,v=function(b){var c=this;k(this,"hot",b,{writable:!1}),k(this,"t",p(b),{writable:!1}),t.set(this,{hooks:{}}),u=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return c.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return c.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return c.init()})};$traceurRuntime.createClass(v,{init:function(){this.pluginName=s(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),u||(u=r(this.hot)),u.indexOf(this.pluginName)>=0&&u.splice(u.indexOf(this.pluginName),1),u.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0},enablePlugin:function(){this.enabled=!0},disablePlugin:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1},addHook:function(a,b){var c=t.get(this).hooks[a]=t.get(this).hooks[a]||[];this.hot.addHook(a,b),c.push(b),t.get(this).hooks[a]=c},removeHooks:function(a){var b=this;m(t.get(this).hooks[a]||[],function(c){b.hot.removeHook(a,c)})},clearHooks:function(){var a=this,b=t.get(this).hooks;l(b,function(b,c){return a.removeHooks(c)}),b.length=0},callOnPluginsReady:function(a){this.isPluginsReady?a():this.pluginsInitializedCallbacks.push(a)},onAfterPluginsInitialized:function(){m(this.pluginsInitializedCallbacks,function(a){return a()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0},onUpdateSettings:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())},updatePlugin:function(){},destroy:function(){var a=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),l(this,function(b,c){"hot"!==c&&"t"!==c&&(a[c]=null)}),delete this.t,delete this.hot}},{});var w=v;i.plugins.BasePlugin=v},{browser:24,"helpers/array":43,"helpers/object":53,plugins:62,"utils/recordTranslator":132}],64:[function(a,b,c){"use strict";Object.defineProperties(c,{AutoColumnSize:{get:function(){return K}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o=((d=a("_base"))&&d.__esModule&&d||{default:d}).default,p=(e=a("helpers/array"))&&e.__esModule&&e||{default:e},q=p.arrayEach,r=p.arrayFilter,s=p.arrayReduce,t=p.arrayMap,u=(f=a("helpers/feature"))&&f.__esModule&&f||{default:f},v=u.cancelAnimationFrame,w=u.requestAnimationFrame,x=((g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g}).isVisible,y=((h=a("utils/ghostTable"))&&h.__esModule&&h||{default:h}).GhostTable,z=(i=a("helpers/object"))&&i.__esModule&&i||{default:i},A=z.isObject,C=(z.objectEach,(j=a("helpers/number"))&&j.__esModule&&j||{default:j}),D=C.valueAccordingPercent,E=C.rangeEach,F=((k=a("plugins"))&&k.__esModule&&k||{default:k}).registerPlugin,G=((l=a("utils/samplesGenerator"))&&l.__esModule&&l||{default:l}).SamplesGenerator,H=((m=a("helpers/string"))&&m.__esModule&&m||{default:m}).isPercentValue,I=((n=a("3rdparty/walkontable/src/calculator/viewportColumns"))&&n.__esModule&&n||{default:n}).WalkontableViewportColumnsCalculator,J=new WeakMap,K=function(b){var c=this;$traceurRuntime.superConstructor(L).call(this,b),J.set(this,{cachedColumnHeaders:[]}),this.widths=[],this.ghostTable=new y(this.hot),this.samplesGenerator=new G(function(a,b){return c.hot.getDataAtCell(a,b)}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeColumnResize",function(a,b,d){return c.onBeforeColumnResize(a,b,d)})},L=K;$traceurRuntime.createClass(K,{isEnabled:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().autoColumnSize;b&&null!=b.useHeaders&&this.ghostTable.setSetting("useHeaders",b.useHeaders),this.addHook("afterLoadData",function(){return a.onAfterLoadData()}),this.addHook("beforeChange",function(b){return a.onBeforeChange(b)}),this.addHook("beforeRender",function(b){return a.onBeforeRender(b)}),this.addHook("modifyColWidth",function(b,c){return a.getColumnWidth(c,b)}),this.addHook("afterInit",function(){return a.onAfterInit()}),$traceurRuntime.superGet(this,L.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.findColumnsWhereHeaderWasChanged();a.length&&this.clearCache(a),$traceurRuntime.superGet(this,L.prototype,"updatePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,L.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function(){var a=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},b=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},c=void 0!==arguments[2]&&arguments[2],d=this;"number"==typeof a&&(a={from:a,to:a}),"number"==typeof b&&(b={from:b,to:b}),E(a.from,a.to,function(a){if(c||void 0===d.widths[a]&&!d.hot._getColWidthFromSettings(a)){d.samplesGenerator.generateColumnSamples(a,b).forEach(function(a,b){return d.ghostTable.addColumn(b,a)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(a,b){return d.widths[a]=b}),this.ghostTable.clean())},calculateAllColumnsWidth:function(){var a=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},b=this,c=0,d=this.hot.countCols()-1,e=null;this.inProgress=!0;var f=function(){if(!b.hot)return v(e),void(b.inProgress=!1);b.calculateColumnsWidth({from:c,to:Math.min(c+L.CALCULATION_STEP,d)},a),c=c+L.CALCULATION_STEP+1,c<d?e=w(f):(v(e),b.inProgress=!1,b.hot.view.wt.wtOverlays.adjustElementsSize(!0),b.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&b.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},a),this.firstCalculation=!1,c=this.getSyncCalculationLimit()+1),c<d?f():this.inProgress=!1},setSamplingOptions:function(){var a=this.hot.getSettings().autoColumnSize,b=a&&a.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,c=a&&a.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;b&&!isNaN(b)&&this.samplesGenerator.setSampleCount(parseInt(b,10)),c&&this.samplesGenerator.setAllowDuplicates(c)},recalculateAllColumnsWidth:function(){this.hot.view&&x(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())},getSyncCalculationLimit:function(){var a=L.SYNC_CALCULATION_LIMIT,b=this.hot.countCols()-1;return A(this.hot.getSettings().autoColumnSize)&&(a=this.hot.getSettings().autoColumnSize.syncLimit,H(a)?a=D(b,a):a>>=0),Math.min(a,b)},getColumnWidth:function(a){var b=arguments[1],c=void 0===arguments[2]||arguments[2],d=b;return void 0===d&&(d=this.widths[a],c&&"number"==typeof d&&(d=Math.max(d,I.DEFAULT_WIDTH))),d},getFirstVisibleColumn:function(){var a=this.hot.view.wt;return a.wtViewport.columnsVisibleCalculator?a.wtTable.getFirstVisibleColumn():a.wtViewport.columnsRenderCalculator?a.wtTable.getFirstRenderedColumn():-1},getLastVisibleColumn:function(){var a=this.hot.view.wt;return a.wtViewport.columnsVisibleCalculator?a.wtTable.getLastVisibleColumn():a.wtViewport.columnsRenderCalculator?a.wtTable.getLastRenderedColumn():-1},findColumnsWhereHeaderWasChanged:function(){var a=this.hot.getColHeader(),b=J.get(this).cachedColumnHeaders;return s(a,function(a,c,d){var e=b.length;return(e-1<d||b[d]!==c)&&a.push(d),e-1<d?b.push(c):b[d]=c,a},[])},clearCache:function(){var a=void 0!==arguments[0]?arguments[0]:[],b=this;a.length?q(a,function(a){return b.widths[a]=void 0}):this.widths.length=0},isNeedRecalculate:function(){return!!r(this.widths,function(a){return void 0===a}).length},onBeforeRender:function(){var a=this.hot.renderCall;this.hot.countRows()&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,a),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())},onAfterLoadData:function(){var a=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){a.hot&&a.recalculateAllColumnsWidth()},0)},onBeforeChange:function(a){var b=this,c=t(a,function(a){var c=a,e=(c[0],c[1]);return b.hot.propToCol(e)});this.clearCache(c)},onBeforeColumnResize:function(a,b,c){return c&&(this.calculateColumnsWidth(a,void 0,!0),b=this.getColumnWidth(a,void 0,!1)),b},onAfterInit:function(){J.get(this).cachedColumnHeaders=this.hot.getColHeader()},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,L.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},o),F("autoColumnSize",K)},{"3rdparty/walkontable/src/calculator/viewportColumns":4,_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],65:[function(a,b,c){"use strict";Object.defineProperties(c,{AutoRowSize:{get:function(){return F}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n=((d=a("_base"))&&d.__esModule&&d||{default:d}).default,o=(e=a("helpers/array"))&&e.__esModule&&e||{default:e},q=(o.arrayEach,o.arrayFilter),r=(f=a("helpers/feature"))&&f.__esModule&&f||{default:f},s=r.cancelAnimationFrame,t=r.requestAnimationFrame,u=((g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g}).isVisible,v=((h=a("utils/ghostTable"))&&h.__esModule&&h||{default:h}).GhostTable,w=(i=a("helpers/object"))&&i.__esModule&&i||{default:i},x=w.isObject,z=(w.objectEach,(j=a("helpers/number"))&&j.__esModule&&j||{default:j}),A=z.valueAccordingPercent,B=z.rangeEach,C=((k=a("plugins"))&&k.__esModule&&k||{default:k}).registerPlugin,D=((l=a("utils/samplesGenerator"))&&l.__esModule&&l||{default:l}).SamplesGenerator,E=((m=a("helpers/string"))&&m.__esModule&&m||{default:m}).isPercentValue,F=function(b){var c=this;$traceurRuntime.superConstructor(G).call(this,b),this.heights=[],this.ghostTable=new v(this.hot),this.samplesGenerator=new D(function(a,b){return a>=0?c.hot.getDataAtCell(a,b):-1===a?c.hot.getColHeader(b):null}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeRowResize",function(a,b,d){return c.onBeforeRowResize(a,b,d)})},G=F;$traceurRuntime.createClass(F,{isEnabled:function(){return!0===this.hot.getSettings().autoRowSize||x(this.hot.getSettings().autoRowSize)},enablePlugin:function(){var a=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return a.onAfterLoadData()}),this.addHook("beforeChange",function(b){return a.onBeforeChange(b)}),this.addHook("beforeColumnMove",function(){return a.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return a.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return a.clearCache()}),this.addHook("beforeRender",function(b){return a.onBeforeRender(b)}),this.addHook("beforeRowMove",function(b,c){return a.onBeforeRowMove(b,c)}),this.addHook("modifyRowHeight",function(b,c){return a.getRowHeight(c,b)}),this.addHook("modifyColumnHeaderHeight",function(){return a.getColumnHeaderHeight()}),$traceurRuntime.superGet(this,G.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,G.prototype,"disablePlugin").call(this)},calculateRowsHeight:function(){var a=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},b=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},c=void 0!==arguments[2]&&arguments[2],d=this;if("number"==typeof a&&(a={from:a,to:a}),"number"==typeof b&&(b={from:b,to:b}),null!==this.hot.getColHeader(0)){var e=this.samplesGenerator.generateRowSamples(-1,b);this.ghostTable.addColumnHeadersRow(e.get(-1))}B(a.from,a.to,function(a){if(c||void 0===d.heights[a]){d.samplesGenerator.generateRowSamples(a,b).forEach(function(a,b){return d.ghostTable.addRow(b,a)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(a,b){return d.heights[a]=b}),this.ghostTable.clean())},calculateAllRowsHeight:function(){var a=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},b=this,c=0,d=this.hot.countRows()-1,e=null;this.inProgress=!0;var f=function(){if(!b.hot)return s(e),void(b.inProgress=!1);b.calculateRowsHeight({from:c,to:Math.min(c+G.CALCULATION_STEP,d)},a),c=c+G.CALCULATION_STEP+1,c<d?e=t(f):(s(e),b.inProgress=!1,b.hot.view.wt.wtOverlays.adjustElementsSize(!0),b.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&b.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},a),this.firstCalculation=!1,c=this.getSyncCalculationLimit()+1),c<d?f():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))},setSamplingOptions:function(){var a=this.hot.getSettings().autoRowSize,b=a&&a.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,c=a&&a.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;b&&!isNaN(b)&&this.samplesGenerator.setSampleCount(parseInt(b,10)),c&&this.samplesGenerator.setAllowDuplicates(c)},recalculateAllRowsHeight:function(){u(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())},getSyncCalculationLimit:function(){var a=G.SYNC_CALCULATION_LIMIT,b=this.hot.countRows()-1;return x(this.hot.getSettings().autoRowSize)&&(a=this.hot.getSettings().autoRowSize.syncLimit,E(a)?a=A(b,a):a>>=0),Math.min(a,b)},getRowHeight:function(a){var b=arguments[1],c=b;return void 0!==this.heights[a]&&this.heights[a]>(b||0)&&(c=this.heights[a]),c},getColumnHeaderHeight:function(){return this.heights[-1]},getFirstVisibleRow:function(){var a=this.hot.view.wt;return a.wtViewport.rowsVisibleCalculator?a.wtTable.getFirstVisibleRow():a.wtViewport.rowsRenderCalculator?a.wtTable.getFirstRenderedRow():-1},getLastVisibleRow:function(){var a=this.hot.view.wt;return a.wtViewport.rowsVisibleCalculator?a.wtTable.getLastVisibleRow():a.wtViewport.rowsRenderCalculator?a.wtTable.getLastRenderedRow():-1},clearCache:function(){this.heights.length=0,this.heights[-1]=void 0},clearCacheByRange:function(a){var b=this;"number"==typeof a&&(a={from:a,to:a}),B(Math.min(a.from,a.to),Math.max(a.from,a.to),function(a){return b.heights[a]=void 0})},isNeedRecalculate:function(){return!!q(this.heights,function(a){return void 0===a}).length},onBeforeRender:function(){var a=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,a);var b=this.hot.getSettings().fixedRowsBottom;if(b){var c=this.hot.countRows()-1;this.calculateRowsHeight({from:c-b,to:c})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()},onBeforeRowMove:function(a,b){this.clearCacheByRange({from:a,to:b}),this.calculateAllRowsHeight()},onBeforeRowResize:function(a,b,c){return c&&(this.calculateRowsHeight(a,void 0,!0),b=this.getRowHeight(a)),b},onAfterLoadData:function(){var a=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){a.hot&&a.recalculateAllRowsHeight()},0)},onBeforeChange:function(a){var b=null;1===a.length?b=a[0][0]:a.length>1&&(b={from:a[0][0],to:a[a.length-1][0]}),null!==b&&this.clearCacheByRange(b)},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,G.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},n),C("autoRowSize",F)},{_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],66:[function(a,b,c){"use strict";Object.defineProperties(c,{Autofill:{get:function(){return C}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("_base"))&&d.__esModule&&d||{default:d}).default,m=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,n=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayIncludes,o=(g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g},p=o.offset,q=o.outerHeight,r=o.outerWidth,s=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).eventManager,t=((i=a("plugins"))&&i.__esModule&&i||{default:i}).registerPlugin,u=((j=a("3rdparty/walkontable/src/cell/coords"))&&j.__esModule&&j||{default:j}).WalkontableCellCoords,v=(k=a("utils"))&&k.__esModule&&k||{default:k},w=v.getDeltas,x=v.getDragDirectionAndRange,y=v.DIRECTIONS,z=v.getMappedFillHandleSetting,C=function(b){$traceurRuntime.superConstructor(D).call(this,b),this.eventManager=s(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1},D=C;$traceurRuntime.createClass(C,{isEnabled:function(){return this.hot.getSettings().fillHandle},enablePlugin:function(){var a=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(b){return a.onAfterCellCornerMouseDown(b)}),this.addHook("afterOnCellCornerDblClick",function(b){return a.onCellCornerDblClick(b)}),this.addHook("beforeOnCellMouseOver",function(b,c,d){return a.onBeforeCellMouseOver(c)}),$traceurRuntime.superGet(this,D.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,D.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.clearMappedSettings(),$traceurRuntime.superGet(this,D.prototype,"disablePlugin").call(this)},getSelectionData:function(){var a={from:this.hot.getSelectedRange().from,to:this.hot.getSelectedRange().to};return this.hot.getData(a.from.row,a.from.col,a.to.row,a.to.col)},fillIn:function(){if(this.hot.view.wt.selections.fill.isEmpty())return!1;var a=this.hot.view.wt.selections.fill.getCorners();this.resetSelectionOfDraggedArea();var b=this.getCornersOfSelectedCells(),c=x(b,a),d=c.directionOfDrag,e=c.startOfDragCoords,f=c.endOfDragCoords;if(this.hot.runHooks("modifyAutofillRange",b,a),e&&e.row>-1&&e.col>-1){var g=this.getSelectionData(),h=w(e,f,g,d);this.hot.runHooks("beforeAutofill",e,f,g),this.hot.populateFromArray(e.row,e.col,g,f.row,f.col,this.pluginName+".fill",null,d,h),this.setSelection(a)}else this.hot.selection.refreshBorders();return!0},reduceSelectionAreaIfNeeded:function(a){return a.row<0&&(a.row=0),a.col<0&&(a.col=0),a},getCoordsOfDragAndDropBorders:function(a){var d,b=this.hot.getSelectedRange().getTopLeftCorner(),c=this.hot.getSelectedRange().getBottomRightCorner();if(n(this.directions,y.vertical)&&(c.row<a.row||b.row>a.row))d=new u(a.row,c.col);else{if(!n(this.directions,y.horizontal))return;d=new u(c.row,a.col)}return this.reduceSelectionAreaIfNeeded(d)},showBorder:function(a){var b=this.getCoordsOfDragAndDropBorders(a);b&&this.redrawBorders(b)},addRow:function(){var a=this;this.hot._registerTimeout(setTimeout(function(){a.hot.alter("insert_row",void 0,1,a.pluginName+".fill"),a.addingStarted=!1},200))},addNewRowIfNeeded:function(){if(this.hot.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&this.autoInsertRow){var a=this.hot.getSelected(),b=this.hot.view.wt.selections.fill.getCorners(),c=this.hot.countRows();a[2]<c-1&&b[2]===c-1&&(this.addingStarted=!0,this.addRow())}},getCornersOfSelectedCells:function(){return this.hot.selection.isMultiple()?this.hot.view.wt.selections.area.getCorners():this.hot.view.wt.selections.current.getCorners()},getIndexOfLastAdjacentFilledInRow:function(a){for(var d,b=this.hot.getData(),c=this.hot.countRows(),e=a[2]+1;e<c;e++){for(var f=a[1];f<=a[3];f++)if(b[e][f])return-1;var h=b[e][a[1]-1],i=b[e][a[3]+1];(h||i)&&(d=e)}return d},addSelectionFromStartAreaToSpecificRowIndex:function(a,b){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(new u(a[0],a[1])),this.hot.view.wt.selections.fill.add(new u(b,a[3]))},setSelection:function(a){this.hot.selection.setRangeStart(new u(a[0],a[1])),this.hot.selection.setRangeEnd(new u(a[2],a[3]))},selectAdjacent:function(){var a=this.getCornersOfSelectedCells(),b=this.getIndexOfLastAdjacentFilledInRow(a);return-1!==b&&(this.addSelectionFromStartAreaToSpecificRowIndex(a,b),!0)},resetSelectionOfDraggedArea:function(){this.handleDraggedCells=0,this.hot.view.wt.selections.fill.clear()},redrawBorders:function(a){this.hot.view.wt.selections.fill.clear(),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from),this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to),this.hot.view.wt.selections.fill.add(a),this.hot.view.render()},getIfMouseWasDraggedOutside:function(a){var b=p(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+q(this.hot.table),c=p(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+r(this.hot.table);return a.clientY>b&&a.clientX<=c},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()}),this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)})},onCellCornerDblClick:function(){this.selectAdjacent()&&this.fillIn()},onAfterCellCornerMouseDown:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0},onBeforeCellMouseOver:function(a){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(a),this.addNewRowIfNeeded())},onMouseUp:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)},onMouseMove:function(a){var b=this.getIfMouseWasDraggedOutside(a);!1===this.addingStarted&&this.handleDraggedCells>0&&b?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()},clearMappedSettings:function(){this.directions.length=0,this.autoInsertRow=!1},mapSettings:function(){var a=z(this.hot.getSettings().fillHandle);this.directions=a.directions,this.autoInsertRow=a.autoInsertRow},destroy:function(){$traceurRuntime.superGet(this,D.prototype,"destroy").call(this)}},{},l),t("autofill",C),m.hooks.register("modifyAutofillRange"),m.hooks.register("beforeAutofill")},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,utils:67}],67:[function(a,b,c){"use strict";function i(a,b,c,d){var e=c.length,f=c?c[0].length:0,g=[],h=b.row-a.row,i=b.col-a.col;if(-1!==["down","up"].indexOf(d)){for(var j=[],k=0;k<=i;k++){var l=parseInt(c[0][k],10),m=parseInt(c[e-1][k],10),n=("down"===d?m-l:l-m)/(e-1)||0;j.push(n)}g.push(j)}if(-1!==["right","left"].indexOf(d))for(var o=0;o<=h;o++){var p=parseInt(c[o][0],10),q=parseInt(c[o][f-1],10),r=("right"===d?q-p:p-q)/(f-1)||0;g.push([r])}return g}function j(a,b){var c,d,e;return b[0]===a[0]&&b[1]<a[1]?(e="left",c=new WalkontableCellCoords(b[0],b[1]),d=new WalkontableCellCoords(b[2],a[1]-1)):b[0]===a[0]&&b[3]>a[3]?(e="right",c=new WalkontableCellCoords(b[0],a[3]+1),d=new WalkontableCellCoords(b[2],b[3])):b[0]<a[0]&&b[1]===a[1]?(e="up",c=new WalkontableCellCoords(b[0],b[1]),d=new WalkontableCellCoords(a[0]-1,b[3])):b[2]>a[2]&&b[1]===a[1]&&(e="down",c=new WalkontableCellCoords(a[2]+1,b[1]),d=new WalkontableCellCoords(b[2],b[3])),{directionOfDrag:e,startOfDragCoords:c,endOfDragCoords:d}}function k(a){var b={};return!0===a?(b.directions=Object.keys(h),b.autoInsertRow=!0):f(a)?(g(a.autoInsertRow)?a.direction===h.horizontal?b.autoInsertRow=!1:b.autoInsertRow=a.autoInsertRow:b.autoInsertRow=!1,g(a.direction)?b.directions=[a.direction]:b.directions=Object.keys(h)):"string"==typeof a?(b.directions=[a],b.autoInsertRow=!0):(b.directions=[],b.autoInsertRow=!1),b}Object.defineProperties(c,{DIRECTIONS:{get:function(){return h}},getDeltas:{get:function(){return i}},getDragDirectionAndRange:{get:function(){return j}},getMappedFillHandleSetting:{get:function(){return k}},__esModule:{value:!0}});var d,e,f=((d=a("helpers/object"))&&d.__esModule&&d||{default:d}).isObject,g=((e=a("helpers/mixed"))&&e.__esModule&&e||{default:e}).isDefined,h={horizontal:"horizontal",vertical:"vertical"}},{"helpers/mixed":51,"helpers/object":53}],68:[function(a,b,c){"use strict";Object.defineProperties(c,{ColumnSorting:{get:function(){return y}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,m=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,n=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},o=n.addClass,p=n.hasClass,q=n.removeClass,r=(g=a("helpers/array"))&&g.__esModule&&g||{default:g},s=r.arrayMap,t=r.arrayReduce,u=((h=a("helpers/mixed"))&&h.__esModule&&h||{default:h}).isEmpty,v=((i=a("_base"))&&i.__esModule&&i||{default:i}).default,w=((j=a("plugins"))&&j.__esModule&&j||{default:j}).registerPlugin,x=((k=a("utils/sortingAlgorithms/mergeSort"))&&k.__esModule&&k||{default:k}).mergeSort;l.hooks.register("beforeColumnSort"),l.hooks.register("afterColumnSort");var y=function(b){$traceurRuntime.superConstructor(z).call(this,b),this.sortIndicators=[],this.lastSortedColumn=null,this.sortEmptyCells=!1},z=y;$traceurRuntime.createClass(y,{isEnabled:function(){return!!this.hot.getSettings().columnSorting},enablePlugin:function(){var a=this;if(!this.enabled){this.setPluginOptions();var b=this;this.hot.sortIndex=[],this.hot.sort=function(){var a=Array.prototype.slice.call(arguments);return b.sortByColumn.apply(b,a)},void 0===this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(b){return a.sort()}),this.addHook("afterUntrimRow",function(b){return a.sort()}),this.addHook("modifyRow",function(b){return a.translateRow(b)}),this.addHook("unmodifyRow",function(b){return a.untranslateRow(b)}),this.addHook("afterUpdateSettings",function(){return a.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(b,c){return a.getColHeader(b,c)}),this.addHook("afterOnCellMouseDown",function(b,c){return a.onAfterOnCellMouseDown(b,c)}),this.addHook("afterCreateRow",function(){b.afterCreateRow.apply(b,arguments)}),this.addHook("afterRemoveRow",function(){b.afterRemoveRow.apply(b,arguments)}),this.addHook("afterInit",function(){return a.sortBySettings()}),this.addHook("afterLoadData",function(){a.hot.sortIndex=[],a.hot.view&&a.sortBySettings()}),this.hot.view&&this.sortBySettings(),$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this)}},disablePlugin:function(){this.hot.sort=void 0,$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function(){this.sortBySettings()},sortBySettings:function(){var c,d,a=this.hot.getSettings().columnSorting,b=this.loadSortingState();void 0===b?(c=a.column,d=a.sortOrder):(c=b.sortColumn,d=b.sortOrder),"number"==typeof c&&(this.lastSortedColumn=c,this.sortByColumn(c,d))},setSortingColumn:function(a,b){if(void 0===a)return this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0);this.hot.sortColumn===a&&void 0===b?!1===this.hot.sortOrder?this.hot.sortOrder=void 0:this.hot.sortOrder=!this.hot.sortOrder:this.hot.sortOrder=void 0===b||b,this.hot.sortColumn=a},sortByColumn:function(a,b){if(this.setSortingColumn(a,b),void 0!==this.hot.sortColumn){!1!==l.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder)&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),l.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState()}},saveSortingState:function(){var a={};void 0!==this.hot.sortColumn&&(a.sortColumn=this.hot.sortColumn),void 0!==this.hot.sortOrder&&(a.sortOrder=this.hot.sortOrder),(a.hasOwnProperty("sortColumn")||a.hasOwnProperty("sortOrder"))&&l.hooks.run(this.hot,"persistentStateSave","columnSorting",a)},loadSortingState:function(){var a={};return l.hooks.run(this.hot,"persistentStateLoad","columnSorting",a),a.value},updateOrderClass:function(){var a;!0===this.hot.sortOrder?a="ascending":!1===this.hot.sortOrder&&(a="descending"),this.sortOrderClass=a},enableObserveChangesPlugin:function(){var a=this;this.hot._registerTimeout(setTimeout(function(){a.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(a,b){return function(c,d){return"string"==typeof c[1]&&(c[1]=c[1].toLowerCase()),"string"==typeof d[1]&&(d[1]=d[1].toLowerCase()),c[1]===d[1]?0:u(c[1])?u(d[1])?0:b.columnSorting.sortEmptyCells&&a?-1:1:u(d[1])?u(c[1])?0:b.columnSorting.sortEmptyCells&&a?1:-1:isNaN(c[1])&&!isNaN(d[1])?a?1:-1:!isNaN(c[1])&&isNaN(d[1])?a?-1:1:(isNaN(c[1])||isNaN(d[1])||(c[1]=parseFloat(c[1]),d[1]=parseFloat(d[1])),c[1]<d[1]?a?-1:1:c[1]>d[1]?a?1:-1:0)}},dateSort:function(a,b){return function(c,d){if(c[1]===d[1])return 0;if(u(c[1]))return u(d[1])?0:b.columnSorting.sortEmptyCells&&a?-1:1;if(u(d[1]))return u(c[1])?0:b.columnSorting.sortEmptyCells&&a?1:-1;var e=m(c[1],b.dateFormat),f=m(d[1],b.dateFormat);return e.isValid()?f.isValid()?f.isAfter(e)?a?-1:1:f.isBefore(e)?a?1:-1:0:-1:1}},numericSort:function(a,b){return function(c,d){var e=parseFloat(c[1]),f=parseFloat(d[1]);if(e===f||isNaN(e)&&isNaN(f))return 0;if(b.columnSorting.sortEmptyCells){if(u(c[1]))return a?-1:1;if(u(d[1]))return a?1:-1}return isNaN(e)?1:isNaN(f)?-1:e<f?a?-1:1:e>f?a?1:-1:0}},sort:function(){if(void 0===this.hot.sortOrder)return void(this.hot.sortIndex.length=0);var c,d,a=this.hot.getCellMeta(0,this.hot.sortColumn),b=this.hot.countEmptyRows();this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,void 0===a.columnSorting.sortEmptyCells&&(a.columnSorting={sortEmptyCells:this.sortEmptyCells}),d=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-b;for(var e=0,f=d;e<f;e++)this.hot.sortIndex.push([e,this.hot.getDataAtCell(e,this.hot.sortColumn)]);if(a.sortFunction)c=a.sortFunction;else switch(a.type){case"date":c=this.dateSort;break;case"numeric":c=this.numericSort;break;default:c=this.defaultSort}x(this.hot.sortIndex,c(this.hot.sortOrder,a));for(var g=this.hot.sortIndex.length;g<this.hot.countRows();g++)this.hot.sortIndex.push([g,this.hot.getDataAtCell(g,this.hot.sortColumn)]);this.hot.sortingEnabled=!0},updateSortIndicator:function(){if(void 0!==this.hot.sortOrder){var a=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=a.sortIndicator}},translateRow:function(a){return this.hot.sortingEnabled&&void 0!==this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[a]?this.hot.sortIndex[a][0]:a},untranslateRow:function(a){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var b=0;b<this.hot.sortIndex.length;b++)if(this.hot.sortIndex[b][0]==a)return b},getColHeader:function(a,b){if(a<0||!b.parentNode)return!1;var c=b.querySelector(".colHeader"),e=(b.getAttribute("colspan"),b.parentNode.parentNode.childNodes),f=Array.prototype.indexOf.call(e,b.parentNode);f-=e.length,c&&(this.hot.getSettings().columnSorting&&a>=0&&-1===f&&o(c,"columnSorting"),q(c,"descending"),q(c,"ascending"),this.sortIndicators[a]&&a===this.hot.sortColumn&&("ascending"===this.sortOrderClass?o(c,"ascending"):"descending"===this.sortOrderClass&&o(c,"descending")))},isSorted:function(){return void 0!==this.hot.sortColumn},afterCreateRow:function(a,b){if(this.isSorted()){for(var c=0;c<this.hot.sortIndex.length;c++)this.hot.sortIndex[c][0]>=a&&(this.hot.sortIndex[c][0]+=b);for(var c=0;c<b;c++)this.hot.sortIndex.splice(a+c,0,[a+c,this.hot.getSourceData()[a+c][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(a,b){function d(a){return t(c,function(b,c){return a>c&&b++,b},0)}if(this.isSorted()){var c=this.hot.sortIndex.splice(a,b);c=s(c,function(a){return a[0]}),this.hot.sortIndex=s(this.hot.sortIndex,function(a,b){var c=d(a[0]);return c&&(a[0]-=c),a}),this.saveSortingState()}},setPluginOptions:function(){var a=this.hot.getSettings().columnSorting;this.sortEmptyCells="object"==typeof a&&(a.sortEmptyCells||!1)},onAfterOnCellMouseDown:function(a,b){b.row>-1||p(a.realTarget,"columnSorting")&&(b.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=b.col,this.sortByColumn(b.col))}},{},v),w("columnSorting",y)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,moment:"moment",plugins:62,"utils/sortingAlgorithms/mergeSort":134}],69:[function(a,b,c){"use strict";Object.defineProperties(c,{CommentEditor:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,f=function(){this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()},g=f;$traceurRuntime.createClass(f,{setPosition:function(a,b){this.editorStyle.left=a+"px",this.editorStyle.top=b+"px"},setSize:function(a,b){if(a&&b){var c=this.getInputElement();c.style.width=a+"px",c.style.height=b+"px"}},resetSize:function(){var a=this.getInputElement();a.style.width="",a.style.height=""},setReadOnlyState:function(a){this.getInputElement().readOnly=a},show:function(){this.editorStyle.display="block",this.hidden=!1},hide:function(){this.editorStyle.display="none",this.hidden=!0},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(){var a=void 0!==arguments[0]?arguments[0]:"";a=a||"",this.getInputElement().value=a},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var b,c,a=document.querySelector("."+g.CLASS_EDITOR_CONTAINER);return a||(a=document.createElement("div"),e(a,g.CLASS_EDITOR_CONTAINER),document.body.appendChild(a)),b=document.createElement("div"),e(b,g.CLASS_EDITOR),c=document.createElement("textarea"),e(c,g.CLASS_INPUT),b.appendChild(c),a.appendChild(b),b},getInputElement:function(){return this.editor.querySelector("."+g.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":47}],70:[function(a,b,c){"use strict";var d;Object.defineProperties(c,{Comments:{get:function(){return P}},__esModule:{value:!0}});var e,f,g,h,i,j,k,l,m,n,o=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,p=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},q=p.addClass,r=p.closest,s=p.isChildOf,t=p.hasClass,u=p.offset,v=p.outerWidth,w=p.outerHeight,x=p.getScrollableElement,y=(g=a("helpers/object"))&&g.__esModule&&g||{default:g},z=y.deepClone,A=y.deepExtend,B=((h=a("helpers/function"))&&h.__esModule&&h||{default:h}).debounce,C=((i=a("eventManager"))&&i.__esModule&&i||{default:i}).EventManager,D=((j=a("3rdparty/walkontable/src/cell/coords"))&&j.__esModule&&j||{default:j}).WalkontableCellCoords,E=((k=a("plugins"))&&k.__esModule&&k||{default:k}).registerPlugin,F=((l=a("_base"))&&l.__esModule&&l||{default:l}).default,G=((m=a("commentEditor"))&&m.__esModule&&m||{default:m}).CommentEditor,H=(n=a("contextMenu/utils"))&&n.__esModule&&n||{default:n},I=H.checkSelectionConsistency,J=H.markLabelAsSelected,K=new WeakMap,L="comment",M="value",N="style",O="readOnly",P=function(b){$traceurRuntime.superConstructor(Q).call(this,b),this.editor=null,this.eventManager=null,this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null,this.displayDelay=250,K.set(this,{tempEditorDimensions:{},cellBelowCursor:null})},Q=P;$traceurRuntime.createClass(P,(d={},Object.defineProperty(d,"isEnabled",{value:function(){return!!this.hot.getSettings().comments},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"enablePlugin",{value:function(){var a=this;this.enabled||(this.editor||(this.editor=new G),this.eventManager||(this.eventManager=new C(this)),this.addHook("afterContextMenuDefaultOptions",function(b){return a.addToContextMenu(b)}),this.addHook("afterRenderer",function(b,c,d,e,f,g){return a.onAfterRenderer(b,g)}),this.addHook("afterScrollHorizontally",function(){return a.hide()}),this.addHook("afterScrollVertically",function(){return a.hide()}),this.addHook("afterBeginEditing",function(b){return a.onAfterBeginEditing(b)}),this.registerListeners(),$traceurRuntime.superGet(this,Q.prototype,"enablePlugin").call(this))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"disablePlugin",{value:function(){$traceurRuntime.superGet(this,Q.prototype,"disablePlugin").call(this)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"registerListeners",{value:function(){var a=this;this.eventManager.addEventListener(document,"mouseover",function(b){return a.onMouseOver(b)}),this.eventManager.addEventListener(document,"mousedown",function(b){return a.onMouseDown(b)}),this.eventManager.addEventListener(document,"mouseup",function(b){return a.onMouseUp(b)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(b){return a.onEditorBlur(b)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(b){return a.onEditorMouseDown(b)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(b){return a.onEditorMouseUp(b)})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setRange",{value:function(a){this.range=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"clearRange",{value:function(){this.range={}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"targetIsCellWithComment",{value:function(a){var b=r(a.target,"TD","TBODY");return!!(b&&t(b,"htCommentCell")&&r(b,[this.hot.rootElement]))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"targetIsCommentTextArea",{value:function(a){return this.editor.getInputElement()===a.target},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setComment",{value:function(a){var b;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var c=this.editor.getValue(),d="";null!=a?d=a:null!=c&&(d=c);var e=this.range.from.row,f=this.range.from.col;this.updateCommentMeta(e,f,(b={},Object.defineProperty(b,M,{value:d,configurable:!0,enumerable:!0,writable:!0}),b)),this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setCommentAtCell",{value:function(a,b,c){this.setRange({from:new D(a,b)}),this.setComment(c)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"removeComment",{value:function(){var a=void 0===arguments[0]||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,L,void 0),a&&this.hot.render(),this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"removeCommentAtCell",{value:function(a,b){var c=void 0===arguments[2]||arguments[2];this.setRange({from:new D(a,b)}),this.removeComment(c)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"getComment",{value:function(){var a=this.range.from.row,b=this.range.from.col;return this.getCommentMeta(a,b,M)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"getCommentAtCell",{value:function(a,b){return this.getCommentMeta(a,b,M)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"show",{value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(a[L]?a[L][M]:""),this.editor.hidden&&this.editor.show(),!0},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"showAtCell",{value:function(a,b){return this.setRange({from:new D(a,b)}),this.show()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"hide",{value:function(){this.editor.hidden||this.editor.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"refreshEditor",{value:function(){if(void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var b=x(this.hot.view.wt.wtTable.TABLE),c=this.hot.view.wt.wtTable.getCell(this.range.from),d=this.range.from.row,e=this.range.from.col,f=u(c),g=this.hot.view.wt.wtTable.getStretchedColumnWidth(e),h=f.top<0?0:f.top,i=f.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&b!==window&&(h-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&b!==window&&(i-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var j=i+g,k=h,l=this.getCommentMeta(d,e,N),m=this.getCommentMeta(d,e,O);l?this.editor.setSize(l.width,l.height):this.editor.resetSize(),this.editor.setReadOnlyState(m),this.editor.setPosition(j,k)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"checkSelectionCommentsConsistency",{value:function(){var a=this.hot.getSelectedRange();if(!a)return!1;var b=!1,c=a.from;return this.getCommentMeta(c.row,c.col,M)&&(b=!0),b},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"updateCommentMeta",{value:function(a,b,c){var e,d=this.hot.getCellMeta(a,b)[L];d?(e=z(d),A(e,c)):e=c,this.hot.setCellMeta(a,b,L,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"getCommentMeta",{value:function(a,b,c){var d=this.hot.getCellMeta(a,b);if(d[L])return d[L][c]},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onMouseDown",{value:function(a){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(a)){var b=r(a.target,"TD","TBODY"),c=null;b&&(c=this.hot.view.wt.wtTable.getCoords(b)),(!b||this.range.from&&c&&(this.range.from.row!==c.row||this.range.from.col!==c.col))&&this.hide()}this.contextMenuEvent=!1}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onMouseOver",{value:function(a){var b=this;if(!this.mouseDown&&!this.editor.isFocused()){var c=K.get(this);c.cellBelowCursor=document.elementFromPoint(a.clientX,a.clientY),B(function(){if(!t(a.target,"wtBorder")&&c.cellBelowCursor===a.target&&b.editor)if(b.targetIsCellWithComment(a)){var d=b.hot.view.wt.wtTable.getCoords(a.target),e={from:new D(d.row,d.col)};b.setRange(e),b.show()}else!s(a.target,document)||b.targetIsCommentTextArea(a)||b.editor.isFocused()||b.hide()},this.displayDelay)()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onMouseUp",{value:function(a){this.mouseDown=!1},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onAfterRenderer",{value:function(a,b){b[L]&&b[L][M]&&q(a,b.commentedCellClassName)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onEditorBlur",{value:function(a){this.setComment()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onEditorMouseDown",{value:function(a){K.get(this).tempEditorDimensions={width:v(a.target),height:w(a.target)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onEditorMouseUp",{value:function(a){var b,c=K.get(this),d=v(a.target),e=w(a.target);d===c.tempEditorDimensions.width+1&&e===c.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,(b={},Object.defineProperty(b,N,{value:{width:d,height:e},configurable:!0,enumerable:!0,writable:!0}),b))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onContextMenuAddComment",{value:function(){var a=this,b=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:b.from}),this.show(),setTimeout(function(){a.hot&&(a.hot.deselectCell(),a.editor.focus())},10)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onContextMenuRemoveComment",{value:function(a){this.contextMenuEvent=!0;for(var b=a.start.row;b<=a.end.row;b++)for(var c=a.start.col;c<=a.end.col;c++)this.removeCommentAtCell(b,c,!1);this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onContextMenuMakeReadOnly",{value:function(a){var b;this.contextMenuEvent=!0;for(var c=a.start.row;c<=a.end.row;c++)for(var d=a.start.col;d<=a.end.col;d++){var e=!!this.getCommentMeta(c,d,O);this.updateCommentMeta(c,d,(b={},Object.defineProperty(b,O,{value:!e,configurable:!0,enumerable:!0,writable:!0}),b))}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"addToContextMenu",{value:function(a){var b=this;a.items.push(o.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return b.checkSelectionCommentsConsistency()?"Edit comment":"Add comment"},callback:function(){return b.onContextMenuAddComment()},disabled:function(){return!(this.getSelected()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return"Delete comment"},callback:function(a,c){return b.onContextMenuRemoveComment(c)},disabled:function(){return b.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var a=this,b="Read only comment";return I(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c)[L];if(d&&(d=d[O]),d)return!0})&&(b=J(b)),b},callback:function(a,c){return b.onContextMenuMakeReadOnly(c)},disabled:function(){return b.hot.selection.selectedHeader.corner||!b.checkSelectionCommentsConsistency()}})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"onAfterBeginEditing",{value:function(a,b){this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"destroy",{value:function(){this.editor&&this.editor.destroy(),$traceurRuntime.superGet(this,Q.prototype,"destroy").call(this)},configurable:!0,enumerable:!0,writable:!0}),d),{},F),E("comments",P)},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,commentEditor:69,"contextMenu/utils":89,eventManager:42,"helpers/dom/element":47,"helpers/function":50,"helpers/object":53,plugins:62}],71:[function(a,b,c){"use strict";function g(a,b){var c;return e(b,function(b){var d=b.key?b.key.split(":"):null;if(Array.isArray(d)&&d[1]===a)return c=b,!1}),c}Object.defineProperties(c,{CommandExecutor:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,f=function(b){this.hot=b,this.commands={},this.commonCallback=null};$traceurRuntime.createClass(f,{registerCommand:function(a,b){this.commands[a]=b},setCommonCallback:function(a){this.commonCallback=a},execute:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=this,f=a.split(":");a=f[0];var h=2===f.length?f[1]:null,i=this.commands[a];if(!i)throw new Error("Menu command '"+a+"' not exists.");if(h&&i.submenu&&(i=g(h,i.submenu.items)),!0!==i.disabled&&("function"!=typeof i.disabled||!0!==i.disabled.call(this.hot))&&!i.hasOwnProperty("submenu")){var j=[];"function"==typeof i.callback&&j.push(i.callback),"function"==typeof this.commonCallback&&j.push(this.commonCallback),b.unshift(f.join(":")),e(j,function(a){return a.apply(d.hot,b)})}}},{})},{"helpers/array":43}],72:[function(a,b,c){"use strict";Object.defineProperties(c,{ContextMenu:{get:function(){return Q}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,i,n,o=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,p=((e=a("_base"))&&e.__esModule&&e||{default:e}).default,q=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,r=((g=a("commandExecutor"))&&g.__esModule&&g||{default:g}).CommandExecutor,s=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).EventManager,t=((i=a("helpers/dom/element"))&&i.__esModule&&i||{default:i}).hasClass,u=((j=a("itemsFactory"))&&j.__esModule&&j||{default:j}).ItemsFactory,v=((k=a("menu"))&&k.__esModule&&k||{default:k}).Menu,w=((l=a("plugins"))&&l.__esModule&&l||{default:l}).registerPlugin,x=(m=a("helpers/dom/event"))&&m.__esModule&&m||{default:m},y=x.stopPropagation,z=x.pageX,A=x.pageY,B=(i=a("helpers/dom/element"))&&i.__esModule&&i||{default:i},C=B.getWindowScrollLeft,D=B.getWindowScrollTop,E=(n=a("predefinedItems"))&&n.__esModule&&n||{default:n},F=E.ROW_ABOVE,G=E.ROW_BELOW,H=E.COLUMN_LEFT,I=E.COLUMN_RIGHT,J=E.REMOVE_ROW,K=E.REMOVE_COLUMN,L=E.UNDO,M=E.REDO,N=E.READ_ONLY,O=E.ALIGNMENT,P=E.SEPARATOR,Q=function(b){$traceurRuntime.superConstructor(R).call(this,b),this.eventManager=new s(this),this.commandExecutor=new r(this.hot),this.itemsFactory=null,this.menu=null},R=Q;$traceurRuntime.createClass(Q,{isEnabled:function(){return this.hot.getSettings().contextMenu},enablePlugin:function(){var a=this;if(!this.enabled){this.itemsFactory=new u(this.hot,R.DEFAULT_ITEMS);var b=this.hot.getSettings().contextMenu,c={items:this.itemsFactory.getItems(b)};this.registerEvents(),"function"==typeof b.callback&&this.commandExecutor.setCommonCallback(b.callback),$traceurRuntime.superGet(this,R.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){a.hot.runHooks("afterContextMenuDefaultOptions",c),a.itemsFactory.setPredefinedItems(c.items);var d=a.itemsFactory.getItems(b);a.menu=new v(a.hot,{className:"htContextMenu",keepInViewport:!0}),a.hot.runHooks("beforeContextMenuSetItems",d),a.menu.setMenuItems(d),a.menu.addLocalHook("afterOpen",function(){return a.onMenuAfterOpen()}),a.menu.addLocalHook("afterClose",function(){return a.onMenuAfterClose()}),a.menu.addLocalHook("executeCommand",function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a.executeCommand.apply(a,b)}),q(d,function(b){return a.commandExecutor.registerCommand(b.key,b)})})}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,R.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),$traceurRuntime.superGet(this,R.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(b){return a.onContextMenu(b)})},open:function(a){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(A(a),10)-D(),left:parseInt(z(a),10)-C()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,o.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.commandExecutor.execute.apply(this.commandExecutor,a)},onContextMenu:function(a){function e(a){return"TD"===a.nodeName||"TD"===a.parentNode.nodeName}var b=this.hot.getSettings(),c=b.rowHeaders,d=b.colHeaders,f=a.realTarget;this.close(),t(f,"handsontableInput")||(a.preventDefault(),y(a),(c||d||e(f)||t(f,"current")&&t(f,"wtBorder"))&&this.open(a))},onMenuAfterOpen:function(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)},destroy:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,R.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[F,G,P,H,I,P,J,K,P,L,M,P,N,P,O]}},p),Q.SEPARATOR={name:P},o.hooks.register("afterContextMenuDefaultOptions"),o.hooks.register("afterContextMenuShow"),o.hooks.register("afterContextMenuHide"),o.hooks.register("afterContextMenuExecute"),w("contextMenu",Q)},{_base:63,browser:24,commandExecutor:71,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,itemsFactory:74,menu:75,plugins:62,predefinedItems:76}],73:[function(a,b,c){"use strict";Object.defineProperties(c,{Cursor:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},i=h.getWindowScrollLeft,j=h.getWindowScrollTop,k=(f=a("helpers/dom/event"))&&f.__esModule&&f||{default:f},l=k.pageX,m=k.pageY,n=function(b){var e,f,g,h,k,n,c=j(),d=i();this.type=this.getSourceType(b),"literal"===this.type?(e=parseInt(b.top,10),g=parseInt(b.left,10),k=b.height||0,n=b.width||0,f=e,h=g,e+=c,g+=d):"event"===this.type&&(e=parseInt(m(b),10),g=parseInt(l(b),10),k=b.target.clientHeight,n=b.target.clientWidth,f=e-c,h=g-d),this.top=e,this.topRelative=f,this.left=g,this.leftRelative=h,this.scrollTop=c,this.scrollLeft=d,this.cellHeight=k,this.cellWidth=n};$traceurRuntime.createClass(n,{getSourceType:function(a){var b="literal";return a instanceof Event&&(b="event"),b},fitsAbove:function(a){return this.topRelative>=a.offsetHeight},fitsBelow:function(a){var b=void 0!==arguments[1]?arguments[1]:window.innerHeight;return this.topRelative+a.offsetHeight<=b},fitsOnRight:function(a){var b=void 0!==arguments[1]?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+a.offsetWidth<=b},fitsOnLeft:function(a){return this.leftRelative>=a.offsetWidth}},{}),g.plugins.utils=g.plugins.utils||{},g.plugins.utils.Cursor=n},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48}],74:[function(a,b,c){"use strict";function q(){var a=void 0!==arguments[0]?arguments[0]:null,b=void 0!==arguments[1]?arguments[1]:[],c=void 0!==arguments[2]?arguments[2]:{},d=[];return a&&a.items?a=a.items:Array.isArray(a)||(a=b),i(a)?h(a,function(a,b){var e=c["string"==typeof a?a:b];e||(e=a),i(a)?j(e,a):"string"==typeof e&&(e={name:e}),void 0===e.key&&(e.key=b),d.push(e)}):k(a,function(a,b){var e=c[a];!e&&n.indexOf(a)>=0||(e||(e={name:a,key:b+""}),i(a)&&j(e,a),void 0===e.key&&(e.key=b),d.push(e))}),d}Object.defineProperties(c,{ItemsFactory:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g=(d=a("helpers/object"))&&d.__esModule&&d||{default:d},h=g.objectEach,i=g.isObject,j=g.extend,k=((e=a("helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,l=(f=a("predefinedItems"))&&f.__esModule&&f||{default:f},m=l.SEPARATOR,n=l.ITEMS,o=l.predefinedItems,p=function(b){var c=void 0!==arguments[1]?arguments[1]:null;this.hot=b,this.predefinedItems=o(),this.defaultOrderPattern=c};$traceurRuntime.createClass(p,{setPredefinedItems:function(a){var b=this,c={};this.defaultOrderPattern.length=0,h(a,function(a,d){var e="";a.name===m?(c[m]=a,e=m):isNaN(parseInt(d,10))?(a.key=void 0===a.key?d:a.key,c[d]=a,e=a.key):(c[a.key]=a,e=a.key),b.defaultOrderPattern.push(e)}),this.predefinedItems=c},getItems:function(){return q(void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}},{})},{"helpers/array":43,"helpers/object":53,predefinedItems:76}],75:[function(a,b,c){"use strict";Object.defineProperties(c,{Menu:{get:function(){return R}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,q=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},r=q.addClass,s=q.empty,t=q.fastInnerHTML,u=q.getScrollbarWidth,v=q.isChildOf,w=q.removeClass,x=(f=a("helpers/array"))&&f.__esModule&&f||{default:f},y=x.arrayEach,z=x.arrayFilter,A=x.arrayReduce,B=((g=a("cursor"))&&g.__esModule&&g||{default:g}).Cursor,C=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).EventManager,D=((i=a("helpers/object"))&&i.__esModule&&i||{default:i}).mixin,E=((j=a("helpers/function"))&&j.__esModule&&j||{default:j}).debounce,F=(k=a("utils"))&&k.__esModule&&k||{default:k},G=F.filterSeparators,H=F.hasSubMenu,I=F.isDisabled,J=F.isItemHidden,K=F.isSeparator,L=F.isSelectionDisabled,M=F.normalizeSelection,N=((l=a("helpers/unicode"))&&l.__esModule&&l||{default:l}).KEY_CODES,O=((m=a("mixins/localHooks"))&&m.__esModule&&m||{default:m}).localHooks,P=((n=a("predefinedItems"))&&n.__esModule&&n||{default:n}).SEPARATOR,Q=((o=a("helpers/dom/event"))&&o.__esModule&&o||{default:o}).stopImmediatePropagation,R=function(b,c){this.hot=b,this.options=c||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new C(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()},S=R;$traceurRuntime.createClass(R,{registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(b){return a.onDocumentMouseDown(b)})},setMenuItems:function(a){this.menuItems=a},setOffset:function(a){var b=void 0!==arguments[1]?arguments[1]:0;this.offset[a]=b},isSubMenu:function(){return null!==this.parentMenu},open:function(){var a=this;this.container.removeAttribute("style"),this.container.style.display="block";var b=E(function(b){return a.openSubMenu(b)},300),c=z(this.menuItems,function(b){return J(b,a.hot)});c=G(c,P);var d={data:c,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(b,c,d,e,f,g){return a.menuItemRenderer(b,c,d,e,f,g)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(b){return a.onBeforeKeyDown(b)},afterOnCellMouseOver:function(c,d,e){a.isAllSubMenusClosed()?b(d.row):a.openSubMenu(d.row)},rowHeights:function(a){return c[a].name===P?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new p.Core(this.container,d),this.hotMenu.addHook("afterInit",function(){return a.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(b,c,d,e,f){return a.onAfterSelection(b,c,d,e,f)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")},close:function(){var a=void 0!==arguments[0]&&arguments[0];this.isOpened()&&(a&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))},openSubMenu:function(a){if(!this.hotMenu)return!1;var b=this.hotMenu.getCell(a,0);if(this.closeAllSubMenus(),!b||!H(b))return!1;var c=this.hotMenu.getSourceDataAtRow(a),d=new S(this.hot,{parent:this,name:c.name,className:this.options.className,keepInViewport:!0});return d.setMenuItems(c.submenu.items),d.open(),d.setPosition(b.getBoundingClientRect()),this.hotSubMenus[c.key]=d,d},closeSubMenu:function(a){var b=this.hotMenu.getSourceDataAtRow(a),c=this.hotSubMenus[b.key];c&&(c.destroy(),delete this.hotSubMenus[b.key])},closeAllSubMenus:function(){var a=this;y(this.hotMenu.getData(),function(b,c){return a.closeSubMenu(c)})},isAllSubMenusClosed:function(){return 0===Object.keys(this.hotSubMenus).length},destroy:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()},isOpened:function(){return null!==this.hotMenu},executeCommand:function(a){if(this.isOpened()&&this.hotMenu.getSelected()){var b=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);if(this.runLocalHooks("select",b,a),!1!==b.isCommand&&b.name!==P){var c=this.hot.getSelectedRange(),d=c?M(c):{},e=!0;(!0===b.disabled||"function"==typeof b.disabled&&!0===b.disabled.call(this.hot)||b.submenu)&&(e=!1),this.runLocalHooks("executeCommand",b.key,d,a),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",b.key,d,a),e&&this.close(!0)}}},setPosition:function(a){var b=new B(a);this.options.keepInViewport?(b.fitsBelow(this.container)?this.setPositionBelowCursor(b):b.fitsAbove(this.container)?this.setPositionAboveCursor(b):this.setPositionBelowCursor(b),b.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(b):this.setPositionOnLeftOfCursor(b)):(this.setPositionBelowCursor(b),this.setPositionOnRightOfCursor(b))},setPositionAboveCursor:function(a){var b=this.offset.above+a.top-this.container.offsetHeight;this.isSubMenu()&&(b=a.top+a.cellHeight-this.container.offsetHeight+3),this.container.style.top=b+"px"},setPositionBelowCursor:function(a){var b=this.offset.below+a.top;this.isSubMenu()&&(b=a.top-1),this.container.style.top=b+"px"},setPositionOnRightOfCursor:function(a){var b;b=this.isSubMenu()?1+a.left+a.cellWidth:this.offset.right+1+a.left,this.container.style.left=b+"px"},setPositionOnLeftOfCursor:function(a){var b=this.offset.left+a.left-this.container.offsetWidth+u()+4;this.container.style.left=b+"px"},selectFirstCell:function(){var a=this.hotMenu.getCell(0,0);K(a)||I(a)||L(a)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)},selectLastCell:function(){var a=this.hotMenu.countRows()-1,b=this.hotMenu.getCell(a,0);K(b)||I(b)||L(b)?this.selectPrevCell(a,0):this.hotMenu.selectCell(a,0)},selectNextCell:function(a,b){var c=a+1,d=c<this.hotMenu.countRows()?this.hotMenu.getCell(c,b):null;d&&(K(d)||I(d)||L(d)?this.selectNextCell(c,b):this.hotMenu.selectCell(c,b))},selectPrevCell:function(a,b){var c=a-1,d=c>=0?this.hotMenu.getCell(c,b):null;d&&(K(d)||I(d)||L(d)?this.selectPrevCell(c,b):this.hotMenu.selectCell(c,b))},menuItemRenderer:function(a,b,c,d,e,f){var g=this,h=a.getSourceDataAtRow(c),i=document.createElement("div"),j=function(a){return a.hasOwnProperty("submenu")},k=function(a){return new RegExp(P,"i").test(a.name)},l=function(a){return!0===a.disabled||"function"==typeof a.disabled&&!0===a.disabled.call(g.hot)},m=function(a){return a.disableSelection};"function"==typeof f&&(f=f.call(this.hot)),s(b),r(i,"htItemWrapper"),b.appendChild(i),k(h)?r(b,"htSeparator"):"function"==typeof h.renderer?(r(b,"htCustomMenuRenderer"),b.appendChild(h.renderer(a,i,c,d,e,f))):t(i,f),l(h)?(r(b,"htDisabled"),this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()})):m(h)?(r(b,"htSelectionDisabled"),this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()})):j(h)?(r(b,"htSubmenu"),m(h)?this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()}):this.eventManager.addEventListener(b,"mouseenter",function(){return a.selectCell(c,d,void 0,void 0,!1,!1)})):(w(b,"htSubmenu"),w(b,"htDisabled"),m(h)?this.eventManager.addEventListener(b,"mouseenter",function(){return a.deselectCell()}):this.eventManager.addEventListener(b,"mouseenter",function(){return a.selectCell(c,d,void 0,void 0,!1,!1)}))},createContainer:function(){var a=void 0!==arguments[0]?arguments[0]:null;a&&(a=a.replace(/[^A-z0-9]/g,"_"),a=this.options.className+"Sub_"+a);var b;return b=a?document.querySelector("."+this.options.className+"."+a):document.querySelector("."+this.options.className),b||(b=document.createElement("div"),r(b,"htMenu "+this.options.className),a&&r(b,a),document.getElementsByTagName("body")[0].appendChild(b)),b},blockMainTableCallbacks:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},onBeforeKeyDown:function(a){var b=this.hotMenu.getSelected(),c=!1;switch(this.keyEvent=!0,a.keyCode){case N.ESCAPE:this.close(),c=!0;break;case N.ENTER:b&&(this.hotMenu.getSourceDataAtRow(b[0]).submenu?c=!0:(this.executeCommand(a),this.close(!0)));break;case N.ARROW_DOWN:b?this.selectNextCell(b[0],b[1]):this.selectFirstCell(),c=!0;break;case N.ARROW_UP:b?this.selectPrevCell(b[0],b[1]):this.selectLastCell(),c=!0;break;case N.ARROW_RIGHT:if(b){var d=this.openSubMenu(b[0]);d&&d.selectFirstCell()}c=!0;break;case N.ARROW_LEFT:b&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),c=!0)}c&&(a.preventDefault(),Q(a)),this.keyEvent=!1},onAfterInit:function(){var a=this.hotMenu.getSettings().data,b=this.hotMenu.view.wt.wtTable.hider.style,c=this.hotMenu.view.wt.wtTable.holder.style,d=parseInt(b.width,10),e=A(a,function(a,b){return a+(b.name===P?1:26)},0);c.width=d+22+"px",c.height=e+4+"px",b.height=c.height},onAfterSelection:function(a,b,c,d,e){!1===this.keyEvent&&(e.value=!0)},onDocumentMouseDown:function(a){this.isOpened()&&(this.container&&v(a.target,this.container)&&this.executeCommand(a),this.options.standalone&&this.hotMenu&&!v(a.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!v(a.target,".htMenu")&&v(a.target,document)&&this.close(!0))}},{}),D(R,O)},{browser:24,cursor:73,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/object":53,"helpers/unicode":56,"mixins/localHooks":58,predefinedItems:76,utils:89}],76:[function(a,b,c){"use strict";function ca(){var a={};return r(ba,function(b,c){return a[c]=b()}),a}function da(a,b){-1===aa.indexOf(a)&&(ba[a]=b)}var d;Object.defineProperties(c,{ALIGNMENT:{get:function(){return f.KEY}},CLEAR_COLUMN:{get:function(){return g.KEY}},COLUMN_LEFT:{get:function(){return h.KEY}},COLUMN_RIGHT:{get:function(){return i.KEY}},READ_ONLY:{get:function(){return j.KEY}},REDO:{get:function(){return k.KEY}},REMOVE_COLUMN:{get:function(){return l.KEY}},REMOVE_ROW:{get:function(){return m.KEY}},ROW_ABOVE:{get:function(){return n.KEY}},ROW_BELOW:{get:function(){return o.KEY}},SEPARATOR:{get:function(){return p.KEY}},UNDO:{get:function(){return q.KEY}},ITEMS:{get:function(){return aa}},predefinedItems:{get:function(){return ca}},addItem:{get:function(){return da}},__esModule:{value:!0}});var e,f,g,h,i,j,k,l,m,n,o,p,q,f,g,h,i,j,k,l,m,n,o,p,q,r=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).objectEach,s=(f=a("predefinedItems/alignment"))&&f.__esModule&&f||{default:f},t=s.alignmentItem,u=s.KEY,v=(g=a("predefinedItems/clearColumn"))&&g.__esModule&&g||{default:g},w=v.clearColumnItem,x=v.KEY,y=(h=a("predefinedItems/columnLeft"))&&h.__esModule&&h||{default:h},z=y.columnLeftItem,A=y.KEY,B=(i=a("predefinedItems/columnRight"))&&i.__esModule&&i||{default:i},C=B.columnRightItem,D=B.KEY,E=(j=a("predefinedItems/readOnly"))&&j.__esModule&&j||{default:j},F=E.readOnlyItem,G=E.KEY,H=(k=a("predefinedItems/redo"))&&k.__esModule&&k||{default:k},I=H.redoItem,J=H.KEY,K=(l=a("predefinedItems/removeColumn"))&&l.__esModule&&l||{default:l},L=K.removeColumnItem,M=K.KEY,N=(m=a("predefinedItems/removeRow"))&&m.__esModule&&m||{default:m},O=N.removeRowItem,P=N.KEY,Q=(n=a("predefinedItems/rowAbove"))&&n.__esModule&&n||{default:n},R=Q.rowAboveItem,S=Q.KEY,T=(o=a("predefinedItems/rowBelow"))&&o.__esModule&&o||{default:o},U=T.rowBelowItem,V=T.KEY,W=(p=a("predefinedItems/separator"))&&p.__esModule&&p||{default:p},X=W.separatorItem,Y=W.KEY,Z=(q=a("predefinedItems/undo"))&&q.__esModule&&q||{default:q},$=Z.undoItem,_=Z.KEY,f=(f=a("predefinedItems/alignment"))&&f.__esModule&&f||{default:f},g=(g=a("predefinedItems/clearColumn"))&&g.__esModule&&g||{default:g},h=(h=a("predefinedItems/columnLeft"))&&h.__esModule&&h||{default:h},i=(i=a("predefinedItems/columnRight"))&&i.__esModule&&i||{default:i},j=(j=a("predefinedItems/readOnly"))&&j.__esModule&&j||{default:j},k=(k=a("predefinedItems/redo"))&&k.__esModule&&k||{default:k},l=(l=a("predefinedItems/removeColumn"))&&l.__esModule&&l||{default:l},m=(m=a("predefinedItems/removeRow"))&&m.__esModule&&m||{default:m},n=(n=a("predefinedItems/rowAbove"))&&n.__esModule&&n||{default:n},o=(o=a("predefinedItems/rowBelow"))&&o.__esModule&&o||{default:o},p=(p=a("predefinedItems/separator"))&&p.__esModule&&p||{default:p},q=(q=a("predefinedItems/undo"))&&q.__esModule&&q||{default:q},aa=[S,V,A,D,x,P,M,_,J,G,u,Y],ba=(d={},Object.defineProperty(d,Y,{value:X,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,S,{value:R,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,V,{value:U,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,A,{value:z,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,D,{value:C,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,x,{value:w,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,P,{value:O,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,M,{value:L,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,_,{value:$,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,J,{value:I,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,G,{value:F,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,u,{value:t,configurable:!0,enumerable:!0,writable:!0}),d)},{"helpers/object":53,"predefinedItems/alignment":77,"predefinedItems/clearColumn":78,"predefinedItems/columnLeft":79,"predefinedItems/columnRight":80,"predefinedItems/readOnly":81,"predefinedItems/redo":82,"predefinedItems/removeColumn":83,"predefinedItems/removeRow":84,"predefinedItems/rowAbove":85,"predefinedItems/rowBelow":86,"predefinedItems/separator":87,"predefinedItems/undo":88}],77:[function(a,b,c){"use strict";function m(){return{key:l,name:"Alignment",disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:l+":left",name:function(){var a=this,b="Left";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htLeft"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="horizontal",e="htLeft";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{key:l+":center",name:function(){var a=this,b="Center";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htCenter"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="horizontal",e="htCenter";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{key:l+":right",name:function(){var a=this,b="Right";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htRight"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="horizontal",e="htRight";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{key:l+":justify",name:function(){var a=this,b="Justify";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htJustify"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="horizontal",e="htJustify";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{name:k},{key:l+":top",name:function(){var a=this,b="Top";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htTop"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="vertical",e="htTop";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{key:l+":middle",name:function(){var a=this,b="Middle";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htMiddle"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="vertical",e="htMiddle";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1},{key:l+":bottom",name:function(){var a=this,b="Bottom";return i(this.getSelectedRange(),function(b,c){var d=a.getCellMeta(b,c).className;if(d&&-1!==d.indexOf("htBottom"))return!0})&&(b=j(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=h(b,function(b,c){return a.getCellMeta(b,c).className}),d="vertical",e="htBottom";this.runHooks("beforeCellAlignment",c,b,d,e),g(b,d,e,function(b,c){return a.getCellMeta(b,c)},function(b,c,d,e){return a.setCellMeta(b,c,d,e)}),this.render()},disabled:!1}]}}}Object.defineProperties(c,{KEY:{get:function(){return l}},alignmentItem:{get:function(){return m}},__esModule:{value:!0}});var d,e,f=(d=a("utils"))&&d.__esModule&&d||{default:d},g=f.align,h=f.getAlignmentClasses,i=f.checkSelectionConsistency,j=f.markLabelAsSelected,k=((e=a("separator"))&&e.__esModule&&e||{default:e}).KEY,l="alignment"},{separator:87,utils:89}],78:[function(a,b,c){"use strict";function g(){return{key:f,name:"Clear column",callback:function(a,b){var c=b.start.col;this.countRows()&&this.populateFromArray(0,c,[[null]],Math.max(b.start.row,b.end.row),c,"ContextMenu.clearColumn")},disabled:function(){var a=e(this);if(!a)return!0;var b=[a[0],0,a[0],this.countCols()-1],c=b.join(",")==a.join(",");return a[1]<0||this.countCols()>=this.getSettings().maxCols||c}}}Object.defineProperties(c,{KEY:{get:function(){return f}},clearColumnItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="clear_column"},{utils:89}],79:[function(a,b,c){"use strict";function g(){return{key:f,name:"Insert column on the left",callback:function(a,b){this.alter("insert_col",b.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var a=e(this);if(!a)return!0;if(!this.isColumnModificationAllowed())return!0;var b=[a[0],0,a[0],this.countCols()-1],c=b.join(",")==a.join(","),d=1===this.countCols();return a[1]<0||this.countCols()>=this.getSettings().maxCols||!d&&c},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(c,{KEY:{get:function(){return f}},columnLeftItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="col_left"},{utils:89}],80:[function(a,b,c){"use strict";function g(){return{key:f,name:"Insert column on the right",callback:function(a,b){this.alter("insert_col",b.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var a=e(this);if(!a)return!0;if(!this.isColumnModificationAllowed())return!0;var b=[a[0],0,a[0],this.countCols()-1],c=b.join(",")==a.join(","),d=1===this.countCols();return a[1]<0||this.countCols()>=this.getSettings().maxCols||!d&&c},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(c,{KEY:{get:function(){return f}},columnRightItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="col_right"},{utils:89}],81:[function(a,b,c){"use strict";function i(){return{key:h,name:function(){var a=this,b="Read only";return f(this.getSelectedRange(),function(b,c){return a.getCellMeta(b,c).readOnly})&&(b=g(b)),b},callback:function(){var a=this,b=this.getSelectedRange(),c=f(b,function(b,c){return a.getCellMeta(b,c).readOnly});b.forAll(function(b,d){a.setCellMeta(b,d,"readOnly",!c)}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}Object.defineProperties(c,{KEY:{get:function(){return h}},readOnlyItem:{get:function(){return i}},__esModule:{value:!0}});var d,e=(d=a("utils"))&&d.__esModule&&d||{default:d},f=e.checkSelectionConsistency,g=e.markLabelAsSelected,h="make_read_only"},{utils:89}],82:[function(a,b,c){"use strict";function e(){return{key:d,name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}Object.defineProperties(c,{KEY:{get:function(){return d}},redoItem:{get:function(){return e}},__esModule:{value:!0}});var d="redo"},{}],83:[function(a,b,c){"use strict";function g(){return{key:f,name:"Remove column",callback:function(a,b){var c=b.end.col-b.start.col+1;this.alter("remove_col",b.start.col,c,"ContextMenu.removeColumn")},disabled:function(){var a=e(this),b=this.countCols();return!a||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!b},hidden:function(){return!this.getSettings().allowRemoveColumn}}}Object.defineProperties(c,{KEY:{get:function(){return f}},removeColumnItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="remove_col"},{utils:89}],84:[function(a,b,c){"use strict";function g(){return{key:f,name:"Remove row",callback:function(a,b){var c=b.end.row-b.start.row+1;this.alter("remove_row",b.start.row,c,"ContextMenu.removeRow")},disabled:function(){var a=e(this),b=this.countRows();return!a||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!b},hidden:function(){return!this.getSettings().allowRemoveRow}}}Object.defineProperties(c,{KEY:{get:function(){return f}},removeRowItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="remove_row"},{utils:89}],85:[function(a,b,c){"use strict";function g(){return{key:f,name:"Insert row above",callback:function(a,b){this.alter("insert_row",b.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!e(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(c,{KEY:{get:function(){return f}},rowAboveItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="row_above"},{utils:89}],86:[function(a,b,c){"use strict";function g(){return{key:f,name:"Insert row below",callback:function(a,b){this.alter("insert_row",b.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!e(this)||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(c,{KEY:{get:function(){return f}},rowBelowItem:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("utils"))&&d.__esModule&&d||{default:d}).getValidSelection,f="row_below"},{utils:89}],87:[function(a,b,c){"use strict";function e(){return{name:d}}Object.defineProperties(c,{KEY:{get:function(){return d}},separatorItem:{get:function(){return e}},__esModule:{value:!0}});var d="---------"},{}],88:[function(a,b,c){"use strict";function e(){return{key:d,name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}Object.defineProperties(c,{KEY:{get:function(){return d}},undoItem:{get:function(){return e}},__esModule:{value:!0}});var d="undo"},{}],89:[function(a,b,c){"use strict";function j(a){return{start:a.getTopLeftCorner(),end:a.getBottomRightCorner()}}function k(a){return h(a,"htSeparator")}function l(a){return h(a,"htSubmenu")}function m(a){return h(a,"htDisabled")}function n(a){return h(a,"htSelectionDisabled")}function o(a){var b=a.getSelected();return b?b[0]<0?null:b:null}function p(a,b){return-1!=a.indexOf(b)?a:(a=a.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),a+=" "+b)}function q(a,b){return-1!=a.indexOf(b)?a:(a=a.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),a+=" "+b)}function r(a,b){for(var c={},d=a.from.row;d<=a.to.row;d++)for(var e=a.from.col;e<=a.to.col;e++)c[d]||(c[d]=[]),c[d][e]=b(d,e);return c}function s(a,b,c,d,e){if(a.from.row==a.to.row&&a.from.col==a.to.col)t(a.from.row,a.from.col,b,c,d,e);else for(var f=a.from.row;f<=a.to.row;f++)for(var g=a.from.col;g<=a.to.col;g++)t(f,g,b,c,d,e)}function t(a,b,c,d,e,f){var g=e(a,b),h=d;g.className&&(h="vertical"===c?p(g.className,d):q(g.className,d)),f(a,b,"className",h)}function u(a,b){var c=!1;return a&&a.forAll(function(a,d){if(b(a,d))return c=!0,!1}),c}function v(a){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+a}function w(a,b){return!a.hidden||!("function"==typeof a.hidden&&a.hidden.call(b))}function x(a,b){for(var c=a.slice(0),d=0;d<c.length&&c[d].name===b;)c.shift();return c}function y(a,b){var c=a.slice(0);return c.reverse(),c=x(c,b),c.reverse(),c}function z(a){var b=[];return g(a,function(a,c){c>0?b[b.length-1].name!==a.name&&b.push(a):b.push(a)}),b}function A(a){var b=void 0!==arguments[1]?arguments[1]:i,c=a.slice(0);return c=x(c,b),c=y(c,b),c=z(c)}Object.defineProperties(c,{normalizeSelection:{get:function(){return j}},isSeparator:{get:function(){return k}},hasSubMenu:{get:function(){return l}},isDisabled:{get:function(){return m}},isSelectionDisabled:{get:function(){return n}},getValidSelection:{get:function(){return o}},prepareVerticalAlignClass:{get:function(){return p}},prepareHorizontalAlignClass:{get:function(){return q}},getAlignmentClasses:{get:function(){return r}},align:{get:function(){return s}},checkSelectionConsistency:{get:function(){return u}},markLabelAsSelected:{get:function(){return v}},isItemHidden:{get:function(){return w}},filterSeparators:{get:function(){return A}},__esModule:{value:!0}});var d,e,f,g=((d=a("helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,h=((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).hasClass,i=((f=a("predefinedItems/separator"))&&f.__esModule&&f||{default:f}).KEY},{"helpers/array":43,"helpers/dom/element":47,"predefinedItems/separator":87}],90:[function(a,b,c){"use strict";Object.defineProperties(c,{ContextMenuCopyPaste:{get:function(){return r}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=((d=a("_base"))&&d.__esModule&&d||{default:d}).default,l=((e=a("zeroclipboard"))&&e.__esModule&&e||{default:e}).default,m=((f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f}).removeClass,n=((g=a("helpers/array"))&&g.__esModule&&g||{default:g}).arrayEach,o=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).EventManager,p=((i=a("plugins"))&&i.__esModule&&i||{default:i}).registerPlugin,q=((j=a("contextMenu/predefinedItems"))&&j.__esModule&&j||{default:j}).SEPARATOR,r=function(b){$traceurRuntime.superConstructor(s).call(this,b),this.eventManager=new o(this),this.swfPath=null,this.outsideClickDeselectsCache=null},s=r;$traceurRuntime.createClass(r,{isEnabled:function(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function(){var a=this;if(!this.enabled){"object"==typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath),void 0===l&&console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){void 0===navigator.mimeTypes["application/x-shockwave-flash"]&&console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.swfPath&&l.config({swfPath:this.swfPath}),this.hot.addHook("afterContextMenuShow",function(){return a.onAfterContextMenuShow()}),this.hot.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)}),this.registerEvents(),$traceurRuntime.superGet(this,s.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,s.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(document,"mouseenter",function(){return a.removeCurrentClass()}),this.eventManager.addEventListener(document,"mouseleave",function(){return a.removeZeroClipboardClass()})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.triggerCopy(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function(a){a.items.unshift({key:"copy",name:"Copy",disabled:function(){return this.selection.selectedHeader.corner}},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()},disabled:function(){return this.selection.selectedHeader.corner}},{name:q})},onAfterContextMenuShow:function(){var a=this,b=this.hot.getPlugin("contextMenu"),c=b.menu.hotMenu.getSourceData();n(c,function(c,d){if("copy"===c.key){var e=new l(b.menu.hotMenu.getCell(d,0));return e.off(),e.on("copy",function(b){b.clipboardData.setData("text/plain",a.getCopyValue()),a.hot.getSettings().outsideClickDeselects=a.outsideClickDeselectsCache}),!1}})},removeCurrentClass:function(){var a=this.hot.getPlugin("contextMenu");if(a.enabled){if(a.menu.isOpened()){var b=a.menu.hotMenu.rootElement.querySelector("td.current");b&&m(b,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1}},removeZeroClipboardClass:function(){var a=this.hot.getPlugin("contextMenu");if(a.enabled){if(a.menu.isOpened()){var b=a.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover");b&&m(b,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache}}},{},k),p("contextMenuCopyPaste",r)},{_base:63,"contextMenu/predefinedItems":76,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,zeroclipboard:"zeroclipboard"}],91:[function(a,b,c){"use strict";function D(a){function c(){a.isListening()}function d(){var c=b.getRangedData(b.copyableRanges);if(!a.getSettings().fragmentSelection||q.stringify(c)==z()){!!a.runHooks("beforeCut",c,b.copyableRanges)?(a.copyPaste.copyPasteInstance.copyable(q.stringify(c)),a.selection.empty(),a.runHooks("afterCut",c,b.copyableRanges)):a.copyPaste.copyPasteInstance.copyable("")}}function e(){if(a.isListening()){var c=b.getRangedData(b.copyableRanges);if(!a.getSettings().fragmentSelection||q.stringify(c)==z()){!!a.runHooks("beforeCopy",c,b.copyableRanges)?(a.copyPaste.copyPasteInstance.copyable(q.stringify(c)),a.runHooks("afterCopy",c,b.copyableRanges)):a.copyPaste.copyPasteInstance.copyable("")}}}function f(c){var d,e,f,g,h,i,j,k,l,m;if(a.isListening()&&a.selection.isSelected()){d=c,e=q.parse(d),f=a.getSelected(),g=new B(f[0],f[1]),h=new B(f[2],f[3]),i=new C(g,g,h),j=i.getTopLeftCorner(),k=i.getBottomRightCorner(),l=j,m=new B(Math.max(k.row,e.length-1+j.row),Math.max(k.col,e[0].length-1+j.col));var n=h.row-g.row>=e.length-1,o=h.col-g.col>=e[0].length-1;a.addHookOnce("afterChange",function(b,c){var d=b?b.length:0;if(d){var e={row:0,col:0},f=-1;u(b,function(a,c){var g=d>c+1?b[c+1]:null;g&&(n||(e.row=e.row+Math.max(g[0]-a[0]-1,0)),!o&&a[1]>f&&(f=a[1],e.col=e.col+Math.max(g[1]-a[1]-1,0)))}),a.selectCell(l.row,l.col,m.row+e.row,m.col+e.col)}});!!a.runHooks("beforePaste",e,b.copyableRanges)&&(a.populateFromArray(l.row,l.col,e,m.row,m.col,"CopyPaste.paste",a.getSettings().pasteMode),a.runHooks("afterPaste",e,b.copyableRanges))}}function g(c){if(a.getSelected()&&!(a.getActiveEditor()&&a.getActiveEditor().isOpened()||y(c))){if(t(c.keyCode)){if(a.getSettings().fragmentSelection&&z())return;return b.setCopyableText(),void x(c)}(c.ctrlKey||c.metaKey)&&!c.altKey&&(c.keyCode==s.A&&a._registerTimeout(setTimeout(A(b.setCopyableText,b),0)),c.keyCode==s.X&&d(),c.keyCode==s.C&&e())}}var b=this;this.copyPasteInstance=p(),this.copyPasteInstance.onCut(c),this.copyPasteInstance.triggerCopy=e,this.copyPasteInstance.onPaste(f),this.onPaste=f,this.copyableRanges=[],a.addHook("beforeKeyDown",g),this.destroy=function(){this.copyPasteInstance&&(this.copyPasteInstance.removeCallback(c),this.copyPasteInstance.removeCallback(f),this.copyPasteInstance.destroy(),this.copyPasteInstance=null),a.removeHook("beforeKeyDown",g)},a.addHook("afterDestroy",A(this.destroy,this)),this.triggerPaste=A(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=A(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var b=a.getSettings(),c=b.copyRowsLimit,d=b.copyColsLimit,e=a.getSelectedRange(),f=e.getTopLeftCorner(),g=e.getBottomRightCorner(),h=f.row,i=f.col,j=g.row,k=g.col,l=Math.min(j,h+c-1),m=Math.min(k,i+d-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:h,startCol:i,endRow:l,endCol:m}),this.copyableRanges=a.runHooks("modifyCopyableRange",this.copyableRanges);var n=this.getRangedCopyableData(this.copyableRanges);a.copyPaste.copyPasteInstance.copyable(n),j===l&&k===m||o.hooks.run(a,"afterCopyLimit",j-h+1,k-i+1,c,d)},this.getRangedCopyableData=function(b){var c=[],d=[],e=[];return u(b,function(a){v(a.startRow,a.endRow,function(a){-1===d.indexOf(a)&&d.push(a)}),v(a.startCol,a.endCol,function(a){-1===e.indexOf(a)&&e.push(a)})}),u(d,function(b){var d=[];u(e,function(c){d.push(a.getCopyableData(b,c))}),c.push(d)}),q.stringify(c)},this.getRangedData=function(b){var c=[],d=[],e=[];return u(b,function(a){v(a.startRow,a.endRow,function(a){-1===d.indexOf(a)&&d.push(a)}),v(a.startCol,a.endCol,function(a){-1===e.indexOf(a)&&e.push(a)})}),u(d,function(b){var d=[];u(e,function(c){d.push(a.getCopyableData(b,c))}),c.push(d)}),c}}function E(){var a=this,b=!1!==a.getSettings().copyPaste;b&&!a.copyPaste?a.copyPaste=new D(a):!b&&a.copyPaste&&(a.copyPaste.destroy(),a.copyPaste=null)}Object.defineProperties(c,{CopyPastePlugin:{get:function(){return D}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,p=((e=a("copyPaste"))&&e.__esModule&&e||{default:e}).default,q=((f=a("SheetClip"))&&f.__esModule&&f||{default:f}).default,r=(g=a("helpers/unicode"))&&g.__esModule&&g||{default:g},s=r.KEY_CODES,t=r.isCtrlKey,u=((h=a("helpers/array"))&&h.__esModule&&h||{default:h}).arrayEach,v=((i=a("helpers/number"))&&i.__esModule&&i||{default:i}).rangeEach,w=(j=a("helpers/dom/event"))&&j.__esModule&&j||{default:j},x=w.stopImmediatePropagation,y=w.isImmediatePropagationStopped,z=((k=a("helpers/dom/element"))&&k.__esModule&&k||{default:k}).getSelectionText,A=((l=a("helpers/function"))&&l.__esModule&&l||{default:l}).proxy,B=((m=a("3rdparty/walkontable/src/cell/coords"))&&m.__esModule&&m||{default:m}).WalkontableCellCoords,C=((n=a("3rdparty/walkontable/src/cell/range"))&&n.__esModule&&n||{default:n}).WalkontableCellRange;o.hooks.add("afterInit",E),o.hooks.add("afterUpdateSettings",E),o.hooks.register("afterCopyLimit"),o.hooks.register("modifyCopyableRange"),o.hooks.register("beforeCut"),o.hooks.register("afterCut"),o.hooks.register("beforePaste"),o.hooks.register("afterPaste"),o.hooks.register("beforeCopy"),o.hooks.register("afterCopy")},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,SheetClip:"SheetClip",browser:24,copyPaste:"copyPaste","helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/number":52,"helpers/unicode":56}],92:[function(a,b,c){"use strict";function l(){}var d,e,f,g,m,h=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=((e=a("plugins"))&&e.__esModule,((f=a("3rdparty/walkontable/src/cell/range"))&&f.__esModule&&f||{default:f}).WalkontableCellRange),k=((g=a("3rdparty/walkontable/src/selection"))&&g.__esModule&&g||{default:g}).WalkontableSelection,n=function(a){return"boolean"==typeof a&&!0===a||"object"==typeof a&&a.length>0},o=function(){n(this.getSettings().customBorders)&&(this.customBorders||(m=this,this.customBorders=new l))},p=function(a){for(var b=0;b<m.view.wt.selections.length;b++)if(m.view.wt.selections[b].settings.className==a)return b;return-1},q=function(a){var b={row:a.row,col:a.col},c=new k(a,new j(b,b,b)),d=p(a.className);d>=0?m.view.wt.selections[d]=c:m.view.wt.selections.push(c)},r=function(a,b,c){var d=x(a,b);d=y(d,c),this.setCellMeta(a,b,"borders",d),q(d)},s=function(a){for(var b=a.range,c=b.from.row;c<=b.to.row;c++)for(var d=b.from.col;d<=b.to.col;d++){var e=x(c,d),f=0;c==b.from.row&&(f++,a.hasOwnProperty("top")&&(e.top=a.top)),c==b.to.row&&(f++,a.hasOwnProperty("bottom")&&(e.bottom=a.bottom)),d==b.from.col&&(f++,a.hasOwnProperty("left")&&(e.left=a.left)),d==b.to.col&&(f++,a.hasOwnProperty("right")&&(e.right=a.right)),f>0&&(this.setCellMeta(c,d,"borders",e),q(e))}},t=function(a,b){return"border_row"+a+"col"+b},u=function(){return{width:1,color:"#000"}},v=function(){return{hide:!0}},w=function(){return{width:1,color:"#000",cornerVisible:!1}},x=function(a,b){return{className:t(a,b),border:w(),row:a,col:b,top:v(),right:v(),bottom:v(),left:v()}},y=function(a,b){return b.hasOwnProperty("border")&&(a.border=b.border),b.hasOwnProperty("top")&&(a.top=b.top),b.hasOwnProperty("right")&&(a.right=b.right),b.hasOwnProperty("bottom")&&(a.bottom=b.bottom),b.hasOwnProperty("left")&&(a.left=b.left),a},z=function(a){for(var b=document.querySelectorAll("."+a),c=0;c<b.length;c++)if(b[c]&&"TD"!=b[c].nodeName){var d=b[c].parentNode;d.parentNode&&d.parentNode.removeChild(d)}},A=function(a,b){var c=t(a,b);z(c),this.removeCellMeta(a,b,"borders")},B=function(a,b,c,d){var e=this.getCellMeta(a,b).borders;e&&void 0!=e.border||(e=x(a,b)),e[c]=d?v():u(),this.setCellMeta(a,b,"borders",e);var f=t(a,b);z(f),q(e),this.render()},C=function(a,b,c){if(a.from.row==a.to.row&&a.from.col==a.to.col)"noBorders"==b?A.call(this,a.from.row,a.from.col):B.call(this,a.from.row,a.from.col,b,c);else switch(b){case"noBorders":for(var d=a.from.col;d<=a.to.col;d++)for(var e=a.from.row;e<=a.to.row;e++)A.call(this,e,d);break;case"top":for(var f=a.from.col;f<=a.to.col;f++)B.call(this,a.from.row,f,b,c);break;case"right":for(var g=a.from.row;g<=a.to.row;g++)B.call(this,g,a.to.col,b);break;case"bottom":for(var h=a.from.col;h<=a.to.col;h++)B.call(this,a.to.row,h,b);break;case"left":for(var i=a.from.row;i<=a.to.row;i++)B.call(this,i,a.from.col,b)}},D=function(a,b){var c=!1;return a.getSelectedRange().forAll(function(d,e){var f=a.getCellMeta(d,e).borders;if(f){if(!b)return c=!0,!1;if(!f[b].hasOwnProperty("hide"))return c=!0,!1}}),c},E=function(a){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+a},F=function(a){this.getSettings().customBorders&&(a.items.push(h.plugins.ContextMenu.SEPARATOR),a.items.push({key:"borders",name:"Borders",disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var a="Top";return D(this,"top")&&(a=E(a)),a},callback:function(){var a=D(this,"top");C.call(this,this.getSelectedRange(),"top",a)}},{key:"borders:right",name:function(){var a="Right";return D(this,"right")&&(a=E(a)),a},callback:function(){var a=D(this,"right");C.call(this,this.getSelectedRange(),"right",a)}},{key:"borders:bottom",name:function(){var a="Bottom";return D(this,"bottom")&&(a=E(a)),a},callback:function(){var a=D(this,"bottom");C.call(this,this.getSelectedRange(),"bottom",a)}},{key:"borders:left",name:function(){var a="Left";return D(this,"left")&&(a=E(a)),a},callback:function(){var a=D(this,"left");C.call(this,this.getSelectedRange(),"left",a)}},{key:"borders:no_borders",name:"Remove border(s)",callback:function(){C.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!D(this)}}]}}))};h.hooks.add("beforeInit",o),h.hooks.add("afterContextMenuDefaultOptions",F),h.hooks.add("afterInit",function(){var a=this.getSettings().customBorders;if(a){for(var b=0;b<a.length;b++)a[b].range?s.call(this,a[b]):r.call(this,a[b].row,a[b].col,a[b]);this.render(),this.view.wt.draw(!0)}}),h.CustomBorders=l},{"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/selection":19,browser:24,plugins:62}],93:[function(a,b,c){"use strict";function j(){this.boundaries=null,this.callback=null}Object.defineProperties(c,{DragToScroll:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=((e=a("eventManager"))&&e.__esModule&&e||{default:e}).eventManager;(f=a("plugins"))&&f.__esModule;g.plugins.DragToScroll=j,j.prototype.setBoundaries=function(a){this.boundaries=a},j.prototype.setCallback=function(a){this.callback=a},j.prototype.check=function(a,b){var c=0,d=0;b<this.boundaries.top?d=b-this.boundaries.top:b>this.boundaries.bottom&&(d=b-this.boundaries.bottom),a<this.boundaries.left?c=a-this.boundaries.left:a>this.boundaries.right&&(c=a-this.boundaries.right),this.callback(c,d)};var k,m=function(a){a.dragToScrollListening=!1;var b=a.view.wt.wtTable.holder;k=new j,b!==window&&(k.setBoundaries(b.getBoundingClientRect()),k.setCallback(function(a,c){a<0?b.scrollLeft-=50:a>0&&(b.scrollLeft+=50),c<0?b.scrollTop-=20:c>0&&(b.scrollTop+=20)}),a.dragToScrollListening=!0)};g.hooks.add("afterInit",function(){var a=this,b=h(this);b.addEventListener(document,"mouseup",function(){a.dragToScrollListening=!1}),b.addEventListener(document,"mousemove",function(b){a.dragToScrollListening&&k.check(b.clientX,b.clientY)})}),g.hooks.add("afterDestroy",function(){h(this).clear()}),g.hooks.add("afterOnCellMouseDown",function(){m(this)}),g.hooks.add("afterOnCellCornerMouseDown",function(){m(this)}),g.plugins.DragToScroll=j},{browser:24,eventManager:42,plugins:62}],94:[function(a,b,c){"use strict";function d(a){return{key:"freeze_column",name:"Freeze this column",callback:function(){var b=this.getSelectedRange().from.col;a.freezeColumn(b),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var a=this.getSelectedRange(),b=!1;return void 0===a?b=!0:(a.from.col!==a.to.col||a.from.col<=this.getSettings().fixedColumnsLeft-1)&&(b=!0),b}}}Object.defineProperties(c,{freezeColumnItem:{get:function(){return d}},__esModule:{value:!0}})},{}],95:[function(a,b,c){"use strict";function d(a){return{key:"unfreeze_column",name:"Unfreeze this column",callback:function(){var b=this.getSelectedRange().from.col;a.unfreezeColumn(b),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var a=this.getSelectedRange(),b=!1;return void 0===a?b=!0:(a.from.col!==a.to.col||a.from.col>=this.getSettings().fixedColumnsLeft)&&(b=!0),b}}}Object.defineProperties(c,{unfreezeColumnItem:{get:function(){return d}},__esModule:{value:!0}})},{}],96:[function(a,b,c){"use strict";Object.defineProperties(c,{ManualColumnFreeze:{get:function(){return q}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=((e=a("_base"))&&e.__esModule&&e||{default:e}).default,l=((f=a("plugins"))&&f.__esModule&&f||{default:f}).registerPlugin,m=((g=a("helpers/array"))&&g.__esModule&&g||{default:g}).arrayEach,n=((h=a("contextMenuItem/freezeColumn"))&&h.__esModule&&h||{default:h}).freezeColumnItem,o=((i=a("contextMenuItem/unfreezeColumn"))&&i.__esModule&&i||{default:i}).unfreezeColumnItem,p=new WeakMap,q=function(b){$traceurRuntime.superConstructor(r).call(this,b),p.set(this,{moveByFreeze:!1,afterFirstUse:!1}),this.frozenColumnsBasePositions=[],this.manualColumnMovePlugin=void 0},r=q;$traceurRuntime.createClass(q,{isEnabled:function(){return!!this.hot.getSettings().manualColumnFreeze},enablePlugin:function(){var a=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(b){return a.addContextMenuEntry(b)}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("beforeColumnMove",function(b,c){return a.onBeforeColumnMove(b,c)}),$traceurRuntime.superGet(this,r.prototype,"enablePlugin").call(this))},disablePlugin:function(){var a=p.get(this);a.afterFirstUse=!1,a.moveByFreeze=!1,$traceurRuntime.superGet(this,r.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,r.prototype,"updatePlugin").call(this)},freezeColumn:function(a){var b=p.get(this),c=this.hot.getSettings();b.afterFirstUse||(b.afterFirstUse=!0),c.fixedColumnsLeft===this.hot.countCols()||a<=c.fixedColumnsLeft-1||(b.moveByFreeze=!0,a!==this.getMovePlugin().columnsMapper.getValueByIndex(a)&&(this.frozenColumnsBasePositions[c.fixedColumnsLeft]=a),this.getMovePlugin().moveColumn(a,c.fixedColumnsLeft++))},unfreezeColumn:function(a){var b=p.get(this),c=this.hot.getSettings();if(b.afterFirstUse||(b.afterFirstUse=!0),!(c.fixedColumnsLeft<=0||a>c.fixedColumnsLeft-1)){var d=this.getBestColumnReturnPosition(a);b.moveByFreeze=!0,c.fixedColumnsLeft--,this.getMovePlugin().moveColumn(a,d+1)}},getMovePlugin:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin},getBestColumnReturnPosition:function(a){var f,b=this.getMovePlugin(),c=this.hot.getSettings(),d=c.fixedColumnsLeft,e=b.columnsMapper.getValueByIndex(d);if(null==this.frozenColumnsBasePositions[a])for(f=b.columnsMapper.getValueByIndex(a);e<f;)d++,e=b.columnsMapper.getValueByIndex(d);else{for(f=this.frozenColumnsBasePositions[a],this.frozenColumnsBasePositions[a]=void 0;e<=f;)d++,e=b.columnsMapper.getValueByIndex(d);d=e}return d-1},addContextMenuEntry:function(a){a.items.push(j.plugins.ContextMenu.SEPARATOR,n(this),o(this))},onAfterInit:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()},onBeforeColumnMove:function(a,b){var c=p.get(this);if(c.afterFirstUse&&!c.moveByFreeze){var d=this.hot.getSettings().fixedColumnsLeft,e=b<d;if(e||m(a,function(a,b,c){if(a<d)return e=!0,!1}),e)return!1}c.moveByFreeze&&(c.moveByFreeze=!1)},destroy:function(){$traceurRuntime.superGet(this,r.prototype,"destroy").call(this)}},{},k),l("manualColumnFreeze",q)},{_base:63,browser:24,"contextMenuItem/freezeColumn":94,"contextMenuItem/unfreezeColumn":95,"helpers/array":43,plugins:62}],97:[function(a,b,c){"use strict";Object.defineProperties(c,{ColumnsMapper:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=((e=a("mixins/arrayMapper"))&&e.__esModule&&e||{default:e}).arrayMapper,k=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayFilter,l=((g=a("helpers/object"))&&g.__esModule&&g||{default:g}).mixin,m=((h=a("helpers/number"))&&h.__esModule&&h||{default:h}).rangeEach,n=function(b){this.manualColumnMove=b};$traceurRuntime.createClass(n,{createMap:function(a){var b=this,c=void 0===a?this._arrayMap.length:a;this._arrayMap.length=0,m(c-1,function(a){b._arrayMap[a]=a})},destroy:function(){this._arrayMap=null},moveColumn:function(a,b){var c=this._arrayMap[a];this._arrayMap[a]=null,this._arrayMap.splice(b,0,c)},clearNull:function(){this._arrayMap=k(this._arrayMap,function(a){return null!==a})}},{}),l(n,j),i.utils.ManualColumnMoveColumnsMapper=n},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],98:[function(a,b,c){"use strict";Object.defineProperties(c,{ManualColumnMove:{get:function(){return F}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n=((d=a("_base.js"))&&d.__esModule&&d||{default:d}).default,o=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,p=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,q=(g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g},r=q.addClass,s=q.removeClass,t=q.offset,u=((h=a("helpers/number"))&&h.__esModule&&h||{default:h}).rangeEach,v=((i=a("eventManager"))&&i.__esModule&&i||{default:i}).eventManager,w=((j=a("plugins"))&&j.__esModule&&j||{default:j}).registerPlugin,x=((k=a("columnsMapper"))&&k.__esModule&&k||{default:k}).ColumnsMapper,y=((l=a("ui/backlight"))&&l.__esModule&&l||{default:l}).BacklightUI,z=((m=a("ui/guideline"))&&m.__esModule&&m||{default:m}).GuidelineUI,A=new WeakMap,B="ht__manualColumnMove",C="show-ui",D="on-moving--columns",E="after-selection--columns",F=function(b){$traceurRuntime.superConstructor(G).call(this,b),A.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),this.removedColumns=[],this.columnsMapper=new x(this),this.eventManager=v(this),this.backlight=new y(b),this.guideline=new z(b)},G=F;$traceurRuntime.createClass(F,{isEnabled:function(){return!!this.hot.getSettings().manualColumnMove},enablePlugin:function(){var a=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(b,c,d,e){return a.onBeforeOnCellMouseDown(b,c,d,e)}),this.addHook("beforeOnCellMouseOver",function(b,c,d,e){return a.onBeforeOnCellMouseOver(b,c,d,e)}),this.addHook("afterScrollVertically",function(){return a.onAfterScrollVertically()}),this.addHook("modifyCol",function(b,c){return a.onModifyCol(b,c)}),this.addHook("beforeRemoveCol",function(b,c){return a.onBeforeRemoveCol(b,c)}),this.addHook("afterRemoveCol",function(b,c){return a.onAfterRemoveCol(b,c)}),this.addHook("afterCreateCol",function(b,c){return a.onAfterCreateCol(b,c)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),this.addHook("unmodifyCol",function(b){return a.onUnmodifyCol(b)}),this.registerEvents(),r(this.hot.rootElement,B),$traceurRuntime.superGet(this,G.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,G.prototype,"updatePlugin").call(this)},disablePlugin:function(){var a=this.hot.getSettings().manualColumnMove;Array.isArray(a)&&this.columnsMapper.clearMap(),s(this.hot.rootElement,B),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,G.prototype,"disablePlugin").call(this)},moveColumn:function(a,b){this.moveColumns([a],b)},moveColumns:function(a,b){var c=this,d=A.get(this),e=this.hot.runHooks("beforeColumnMove",a,b);d.disallowMoving=!e,!1!==e&&(p(a,function(a,b,d){d[b]=c.columnsMapper.getValueByIndex(a)}),p(a,function(a,d){var e=c.columnsMapper.getIndexByValue(a);e!==b&&c.columnsMapper.moveColumn(e,b+d)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",a,b)},changeSelection:function(a,b){var c=this.hot.selection,d=this.hot.countRows()-1;c.setRangeStartOnly(new WalkontableCellCoords(0,a)),c.setRangeEnd(new WalkontableCellCoords(d,b),!1)},getColumnsWidth:function(a,b){for(var c=0,d=a;d<b;d++){var e=0;e=d<0?this.hot.view.wt.wtTable.getColumnWidth(d)||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(d)||0,c+=e}return c},initialSettings:function(){var a=this.hot.getSettings().manualColumnMove;Array.isArray(a)?this.moveColumns(a,0):void 0!==a&&this.persistentStateLoad()},isFixedColumnsLeft:function(a){return a<this.hot.getSettings().fixedColumnsLeft},persistentStateSave:function(){o.hooks.run(this.hot,"persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)},persistentStateLoad:function(){var a={};o.hooks.run(this.hot,"persistentStateLoad","manualColumnMove",a),a.value&&(this.columnsMapper._arrayMap=a.value)},prepareColumnsToMoving:function(a,b){var c=[];return u(a,b,function(a){c.push(a)}),c},refreshPositions:function(){var a=A.get(this),b=this.hot.view.wt.wtTable.getFirstVisibleColumn(),c=this.hot.view.wt.wtTable.getLastVisibleColumn(),d=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtOverlays.scrollableElement,f="number"==typeof e.scrollX?e.scrollX:e.scrollLeft,g=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,a.coordsColumn),h=a.target.eventPageX-(a.rootElementOffset-(void 0===e.scrollX?f:0)),i=d.hider.offsetWidth,j=d.TBODY.offsetLeft,k=this.backlight.getOffset().left,l=this.backlight.getSize().width,m=0;if(a.rootElementOffset+d.holder.offsetWidth+f<a.target.eventPageX&&a.coordsColumn<a.countCols&&a.coordsColumn++,a.hasRowHeaders&&(m=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(a.coordsColumn)&&(g+=f),g+=m,a.coordsColumn<0)a.fixedColumns>0?a.target.col=0:a.target.col=b>0?b-1:b;else if(a.target.TD.offsetWidth/2+g<=h){var n=a.coordsColumn>=a.countCols?a.countCols-1:a.coordsColumn;a.target.col=n+1,g+=a.target.TD.offsetWidth,a.target.col>c&&this.hot.scrollViewportTo(void 0,c+1,void 0,!0)}else a.target.col=a.coordsColumn,a.target.col<=b&&a.target.col>=a.fixedColumns&&this.hot.scrollViewportTo(void 0,b-1);a.target.col<=b&&a.target.col>=a.fixedColumns&&this.hot.scrollViewportTo(void 0,b-1);var o=h,p=g;h+l+k>=i?o=i-l-k:h+k<j+m&&(o=j+m+Math.abs(k)),g>=i-1?p=i-1:0===p?p=1:void 0!==e.scrollX&&a.coordsColumn<a.fixedColumns&&(p-=a.rootElementOffset<=e.scrollX?a.rootElementOffset:0),this.backlight.setPosition(null,o),this.guideline.setPosition(null,p)},updateColumnsMapper:function(){var a=this.hot.countSourceCols(),b=this.columnsMapper._arrayMap.length;if(0===b)this.columnsMapper.createMap(a||this.hot.getSettings().startCols);else if(b<a){var c=a-b;this.columnsMapper.insertItems(b,c)}else if(b>a){var d=a-1,e=[];p(this.columnsMapper._arrayMap,function(a,b,c){a>d&&e.push(b)}),this.columnsMapper.removeItems(e)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeOnCellMouseDown:function(a,b,c,d){var e=this.hot.view.wt.wtTable,f=this.hot.selection.selectedHeader.cols,g=this.hot.getSelectedRange(),h=A.get(this),i=a.realTarget.className.indexOf("columnSorting")>-1;if(!g||!f||h.pressed||0!==a.button||i)return h.pressed=!1,h.columnsToMove.length=0,void s(this.hot.rootElement,[D,C]);var j=this.guideline.isBuilt()&&!this.guideline.isAppended(),k=this.backlight.isBuilt()&&!this.backlight.isAppended();j&&k&&(this.guideline.appendTo(e.hider),this.backlight.appendTo(e.hider));var l=g,m=l.from,n=l.to,o=Math.min(m.col,n.col),p=Math.max(m.col,n.col);if(b.row<0&&b.col>=o&&b.col<=p){d.column=!0,h.pressed=!0,h.target.eventPageX=a.pageX,h.coordsColumn=b.col,h.target.TD=c,h.target.col=b.col,h.columnsToMove=this.prepareColumnsToMoving(o,p),h.hasRowHeaders=!!this.hot.getSettings().rowHeaders,h.countCols=this.hot.countCols(),h.fixedColumns=this.hot.getSettings().fixedColumnsLeft,h.rootElementOffset=t(this.hot.rootElement).left;var q=h.hasRowHeaders?-1:0,u=e.holder.scrollTop+e.getColumnHeaderHeight(0)+1,v=b.col<h.fixedColumns,w=this.hot.view.wt.wtOverlays.scrollableElement,x=w.scrollX?w.scrollX-h.rootElementOffset:0,y=a.layerX-(v?x:0),z=Math.abs(this.getColumnsWidth(o,b.col)+y);this.backlight.setPosition(u,this.getColumnsWidth(q,o)+z),this.backlight.setSize(this.getColumnsWidth(o,p+1),e.hider.offsetHeight-u),this.backlight.setOffset(null,-1*z),r(this.hot.rootElement,D)}else s(this.hot.rootElement,E),h.pressed=!1,h.columnsToMove.length=0},onMouseMove:function(a){var b=A.get(this);if(b.pressed){if(a.realTarget===this.backlight.element){var c=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(c)})}b.target.eventPageX=a.pageX,this.refreshPositions()}},onBeforeOnCellMouseOver:function(a,b,c,d){var e=this.hot.getSelectedRange(),f=A.get(this);e&&f.pressed&&(f.columnsToMove.indexOf(b.col)>-1?s(this.hot.rootElement,C):r(this.hot.rootElement,C),d.row=!0,d.column=!0,d.cell=!0,f.coordsColumn=b.col,f.target.TD=c)},onMouseUp:function(){var a=A.get(this);if(a.coordsColumn=void 0,a.pressed=!1,a.backlightWidth=0,s(this.hot.rootElement,[D,C,E]),this.hot.selection.selectedHeader.cols&&r(this.hot.rootElement,E),!(a.columnsToMove.length<1||void 0===a.target.col||a.columnsToMove.indexOf(a.target.col)>-1)){if(this.moveColumns(a.columnsToMove,a.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!a.disallowMoving){var b=this.columnsMapper.getIndexByValue(a.columnsToMove[0]),c=this.columnsMapper.getIndexByValue(a.columnsToMove[a.columnsToMove.length-1]);this.changeSelection(b,c)}a.columnsToMove.length=0}},onAfterScrollVertically:function(){var a=this.hot.view.wt.wtTable,b=a.getColumnHeaderHeight(0)+1,c=a.holder.scrollTop,d=b+c;this.backlight.setPosition(d),this.backlight.setSize(null,a.hider.offsetHeight-d)},onAfterCreateCol:function(a,b){this.columnsMapper.shiftItems(a,b)},onBeforeRemoveCol:function(a,b){var c=this;this.removedColumns.length=0,!1!==a&&u(a,a+b-1,function(a){c.removedColumns.push(c.hot.runHooks("modifyCol",a,c.pluginName))})},onAfterRemoveCol:function(a,b){this.columnsMapper.unshiftItems(this.removedColumns)},onAfterLoadData:function(a){this.updateColumnsMapper()},onModifyCol:function(a,b){if(b!==this.pluginName){var c=this.columnsMapper.getValueByIndex(a);a=null===c?a:c}return a},onUnmodifyCol:function(a){var b=this.columnsMapper.getIndexByValue(a);return null===b?a:b},onAfterPluginsInitialized:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()},destroy:function(){this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,G.prototype,"destroy").call(this)}},{},n),w("ManualColumnMove",F),o.hooks.register("beforeColumnMove"),o.hooks.register("afterColumnMove"),o.hooks.register("unmodifyCol")},{"_base.js":63,browser:24,columnsMapper:97,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,"ui/backlight":100,"ui/guideline":101}],99:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseUI:{get:function(){return j}},__esModule:{value:!0}});var d,e=((d=a("helpers/number"))&&d.__esModule&&d||{default:d}).isNumeric,f=0,g=1,h=2,i="px",j=function(b){this.hot=b,this._element=null,this.state=f};$traceurRuntime.createClass(j,{appendTo:function(a){a.appendChild(this._element),this.state=h},build:function(){this._element=document.createElement("div"),this.state=g},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=f},isAppended:function(){return this.state===h},isBuilt:function(){return this.state>=g},setPosition:function(a,b){e(a)&&(this._element.style.top=a+i),e(b)&&(this._element.style.left=b+i)},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(a,b){e(a)&&(this._element.style.width=a+i),e(b)&&(this._element.style.height=b+i)},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(a,b){e(a)&&(this._element.style.marginTop=a+i),e(b)&&(this._element.style.marginLeft=b+i)},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{"helpers/number":52}],100:[function(a,b,c){"use strict";Object.defineProperties(c,{BacklightUI:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,g=((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).addClass,i=function(b){$traceurRuntime.superConstructor(j).call(this,b)},j=i;$traceurRuntime.createClass(i,{build:function(){$traceurRuntime.superGet(this,j.prototype,"build").call(this),g(this._element,"ht__manualColumnMove--backlight")}},{},f)},{_base:99,"helpers/dom/element":47}],101:[function(a,b,c){"use strict";Object.defineProperties(c,{GuidelineUI:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,g=((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).addClass,i=function(b){$traceurRuntime.superConstructor(j).call(this,b)},j=i;$traceurRuntime.createClass(i,{build:function(){$traceurRuntime.superGet(this,j.prototype,"build").call(this),g(this._element,"ht__manualColumnMove--guideline")}},{},f)},{_base:99,"helpers/dom/element":47}],102:[function(a,b,c){"use strict";Object.defineProperties(c,{ManualColumnResize:{get:function(){return z}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,m=((e=a("_base.js"))&&e.__esModule&&e||{default:e}).default,n=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},o=n.addClass,p=n.hasClass,q=n.removeClass,r=n.outerHeight,s=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).eventManager,t=(h=a("helpers/dom/event"))&&h.__esModule&&h||{default:h},u=t.pageX,w=(t.pageY,((i=a("helpers/array"))&&i.__esModule&&i||{default:i}).arrayEach),x=((j=a("helpers/number"))&&j.__esModule&&j||{default:j}).rangeEach,y=((k=a("plugins"))&&k.__esModule&&k||{default:k}).registerPlugin,z=function(b){$traceurRuntime.superConstructor(A).call(this,b),this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=s(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualColumnWidths=[],o(this.handle,"manualColumnResizer"),o(this.guide,"manualColumnResizerGuide")},A=z;$traceurRuntime.createClass(z,{isEnabled:function(){return this.hot.getSettings().manualColumnResize},enablePlugin:function(){var a=this;if(!this.enabled){this.manualColumnWidths=[];var b=this.hot.getSettings().manualColumnResize,c=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(b,c){return a.onModifyColWidth(b,c)}),this.addHook("beforeStretchingColumnWidth",function(b,c){return a.onBeforeStretchingColumnWidth(b,c)}),this.addHook("beforeColumnResize",function(b,c,d){return a.onBeforeColumnResize(b,c,d)}),void 0!==c?this.manualColumnWidths=c:Array.isArray(b)?this.manualColumnWidths=b:this.manualColumnWidths=[],l.hooks.register("beforeColumnResize"),l.hooks.register("afterColumnResize"),this.bindEvents(),$traceurRuntime.superGet(this,A.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().manualColumnResize;Array.isArray(a)?this.manualColumnWidths=a:a||(this.manualColumnWidths=[])},disablePlugin:function(){$traceurRuntime.superGet(this,A.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function(){var a={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",a),a.value},setupHandlePosition:function(a){var b=this;if(!a.parentNode)return!1;this.currentTH=a;var c=this.hot.view.wt.wtTable.getCoords(a).col,d=r(this.currentTH);if(c>=0){var e=this.currentTH.getBoundingClientRect();if(this.currentCol=c,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var f=this.hot.getSelectedRange(),g=f.from,h=f.to,i=g.col,j=h.col;i>=j&&(i=h.col,j=g.col),this.currentCol>=i&&this.currentCol<=j?x(i,j,function(a){return b.selectedCols.push(a)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=e.left-6,this.startWidth=parseInt(e.width,10),this.handle.style.top=e.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=d+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function(){var a=parseInt(r(this.handle),10),b=parseInt(this.handle.style.top,10)+a,c=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);o(this.handle,"active"),o(this.guide,"active"),this.guide.style.top=b+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=c-a+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function(){q(this.handle,"active"),q(this.guide,"active")},checkIfColumnHeader:function(a){if(a!=this.hot.rootElement){var b=a.parentNode;return"THEAD"===b.tagName||this.checkIfColumnHeader(b)}return!1},getTHFromTargetElement:function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:this.getTHFromTargetElement(a.parentNode):null},onMouseOver:function(a){if(this.checkIfColumnHeader(a.target)){var b=this.getTHFromTargetElement(a.target);if(!b)return;var c=b.getAttribute("colspan");!b||null!==c&&1!==c||this.pressed||this.setupHandlePosition(b)}},afterMouseDownTimeout:function(){var a=this,b=function(){a.hot.forceFullRender=!0,a.hot.view.render(),a.hot.view.wt.wtOverlays.adjustElementsSize(!0)},c=function(c,d){var e=a.hot.runHooks("beforeColumnResize",c,a.newSize,!0);void 0!==e&&(a.newSize=e),"all"===a.hot.getSettings().stretchH?a.clearManualSize(c):a.setManualSize(c,a.newSize),d&&b(),a.saveManualColumnWidths(),a.hot.runHooks("afterColumnResize",c,a.newSize,!0)};if(this.dblclick>=2){this.selectedCols.length>1?(w(this.selectedCols,function(a){c(a)}),b()):w(this.selectedCols,function(a){c(a,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(a){var b=this;p(a.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return b.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=u(a),this.newSize=this.startWidth)},onMouseMove:function(a){var b=this;this.pressed&&(this.currentWidth=this.startWidth+(u(a)-this.startX),w(this.selectedCols,function(a){b.newSize=b.setManualSize(a,b.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(a){var b=this,c=function(){b.hot.forceFullRender=!0,b.hot.view.render(),b.hot.view.wt.wtOverlays.adjustElementsSize(!0)},d=function(a,d){b.hot.runHooks("beforeColumnResize",a,b.newSize),d&&c(),b.saveManualColumnWidths(),b.hot.runHooks("afterColumnResize",a,b.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth){this.selectedCols.length>1?(w(this.selectedCols,function(a){d(a)}),c()):w(this.selectedCols,function(a){d(a,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(b){return a.onMouseOver(b)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(b){return a.onMouseDown(b)}),this.eventManager.addEventListener(window,"mousemove",function(b){return a.onMouseMove(b)}),this.eventManager.addEventListener(window,"mouseup",function(b){return a.onMouseUp(b)})},setManualSize:function(a,b){return b=Math.max(b,20),a=this.hot.runHooks("modifyCol",a),this.manualColumnWidths[a]=b,b},clearManualSize:function(a){a=this.hot.runHooks("modifyCol",a),this.manualColumnWidths[a]=void 0},onModifyColWidth:function(a,b){return this.enabled&&(b=this.hot.runHooks("modifyCol",b),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[b])?this.manualColumnWidths[b]:a},onBeforeStretchingColumnWidth:function(a,b){var c=this.manualColumnWidths[b];return void 0===c&&(c=a),c},onBeforeColumnResize:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}},{},m),y("manualColumnResize",z)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],103:[function(a,b,c){"use strict";Object.defineProperties(c,{ManualRowMove:{get:function(){return F}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n=((d=a("_base.js"))&&d.__esModule&&d||{default:d}).default,o=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,p=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,q=(g=a("helpers/dom/element"))&&g.__esModule&&g||{default:g},r=q.addClass,s=q.removeClass,t=q.offset,u=((h=a("helpers/number"))&&h.__esModule&&h||{default:h}).rangeEach,v=((i=a("eventManager"))&&i.__esModule&&i||{default:i}).eventManager,w=((j=a("plugins"))&&j.__esModule&&j||{default:j}).registerPlugin,x=((k=a("rowsMapper"))&&k.__esModule&&k||{default:k}).RowsMapper,y=((l=a("ui/backlight"))&&l.__esModule&&l||{default:l}).BacklightUI,z=((m=a("ui/guideline"))&&m.__esModule&&m||{default:m}).GuidelineUI,A=new WeakMap,B="ht__manualRowMove",C="show-ui",D="on-moving--rows",E="after-selection--rows",F=function(b){$traceurRuntime.superConstructor(G).call(this,b),A.set(this,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),this.removedRows=[],this.rowsMapper=new x(this),this.eventManager=v(this),this.backlight=new y(b),this.guideline=new z(b)},G=F;$traceurRuntime.createClass(F,{isEnabled:function(){return!!this.hot.getSettings().manualRowMove},enablePlugin:function(){var a=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(b,c,d,e){return a.onBeforeOnCellMouseDown(b,c,d,e)}),this.addHook("beforeOnCellMouseOver",function(b,c,d,e){return a.onBeforeOnCellMouseOver(b,c,d,e)}),this.addHook("afterScrollHorizontally",function(){return a.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(b,c){return a.onModifyRow(b,c)}),this.addHook("beforeRemoveRow",function(b,c){return a.onBeforeRemoveRow(b,c)}),this.addHook("afterRemoveRow",function(b,c){return a.onAfterRemoveRow(b,c)}),this.addHook("afterCreateRow",function(b,c){return a.onAfterCreateRow(b,c)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),this.addHook("beforeColumnSort",function(b,c){return a.onBeforeColumnSort(b,c)}),this.addHook("unmodifyRow",function(b){return a.onUnmodifyRow(b)}),this.registerEvents(),r(this.hot.rootElement,B),$traceurRuntime.superGet(this,G.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,G.prototype,"updatePlugin").call(this)},disablePlugin:function(){var a=this.hot.getSettings().manualRowMove;Array.isArray(a)&&this.rowsMapper.clearMap(),s(this.hot.rootElement,B),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,G.prototype,"disablePlugin").call(this)},moveRow:function(a,b){this.moveRows([a],b)},moveRows:function(a,b){var c=this,d=A.get(this),e=this.hot.runHooks("beforeRowMove",a,b);d.disallowMoving=!1===e,d.disallowMoving||(p(a,function(a,b,d){d[b]=c.rowsMapper.getValueByIndex(a)}),p(a,function(a,d){var e=c.rowsMapper.getIndexByValue(a);e!==b&&c.rowsMapper.moveRow(e,b+d)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",a,b)},changeSelection:function(a,b){var c=this.hot.selection,d=this.hot.countCols()-1;c.setRangeStartOnly(new WalkontableCellCoords(a,0)),c.setRangeEnd(new WalkontableCellCoords(b,d),!1)},getRowsHeight:function(a,b){for(var c=0,d=a;d<b;d++){c+=this.hot.view.wt.wtTable.getRowHeight(d)||23}return c},initialSettings:function(){var a=this.hot.getSettings().manualRowMove;if(Array.isArray(a))this.moveRows(a,0);else if(void 0!==a){var b=this.persistentStateLoad();b.length&&this.moveRows(b,0)}},isFixedRowTop:function(a){return a<this.hot.getSettings().fixedRowsTop},isFixedRowBottom:function(a){return a>this.hot.getSettings().fixedRowsBottom},persistentStateSave:function(){o.hooks.run(this.hot,"persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)},persistentStateLoad:function(){var a={};return o.hooks.run(this.hot,"persistentStateLoad","manualRowMove",a),a.value?a.value:[]},prepareRowsToMoving:function(){var a=this.hot.getSelectedRange(),b=[];if(!a)return b;var c=a,d=c.from,e=c.to,f=Math.min(d.row,e.row),g=Math.max(d.row,e.row);return u(f,g,function(a){b.push(a)}),b},refreshPositions:function(){var a=A.get(this),b=a.target.coords,c=this.hot.view.wt.wtTable.getFirstVisibleRow(),d=this.hot.view.wt.wtTable.getLastVisibleRow(),e=this.hot.getSettings().fixedRowsTop,f=this.hot.countRows();b.row<e&&c>0&&this.hot.scrollViewportTo(c-1),b.row>=d&&d<f&&this.hot.scrollViewportTo(d+1,void 0,!0);var g=this.hot.view.wt.wtTable,h=a.target.TD,i=t(this.hot.rootElement),j=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,b.row),k=a.target.eventPageY-i.top+g.holder.scrollTop,l=g.hider.offsetHeight,m=g.TBODY.offsetTop,n=this.backlight.getOffset().top,o=this.backlight.getSize().height;i.top+g.holder.offsetHeight<a.target.eventPageY&&a.target.coords.row++,this.isFixedRowTop(b.row)&&(j+=g.holder.scrollTop),b.row<0?a.target.row=c>0?c-1:c:h.offsetHeight/2+j<=k?(a.target.row=b.row+1,j+=0===b.row?h.offsetHeight-1:h.offsetHeight):a.target.row=b.row;var p=k,q=j;k+o+n>=l?p=l-o-n:k+n<m&&(p=m+Math.abs(n)),j>=l-1&&(q=l-1);var r=0;this.hot.view.wt.wtOverlays.topOverlay&&(r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),b.row>=e&&q-g.holder.scrollTop<r&&this.hot.scrollViewportTo(b.row),this.backlight.setPosition(p),this.guideline.setPosition(q)},updateRowsMapper:function(){var a=this.hot.countSourceRows(),b=this.rowsMapper._arrayMap.length;if(0===b)this.rowsMapper.createMap(a||this.hot.getSettings().startRows);else if(b<a){var c=a-b;this.rowsMapper.insertItems(b,c)}else if(b>a){var d=a-1,e=[];p(this.rowsMapper._arrayMap,function(a,b,c){a>d&&e.push(b)}),this.rowsMapper.removeItems(e)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(b){return a.onMouseMove(b)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return a.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeColumnSort:function(a,b){A.get(this).disallowMoving=void 0!==b},onBeforeOnCellMouseDown:function(a,b,c,d){var e=this.hot.view.wt.wtTable,f=this.hot.selection.selectedHeader.rows,g=this.hot.getSelectedRange(),h=A.get(this);if(!g||!f||h.pressed||0!==a.button)return h.pressed=!1,h.rowsToMove.length=0,void s(this.hot.rootElement,[D,C]);var i=this.guideline.isBuilt()&&!this.guideline.isAppended(),j=this.backlight.isBuilt()&&!this.backlight.isAppended();i&&j&&(this.guideline.appendTo(e.hider),this.backlight.appendTo(e.hider));var k=g,l=k.from,m=k.to,n=Math.min(l.row,m.row),o=Math.max(l.row,m.row);if(b.col<0&&b.row>=n&&b.row<=o){d.row=!0,h.pressed=!0,h.target.eventPageY=a.pageY,h.target.coords=b,h.target.TD=c,h.rowsToMove=this.prepareRowsToMoving();var p=e.holder.scrollLeft+e.getColumnWidth(-1);this.backlight.setPosition(null,p),this.backlight.setSize(e.hider.offsetWidth-p,this.getRowsHeight(n,o+1)),this.backlight.setOffset(-1*(this.getRowsHeight(n,b.row)+a.layerY),null),r(this.hot.rootElement,D),this.refreshPositions()}else s(this.hot.rootElement,E),h.pressed=!1,h.rowsToMove.length=0},onMouseMove:function(a){var b=A.get(this);if(b.pressed){if(a.realTarget===this.backlight.element){var c=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,c)})}b.target.eventPageY=a.pageY,this.refreshPositions()}},onBeforeOnCellMouseOver:function(a,b,c,d){var e=this.hot.getSelectedRange(),f=A.get(this);e&&f.pressed&&(f.rowsToMove.indexOf(b.row)>-1?s(this.hot.rootElement,C):r(this.hot.rootElement,C),d.row=!0,d.column=!0,d.cell=!0,f.target.coords=b,f.target.TD=c)},onMouseUp:function(){var a=A.get(this),b=a.target.row,c=a.rowsToMove.length;if(a.pressed=!1,a.backlightHeight=0,s(this.hot.rootElement,[D,C,E]),this.hot.selection.selectedHeader.rows&&r(this.hot.rootElement,E),!(c<1||void 0===b||a.rowsToMove.indexOf(b)>-1||a.rowsToMove[c-1]===b-1)){if(this.moveRows(a.rowsToMove,b),this.persistentStateSave(),this.hot.render(),!a.disallowMoving){var d=this.rowsMapper.getIndexByValue(a.rowsToMove[0]),e=this.rowsMapper.getIndexByValue(a.rowsToMove[c-1]);this.changeSelection(d,e)}a.rowsToMove.length=0}},onAfterScrollHorizontally:function(){var a=this.hot.view.wt.wtTable,b=a.getColumnWidth(-1),c=a.holder.scrollLeft,d=b+c;this.backlight.setPosition(null,d),this.backlight.setSize(a.hider.offsetWidth-d)},onAfterCreateRow:function(a,b){this.rowsMapper.shiftItems(a,b)},onBeforeRemoveRow:function(a,b){var c=this;this.removedRows.length=0,!1!==a&&u(a,a+b-1,function(a){c.removedRows.push(c.hot.runHooks("modifyRow",a,c.pluginName))})},onAfterRemoveRow:function(a,b){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function(a){this.updateRowsMapper()},onModifyRow:function(a,b){if(b!==this.pluginName){var c=this.rowsMapper.getValueByIndex(a);a=null===c?a:c}return a},onUnmodifyRow:function(a){var b=this.rowsMapper.getIndexByValue(a);return null===b?a:b},onAfterPluginsInitialized:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()},destroy:function(){this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,G.prototype,"destroy").call(this)}},{},n),w("ManualRowMove",F),o.hooks.register("beforeRowMove"),o.hooks.register("afterRowMove"),o.hooks.register("unmodifyRow")},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,rowsMapper:104,"ui/backlight":106,"ui/guideline":107}],104:[function(a,b,c){"use strict";Object.defineProperties(c,{RowsMapper:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=((e=a("mixins/arrayMapper"))&&e.__esModule&&e||{default:e}).arrayMapper,k=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayFilter,l=((g=a("helpers/object"))&&g.__esModule&&g||{default:g}).mixin,m=((h=a("helpers/number"))&&h.__esModule&&h||{default:h}).rangeEach,n=function(b){this.manualRowMove=b};$traceurRuntime.createClass(n,{createMap:function(a){var b=this,c=void 0===a?this._arrayMap.length:a;this._arrayMap.length=0,m(c-1,function(a){b._arrayMap[a]=a})},destroy:function(){this._arrayMap=null},moveRow:function(a,b){var c=this._arrayMap[a];this._arrayMap[a]=null,this._arrayMap.splice(b,0,c)},clearNull:function(){this._arrayMap=k(this._arrayMap,function(a){return null!==a})}},{}),l(n,j),i.utils.ManualRowMoveRowsMapper=n},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],105:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseUI:{get:function(){return h}},__esModule:{value:!0}});var d=0,e=1,f=2,g="px",h=function(b){this.hot=b,this._element=null,this.state=d};$traceurRuntime.createClass(h,{appendTo:function(a){a.appendChild(this._element),this.state=f},build:function(){this._element=document.createElement("div"),this.state=e},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=d},isAppended:function(){return this.state===f},isBuilt:function(){return this.state>=e},setPosition:function(a,b){a&&(this._element.style.top=a+g),b&&(this._element.style.left=b+g)},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(a,b){a&&(this._element.style.width=a+g),b&&(this._element.style.height=b+g)},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(a,b){a&&(this._element.style.marginTop=a+g),b&&(this._element.style.marginLeft=b+g)},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{}],106:[function(a,b,c){"use strict";Object.defineProperties(c,{BacklightUI:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,g=((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).addClass,i=function(b){$traceurRuntime.superConstructor(j).call(this,b)},j=i;$traceurRuntime.createClass(i,{build:function(){$traceurRuntime.superGet(this,j.prototype,"build").call(this),g(this._element,"ht__manualRowMove--backlight")}},{},f)},{_base:105,"helpers/dom/element":47}],107:[function(a,b,c){"use strict";Object.defineProperties(c,{GuidelineUI:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,g=((e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}).addClass,i=function(b){$traceurRuntime.superConstructor(j).call(this,b)},j=i;$traceurRuntime.createClass(i,{build:function(){$traceurRuntime.superGet(this,j.prototype,"build").call(this),g(this._element,"ht__manualRowMove--guideline")}},{},f)},{_base:105,"helpers/dom/element":47}],108:[function(a,b,c){"use strict";Object.defineProperties(c,{ManualRowResize:{get:function(){return z}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,m=((e=a("_base.js"))&&e.__esModule&&e||{default:e}).default,n=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},o=n.addClass,p=n.hasClass,q=n.removeClass,r=n.outerWidth,s=((g=a("eventManager"))&&g.__esModule&&g||{default:g}).eventManager,t=(h=a("helpers/dom/event"))&&h.__esModule&&h||{default:h},v=(t.pageX,t.pageY),w=((i=a("helpers/array"))&&i.__esModule&&i||{default:i}).arrayEach,x=((j=a("helpers/number"))&&j.__esModule&&j||{default:j}).rangeEach,y=((k=a("plugins"))&&k.__esModule&&k||{default:k}).registerPlugin,z=function(b){$traceurRuntime.superConstructor(A).call(this,b),this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=s(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualRowHeights=[],o(this.handle,"manualRowResizer"),o(this.guide,"manualRowResizerGuide")},A=z;$traceurRuntime.createClass(z,{isEnabled:function(){return this.hot.getSettings().manualRowResize},enablePlugin:function(){var a=this;if(!this.enabled){this.manualRowHeights=[];var b=this.hot.getSettings().manualRowResize,c=this.loadManualRowHeights();void 0!==c?this.manualRowHeights=c:Array.isArray(b)?this.manualRowHeights=b:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(b,c){return a.onModifyRowHeight(b,c)}),l.hooks.register("beforeRowResize"),l.hooks.register("afterRowResize"),this.bindEvents(),$traceurRuntime.superGet(this,A.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().manualRowResize;Array.isArray(a)?this.manualRowHeights=a:a||(this.manualRowHeights=[])},disablePlugin:function(){$traceurRuntime.superGet(this,A.prototype,"disablePlugin").call(this)},saveManualRowHeights:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function(){var a={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",a),a.value},setupHandlePosition:function(a){var b=this;this.currentTH=a;var c=this.hot.view.wt.wtTable.getCoords(a).row,d=r(this.currentTH);if(c>=0){var e=this.currentTH.getBoundingClientRect();if(this.currentRow=c,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var f=this.hot.getSelectedRange(),g=f.from,h=f.to,i=g.row,j=h.row;i>=j&&(i=h.row,j=g.row),this.currentRow>=i&&this.currentRow<=j?x(i,j,function(a){return b.selectedRows.push(a)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=e.top-6,this.startHeight=parseInt(e.height,10),this.handle.style.left=e.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=d+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function(){var a=parseInt(r(this.handle),10),b=parseInt(this.handle.style.left,10)+a,c=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);o(this.handle,"active"),o(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=b+"px",this.guide.style.width=c-a+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function(){q(this.handle,"active"),q(this.guide,"active")},checkIfRowHeader:function(a){if(a!=this.hot.rootElement){var b=a.parentNode;return"TBODY"===b.tagName||this.checkIfRowHeader(b)}return!1},getTHFromTargetElement:function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:this.getTHFromTargetElement(a.parentNode):null},onMouseOver:function(a){if(this.checkIfRowHeader(a.target)){var b=this.getTHFromTargetElement(a.target);b&&(this.pressed||this.setupHandlePosition(b))}},afterMouseDownTimeout:function(){var a=this,b=function(){a.hot.forceFullRender=!0,a.hot.view.render(),a.hot.view.wt.wtOverlays.adjustElementsSize(!0)},c=function(c,d){var e=a.hot.runHooks("beforeRowResize",c,a.newSize,!0);void 0!==e&&(a.newSize=e),a.setManualSize(c,a.newSize),d&&b(),a.hot.runHooks("afterRowResize",c,a.newSize,!0)};if(this.dblclick>=2){this.selectedRows.length>1?(w(this.selectedRows,function(a){c(a)}),b()):w(this.selectedRows,function(a){c(a,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(a){var b=this;p(a.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return b.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=v(a),this.newSize=this.startHeight)},onMouseMove:function(a){var b=this;this.pressed&&(this.currentHeight=this.startHeight+(v(a)-this.startY),w(this.selectedRows,function(a){b.newSize=b.setManualSize(a,b.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(a){var b=this,c=function(){b.hot.forceFullRender=!0,b.hot.view.render(),b.hot.view.wt.wtOverlays.adjustElementsSize(!0)},d=function(a,d){b.hot.runHooks("beforeRowResize",a,b.newSize),d&&c(),b.saveManualRowHeights(),b.hot.runHooks("afterRowResize",a,b.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight){this.selectedRows.length>1?(w(this.selectedRows,function(a){d(a)}),c()):w(this.selectedRows,function(a){d(a,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(b){return a.onMouseOver(b)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(b){return a.onMouseDown(b)}),this.eventManager.addEventListener(window,"mousemove",function(b){return a.onMouseMove(b)}),this.eventManager.addEventListener(window,"mouseup",function(b){return a.onMouseUp(b)})},setManualSize:function(a,b){return a=this.hot.runHooks("modifyRow",a),this.manualRowHeights[a]=b,b},onModifyRowHeight:function(a,b){if(this.enabled){var c=this.hot.getPlugin("autoRowSize"),d=c?c.heights[b]:null;b=this.hot.runHooks("modifyRow",b);var e=this.manualRowHeights[b];if(void 0!==e&&(e===d||e>(a||0)))return e}return a}},{},m),y("manualRowResize",z)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],109:[function(a,b,c){"use strict";function p(){var a=[];return a.getInfo=function(a,b){for(var c=0,d=this.length;c<d;c++)if(this[c].row<=a&&this[c].row+this[c].rowspan-1>=a&&this[c].col<=b&&this[c].col+this[c].colspan-1>=b)return this[c]},a.setInfo=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b].row===a.row&&this[b].col===a.col)return void(this[b]=a);this.push(a)},a.removeInfo=function(a,b){for(var c=0,d=this.length;c<d;c++)if(this[c].row===a&&this[c].col===b){this.splice(c,1);break}},a}function q(a){if(this.mergedCellInfoCollection=new p,Array.isArray(a))for(var b=0,c=a.length;b<c;b++)this.mergedCellInfoCollection.setInfo(a[b])}function E(a,b){if(this.getSettings().mergeCells&&!this.selection.isMultiple()){var d=this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1]);d&&(a[0]=d.row,a[1]=d.col,a[2]=d.row+d.rowspan-1,a[3]=d.col+d.colspan-1)}}function F(a,b){this.mergeCells&&this.mergeCells.shiftCollection("right",a,b)}function G(a,b){this.mergeCells&&this.mergeCells.shiftCollection("left",a,b)}function H(a,b){this.mergeCells&&this.mergeCells.shiftCollection("down",a,b)}function I(a,b){this.mergeCells&&this.mergeCells.shiftCollection("up",a,b)}Object.defineProperties(c,{MergeCells:{get:function(){return q}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,l=((e=a("plugins"))&&e.__esModule,((f=a("helpers/dom/event"))&&f.__esModule&&f||{default:f}).stopImmediatePropagation),m=((g=a("3rdparty/walkontable/src/cell/coords"))&&g.__esModule&&g||{default:g}).WalkontableCellCoords,n=((h=a("3rdparty/walkontable/src/cell/range"))&&h.__esModule&&h||{default:h}).WalkontableCellRange,o=((i=a("3rdparty/walkontable/src/table"))&&i.__esModule&&i||{default:i}).WalkontableTable;q.prototype.canMergeRange=function(a){return!a.isSingle()},q.prototype.mergeRange=function(a){if(this.canMergeRange(a)){var b=a.getTopLeftCorner(),c=a.getBottomRightCorner(),d={};d.row=b.row,d.col=b.col,d.rowspan=c.row-b.row+1,d.colspan=c.col-b.col+1,this.mergedCellInfoCollection.setInfo(d)}},q.prototype.mergeOrUnmergeSelection=function(a){this.mergedCellInfoCollection.getInfo(a.from.row,a.from.col)?this.unmergeSelection(a.from):this.mergeSelection(a)},q.prototype.mergeSelection=function(a){this.mergeRange(a)},q.prototype.unmergeSelection=function(a){var b=this.mergedCellInfoCollection.getInfo(a.row,a.col);this.mergedCellInfoCollection.removeInfo(b.row,b.col)},q.prototype.applySpanProperties=function(a,b,c){var d=this.mergedCellInfoCollection.getInfo(b,c);d?d.row===b&&d.col===c?(a.setAttribute("rowspan",d.rowspan),a.setAttribute("colspan",d.colspan)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none"):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"))},q.prototype.modifyTransform=function(a,b,c){var d=function(a,b){return b.row>=a.row&&b.row<=a.row+a.rowspan-1},e=function(a,b){return b.col>=a.col&&b.col<=a.col+a.colspan-1},f=function(a){return new m(b.to.row+a.row,b.to.col+a.col)},g={row:c.row,col:c.col};if("modifyTransformStart"==a){this.lastDesiredCoords||(this.lastDesiredCoords=new m(null,null));for(var h=new m(b.highlight.row,b.highlight.col),i=this.mergedCellInfoCollection.getInfo(h.row,h.col),k=0,l=this.mergedCellInfoCollection.length;k<l;k++){var o=this.mergedCellInfoCollection[k];if(o=new m(o.row+o.rowspan-1,o.col+o.colspan-1),b.includes(o)){!0;break}}if(i){var p=new m(i.row,i.col),q=new m(i.row+i.rowspan-1,i.col+i.colspan-1);new n(p,p,q).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new m(null,null)),g.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-h.row:g.row,g.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-h.col:g.col,c.row>0?g.row=i.row+i.rowspan-1-h.row+c.row:c.row<0&&(g.row=h.row-i.row+c.row),c.col>0?g.col=i.col+i.colspan-1-h.col+c.col:c.col<0&&(g.col=h.col-i.col+c.col)}var s=new m(b.highlight.row+g.row,b.highlight.col+g.col),t=this.mergedCellInfoCollection.getInfo(s.row,s.col);t&&(this.lastDesiredCoords=s,g={row:t.row-h.row,col:t.col-h.col})}else if("modifyTransformEnd"==a)for(var k=0,l=this.mergedCellInfoCollection.length;k<l;k++){var u=this.mergedCellInfoCollection[k],p=new m(u.row,u.col),q=new m(u.row+u.rowspan-1,u.col+u.colspan-1),v=new n(p,p,q),w=b.getBordersSharedWith(v);if(v.isEqual(b))b.setDirection("NW-SE");else if(w.length>0){var x=b.highlight.isEqual(v.from);w.indexOf("top")>-1?b.to.isSouthEastOf(v.from)&&x?b.setDirection("NW-SE"):b.to.isSouthWestOf(v.from)&&x&&b.setDirection("NE-SW"):w.indexOf("bottom")>-1&&(b.to.isNorthEastOf(v.from)&&x?b.setDirection("SW-NE"):b.to.isNorthWestOf(v.from)&&x&&b.setDirection("SE-NW"))}var s=f(g),y=d(u,s),z=e(u,s);b.includesRange(v)&&(v.includes(s)||y||z)&&(y&&(g.row<0?g.row-=u.rowspan-1:g.row>0&&(g.row+=u.rowspan-1)),z&&(g.col<0?g.col-=u.colspan-1:g.col>0&&(g.col+=u.colspan-1)))}0!==g.row&&(c.row=g.row),0!==g.col&&(c.col=g.col)},q.prototype.shiftCollection=function(a,b,c){var d=[0,0];switch(a){case"right":d[0]+=1;break;case"left":d[0]-=1;break;case"down":d[1]+=1;break;case"up":d[1]-=1}for(var e=0;e<this.mergedCellInfoCollection.length;e++){var f=this.mergedCellInfoCollection[e];"right"===a||"left"===a?b<=f.col&&(f.col+=d[0]):b<=f.row&&(f.row+=d[1])}};var r=function(){var a=this,b=a.getSettings().mergeCells;b&&(a.mergeCells||(a.mergeCells=new q(b)))},s=function(){var a=this;a.mergeCells&&(a.view.wt.wtTable.getCell=function(b){if(a.getSettings().mergeCells){var c=a.mergeCells.mergedCellInfoCollection.getInfo(b.row,b.col);c&&(b=c)}return o.prototype.getCell.call(this,b)})},t=function(){var a=this,b=a.getSettings().mergeCells;if(b)if(a.mergeCells){if(a.mergeCells.mergedCellInfoCollection=new p,Array.isArray(b))for(var c=0,d=b.length;c<d;c++)a.mergeCells.mergedCellInfoCollection.setInfo(b[c])}else a.mergeCells=new q(b);else a.mergeCells&&(a.mergeCells.mergedCellInfoCollection=new p)},u=function(a){if(this.mergeCells){(a.ctrlKey||a.metaKey)&&!a.altKey&&77===a.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),l(a))}},v=function(a){this.getSettings().mergeCells&&(a.items.push(j.plugins.ContextMenu.SEPARATOR),a.items.push({key:"mergeCells",name:function(){var a=this.getSelected();return this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return this.selection.selectedHeader.corner}}))},w=function(a,b,c,d,e,f){this.mergeCells&&this.mergeCells.applySpanProperties(a,b,c)},x=function(a){return function(b){if(this.getSettings().mergeCells){var d=this.getSelectedRange();if(this.mergeCells.modifyTransform(a,d,b),"modifyTransformEnd"===a){var e=this.countRows(),f=this.countCols();d.from.row<0?d.from.row=0:d.from.row>0&&d.from.row>=e&&(d.from.row=d.from-1),d.from.col<0?d.from.col=0:d.from.col>0&&d.from.col>=f&&(d.from.col=f-1)}}}},y=function(a){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var c=this.getSelectedRange();c.highlight=new m(c.highlight.row,c.highlight.col),c.to=a;var d=!1;do{d=!1;for(var e=0,f=this.mergeCells.mergedCellInfoCollection.length;e<f;e++){var g=this.mergeCells.mergedCellInfoCollection[e],h=new m(g.row,g.col),i=new m(g.row+g.rowspan-1,g.col+g.colspan-1),j=new n(h,h,i);c.expandByRange(j)&&(a.row=c.to.row,a.col=c.to.col,d=!0)}}while(d)}},z=function(a,b){if(b&&"area"==b){if(this.getSettings().mergeCells)for(var d=this.getSelectedRange(),e=new n(d.from,d.from,d.from),f=new n(d.to,d.to,d.to),g=0,h=this.mergeCells.mergedCellInfoCollection.length;g<h;g++){var i=this.mergeCells.mergedCellInfoCollection[g],j=new m(i.row,i.col),k=new m(i.row+i.rowspan-1,i.col+i.colspan-1),l=new n(j,j,k);e.expandByRange(l)&&(a[0]=e.from.row,a[1]=e.from.col),f.expandByRange(l)&&(a[2]=f.from.row,a[3]=f.from.col)}}},A=function(a,b,c){if(this.getSettings().mergeCells){var e=this.mergeCells.mergedCellInfoCollection.getInfo(a,b);!e||e.row==a&&e.col==b||(c.copyable=!1)}},B=function(a){if(this.getSettings().mergeCells)for(var d,c=this.countCols(),e=0;e<c;e++){if((d=this.mergeCells.mergedCellInfoCollection.getInfo(a.startRow,e))&&d.row<a.startRow)return a.startRow=d.row,B.call(this,a);if(d=this.mergeCells.mergedCellInfoCollection.getInfo(a.endRow,e)){var f=d.row+d.rowspan-1;if(f>a.endRow)return a.endRow=f,B.call(this,a)}}},C=function(a){if(this.getSettings().mergeCells)for(var d,c=this.countRows(),e=0;e<c;e++){if((d=this.mergeCells.mergedCellInfoCollection.getInfo(e,a.startColumn))&&d.col<a.startColumn)return a.startColumn=d.col,C.call(this,a);if(d=this.mergeCells.mergedCellInfoCollection.getInfo(e,a.endColumn)){var f=d.col+d.colspan-1;if(f>a.endColumn)return a.endColumn=f,C.call(this,a)}}},D=function(a){if(a&&this.mergeCells){var b=this.mergeCells.mergedCellInfoCollection,c=this.getSelectedRange();for(var d in b)if(c.highlight.row==b[d].row&&c.highlight.col==b[d].col&&c.to.row==b[d].row+b[d].rowspan-1&&c.to.col==b[d].col+b[d].colspan-1)return!1}return a};j.hooks.add("beforeInit",r),j.hooks.add("afterInit",s),j.hooks.add("afterUpdateSettings",t),j.hooks.add("beforeKeyDown",u),j.hooks.add("modifyTransformStart",x("modifyTransformStart")),j.hooks.add("modifyTransformEnd",x("modifyTransformEnd")),j.hooks.add("beforeSetRangeEnd",y),j.hooks.add("beforeDrawBorders",z),j.hooks.add("afterIsMultipleSelection",D),j.hooks.add("afterRenderer",w),j.hooks.add("afterContextMenuDefaultOptions",v),j.hooks.add("afterGetCellMeta",A),j.hooks.add("afterViewportRowCalculatorOverride",B),j.hooks.add("afterViewportColumnCalculatorOverride",C),j.hooks.add("modifyAutofillRange",E),j.hooks.add("afterCreateCol",F),j.hooks.add("afterRemoveCol",G),j.hooks.add("afterCreateRow",H),j.hooks.add("afterRemoveRow",I),j.MergeCells=q},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/table":21,browser:24,"helpers/dom/event":48,plugins:62}],110:[function(a,b,c){"use strict";Object.defineProperties(c,{MultipleSelectionHandles:{get:function(){return s}},__esModule:{value:!0}});var d,e,f,g,h,i,k=((d=a("browser"))&&d.__esModule,(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e}),l=k.getWindowScrollTop,m=k.hasClass,n=k.getWindowScrollLeft,o=((f=a("helpers/browser"))&&f.__esModule&&f||{default:f}).isMobileBrowser,p=((g=a("_base"))&&g.__esModule&&g||{default:g}).default,q=((h=a("eventManager"))&&h.__esModule&&h||{default:h}).EventManager,r=((i=a("plugins"))&&i.__esModule&&i||{default:i}).registerPlugin,s=function(b){$traceurRuntime.superConstructor(t).call(this,b),this.dragged=[],this.eventManager=null,this.lastSetCell=null},t=s;$traceurRuntime.createClass(s,{isEnabled:function(){return o()},enablePlugin:function(){this.enabled||(this.eventManager||(this.eventManager=new q(this)),this.registerListeners(),$traceurRuntime.superGet(this,t.prototype,"enablePlugin").call(this))},registerListeners:function(){function b(b){if(1===a.dragged.length)return a.dragged.splice(0,a.dragged.length),!0;var c=a.dragged.indexOf(b);if(-1==c)return!1;0===c?a.dragged=a.dragged.slice(0,1):1==c&&(a.dragged=a.dragged.slice(-1))}var a=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(b){var c;return m(b.target,"topLeftSelectionHandle-HitArea")?(c=a.hot.getSelectedRange(),a.dragged.push("topLeft"),a.touchStartRange={width:c.getWidth(),height:c.getHeight(),direction:c.getDirection()},b.preventDefault(),!1):m(b.target,"bottomRightSelectionHandle-HitArea")?(c=a.hot.getSelectedRange(),a.dragged.push("bottomRight"),a.touchStartRange={width:c.getWidth(),height:c.getHeight(),direction:c.getDirection()},b.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(c){return m(c.target,"topLeftSelectionHandle-HitArea")?(b.call(a,"topLeft"),a.touchStartRange=void 0,c.preventDefault(),!1):m(c.target,"bottomRightSelectionHandle-HitArea")?(b.call(a,"bottomRight"),a.touchStartRange=void 0,c.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(b){var e,f,g,h,i,j,k,c=l(),d=n();0!==a.dragged.length&&(e=document.elementFromPoint(b.touches[0].screenX-d,b.touches[0].screenY-c))&&e!==a.lastSetCell&&("TD"!=e.nodeName&&"TH"!=e.nodeName||(f=a.hot.getCoords(e),-1==f.col&&(f.col=0),g=a.hot.getSelectedRange(),h=g.getWidth(),i=g.getHeight(),j=g.getDirection(),1==h&&1==i&&a.hot.selection.setRangeEnd(f),k=a.getCurrentRangeCoords(g,f,a.touchStartRange.direction,j,a.dragged[0]),null!==k.start&&a.hot.selection.setRangeStart(k.start),a.hot.selection.setRangeEnd(k.end),a.lastSetCell=e),b.preventDefault())})},getCurrentRangeCoords:function(a,b,c,d,e){var f=a.getTopLeftCorner(),g=a.getBottomRightCorner(),h=a.getBottomLeftCorner(),i=a.getTopRightCorner(),j={start:null,end:null};switch(c){case"NE-SW":switch(d){case"NE-SW":case"NW-SE":j="topLeft"==e?{start:new WalkontableCellCoords(b.row,a.highlight.col),end:new WalkontableCellCoords(h.row,b.col)}:{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,f.col)};break;case"SE-NW":"bottomRight"==e&&(j={start:new WalkontableCellCoords(g.row,b.col),end:new WalkontableCellCoords(b.row,f.col)})}break;case"NW-SE":switch(d){case"NE-SW":"topLeft"==e?j={start:b,end:h}:j.end=b;break;case"NW-SE":"topLeft"==e?j={start:b,end:g}:j.end=b;break;case"SE-NW":"topLeft"==e?j={start:b,end:f}:j.end=b;break;case"SW-NE":"topLeft"==e?j={start:b,end:i}:j.end=b}break;case"SW-NE":switch(d){case"NW-SE":j="bottomRight"==e?{start:new WalkontableCellCoords(b.row,f.col),end:new WalkontableCellCoords(h.row,b.col)}:{start:new WalkontableCellCoords(f.row,b.col),end:new WalkontableCellCoords(b.row,g.col)};break;case"SW-NE":j="topLeft"==e?{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,g.col)}:{start:new WalkontableCellCoords(b.row,f.col),end:new WalkontableCellCoords(f.row,b.col)};break;case"SE-NW":"bottomRight"==e?j={start:new WalkontableCellCoords(b.row,i.col),end:new WalkontableCellCoords(f.row,b.col)}:"topLeft"==e&&(j={start:h,end:b})}break;case"SE-NW":switch(d){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==e&&(j.end=b);break;case"SE-NW":"topLeft"==e?j.end=b:j={start:b,end:f}}}return j},isDragged:function(){return this.dragged.length>0}},{},p),r("multipleSelectionHandles",s)},{_base:63,browser:24,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,plugins:62}],111:[function(a,b,c){"use strict";Object.defineProperties(c,{DataObserver:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("jsonpatch"))&&d.__esModule&&d||{default:d}).default,i=((e=a("../../mixins/localHooks"))&&e.__esModule&&e||{default:e}).localHooks,j=((f=a("../../helpers/object"))&&f.__esModule&&f||{default:f}).mixin,k=((g=a("utils"))&&g.__esModule&&g||{default:g}).cleanPatches,l=function(b){this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(b)};$traceurRuntime.createClass(l,{setObservedData:function(a){var b=this;this.observer&&h.unobserve(this.observedData,this.observer),this.observedData=a,this.observer=h.observe(this.observedData,function(a){return b.onChange(a)})},isPaused:function(){return this.paused},pause:function(){this.paused=!0},resume:function(){this.paused=!1},onChange:function(a){this.runLocalHooks("change",k(a))},destroy:function(){h.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}},{}),j(l,i)},{"../../helpers/object":53,"../../mixins/localHooks":58,jsonpatch:"jsonpatch",utils:113}],112:[function(a,b,c){"use strict";Object.defineProperties(c,{ObserveChanges:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=((e=a("_base"))&&e.__esModule&&e||{default:e}).default,m=((f=a("jsonpatch"))&&f.__esModule,((g=a("dataObserver"))&&g.__esModule&&g||{default:g}).DataObserver),n=((h=a("helpers/array"))&&h.__esModule&&h||{default:h}).arrayEach,o=((i=a("plugins"))&&i.__esModule&&i||{default:i}).registerPlugin;j.hooks.register("afterChangesObserved");var p=function(b){$traceurRuntime.superConstructor(q).call(this,b),this.observer=null},q=p;$traceurRuntime.createClass(p,{isEnabled:function(){return this.hot.getSettings().observeChanges},enablePlugin:function(){var a=this;this.enabled||(this.observer||(this.observer=new m(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(b){return a.onDataChange(b)}),this.addHook("afterCreateRow",function(){return a.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return a.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return a.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return a.onAfterTableAlter()}),this.addHook("afterChange",function(b,c){return a.onAfterTableAlter(c)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),$traceurRuntime.superGet(this,q.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),$traceurRuntime.superGet(this,q.prototype,"disablePlugin").call(this)},onDataChange:function(a){var b=this;if(!this.observer.isPaused()){var c=this.pluginName+".change",d={add:function(a){isNaN(a.col)?b.hot.runHooks("afterCreateRow",a.row,1,c):b.hot.runHooks("afterCreateCol",a.col,1,c)},remove:function(a){isNaN(a.col)?b.hot.runHooks("afterRemoveRow",a.row,1,c):b.hot.runHooks("afterRemoveCol",a.col,1,c)},replace:function(a){b.hot.runHooks("afterChange",[a.row,a.col,null,a.value],c)}};n(a,function(a){d[a.op]&&d[a.op](a)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")},onAfterTableAlter:function(a){var b=this;"loadData"!==a&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return b.observer.resume()}))},onAfterLoadData:function(a){a||this.observer.setObservedData(this.hot.getSourceData())},destroy:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),$traceurRuntime.superGet(this,q.prototype,"destroy").call(this)},_exposePublicApi:function(){var a=this,b=this.hot;b.pauseObservingChanges=function(){return a.observer.pause()},b.resumeObservingChanges=function(){return a.observer.resume()},b.isPausedObservingChanges=function(){return a.observer.isPaused()}},_deletePublicApi:function(){var a=this.hot;delete a.pauseObservingChanges,delete a.resumeObservingChanges,delete a.isPausedObservingChanges}},{},k),o("observeChanges",p)},{_base:63,browser:24,dataObserver:111,"helpers/array":43,jsonpatch:"jsonpatch",plugins:62}],113:[function(a,b,c){"use strict";function h(a){var b=[];return a=f(a,function(a){return!/[\/]length/gi.test(a.path)&&!!i(a.path)}),a=g(a,function(a){var b=i(a.path);return a.row=b.row,a.col=b.col,a}),a=f(a,function(a){if(-1!==["add","remove"].indexOf(a.op)&&!isNaN(a.col)){if(-1!==b.indexOf(a.col))return!1;b.push(a.col)}return!0}),b.length=0,a}function i(a){var b=a.match(/^\/(\d+)\/?(.*)?$/);if(!b)return null;var c=b,d=c[1],e=c[2];return{row:parseInt(d,10),col:/^\d*$/.test(e)?parseInt(e,10):e}}Object.defineProperties(c,{cleanPatches:{get:function(){return h}},parsePath:{get:function(){return i}},__esModule:{value:!0}});var d,e=(d=a("../../helpers/array"))&&d.__esModule&&d||{default:d},f=e.arrayFilter,g=e.arrayMap},{"../../helpers/array":43}],114:[function(a,b,c){"use strict";function h(a){var b,c=function(){window.localStorage[a+"__persistentStateKeys"]=JSON.stringify(b)},e=function(){b=[],c()};(function(){var c=window.localStorage[a+"__persistentStateKeys"],d="string"==typeof c?JSON.parse(c):void 0;b=d||[]})(),this.saveValue=function(d,e){window.localStorage[a+"_"+d]=JSON.stringify(e),-1==b.indexOf(d)&&(b.push(d),c())},this.loadValue=function(b,c){b=void 0===b?c:b;var d=window.localStorage[a+"_"+b];return void 0===d?void 0:JSON.parse(d)},this.reset=function(b){window.localStorage.removeItem(a+"_"+b)},this.resetAll=function(){for(var c=0;c<b.length;c++)window.localStorage.removeItem(a+"_"+b[c]);e()}}function i(){function d(){var a=this;for(var c in b)b.hasOwnProperty(c)&&a.addHook(c,b[c])}function e(){var a=this;for(var c in b)b.hasOwnProperty(c)&&a.removeHook(c,b[c])}var a=this;this.init=function(){var b=this,c=b.getSettings().persistentState;if(a.enabled=!!c,!a.enabled)return void e.call(b);b.storage||(b.storage=new h(b.rootElement.id)),b.resetState=a.resetValue,d.call(b)},this.saveValue=function(a,b){this.storage.saveValue(a,b)},this.loadValue=function(a,b){var c=this;b.value=c.storage.loadValue(a)},this.resetValue=function(a){var b=this;void 0===a?b.storage.resetAll():b.storage.reset(a)};var b={persistentStateSave:a.saveValue,persistentStateLoad:a.loadValue,persistentStateReset:a.resetValue};for(var c in b)b.hasOwnProperty(c)&&f.hooks.register(c)}Object.defineProperties(c,{HandsontablePersistentState:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=((e=a("plugins"))&&e.__esModule,new i);f.hooks.add("beforeInit",j.init),f.hooks.add("afterUpdateSettings",j.init)},{browser:24,plugins:62}],115:[function(a,b,c){"use strict";function o(){var a=this;!a.getSettings().search?delete a.search:a.search=new g.Search(a)}var d,e,f,g=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,h=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},i=h.addClass,j=h.removeClass,k=(f=a("renderers"))&&f.__esModule&&f||{default:f},l=k.registerRenderer,m=k.getRenderer;g.Search=function(b){this.query=function(a,c,d){var e=b.countRows(),f=b.countCols(),h=[];c||(c=g.Search.global.getDefaultCallback()),d||(d=g.Search.global.getDefaultQueryMethod());for(var i=0;i<e;i++)for(var j=0;j<f;j++){var k=b.getDataAtCell(i,j),l=b.getCellMeta(i,j),m=l.search.callback||c,n=l.search.queryMethod||d,o=n(a,k);if(o){var p={row:i,col:j,data:k};h.push(p)}m&&m(b,i,j,k,o)}return h}},g.Search.DEFAULT_CALLBACK=function(a,b,c,d,e){a.getCellMeta(b,c).isSearchResult=e},g.Search.DEFAULT_QUERY_METHOD=function(a,b){return!(void 0===a||null==a||!a.toLowerCase||0===a.length)&&(void 0!==b&&null!=b&&-1!=b.toString().toLowerCase().indexOf(a.toLowerCase()))},g.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",g.Search.global=function(){var a=g.Search.DEFAULT_CALLBACK,b=g.Search.DEFAULT_QUERY_METHOD,c=g.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return a},setDefaultCallback:function(b){a=b},getDefaultQueryMethod:function(){return b},setDefaultQueryMethod:function(a){b=a},getDefaultSearchResultClass:function(){return c},setDefaultSearchResultClass:function(a){c=a}}}(),g.SearchCellDecorator=function(a,b,c,d,e,f,h){var k=null!==h.search&&"object"==typeof h.search&&h.search.searchResultClass||g.Search.global.getDefaultSearchResultClass();h.isSearchResult?i(b,k):j(b,k)};var n=m("base");l("base",function(a,b,c,d,e,f,h){n.apply(this,arguments),g.SearchCellDecorator.apply(this,arguments)}),g.hooks.add("afterInit",o),g.hooks.add("afterUpdateSettings",o)},{browser:24,"helpers/dom/element":47,renderers:118}],116:[function(a,b,c){"use strict";Object.defineProperties(c,{TouchScroll:{get:function(){return r}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},l=k.addClass,m=k.removeClass,n=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,o=((g=a("_base"))&&g.__esModule&&g||{default:g}).default,p=((h=a("plugins"))&&h.__esModule&&h||{default:h}).registerPlugin,q=((i=a("helpers/feature"))&&i.__esModule&&i||{default:i}).isTouchSupported,r=function(b){$traceurRuntime.superConstructor(s).call(this,b),this.scrollbars=[],this.clones=[],this.lockedCollection=!1},s=r;$traceurRuntime.createClass(r,{isEnabled:function(){return q()},enablePlugin:function(){var a=this;this.enabled||(this.addHook("afterRender",function(){return a.onAfterRender()}),this.registerEvents(),$traceurRuntime.superGet(this,s.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.lockedCollection=!1,$traceurRuntime.superGet(this,s.prototype,"updatePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,s.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.addHook("beforeTouchScroll",function(){return a.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return a.onAfterMomentumScroll()})},onAfterRender:function(){if(!this.lockedCollection){var a=this.hot.view.wt.wtOverlays,b=a.topOverlay,c=a.bottomOverlay,d=a.leftOverlay,e=a.topLeftCornerOverlay,f=a.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(b),c.clone&&this.scrollbars.push(c),this.scrollbars.push(d),e&&this.scrollbars.push(e),f&&f.clone&&this.scrollbars.push(f),this.clones.length=0,b.needFullRender&&this.clones.push(b.clone.wtTable.holder.parentNode),c.needFullRender&&this.clones.push(c.clone.wtTable.holder.parentNode),d.needFullRender&&this.clones.push(d.clone.wtTable.holder.parentNode),e&&this.clones.push(e.clone.wtTable.holder.parentNode),f&&f.clone&&this.clones.push(f.clone.wtTable.holder.parentNode)}},onBeforeTouchScroll:function(){j.freezeOverlays=!0,n(this.clones,function(a){l(a,"hide-tween")})},onAfterMomentumScroll:function(){var a=this;j.freezeOverlays=!1,n(this.clones,function(a){m(a,"hide-tween"),l(a,"show-tween")}),setTimeout(function(){n(a.clones,function(a){m(a,"show-tween")})},400),n(this.scrollbars,function(a){a.refresh(),a.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},o),p("touchScroll",r)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,plugins:62}],117:[function(a,b,c){"use strict";function p(){var a=this;void 0===a.getSettings().undo||a.getSettings().undo?a.undoRedo||(a.undoRedo=new i.UndoRedo(a),s(a),a.addHook("beforeKeyDown",q),a.addHook("afterChange",r)):a.undoRedo&&(delete a.undoRedo,t(a),a.removeHook("beforeKeyDown",q),a.removeHook("afterChange",r))}function q(a){var b=this;(a.ctrlKey||a.metaKey)&&!a.altKey&&(89===a.keyCode||a.shiftKey&&90===a.keyCode?(b.undoRedo.redo(),o(a)):90===a.keyCode&&(b.undoRedo.undo(),o(a)))}function r(a,b){var c=this;if("loadData"===b)return c.undoRedo.clear()}function s(a){a.undo=function(){return a.undoRedo.undo()},a.redo=function(){return a.undoRedo.redo()},a.isUndoAvailable=function(){return a.undoRedo.isUndoAvailable()},a.isRedoAvailable=function(){return a.undoRedo.isRedoAvailable()},a.clearUndo=function(){return a.undoRedo.clear()}}function t(a){delete a.undo,delete a.redo,delete a.isUndoAvailable,delete a.isRedoAvailable,delete a.clearUndo}var d,e,f,g,h,i=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,j=((e=a("helpers/array"))&&e.__esModule&&e||{default:e}).arrayMap,k=((f=a("helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,l=(g=a("helpers/object"))&&g.__esModule&&g||{default:g},m=l.inherit,n=l.deepClone,o=((h=a("helpers/dom/event"))&&h.__esModule&&h||{default:h}).stopImmediatePropagation;i.UndoRedo=function(a){var b=this;this.instance=a,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,a.addHook("afterChange",function(a,c){a&&"UndoRedo.undo"!==c&&"UndoRedo.redo"!==c&&b.done(new i.UndoRedo.ChangeAction(a))}),a.addHook("afterCreateRow",function(a,c,d){if("UndoRedo.undo"!==d&&"UndoRedo.undo"!==d&&"auto"!==d){var e=new i.UndoRedo.CreateRowAction(a,c);b.done(e)}}),a.addHook("beforeRemoveRow",function(a,c,d,e){if("UndoRedo.undo"!==e&&"UndoRedo.redo"!==e&&"auto"!==e){var f=b.instance.getSourceDataArray();a=(f.length+a)%f.length;var g=n(f.slice(a,a+c));b.done(new i.UndoRedo.RemoveRowAction(a,g))}}),a.addHook("afterCreateCol",function(a,c,d){"UndoRedo.undo"!==d&&"UndoRedo.redo"!==d&&"auto"!==d&&b.done(new i.UndoRedo.CreateColumnAction(a,c))}),a.addHook("beforeRemoveCol",function(c,d,e,f){if("UndoRedo.undo"!==f&&"UndoRedo.redo"!==f&&"auto"!==f){var g=b.instance.getSourceDataArray();c=(b.instance.countCols()+c)%b.instance.countCols();var h=[],j=[],l=[];k(g.length-1,function(b){var e=[],f=g[b];k(c,c+(d-1),function(b){e.push(f[a.runHooks("modifyCol",b)])}),h.push(e)}),k(d-1,function(b){l.push(a.runHooks("modifyCol",c+b))}),Array.isArray(a.getSettings().colHeaders)&&k(d-1,function(b){j.push(a.getSettings().colHeaders[a.runHooks("modifyCol",c+b)]||null)});var m=b.instance.getPlugin("manualColumnMove"),n=m.isEnabled()?m.columnsMapper.__arrayMap:[],o=new i.UndoRedo.RemoveColumnAction(c,l,h,j,n);b.done(o)}}),a.addHook("beforeCellAlignment",function(a,c,d,e){var f=new i.UndoRedo.CellAlignmentAction(a,c,d,e);b.done(f)}),a.addHook("beforeFilter",function(a){b.done(new i.UndoRedo.FiltersAction(a))}),a.addHook("beforeRowMove",function(a,c){!1!==a&&b.done(new i.UndoRedo.RowMoveAction(a,c))})},i.UndoRedo.prototype.done=function(a){this.ignoreNewActions||(this.doneActions.push(a),this.undoneActions.length=0)},i.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var a=this.doneActions.pop(),b=n(a),c=this.instance;if(!1===c.runHooks("beforeUndo",b))return;this.ignoreNewActions=!0;var e=this;a.undo(this.instance,function(){e.ignoreNewActions=!1,e.undoneActions.push(a)}),c.runHooks("afterUndo",b)}},i.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var a=this.undoneActions.pop(),b=n(a),c=this.instance;if(!1===c.runHooks("beforeRedo",b))return;this.ignoreNewActions=!0;var e=this;a.redo(this.instance,function(){e.ignoreNewActions=!1,e.doneActions.push(a)}),c.runHooks("afterRedo",b)}},i.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},i.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},i.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},i.UndoRedo.Action=function(){},i.UndoRedo.Action.prototype.undo=function(){},i.UndoRedo.Action.prototype.redo=function(){},i.UndoRedo.ChangeAction=function(a){this.changes=a,this.actionType="change"},m(i.UndoRedo.ChangeAction,i.UndoRedo.Action),i.UndoRedo.ChangeAction.prototype.undo=function(a,b){for(var c=n(this.changes),d=a.countEmptyRows(!0),e=a.countEmptyCols(!0),f=0,g=c.length;f<g;f++)c[f].splice(3,1);a.addHookOnce("afterChange",b),a.setDataAtRowProp(c,null,null,"UndoRedo.undo");for(var h=0,i=c.length;h<i;h++)a.getSettings().minSpareRows&&c[h][0]+1+a.getSettings().minSpareRows===a.countRows()&&d==a.getSettings().minSpareRows&&(a.alter("remove_row",parseInt(c[h][0]+1,10),a.getSettings().minSpareRows),a.undoRedo.doneActions.pop()),a.getSettings().minSpareCols&&c[h][1]+1+a.getSettings().minSpareCols===a.countCols()&&e==a.getSettings().minSpareCols&&(a.alter("remove_col",parseInt(c[h][1]+1,10),a.getSettings().minSpareCols),a.undoRedo.doneActions.pop())},i.UndoRedo.ChangeAction.prototype.redo=function(a,b){for(var c=n(this.changes),d=0,e=c.length;d<e;d++)c[d].splice(2,1);a.addHookOnce("afterChange",b),a.setDataAtRowProp(c,null,null,"UndoRedo.redo")},i.UndoRedo.CreateRowAction=function(a,b){this.index=a,this.amount=b,this.actionType="insert_row"},m(i.UndoRedo.CreateRowAction,i.UndoRedo.Action),i.UndoRedo.CreateRowAction.prototype.undo=function(a,b){var c=a.countRows(),d=a.getSettings().minSpareRows;this.index>=c&&this.index-d<c&&(this.index-=d),a.addHookOnce("afterRemoveRow",b),a.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},i.UndoRedo.CreateRowAction.prototype.redo=function(a,b){a.addHookOnce("afterCreateRow",b),a.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},i.UndoRedo.RemoveRowAction=function(a,b){this.index=a,this.data=b,this.actionType="remove_row"},m(i.UndoRedo.RemoveRowAction,i.UndoRedo.Action),i.UndoRedo.RemoveRowAction.prototype.undo=function(a,b){a.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),a.addHookOnce("afterRender",b),a.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},i.UndoRedo.RemoveRowAction.prototype.redo=function(a,b){a.addHookOnce("afterRemoveRow",b),a.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},i.UndoRedo.CreateColumnAction=function(a,b){this.index=a,this.amount=b,this.actionType="insert_col"},m(i.UndoRedo.CreateColumnAction,i.UndoRedo.Action),i.UndoRedo.CreateColumnAction.prototype.undo=function(a,b){a.addHookOnce("afterRemoveCol",b),a.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},i.UndoRedo.CreateColumnAction.prototype.redo=function(a,b){a.addHookOnce("afterCreateCol",b),a.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},i.UndoRedo.RemoveColumnAction=function(a,b,c,d,e){this.index=a,this.indexes=b,this.data=c,this.amount=this.data[0].length,this.headers=d,this.columnPositions=e.slice(0),this.actionType="remove_col"},m(i.UndoRedo.RemoveColumnAction,i.UndoRedo.Action),i.UndoRedo.RemoveColumnAction.prototype.undo=function(a,b){var d,c=this,e=this.indexes.slice(0).sort(),f=function(a,b,d){return d[c.indexes.indexOf(e[b])]},g=[];k(this.data.length-1,function(a){g[a]=j(c.data[a],f)});var h=[];h=j(this.headers,f);var l=[];i.hooks.run(a,"beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),k(this.data.length-1,function(b){d=a.getSourceDataAtRow(b),k(e.length-1,function(a){d.splice(e[a],0,g[b][a]),l.push([b,e[a],null,g[b][a]])})}),a.getPlugin("formulas")&&a.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&k(h.length-1,function(b){a.getSettings().colHeaders.splice(e[b],0,h[b])}),a.getPlugin("manualColumnMove")&&(a.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),a.addHookOnce("afterRender",b),i.hooks.run(a,"afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),a.getPlugin("formulas")&&a.getPlugin("formulas").recalculateFull(),a.render()},i.UndoRedo.RemoveColumnAction.prototype.redo=function(a,b){a.addHookOnce("afterRemoveCol",b),a.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},i.UndoRedo.CellAlignmentAction=function(a,b,c,d){this.stateBefore=a,this.range=b,this.type=c,this.alignment=d},i.UndoRedo.CellAlignmentAction.prototype.undo=function(a,b){if(a.getPlugin("contextMenu").isEnabled()){for(var c=this.range.from.row;c<=this.range.to.row;c++)for(var d=this.range.from.col;d<=this.range.to.col;d++)a.setCellMeta(c,d,"className",this.stateBefore[c][d]||" htLeft");a.addHookOnce("afterRender",b),a.render()}},i.UndoRedo.CellAlignmentAction.prototype.redo=function(a,b){a.getPlugin("contextMenu").isEnabled()&&(a.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),a.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),a.addHookOnce("afterRender",b),a.render())},i.UndoRedo.FiltersAction=function(a){this.formulaStacks=a,this.actionType="filter"},m(i.UndoRedo.FiltersAction,i.UndoRedo.Action),i.UndoRedo.FiltersAction.prototype.undo=function(a,b){var c=a.getPlugin("filters");a.addHookOnce("afterRender",b),c.formulaCollection.importAllFormulas(this.formulaStacks.slice(0,this.formulaStacks.length-1)),c.filter()},i.UndoRedo.FiltersAction.prototype.redo=function(a,b){var c=a.getPlugin("filters");a.addHookOnce("afterRender",b),c.formulaCollection.importAllFormulas(this.formulaStacks),c.filter()},i.UndoRedo.RowMoveAction=function(a,b){this.rows=a.slice(),this.target=b},m(i.UndoRedo.RowMoveAction,i.UndoRedo.Action),i.UndoRedo.RowMoveAction.prototype.undo=function(a,b){var c=a.getPlugin("manualRowMove");a.addHookOnce("afterRender",b);for(var d=this.rows[0]<this.target?-1*this.rows.length:0,e=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],f=[],g=this.rows.length+d,h=d;h<g;h++)f.push(this.target+h);c.moveRows(f.slice(),e),a.render(),a.selection.setRangeStartOnly(new WalkontableCellCoords(this.rows[0],0)),a.selection.setRangeEnd(new WalkontableCellCoords(this.rows[this.rows.length-1],a.countCols()-1))},i.UndoRedo.RowMoveAction.prototype.redo=function(a,b){var c=a.getPlugin("manualRowMove");a.addHookOnce("afterRender",b),c.moveRows(this.rows.slice(),this.target),a.render();var d=this.rows[0]<this.target?this.target-this.rows.length:this.target;a.selection.setRangeStartOnly(new WalkontableCellCoords(d,0)),a.selection.setRangeEnd(new WalkontableCellCoords(d+this.rows.length-1,a.countCols()-1))},i.hooks.add("afterInit",p),i.hooks.add("afterUpdateSettings",p),i.hooks.register("beforeUndo"),i.hooks.register("afterUndo"),i.hooks.register("beforeRedo"),i.hooks.register("afterRedo")},{browser:24,"helpers/array":43,"helpers/dom/event":48,"helpers/number":52,"helpers/object":53}],118:[function(a,b,c){"use strict";function i(a,b){var c;h[a]=b,c=g(a)+"Renderer",f.renderers[c]=b,f[c]=b,"base"===a&&(f.renderers.cellDecorator=b)}function j(a){if("function"==typeof a)return a;if("string"!=typeof a)throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(a in h))throw Error('No editor registered under name "'+a+'"');return h[a]}function k(a){return a in h}Object.defineProperties(c,{registerRenderer:{get:function(){return i}},getRenderer:{get:function(){return j}},hasRenderer:{get:function(){return k}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("helpers/string"))&&e.__esModule&&e||{default:e}).toUpperCaseFirst,h={};f.renderers=f.renderers||{},f.renderers.registerRenderer=i,f.renderers.getRenderer=j},{browser:24,"helpers/string":55}],119:[function(a,b,c){"use strict";function j(a,b,c,d,e,f,i){i.className&&(b.className?b.className=b.className+" "+i.className:b.className=i.className),i.readOnly&&g(b,i.readOnlyCellClassName),!1===i.valid&&i.invalidCellClassName?g(b,i.invalidCellClassName):h(b,i.invalidCellClassName),!1===i.wordWrap&&i.noWordWrapClassName&&g(b,i.noWordWrapClassName),!f&&i.placeholder&&g(b,i.placeholderCellClassName)}Object.defineProperties(c,{cellDecorator:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.addClass,h=f.removeClass;(0,((e=a("renderers"))&&e.__esModule&&e||{default:e}).registerRenderer)("base",j)},{"helpers/dom/element":47,renderers:118}],120:[function(a,b,c){"use strict";function t(a,b,c,d,e,f,g){var k=(q.cloneNode(!0),r.cloneNode(!0));if(g.allowHtml?n("html").apply(this,arguments):n("text").apply(this,arguments),b.appendChild(k),i(b,"htAutocomplete"),b.firstChild||b.appendChild(document.createTextNode(String.fromCharCode(160))),!a.acArrowListener){var m=l(a);a.acArrowListener=function(e){j(e.target,"htAutocompleteArrow")&&a.view.wt.getSetting("onCellDblClick",null,new p(c,d),b)},m.addEventListener(a.rootElement,"mousedown",a.acArrowListener),a.addHookOnce("afterDestroy",function(){m.destroy()})}}Object.defineProperties(c,{autocompleteRenderer:{get:function(){return t}},__esModule:{value:!0}});var d,e,f,g,h=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},i=h.addClass,j=h.hasClass,l=(h.empty,((e=a("eventManager"))&&e.__esModule&&e||{default:e}).eventManager),m=(f=a("renderers"))&&f.__esModule&&f||{default:f},n=m.getRenderer,o=m.registerRenderer,p=((g=a("3rdparty/walkontable/src/cell/coords"))&&g.__esModule&&g||{default:g}).WalkontableCellCoords,q=document.createElement("DIV");q.className="htAutocompleteWrapper";var r=document.createElement("DIV");r.className="htAutocompleteArrow",r.appendChild(document.createTextNode(String.fromCharCode(9660)));o("autocomplete",t)},{"3rdparty/walkontable/src/cell/coords":6,eventManager:42,"helpers/dom/element":47,renderers:118}],121:[function(a,b,c){"use strict";function B(a,b,c,d,e,f,g){function q(a){var b="SPACE|ENTER",c="DELETE|BACKSPACE",d=u(t,a.keyCode);d(b+"|"+c)&&!x(a)&&v(function(){w(a),a.preventDefault()}),d(b)&&s(),d(c)&&s(!0)}function s(){var b=void 0!==arguments[0]&&arguments[0],c=a.getSelectedRange();if(c){for(var d=c.getTopLeftCorner(),e=c.getBottomRightCorner(),f=[],g=d.row;g<=e.row;g+=1)for(var h=d.col;h<=e.col;h+=1){var i=a.getCellMeta(g,h);if("checkbox"!==i.type)return;if(!0!==i.readOnly){void 0===i.checkedTemplate&&(i.checkedTemplate=!0),void 0===i.uncheckedTemplate&&(i.uncheckedTemplate=!1);var j=a.getDataAtCell(g,h);!1===b?j===i.checkedTemplate?f.push([g,h,i.uncheckedTemplate]):-1!==[i.uncheckedTemplate,null,void 0].indexOf(j)&&f.push([g,h,i.checkedTemplate]):f.push([g,h,i.uncheckedTemplate])}}f.length>0&&a.setDataAtCell(f)}}function v(b){var c=a.getSelectedRange();if(c)for(var d=c.getTopLeftCorner(),e=c.getBottomRightCorner(),f=d.row;f<=e.row;f++)for(var g=d.col;g<=e.col;g++){var h=a.getCellMeta(f,g);if("checkbox"!==h.type)return;var i=a.getCell(f,g);if(null==i)b(f,g,h);else{var j=i.querySelectorAll("input[type=checkbox]");j.length>0&&!h.readOnly&&b(j)}}}r("base").apply(this,arguments);var i=(C(a),D()),j=g.label,k=!1;if(void 0===g.checkedTemplate&&(g.checkedTemplate=!0),void 0===g.uncheckedTemplate&&(g.uncheckedTemplate=!1),l(b),f===g.checkedTemplate||o(f,g.checkedTemplate)?i.checked=!0:f===g.uncheckedTemplate||o(f,g.uncheckedTemplate)?i.checked=!1:null===f?m(i,"noValue"):(i.style.display="none",m(i,A),k=!0),i.setAttribute("data-row",c),i.setAttribute("data-col",d),!k&&j){var n="";j.value?n="function"==typeof j.value?j.value.call(this,c,d,e,f):j.value:j.property&&(n=a.getDataAtRowProp(c,j.property));if (isNaN(n)) { n = n.replace(/<[^>]*href[^>]*>|<\/a>/g, ""); }var p=E(n);"before"===j.position?p.appendChild(i):p.insertBefore(i,p.firstChild),i=p}b.appendChild(i),k&&b.appendChild(document.createTextNode("#bad-value#")),y.has(a)||(y.set(a,!0),a.addHook("beforeKeyDown",q))}function C(a){var b=z.get(a);return b||(b=new p(a),b.addEventListener(a.rootElement,"click",function(b){return G(b,a)}),b.addEventListener(a.rootElement,"mouseup",function(b){return F(b,a)}),b.addEventListener(a.rootElement,"change",function(b){return H(b,a)}),z.set(a,b)),b}function D(){var a=document.createElement("input");return a.className="htCheckboxRendererInput",a.type="checkbox",a.setAttribute("autocomplete","off"),a.setAttribute("tabindex","-1"),a.cloneNode(!1)}function E(a){var b=document.createElement("label");return b.className="htCheckboxRendererLabel",b.appendChild(document.createTextNode(a)),b.cloneNode(!0)}function F(a,b){I(a.target)&&setTimeout(b.listen,10)}function G(a,b){if(!I(a.target))return!1;var c=parseInt(a.target.getAttribute("data-row"),10),d=parseInt(a.target.getAttribute("data-col"),10);b.getCellMeta(c,d).readOnly&&a.preventDefault()}function H(a,b){if(!I(a.target))return!1;var c=parseInt(a.target.getAttribute("data-row"),10),d=parseInt(a.target.getAttribute("data-col"),10),e=b.getCellMeta(c,d);if(!e.readOnly){var f=null;f=a.target.checked?void 0===e.checkedTemplate||e.checkedTemplate:void 0!==e.uncheckedTemplate&&e.uncheckedTemplate,b.setDataAtCell(c,d,f)}}function I(a){return"INPUT"===a.tagName&&"checkbox"===a.getAttribute("type")}Object.defineProperties(c,{checkboxRenderer:{get:function(){return B}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},l=k.empty,m=k.addClass,o=(k.hasClass,((e=a("helpers/string"))&&e.__esModule&&e||{default:e}).equalsIgnoreCase),p=((f=a("eventManager"))&&f.__esModule&&f||{default:f}).EventManager,q=(g=a("renderers"))&&g.__esModule&&g||{default:g},r=q.getRenderer,s=q.registerRenderer,t=((h=a("helpers/unicode"))&&h.__esModule&&h||{default:h}).isKey,u=((i=a("helpers/function"))&&i.__esModule&&i||{default:i}).partial,v=(j=a("helpers/dom/event"))&&j.__esModule&&j||{default:j},w=v.stopImmediatePropagation,x=v.isImmediatePropagationStopped,y=new WeakMap,z=new WeakMap,A="htBadValue";s("checkbox",B)},{eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/string":55,"helpers/unicode":56,renderers:118}],122:[function(a,b,c){"use strict";function j(a,b,c,d,e,g,i){h("base").apply(this,arguments),null!==g&&void 0!==g||(g=""),f(b,g)}Object.defineProperties(c,{htmlRenderer:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).fastInnerHTML,g=(e=a("renderers"))&&e.__esModule&&e||{default:e},h=g.getRenderer;(0,g.registerRenderer)("html",j)},{"helpers/dom/element":47,renderers:118}],123:[function(a,b,c){"use strict";function l(a,b,c,d,e,f,h){if(k(f)){void 0!==h.language&&g.culture(h.language),f=g(f).format(h.format||"0");var j=h.className||"",l=j.length?j.split(" "):[];l.indexOf("htLeft")<0&&l.indexOf("htCenter")<0&&l.indexOf("htRight")<0&&l.indexOf("htJustify")<0&&l.push("htRight"),l.indexOf("htNumeric")<0&&l.push("htNumeric"),h.className=l.join(" ")}i("text")(a,b,c,d,e,f,h)}Object.defineProperties(c,{numericRenderer:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g=((d=a("numbro"))&&d.__esModule&&d||{default:d}).default,h=(e=a("renderers"))&&e.__esModule&&e||{default:e},i=h.getRenderer,j=h.registerRenderer,k=((f=a("helpers/number"))&&f.__esModule&&f||{default:f}).isNumeric;j("numeric",l)},{"helpers/number":52,numbro:"numbro",renderers:118}],124:[function(a,b,c){"use strict";function j(a,b,c,d,e,g,i){h("text").apply(this,arguments),g=b.innerHTML;var j,k=i.hashLength||g.length,l=i.hashSymbol||"*";for(j="";j.split(l).length-1<k;j+=l);f(b,j)}Object.defineProperties(c,{passwordRenderer:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=((d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d}).fastInnerHTML,g=(e=a("renderers"))&&e.__esModule&&e||{default:e},h=g.getRenderer;(0,g.registerRenderer)("password",j)},{"helpers/dom/element":47,renderers:118}],125:[function(a,b,c){"use strict";function n(a,b,c,d,e,f,g){l("base").apply(this,arguments),!f&&g.placeholder&&(f=g.placeholder);var k=j(f);if(a.getSettings().trimWhitespace||(k=k.replace(/ /g,String.fromCharCode(160))),g.rendererTemplate){h(b);var m=document.createElement("TEMPLATE");m.setAttribute("bind","{{}}"),m.innerHTML=g.rendererTemplate,HTMLTemplateElement.decorate(m),m.model=a.getSourceDataAtRow(c),b.appendChild(m)}else i(b,k)}Object.defineProperties(c,{textRenderer:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g=(d=a("helpers/dom/element"))&&d.__esModule&&d||{default:d},h=g.empty,i=g.fastInnerText,j=((e=a("helpers/mixed"))&&e.__esModule&&e||{default:e}).stringify,k=(f=a("renderers"))&&f.__esModule&&f||{default:f},l=k.getRenderer;(0,k.registerRenderer)("text",n)},{"helpers/dom/element":47,"helpers/mixed":51,renderers:118}],126:[function(a,b,c){!function(a){"use strict";function l(a){return{configurable:!0,enumerable:!1,value:a,writable:!0}}function o(){return"__$"+Math.floor(1e9*Math.random())+"$"+ ++n+"$__"}function u(a){return t[a]}function v(){var a=o();return t[a]=!0,a}function w(a){return"object"==typeof a&&a instanceof z}function x(a){return w(a)?"symbol":typeof a}function y(a){var b=new z(a);if(!(this instanceof y))return b;throw new TypeError("Symbol cannot be new'ed")}function z(a){var b=o();f(this,r,{value:this}),f(this,p,{value:b}),f(this,q,{value:a}),F(this),s[b]=this}function E(a){var b=a[A];return b&&b.self===a?b:k(a)?(C.hash.value=D++,C.self.value=a,B.value=d(null,C),f(a,A,B),B.value):void 0}function F(a){return E(a),g.apply(this,arguments)}function G(a){return s[a]||t[a]}function H(a){return w(a)?a[p]:a}function I(a){for(var b=[],c=i(a),d=0;d<c.length;d++){var e=s[c[d]];e&&b.push(e)}return b}function J(b){return a.traceur&&a.traceur.options[b]}function K(a){for(var b=1;b<arguments.length;b++)for(var c=i(arguments[b]),d=0;d<c.length;d++){var e=c[d];G(e)||function(b,c){f(a,c,{get:function(){return b[c]},enumerable:!0})}(arguments[b],c[d])}return a}function L(a){return null!=a&&("object"==typeof a||"function"==typeof a)}function M(a){if(null==a)throw c();return b(a)}function N(a){if(null==a)throw new TypeError("Value cannot be converted to an Object");return a}function O(a,b){a.Symbol||(a.Symbol=b,Object.getOwnPropertySymbols=I),a.Symbol.iterator||(a.Symbol.iterator=b("Symbol.iterator"))}function P(a){O(a,y),a.Reflect=a.Reflect||{},a.Reflect.global=a.Reflect.global||a}if(!a.$traceurRuntime){var b=Object,c=TypeError,d=b.create,e=b.defineProperties,f=b.defineProperty,g=b.freeze,h=b.getOwnPropertyDescriptor,i=b.getOwnPropertyNames,j=b.keys,k=Object.isExtensible,m=l,n=0,p=o(),q=o(),r=o(),s=d(null),t=d(null);f(y.prototype,"constructor",l(y)),f(y.prototype,"toString",m(function(){var a=this[r];if(!J("symbols"))return a[p];if(!a)throw TypeError("Conversion from symbol to string");var b=a[q];return void 0===b&&(b=""),"Symbol("+b+")"})),f(y.prototype,"valueOf",m(function(){var a=this[r];if(!a)throw TypeError("Conversion from symbol to string");return J("symbols")?a:a[p]})),f(z.prototype,"constructor",l(y)),f(z.prototype,"toString",{value:y.prototype.toString,enumerable:!1}),f(z.prototype,"valueOf",{value:y.prototype.valueOf,enumerable:!1});var A=v(),B={value:void 0},C={hash:{value:void 0},self:{value:void 0}},D=0;F(z.prototype),P(a),a.$traceurRuntime={checkObjectCoercible:N,createPrivateName:v,defineProperties:e,defineProperty:f,exportStar:K,getOwnHashObject:E,getOwnPropertyDescriptor:h,getOwnPropertyNames:i,isObject:L,isPrivateName:u,isSymbolString:G,keys:j,setupGlobals:P,toObject:M,toProperty:H,typeof:x}}}(window),function(){"use strict";function b(){for(var d,b=[],c=0,e=0;e<arguments.length;e++){var f=$traceurRuntime.checkObjectCoercible(arguments[e]);"function"!=typeof f[a(Symbol.iterator)]&&(f[a(Symbol.iterator)]=function(){var a=this,b=a.length,c=0;return{next:function(){var d={done:!0};return c<b&&(d.done=!1,d.value=a[c],++c),d}}});for(var g=f[a(Symbol.iterator)]();!(d=g.next()).done;)b[c++]=d.value}return b}var a=$traceurRuntime.toProperty;$traceurRuntime.spread=b}(),function(){"use strict";function l(a,b){var c=g(a);do{var d=f(c,b);if(d)return d;c=g(c)}while(c)}function m(a){return a.__proto__}function n(a,b,c,d){return o(a,b,c).apply(a,d)}function o(a,b,c){var d=l(b,c);if(d)return d.get?d.get.call(a):d.value}function p(a,c,d,e){var f=l(c,d);if(f&&f.set)return f.set.call(a,e),e;throw b("super has no setter '"+d+"'.")}function q(a){for(var b={},c=j(a),d=0;d<c.length;d++){var e=c[d];b[e]=f(a,e)}for(var g=k(a),d=0;d<g.length;d++){var i=g[d];b[h(i)]=f(a,h(i))}return b}function r(a,b,f,g){return e(b,"constructor",{value:a,configurable:!0,enumerable:!1,writable:!0}),arguments.length>3?("function"==typeof g&&(a.__proto__=g),a.prototype=c(s(g),q(b))):a.prototype=b,e(a,"prototype",{configurable:!1,writable:!1}),d(a,q(f))}function s(c){if("function"==typeof c){var d=c.prototype;if(a(d)===d||null===d)return c.prototype;throw new b("super prototype must be an Object or null")}if(null===c)return null;throw new b("Super expression must either be null or a function, not "+typeof c+".")}function t(a,b,c){null!==g(b)&&n(a,b,"constructor",c)}var a=Object,b=TypeError,c=a.create,d=$traceurRuntime.defineProperties,e=$traceurRuntime.defineProperty,f=$traceurRuntime.getOwnPropertyDescriptor,g=Object.getPrototypeOf,h=$traceurRuntime.toProperty,i=Object,j=i.getOwnPropertyNames,k=i.getOwnPropertySymbols;$traceurRuntime.createClass=r,$traceurRuntime.defaultSuperCall=t,$traceurRuntime.superCall=n,$traceurRuntime.superConstructor=m,$traceurRuntime.superGet=o,$traceurRuntime.superSet=p}()},{}],127:[function(a,b,c){"use strict";function H(a){var b=this,c=this;this.eventManager=y(a),this.instance=a,this.settings=a.getSettings(),this.selectionMouseDown=!1;var d=a.rootElement.getAttribute("style");d&&a.rootElement.setAttribute("data-originalstyle",d),n(a.rootElement,"handsontable");var e=document.createElement("TABLE");n(e,"htCore"),a.getSettings().tableClassName&&n(e,a.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),e.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),e.appendChild(this.TBODY),a.table=e,a.container.insertBefore(e,a.container.firstChild),this.eventManager.addEventListener(a.rootElement,"mousedown",function(a){this.selectionMouseDown=!0,c.isTextSelectionAllowed(a.target)||(g(),a.preventDefault(),window.focus())}),this.eventManager.addEventListener(a.rootElement,"mouseup",function(a){this.selectionMouseDown=!1}),this.eventManager.addEventListener(a.rootElement,"mousemove",function(a){this.selectionMouseDown&&!c.isTextSelectionAllowed(a.target)&&(g(),a.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(b){a.selection.isInProgress()&&!b.shiftKey&&a.selection.finish()});var f;this.isMouseDown=function(){return f},this.eventManager.addEventListener(document.documentElement,"mouseup",function(b){a.selection.isInProgress()&&1===b.which&&a.selection.finish(),f=!1,v(document.activeElement)&&a.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(b){var d=b.target,e=b.target,g=b.x||b.clientX,h=b.y||b.clientY;if(!f&&a.rootElement){if(e===a.view.wt.wtTable.holder){var i=r();if(document.elementFromPoint(g+i,h)!==a.view.wt.wtTable.holder||document.elementFromPoint(g,h+i)!==a.view.wt.wtTable.holder)return}else for(;e!==document.documentElement;){if(null===e){if(b.isTargetWebComponent)break;return}if(e===a.rootElement)return;e=e.parentNode}("function"==typeof c.settings.outsideClickDeselects?c.settings.outsideClickDeselects(d):c.settings.outsideClickDeselects)?a.deselectCell():a.destroyEditor()}}),this.eventManager.addEventListener(e,"selectstart",function(a){c.settings.fragmentSelection||u(a.target)||a.preventDefault()});var g=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},h=[new F({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return c.settings.fillHandle&&!c.isCellEdited()&&!a.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!c.isCellEdited()&&!a.selection.isMultiple()}}}),new F({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return c.settings.fillHandle&&!c.isCellEdited()&&a.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!c.isCellEdited()&&a.selection.isMultiple()}}}),new F({className:"highlight",highlightHeaderClassName:c.settings.currentHeaderClassName,highlightRowClassName:c.settings.currentRowClassName,highlightColumnClassName:c.settings.currentColClassName}),new F({className:"fill",border:{width:1,color:"red"}})];h.current=h[0],h.area=h[1],h.highlight=h[2],h.fill=h[3];var i={debug:function(){return c.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e,preventOverflow:function(){return b.settings.preventOverflow},stretchH:function(){return c.settings.stretchH},data:a.getDataAtCell,totalRows:function(){return a.countRows()},totalColumns:function(){return a.countCols()},fixedColumnsLeft:function(){return c.settings.fixedColumnsLeft},fixedRowsTop:function(){return c.settings.fixedRowsTop},fixedRowsBottom:function(){return c.settings.fixedRowsBottom},minSpareRows:function(){return c.settings.minSpareRows},renderAllRows:c.settings.renderAllRows,rowHeaders:function(){var b=[];return a.hasRowHeaders()&&b.push(function(a,b){c.appendRowHeader(a,b)}),l.hooks.run(a,"afterGetRowHeaderRenderers",b),b},columnHeaders:function(){var b=[];return a.hasColHeaders()&&b.push(function(a,b){c.appendColHeader(a,b)}),l.hooks.run(a,"afterGetColumnHeaderRenderers",b),b},columnWidth:a.getColWidth,rowHeight:a.getRowHeight,cellRenderer:function(a,b,d){var e=c.instance.getCellMeta(a,b),f=c.instance.colToProp(b),g=c.instance.getDataAtRowProp(a,f);c.instance.hasHook("beforeValueRender")&&(g=c.instance.runHooks("beforeValueRender",g)),c.instance.runHooks("beforeRenderer",d,a,b,f,g,e),c.instance.getCellRenderer(e)(c.instance,d,a,b,f,g,e),c.instance.runHooks("afterRenderer",d,a,b,f,g,e)},selections:h,hideBorderOnMouseDownOver:function(){return c.settings.fragmentSelection},onCellMouseDown:function(b,d,e,g){var h={row:!1,column:!1,cells:!1};if(a.listen(),c.activeWt=g,f=!0,l.hooks.run(a,"beforeOnCellMouseDown",b,d,e,h),!B(b)){var i=a.getSelectedRange(),j=a.selection,k=j.selectedHeader;if(b.shiftKey&&i)d.row>=0&&d.col>=0&&!h.cells?(j.setSelectedHeaders(!1,!1),j.setRangeEnd(d)):(k.cols||k.rows)&&d.row>=0&&d.col>=0&&!h.cells?(j.setSelectedHeaders(!1,!1),j.setRangeEnd(new E(d.row,d.col))):k.cols&&d.row<0&&!h.column?j.setRangeEnd(new E(i.to.row,d.col)):k.rows&&d.col<0&&!h.row?j.setRangeEnd(new E(d.row,i.to.col)):(!k.cols&&!k.rows&&d.col<0||k.cols&&d.col<0)&&!h.row?(j.setSelectedHeaders(!0,!1),j.setRangeStartOnly(new E(i.from.row,0)),j.setRangeEnd(new E(d.row,a.countCols()-1))):(!k.cols&&!k.rows&&d.row<0||k.rows&&d.row<0)&&!h.column&&(j.setSelectedHeaders(!1,!0),j.setRangeStartOnly(new E(0,i.from.col)),j.setRangeEnd(new E(a.countRows()-1,d.col)));else{var m=!0;if(i){var n=i,o=n.from,p=n.to,q=!j.inInSelection(d);if(d.row<0&&k.cols){var r=Math.min(o.col,p.col),s=Math.max(o.col,p.col);m=d.col<r||d.col>s}else if(d.col<0&&k.rows){var t=Math.min(o.row,p.row),u=Math.max(o.row,p.row);m=d.row<t||d.row>u}else m=q}var v=C(b),w=D(b)||"touchstart"===b.type;d.row<0&&d.col>=0&&!h.column?(j.setSelectedHeaders(!1,!0),(w||v&&m)&&(j.setRangeStartOnly(new E(0,d.col)),j.setRangeEnd(new E(Math.max(a.countRows()-1,0),d.col),!1))):d.col<0&&d.row>=0&&!h.row?(j.setSelectedHeaders(!0,!1),(w||v&&m)&&(j.setRangeStartOnly(new E(d.row,0)),j.setRangeEnd(new E(d.row,Math.max(a.countCols()-1,0)),!1))):d.col>=0&&d.row>=0&&!h.cells?(w||v&&m)&&(j.setSelectedHeaders(!1,!1),j.setRangeStart(d)):d.col<0&&d.row<0&&(d.row=0,d.col=0,j.setSelectedHeaders(!1,!1,!0),j.setRangeStart(d))}l.hooks.run(a,"afterOnCellMouseDown",b,d,e),c.activeWt=c.wt}},onCellMouseOut:function(b,d,e,f){c.activeWt=f,l.hooks.run(a,"beforeOnCellMouseOut",b,d,e),B(b)||(l.hooks.run(a,"afterOnCellMouseOut",b,d,e),c.activeWt=c.wt)},onCellMouseOver:function(b,d,e,g){var h={row:!1,column:!1,cell:!1};c.activeWt=g,l.hooks.run(a,"beforeOnCellMouseOver",b,d,e,h),B(b)||(0===b.button&&f&&(d.row>=0&&d.col,a.selection.selectedHeader.cols&&!h.column?a.selection.setRangeEnd(new E(a.countRows()-1,d.col),!1):a.selection.selectedHeader.rows&&!h.row?a.selection.setRangeEnd(new E(d.row,a.countCols()-1),!1):h.cell||a.selection.setRangeEnd(d)),l.hooks.run(a,"afterOnCellMouseOver",b,d,e),c.activeWt=c.wt)},onCellMouseUp:function(b,d,e,f){c.activeWt=f,l.hooks.run(a,"beforeOnCellMouseUp",b,d,e),l.hooks.run(a,"afterOnCellMouseUp",b,d,e),c.activeWt=c.wt},onCellCornerMouseDown:function(b){b.preventDefault(),l.hooks.run(a,"afterOnCellCornerMouseDown",b)},onCellCornerDblClick:function(b){b.preventDefault(),l.hooks.run(a,"afterOnCellCornerDblClick",b)},beforeDraw:function(a,b){c.beforeRender(a,b)},onDraw:function(a){c.onDraw(a)},onScrollVertically:function(){a.runHooks("afterScrollVertically")},onScrollHorizontally:function(){a.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(b,c){a.runHooks("beforeDrawBorders",b,c)},onBeforeTouchScroll:function(){a.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){a.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(b,c){return a.runHooks("beforeStretchingColumnWidth",b,c)},onModifyRowHeaderWidth:function(b){return a.runHooks("modifyRowHeaderWidth",b)},viewportRowCalculatorOverride:function(b){var d=a.countRows(),e=c.settings.viewportRowRenderingOffset;if("auto"===e&&c.settings.fixedRowsTop&&(e=10),"number"==typeof e&&(b.startRow=Math.max(b.startRow-e,0),b.endRow=Math.min(b.endRow+e,d-1)),"auto"===e){var f=b.startRow+b.endRow-b.startRow,g=Math.ceil(f/d*12);b.startRow=Math.max(b.startRow-g,0),b.endRow=Math.min(b.endRow+g,d-1)}a.runHooks("afterViewportRowCalculatorOverride",b)},viewportColumnCalculatorOverride:function(b){var d=a.countCols(),e=c.settings.viewportColumnRenderingOffset;if("auto"===e&&c.settings.fixedColumnsLeft&&(e=10),"number"==typeof e&&(b.startColumn=Math.max(b.startColumn-e,0),b.endColumn=Math.min(b.endColumn+e,d-1)),"auto"===e){var f=b.startColumn+b.endColumn-b.startColumn,g=Math.ceil(f/d*12);b.startRow=Math.max(b.startColumn-g,0),b.endColumn=Math.min(b.endColumn+g,d-1)}a.runHooks("afterViewportColumnCalculatorOverride",b)},rowHeaderWidth:function(){return c.settings.rowHeaderWidth},columnHeaderHeight:function(){var b=a.runHooks("modifyColumnHeaderHeight");return c.settings.columnHeaderHeight||b}};l.hooks.run(a,"beforeInitWalkontable",i),this.wt=new G(i),this.activeWt=this.wt,this.eventManager.addEventListener(c.wt.wtTable.spreader,"mousedown",function(a){a.target===c.wt.wtTable.spreader&&3===a.which&&A(a)}),this.eventManager.addEventListener(c.wt.wtTable.spreader,"contextmenu",function(a){a.target===c.wt.wtTable.spreader&&3===a.which&&A(a)}),this.eventManager.addEventListener(document.documentElement,"click",function(){c.settings.observeDOMVisibility&&c.wt.drawInterrupted&&(c.instance.forceFullRender=!0,c.render())})}Object.defineProperties(c,{TableView:{get:function(){return H}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,m=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},n=m.addClass,o=m.empty,p=m.fastInnerHTML,q=m.fastInnerText,r=m.getScrollbarWidth,s=m.hasClass,t=m.isChildOf,u=m.isInput,v=m.isOutsideInput,y=(m.removeClass,(f=a("helpers/object"))&&f.__esModule,((g=a("eventManager"))&&g.__esModule&&g||{default:g}).eventManager),z=(h=a("helpers/dom/event"))&&h.__esModule&&h||{default:h},A=z.stopPropagation,B=z.isImmediatePropagationStopped,C=z.isRightClick,D=z.isLeftClick,E=((i=a("3rdparty/walkontable/src/cell/coords"))&&i.__esModule&&i||{default:i}).WalkontableCellCoords,F=((j=a("3rdparty/walkontable/src/selection"))&&j.__esModule&&j||{default:j}).WalkontableSelection,G=((k=a("3rdparty/walkontable/src/core"))&&k.__esModule&&k||{default:k}).Walkontable;l.TableView=H,H.prototype.isTextSelectionAllowed=function(a){if(u(a))return!0;var b=t(a,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!b)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!b)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))},H.prototype.isSelectedOnlyCell=function(){var a=this.instance.getSelected()||[],b=a[0],c=a[1],d=a[2],e=a[3];return void 0!==b&&b===d&&c===e},H.prototype.isCellEdited=function(){var a=this.instance.getActiveEditor();return a&&a.isOpened()},H.prototype.beforeRender=function(a,b){a&&l.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender,b)},H.prototype.onDraw=function(a){a&&l.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},H.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},H.prototype.getCellAtCoords=function(a,b){var c=this.wt.getCell(a,b);return c<0?null:c},H.prototype.scrollViewport=function(a){this.wt.scrollViewport(a)},H.prototype.appendRowHeader=function(a,b){if(b.firstChild){var c=b.firstChild;if(!s(c,"relative"))return o(b),void this.appendRowHeader(a,b);this.updateCellHeader(c.querySelector(".rowHeader"),a,this.instance.getRowHeader)}else{var d=document.createElement("div"),e=document.createElement("span");d.className="relative",e.className="rowHeader",this.updateCellHeader(e,a,this.instance.getRowHeader),d.appendChild(e),b.appendChild(d)}l.hooks.run(this.instance,"afterGetRowHeader",a,b)},H.prototype.appendColHeader=function(a,b){if(b.firstChild){var c=b.firstChild;s(c,"relative")?this.updateCellHeader(c.querySelector(".colHeader"),a,this.instance.getColHeader):(o(b),this.appendColHeader(a,b))}else{var d=document.createElement("div"),e=document.createElement("span");d.className="relative",e.className="colHeader",this.updateCellHeader(e,a,this.instance.getColHeader),d.appendChild(e),b.appendChild(d)}l.hooks.run(this.instance,"afterGetColHeader",a,b)},H.prototype.updateCellHeader=function(a,b,c){var d=b,e=this.wt.wtOverlays.getParentOverlay(a)||this.wt;a.parentNode&&(s(a,"colHeader")?d=e.wtTable.columnFilter.sourceToRendered(b):s(a,"rowHeader")&&(d=e.wtTable.rowFilter.sourceToRendered(b))),d>-1?p(a,c(b)):(q(a,String.fromCharCode(160)),n(a,"cornerHeader"))},H.prototype.maximumVisibleElementWidth=function(a){var b=this.wt.wtViewport.getWorkspaceWidth(),c=b-a;return c>0?c:0},H.prototype.maximumVisibleElementHeight=function(a){var b=this.wt.wtViewport.getWorkspaceHeight(),c=b-a;return c>0?c:0},H.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},H.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()}},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/core":8,"3rdparty/walkontable/src/selection":19,browser:24,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53}],128:[function(a,b,c){"use strict";Object.defineProperties(c,{NodeStructure:{get:function(){return f}},LinkedList:{get:function(){return g}},__esModule:{value:!0}});var d,e=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,f=function(b){this.data=b,this.next=null,this.prev=null};$traceurRuntime.createClass(f,{},{});var g=function(){this.first=null,this.last=null};$traceurRuntime.createClass(g,{push:function(a){var b=new f(a);if(null===this.first)this.first=this.last=b;else{var c=this.last;this.last=b,b.prev=c,c.next=b}},unshift:function(a){var b=new f(a);if(null===this.first)this.first=this.last=b;else{var c=this.first;this.first=b,b.next=c,c.prev=b}},inorder:function(a){for(var b=this.first;b;)a(b),b=b.next},remove:function(a){if(null===this.first)return!1;for(var c,d,b=this.first;b;){if(b.data===a)return c=b.next,d=b.prev,c&&(c.prev=d),d&&(d.next=c),b===this.first&&(this.first=c),b===this.last&&(this.last=d),!0;b=b.next}return!1},hasCycle:function(){for(var a=this.first,b=this.first;;){if(null===a)return!1;if(null===(a=a.next))return!1;if(a=a.next,b=b.next,a===b)return!0}},pop:function(){if(null===this.last)return null;var a=this.last;return this.last=this.last.prev,a},shift:function(){if(null===this.first)return null;var a=this.first;return this.first=this.first.next,a},recursiveReverse:function(){function a(b,c){c&&(a(c,c.next),c.next=b)}if(this.first){a(this.first,this.first.next),this.first.next=null;var b=this.first;this.first=this.last,this.last=b}},reverse:function(){if(this.first&&this.first.next){for(var c,a=this.first.next,b=this.first;a;)c=a.next,a.next=b,b.prev=a,b=a,a=c;this.first.next=null,this.last.prev=null,c=this.first,this.first=b,this.last=c}}},{}),e.utils.NodeStructure=f,e.utils.LinkedList=g},{browser:24}],129:[function(a,b,c){"use strict";Object.defineProperties(c,{Stack:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,f=function(){var b=void 0!==arguments[0]?arguments[0]:[];this.items=b};$traceurRuntime.createClass(f,{push:function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];(a=this.items).push.apply(a,$traceurRuntime.spread(b))},pop:function(){return this.items.pop()},peek:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]},isEmpty:function(){return!this.size()},size:function(){return this.items.length}},{}),e.utils.Stack=f},{browser:24}],130:[function(a,b,c){"use strict";Object.defineProperties(c,{GhostTable:{get:function(){return s}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,k=(e=a("helpers/dom/element"))&&e.__esModule&&e||{default:e},l=k.addClass,m=k.outerHeight,n=k.outerWidth,o=((f=a("helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,s=((g=a("helpers/object"))&&g.__esModule,(h=a("helpers/number"))&&h.__esModule,(i=a("helpers/mixed"))&&i.__esModule,function(b){this.hot=b,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}});$traceurRuntime.createClass(s,{addRow:function(a,b){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var c={row:a};this.rows.push(c),this.samples=b,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(a)),this.container.container.appendChild(this.table.fragment),c.table=this.table.table},addColumnHeadersRow:function(a){if(null!=this.hot.getColHeader(0)){var b={row:-1};this.rows.push(b),this.container=this.createContainer(this.hot.rootElement.className),this.samples=a,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),b.table=this.table.table}},addColumn:function(a,b){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var c={col:a};this.columns.push(c),this.samples=b,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(a)&&this.hot.view.appendColHeader(a,this.table.th),this.table.tBody.appendChild(this.createCol(a)),this.container.container.appendChild(this.table.fragment),c.table=this.table.table},getHeights:function(a){this.injected||this.injectTable(),o(this.rows,function(b){a(b.row,m(b.table)-1)})},getWidths:function(a){this.injected||this.injectTable(),o(this.columns,function(b){a(b.col,n(b.table))})},setSettings:function(a){this.settings=a},setSetting:function(a,b){this.settings||(this.settings={}),this.settings[a]=b},getSettings:function(){return this.settings},getSetting:function(a){return this.settings?this.settings[a]:null},createColGroupsCol:function(){var a=this,b=document,c=b.createDocumentFragment();return this.hot.hasRowHeaders()&&c.appendChild(this.createColElement(-1)),this.samples.forEach(function(b){o(b.strings,function(b){c.appendChild(a.createColElement(b.col))})}),c},createRow:function(a){var b=this,c=document,d=c.createDocumentFragment(),e=c.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(a,e),d.appendChild(e)),this.samples.forEach(function(e){o(e.strings,function(e){var f=e.col,g=b.hot.getCellMeta(a,f);g.col=f,g.row=a;var h=b.hot.getCellRenderer(g),i=c.createElement("td");h(b.hot,i,a,f,b.hot.colToProp(f),e.value,g),d.appendChild(i)})}),d},createColumnHeadersRow:function(){var a=this,b=document,c=b.createDocumentFragment();if(this.hot.hasRowHeaders()){var d=b.createElement("th");this.hot.view.appendColHeader(-1,d),c.appendChild(d)}return this.samples.forEach(function(d){o(d.strings,function(d){var e=d.col,f=b.createElement("th");a.hot.view.appendColHeader(e,f),c.appendChild(f)})}),c},createCol:function(a){var b=this,c=document,d=c.createDocumentFragment();return this.samples.forEach(function(e){o(e.strings,function(e){var f=e.row,g=b.hot.getCellMeta(f,a);g.col=a,g.row=f;var h=b.hot.getCellRenderer(g),i=c.createElement("td"),j=c.createElement("tr");h(b.hot,i,f,a,b.hot.colToProp(a),e.value,g),j.appendChild(i),d.appendChild(j)})}),d},clean:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()},injectTable:function(){var a=void 0!==arguments[0]?arguments[0]:null;this.injected||((a||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)},removeTable:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)},createColElement:function(a){var b=document,c=b.createElement("col");return c.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(a)+"px",c},createTable:function(){var a=void 0!==arguments[0]?arguments[0]:"",b=document,c=b.createDocumentFragment(),d=b.createElement("table"),e=b.createElement("thead"),f=b.createElement("tbody"),g=b.createElement("colgroup"),h=b.createElement("tr"),i=b.createElement("th");return this.isVertical()&&d.appendChild(g),this.isHorizontal()&&(h.appendChild(i),e.appendChild(h),d.style.tableLayout="auto",d.style.width="auto"),d.appendChild(e),this.isVertical()&&f.appendChild(h),d.appendChild(f),l(d,a),c.appendChild(d),{fragment:c,table:d,tHead:e,tBody:f,colGroup:g,tr:h,th:i}},createContainer:function(){var a=void 0!==arguments[0]?arguments[0]:"",b=document,c=b.createDocumentFragment(),d=b.createElement("div");return a="htGhostTable htAutoSize "+a.trim(),l(d,a),c.appendChild(d),{fragment:c,container:d}},isVertical:function(){return!(!this.rows.length||this.columns.length)},isHorizontal:function(){return!(!this.columns.length||this.rows.length)}},{}),j.utils.GhostTable=s},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],131:[function(a,b,c){"use strict";function l(a){return"string"==typeof a&&/fps$/.test(a)&&(a=1e3/parseInt(a.replace("fps","")||0,10)),a}Object.defineProperties(c,{Interval:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=(e=a("helpers/feature"))&&e.__esModule&&e||{default:e},h=g.requestAnimationFrame,i=g.cancelAnimationFrame,j=function(b,c){var d=this;this.timer=null,this.func=b,this.delay=l(c),this.stopped=!0,this._then=null,this._callback=function(){return d.__callback()}},k=j;$traceurRuntime.createClass(j,{start:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=h(this._callback)),this},stop:function(){return this.stopped||(this.stopped=!0,i(this.timer),this.timer=null),this},__callback:function(){if(this.timer=h(this._callback),this.delay){var a=Date.now(),b=a-this._then;b>this.delay&&(this._then=a-b%this.delay,this.func())}else this.func()}},{create:function(a,b){return new k(a,b)}}),f.utils.Interval=j},{browser:24,"helpers/feature":49}],132:[function(a,b,c){"use strict";function k(a,b){i.set(a,b)}function l(a){var b;if(!(a instanceof f.Core)){if(!i.has(a))throw Error("Record translator was not registered for this object identity");a=i.get(a)}return j.has(a)?b=j.get(a):(b=new h(a),j.set(a,b)),b}Object.defineProperties(c,{registerIdentity:{get:function(){return k}},getTranslator:{get:function(){return l}},__esModule:{value:!0}});var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("helpers/object"))&&e.__esModule&&e||{default:e}).isObject,h=function(b){this.hot=b};$traceurRuntime.createClass(h,{toVisualRow:function(a){return this.hot.runHooks("unmodifyRow",a)},toVisualColumn:function(a){return this.hot.runHooks("unmodifyCol",a)},toVisual:function(a,b){return g(a)?{row:this.toVisualRow(a.row),column:this.toVisualColumn(a.column)}:[this.toVisualRow(a),this.toVisualColumn(b)]},toPhysicalRow:function(a){return this.hot.runHooks("modifyRow",a)},toPhysicalColumn:function(a){return this.hot.runHooks("modifyCol",a)},toPhysical:function(a,b){return g(a)?{row:this.toPhysicalRow(a.row),column:this.toPhysicalColumn(a.column)}:[this.toPhysicalRow(a),this.toPhysicalColumn(b)]}},{});var i=new WeakMap,j=new WeakMap;f.utils.RecordTranslator=h,f.utils.RecordTranslatorUtils={registerIdentity:k,getTranslator:l}},{browser:24,"helpers/object":53}],133:[function(a,b,c){"use strict";var d;Object.defineProperties(c,{SamplesGenerator:{get:function(){return v}},__esModule:{value:!0}});var e,f,g,h,i,j,k=((e=a("browser"))&&e.__esModule&&e||{default:e}).default,l=(f=a("helpers/dom/element"))&&f.__esModule&&f||{default:f},q=(l.addClass,l.outerHeight,l.outerWidth,(g=a("helpers/array"))&&g.__esModule,(h=a("helpers/object"))&&h.__esModule&&h||{default:h}),s=(q.objectEach,q.isObject),t=((i=a("helpers/number"))&&i.__esModule&&i||{default:i}).rangeEach,u=((j=a("helpers/mixed"))&&j.__esModule&&j||{default:j}).stringify,v=function(b){this.samples=null,this.dataFactory=b,this.customSampleCount=null,this.allowDuplicates=!1},w=v;$traceurRuntime.createClass(v,(d={},Object.defineProperty(d,"getSampleCount",{value:function(){return this.customSampleCount?this.customSampleCount:w.SAMPLE_COUNT},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setSampleCount",{value:function(a){this.customSampleCount=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"setAllowDuplicates",{value:function(a){this.allowDuplicates=a},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"generateRowSamples",{value:function(a,b){return this.generateSamples("row",b,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"generateColumnSamples",{value:function(a,b){return this.generateSamples("col",b,a)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"generateSamples",{value:function(a,b,c){var d=this,e=new Map;return"number"==typeof c&&(c={from:c,to:c}),t(c.from,c.to,function(c){var f=d.generateSample(a,b,c);e.set(c,f)}),e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,"generateSample",{value:function(a,b,c){var g,d=this,e=new Map,f=[];return t(b.from,b.to,function(b){var h,i;if("row"===a)i=d.dataFactory(c,b);else{if("col"!==a)throw new Error("Unsupported sample type");i=d.dataFactory(b,c)}g=s(i)?Object.keys(i).length:Array.isArray(i)?i.length:u(i).length,e.has(g)||e.set(g,{needed:d.getSampleCount(),strings:[]});var j=e.get(g);if(j.needed){if(!(f.indexOf(i)>-1)||d.allowDuplicates){var l="row"===a?"col":"row";j.strings.push((h={},Object.defineProperty(h,"value",{value:i,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(h,l,{value:b,configurable:!0,enumerable:!0,writable:!0}),h)),f.push(i),j.needed--}}}),e},configurable:!0,enumerable:!0,writable:!0}),d),{get SAMPLE_COUNT(){return 3}}),k.utils.SamplesGenerator=v},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],134:[function(a,b,c){"use strict";function i(a){var b=void 0!==arguments[1]?arguments[1]:h,c=void 0!==arguments[2]?arguments[2]:0,d=void 0!==arguments[3]?arguments[3]:a.length;if(Math.abs(d-c)<=1)return[];var e=Math.ceil((c+d)/2);return i(a,b,c,e),i(a,b,e,d),j(a,b,c,e,d)}function j(a,b,c,d,e){for(var g=new f,h=new f,i=d-c,j=e-d,k=Math.max(i,j),l=e-c,m=0;m<k;m+=1)m<i&&g.push(a[c+m]),m<j&&h.push(a[d+m]);for(var n=0;n<l;)g.first&&h.first?b(g.first.data,h.first.data)>0?a[c+n]=h.shift().data:a[c+n]=g.shift().data:g.first?a[c+n]=g.shift().data:a[c+n]=h.shift().data,n+=1;return a}Object.defineProperties(c,{mergeSort:{get:function(){return i}},__esModule:{value:!0}});var d,e,f=((d=a("../dataStructures/linkedList"))&&d.__esModule&&d||{default:d}).LinkedList,h=function(a,b){var c=a.toString(),d=b.toString();return c===d?0:c<d?-1:1};((e=a("browser"))&&e.__esModule&&e||{default:e}).default.utils.mergeSort=i},{"../dataStructures/linkedList":128,browser:24}],135:[function(a,b,c){"use strict";function h(a,b){var c=a;return function(a){for(var d=!1,e=0,f=a.length;e<f;e++)if(c===a[e]){d=!0;break}b(d)}}var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default;(e=a("helpers/mixed"))&&e.__esModule;f.AutocompleteValidator=function(a,b){if(null==a&&(a=""),this.allowEmpty&&""===a)return void b(!0);this.strict&&this.source?"function"==typeof this.source?this.source(a,h(a,b)):h(a,b)(this.source):b(!0)}},{browser:24,"helpers/mixed":51}],136:[function(a,b,c){"use strict";var d,e,f,g,h=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,i=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,j=((f=a("../helpers/date"))&&f.__esModule&&f||{default:f}).getNormalizedDate,k=((g=a("editors"))&&g.__esModule&&g||{default:g}).getEditor;h.DateValidator=function(a,b){var c=!0,d=k("date",this.instance);null==a&&(a="");var e=i(new Date(a)).isValid()||i(a,d.defaultDateFormat).isValid(),f=i(a,this.dateFormat||d.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===a&&(e=!0,f=!0),e||(c=!1),!e&&f&&(c=!0),e&&!f)if(!0===this.correctFormat){var g=l(a,this.dateFormat),h=this.instance.runHooks("unmodifyRow",this.row),j=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,j,g,"dateValidator"),c=!0}else c=!1;b(c)};var l=function(b,c){var g,d=i(j(b)),e=i(b,c),f=b.search(/[A-z]/g)>-1;return g=d.isValid()&&d.format("x")===e.format("x")||!e.isValid()||f?d:e,g.format(c)}},{"../helpers/date":46,browser:24,editors:30,moment:"moment"}],137:[function(a,b,c){"use strict";var d;((d=a("browser"))&&d.__esModule&&d||{default:d}).default.NumericValidator=function(a,b){null==a&&(a=""),b(!(!this.allowEmpty||""!==a)||""!==a&&/^-?\d*(\.|\,)?\d*$/.test(a))}},{browser:24}],138:[function(a,b,c){"use strict";var d,e,f=((d=a("browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];f.TimeValidator=function(a,b){var c=!0,d=this.timeFormat||"h:mm:ss a";null===a&&(a=""),a=/^\d{3,}$/.test(a)?parseInt(a,10):a;var e=/^\d{1,2}$/.test(a);e&&(a+=":00");var f=g(a,h,!0).isValid()?g(a):g(a,d),i=f.isValid(),j=g(a,d,!0).isValid()&&!e;if(this.allowEmpty&&""===a&&(i=!0,j=!0),i||(c=!1),!i&&j&&(c=!0),i&&!j)if(!0===this.correctFormat){var k=f.format(d),l=this.instance.runHooks("unmodifyRow",this.row),m=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,m,k,"timeValidator"),c=!0}else c=!1;b(c)}},{browser:24,moment:"moment"}],139:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableBottomOverlay:{get:function(){return r}},__esModule:{value:!0}});var d,e,f=(d=a("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.addClass,h=f.getScrollbarWidth,i=f.getScrollTop,j=f.getWindowScrollLeft,k=f.hasClass,l=f.outerHeight,n=(f.innerHeight,f.removeClass),p=(f.setOverlayPosition,f.resetCssTransform),q=((e=a("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,r=function(b){$traceurRuntime.superConstructor(s).call(this,b),this.clone=this.makeClone(q.CLONE_BOTTOM)},s=r;$traceurRuntime.createClass(r,{repositionOverlay:function(){var a=h(),b=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(a=0),b.style.top="",b.style.bottom=a+"px"},shouldBeRendered:function(){return!!this.wot.getSetting("fixedRowsBottom")},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b=0;if(a.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var e,f,c=this.wot.wtTable.hider.getBoundingClientRect(),d=Math.ceil(c.bottom),g=document.body.offsetHeight;e=this.wot.wtTable.hider.style.left,e=""===e?0:e,f=d>g?d-g:0,b=f,f+="px",a.style.top="",a.style.left=e,a.style.bottom=f}else b=this.getScrollPosition(),p(a),this.repositionOverlay();this.adjustHeaderBordersPosition(b)}},setScrollPosition:function(a){this.mainTableScrollableElement===window?window.scrollTo(j(),a):this.mainTableScrollableElement.scrollTop=a},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(a,b){for(var c=0,d=this.wot.wtSettings.settings.defaultRowHeight;a<b;){var e=this.wot.wtTable.getRowHeight(a);c+=void 0===e?d:e,a++}return c},adjustElementsSize:function(){var a=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||a)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),a||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,a=this.wot.wtTable.holder,b=a.clientWidth===a.offsetWidth?0:h(),c=this.clone.wtTable.holder.parentNode,d=c.style;this.trimmingContainer===window?d.width="":d.width=this.wot.wtViewport.getWorkspaceWidth()-b+"px",this.clone.wtTable.holder.style.width=d.width,e=l(this.clone.wtTable.TABLE),d.height=e+"px"},adjustRootChildrenSize:function(){var a=h();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===a&&(a=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+a+"px"},applyToDOM:function(){var a=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==a)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(a,b){var c=this.getTableParentOffset(),d=this.wot.cloneSource?this.wot.cloneSource:this.wot,e=d.wtTable.holder,f=0;b&&e.offsetHeight!==e.clientHeight&&(f=h()),b?(c+=this.sumCellSizes(0,a+1),c-=this.wot.wtViewport.getViewportHeight(),c+=1):c+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),a),c+=f,this.setScrollPosition(c)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return i(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(a){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var b=this.wot.wtTable.holder.parentNode,c=k(b,"innerBorderTop");a?g(b,"innerBorderTop"):n(b,"innerBorderTop"),(!c&&a||c&&!a)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var d=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");d&&(d.style["border-left-width"]=0)}}},{},q),window.WalkontableBottomOverlay=r,q.registerOverlay(q.CLONE_BOTTOM,r)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],140:[function(a,b,c){"use strict";Object.defineProperties(c,{WalkontableBottomLeftCornerOverlay:{get:function(){return m}},__esModule:{value:!0}});var d,e,f=(d=a("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d},g=f.getScrollbarWidth,h=f.outerHeight,i=f.outerWidth,k=(f.setOverlayPosition,f.resetCssTransform),l=((e=a("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"))&&e.__esModule&&e||{default:e}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(n).call(this,b),this.clone=this.makeClone(l.CLONE_BOTTOM_LEFT_CORNER)},n=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsBottom")||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},repositionOverlay:function(){var a=g(),b=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(a=0),b.style.top="",b.style.bottom=a+"px"},resetFixedPosition:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var a=this.clone.wtTable.holder.parentNode,b=h(this.clone.wtTable.TABLE),c=i(this.clone.wtTable.TABLE);if(a.style.top="",this.trimmingContainer===window){var g,j,d=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(d.bottom),f=Math.ceil(d.left),l=document.body.offsetHeight;g=f<0?-f:0,j=e>l?e-l:0,j+="px",g+="px",a.style.top="",a.style.left=g,a.style.bottom=j}else k(a),this.repositionOverlay();a.style.height=b+"px",a.style.width=c+"px"}}},{},l),window.WalkontableBottomLeftCornerOverlay=m,l.registerOverlay(l.CLONE_BOTTOM_LEFT_CORNER,m)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],141:[function(a,b,c){"use strict";var d,e,f,g=((d=a("../node_modules/hot-builder/node_modules/handsontable/src/browser"))&&d.__esModule&&d||{default:d}).default;(e=a("3rdparty/walkontable/src/overlay/bottom"))&&e.__esModule,(f=a("3rdparty/walkontable/src/overlay/bottomLeftCorner"))&&f.__esModule;b.exports=g},{"../node_modules/hot-builder/node_modules/handsontable/src/browser":24,"3rdparty/walkontable/src/overlay/bottom":139,"3rdparty/walkontable/src/overlay/bottomLeftCorner":140}],142:[function(a,b,c){"use strict";Object.defineProperties(c,{BindRowsWithHeaders:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,k=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach),l=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&g.__esModule&&g||{default:g}).registerPlugin,m=((h=a("bindStrategy"))&&h.__esModule&&h||{default:h}).BindStrategy,n=function(b){$traceurRuntime.superConstructor(o).call(this,b),this.bindStrategy=new m,this.removedRows=[]},o=n;$traceurRuntime.createClass(n,{isEnabled:function(){return!!this.hot.getSettings().bindRowsWithHeaders},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof b&&(b=m.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(b),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(b){return a.onModifyRowHeader(b)}),this.addHook("afterCreateRow",function(b,c){return a.onAfterCreateRow(b,c)}),this.addHook("beforeRemoveRow",function(b,c){return a.onBeforeRemoveRow(b,c)}),this.addHook("afterRemoveRow",function(b,c){return a.onAfterRemoveRow(b,c)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),$traceurRuntime.superGet(this,o.prototype,"enablePlugin").call(this)}},updatePlugin:function(){$traceurRuntime.superGet(this,o.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),$traceurRuntime.superGet(this,o.prototype,"disablePlugin").call(this)},onModifyRowHeader:function(a){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",a))},onAfterCreateRow:function(a,b){this.bindStrategy.createRow(a,b)},onBeforeRemoveRow:function(a,b){var c=this;this.removedRows.length=0,!1!==a&&k(a,a+b-1,function(a){c.removedRows.push(c.hot.runHooks("modifyRow",a))})},onAfterRemoveRow:function(a,b){this.bindStrategy.removeRow(this.removedRows)},onAfterLoadData:function(a){a||this.bindStrategy.createMap(this.hot.countSourceRows())},destroy:function(){this.bindStrategy.destroy(),$traceurRuntime.superGet(this,o.prototype,"destroy").call(this)}},{},i),l("bindRowsWithHeaders",n)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,bindStrategy:143}],143:[function(a,b,c){"use strict";Object.defineProperties(c,{BindStrategy:{get:function(){return m}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,k=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"))&&e.__esModule,(f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&f.__esModule,((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&g.__esModule&&g||{default:g}).rangeEach),l={},m=function(){this.strategy=null};$traceurRuntime.createClass(m,{setStrategy:function(a){var b=l[a];if(!b)throw new Error('Bind strategy "'+a+'" does not exist.');this.strategy=new b},createMap:function(a){var b=this.strategy,c=void 0===a?b._arrayMap.length:a;b._arrayMap.length=0,k(c-1,function(a){b._arrayMap.push(a)})},createRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.strategy.createRow.apply(this.strategy,a)},removeRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.strategy.removeRow.apply(this.strategy,a)},translate:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return this.strategy.getValueByIndex.apply(this.strategy,a)},clearMap:function(){this.strategy.clearMap()},destroy:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}},{get DEFAULT_STRATEGY(){return"loose"},registerStrategy:function(a,b){l[a]=b}}),h.utils.BindStrategy=m},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],144:[function(a,b,c){"use strict";Object.defineProperties(c,{LooseBindStrategy:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"))&&d.__esModule&&d||{default:d}).arrayMapper,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).mixin,i=((f=a("bindStrategy"))&&f.__esModule&&f||{default:f}).BindStrategy,j=function(){};$traceurRuntime.createClass(j,{createRow:function(a,b){this.shiftItems(a,b)},removeRow:function(a,b){this.unshiftItems(a,b)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"loose"}}),h(j,g),i.registerStrategy(j.STRATEGY_NAME,j)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],145:[function(a,b,c){"use strict";Object.defineProperties(c,{StrictBindStrategy:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"))&&d.__esModule&&d||{default:d}).arrayMapper,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).mixin,i=((f=a("bindStrategy"))&&f.__esModule&&f||{default:f}).BindStrategy,j=function(){};$traceurRuntime.createClass(j,{createRow:function(a,b){this.insertItems(a,b)},removeRow:function(a,b){this.removeItems(a,b)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"strict"}}),h(j,g),i.registerStrategy(j.STRATEGY_NAME,j)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],146:[function(a,b,c){"use strict";Object.defineProperties(c,{CollapsibleColumns:{get:function(){return z}},__esModule:{value:!0}});var d,e,f,g,h,i,j,h,k,l=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&d.__esModule&&d||{default:d}).objectEach,m=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,n=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,o=(g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&g.__esModule&&g||{default:g},p=o.addClass,q=o.hasClass,r=o.fastInnerText,t=((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&h.__esModule,(i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&i.__esModule&&i||{default:i}),u=t.registerPlugin,w=(t.getPlugin,((j=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&j.__esModule&&j||{default:j}).stopImmediatePropagation),x=((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&h.__esModule&&h||{default:h}).eventManager,y=((k=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&k.__esModule&&k||{default:k}).default,z=function(b){$traceurRuntime.superConstructor(A).call(this,b),this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections={},this.columnHeaderLevelCount=null,this.eventManager=null},A=z;$traceurRuntime.createClass(z,{isEnabled:function(){return!!this.hot.getSettings().collapsibleColumns},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return a.onAfterRender()}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("afterGetColHeader",function(b,c){return a.onAfterGetColHeader(b,c)}),this.addHook("beforeOnCellMouseDown",function(b,c,d){return a.onBeforeOnCellMouseDown(b,c,d)}),this.eventManager=x(this.hot),$traceurRuntime.superGet(this,A.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),$traceurRuntime.superGet(this,A.prototype,"disablePlugin").call(this)},clearButtons:function(){if(this.hot.view){var a=this.hot.view.wt.getSetting("columnHeaders").length,b=this.hot.view.wt.wtTable.THEAD,c=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,e=function(a){a&&a.parentNode.removeChild(a)};n(0,a-1,function(a){var f=b.childNodes[a],g=c.childNodes[a],h=d?d.childNodes[a]:null;n(0,f.childNodes.length-1,function(a){var b=f.childNodes[a].querySelector(".collapsibleIndicator");e(b),g&&g.childNodes[a]&&(b=g.childNodes[a].querySelector(".collapsibleIndicator"),e(b)),d&&h&&h.childNodes[a]&&(b=h.childNodes[a].querySelector(".collapsibleIndicator"),e(b))})},!0)}},parseSettings:function(){var a=this;l(this.settings,function(b){a.buttonEnabledList[b.row]||(a.buttonEnabledList[b.row]={}),a.buttonEnabledList[b.row][b.col]=b.collapsible})},meetsDependencies:function(){var a=this.hot.getSettings();return a.nestedHeaders&&a.hiddenColumns},checkDependencies:function(){var a=this.hot.getSettings();this.meetsDependencies()||(a.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),a.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))},generateIndicator:function(a,b){var c=b.parentNode,d=c.parentNode,e=-1*d.childNodes.length+Array.prototype.indexOf.call(d.childNodes,c);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[e]||!this.buttonEnabledList[e][a]))return null;var f=document.createElement("DIV");return p(f,"collapsibleIndicator"),this.collapsedSections[e]&&!0===this.collapsedSections[e][a]?(p(f,"collapsed"),r(f,"+")):(p(f,"expanded"),r(f,"-")),f},markSectionAs:function(a,b,c,d){switch(this.collapsedSections[b]||(this.collapsedSections[b]={}),a){case"collapsed":this.collapsedSections[b][c]=!0;break;case"expanded":this.collapsedSections[b][c]=void 0}if(d)for(var e=this.nestedHeadersPlugin.colspanArray,f=this.nestedHeadersPlugin.rowCoordsToLevel(b),g=this.nestedHeadersPlugin.getChildHeaders(b,c),h=e[f+1],i=1;i<g.length;i++)h&&h[g[i]].colspan>1&&this.markSectionAs(a,b+1,g[i],!0)},expandSection:function(a){this.markSectionAs("expanded",a.row,a.col,!0),this.toggleCollapsibleSection(a,"expand")},collapseSection:function(a){this.markSectionAs("collapsed",a.row,a.col,!0),this.toggleCollapsibleSection(a,"collapse")},toggleAllCollapsibleSections:function(a){var b=this,c=this.nestedHeadersPlugin.colspanArray;!0===this.settings?m(c,function(c,d){m(c,function(c,e){if(c.colspan>1){d=parseInt(d,10),e=parseInt(e,10);var f=b.nestedHeadersPlugin.levelToRowCoords(d),g=e;b.markSectionAs("collapse"===a?"collapsed":"expanded",f,g,!0),b.toggleCollapsibleSection({row:f,col:g},a)}})}):l(this.buttonEnabledList,function(c,d){l(c,function(c,e){d=parseInt(d,10),e=parseInt(e,10),b.markSectionAs("collapse"===a?"collapsed":"expanded",d,e,!0),b.toggleCollapsibleSection({row:d,col:e},a)})})},collapseAll:function(){this.toggleAllCollapsibleSections("collapse")},expandAll:function(){this.toggleAllCollapsibleSections("expand")},toggleCollapsibleSection:function(a,b){var c=this;a.row&&(a.row=parseInt(a.row,10)),a.col&&(a.col=parseInt(a.col,10));for(var d=this.hiddenColumnsPlugin.hiddenColumns,e=this.nestedHeadersPlugin.colspanArray,f=this.nestedHeadersPlugin.rowCoordsToLevel(a.row),g=e[f][a.col].colspan,h=this.nestedHeadersPlugin.getChildHeaders(a.row,a.col),i=f+1,j=e[i],k=j?j[h[0]].colspan||1:1;k===g&&i<this.columnHeaderLevelCount;)i+=1,j=e[i],k=j?j[h[0]].colspan||1:1;n(k,g-1,function(e){var f=a.col+e;switch(b){case"collapse":c.hiddenColumnsPlugin.isHidden(f)||d.push(f);break;case"expand":c.hiddenColumnsPlugin.isHidden(f)&&d.splice(d.indexOf(f),1)}}),this.hot.render()},onAfterGetColHeader:function(a,b){if(b.hasAttribute("colspan")&&b.getAttribute("colspan")>1&&a>=this.hot.getSettings().fixedColumnsLeft){var c=this.generateIndicator(a,b);null!==c&&b.querySelector("div:first-child").appendChild(c)}},onBeforeOnCellMouseDown:function(a,b){if(q(a.target,"collapsibleIndicator"))return q(a.target,"expanded")?(this.collapsedSections[b.row]||(this.collapsedSections[b.row]=[]),this.markSectionAs("collapsed",b.row,b.col,!0),this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection(b,"collapse")):q(a.target,"collapsed")&&(this.markSectionAs("expanded",b.row,b.col,!0),this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection(b,"expand")),w(a),!1},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length},onAfterRender:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()},destroy:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,$traceurRuntime.superGet(this,A.prototype,"destroy").call(this)}},{},y),u("collapsibleColumns",z)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63}],147:[function(a,b,c){"use strict";Object.defineProperties(c,{ColumnSummary:{get:function(){return r}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"))&&d.__esModule&&d||{default:d}).default,j=((e=a("endpoints"))&&e.__esModule&&e||{default:e}).Endpoints,k=(f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&f.__esModule&&f||{default:f},o=(k.deepClone,k.objectEach,(g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&g.__esModule,(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"))&&h.__esModule&&h||{default:h}),p=o.registerPlugin,r=(o.getPlugin,function(b){$traceurRuntime.superConstructor(s).call(this,b),this.endpoints=null}),s=r;$traceurRuntime.createClass(r,{isEnabled:function(){return!!this.hot.getSettings().columnSummary},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new j(this,this.settings),this.addHook("afterInit",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterInit.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterChange",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterChange.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeCreateRow",function(b,c,d){return a.endpoints.resetSetupBeforeStructureAlteration("insert_row",b,c,null,d)}),this.addHook("beforeCreateCol",function(b,c,d){return a.endpoints.resetSetupBeforeStructureAlteration("insert_col",b,c,null,d)}),this.addHook("beforeRemoveRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.endpoints).resetSetupBeforeStructureAlteration.apply(b,$traceurRuntime.spread(["remove_row"],c))}),this.addHook("beforeRemoveCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.endpoints).resetSetupBeforeStructureAlteration.apply(b,$traceurRuntime.spread(["remove_col"],c))}),this.addHook("beforeRowMove",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeRowMove.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterCreateRow",function(b,c,d){return a.endpoints.resetSetupAfterStructureAlteration("insert_row",b,c,null,d)}),this.addHook("afterCreateCol",function(b,c,d){return a.endpoints.resetSetupAfterStructureAlteration("insert_col",b,c,null,d)}),this.addHook("afterRemoveRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.endpoints).resetSetupAfterStructureAlteration.apply(b,$traceurRuntime.spread(["remove_row"],c))}),this.addHook("afterRemoveCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.endpoints).resetSetupAfterStructureAlteration.apply(b,$traceurRuntime.spread(["remove_col"],c))}),this.addHook("afterRowMove",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterRowMove.apply(b,$traceurRuntime.spread(c))}),$traceurRuntime.superGet(this,s.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null},calculate:function(a){switch(a.type.toLowerCase()){case"sum":a.result=this.calculateSum(a);break;case"min":case"max":a.result=this.calculateMinMax(a,a.type);break;case"count":a.result=this.countEntries(a);break;case"average":a.result=this.calculateAverage(a);break;case"custom":a.result=a.customFunction.call(this,a)}},calculateSum:function(a){var b=0;for(var c in a.ranges)a.ranges.hasOwnProperty(c)&&(b+=this.getPartialSum(a.ranges[c],a.sourceColumn));return b},getPartialSum:function(a,b){var c=0,d=a[1]||a[0],e=null,f=0;do{e=this.getCellValue(d,b)||0;var g=((e+"").split(".")[1]||[]).length||1;g>f&&(f=g),c+=e||0,d--}while(d>=a[0]);return Math.round(c*Math.pow(10,f))/Math.pow(10,f)},calculateMinMax:function(a,b){var c=null;for(var d in a.ranges)if(a.ranges.hasOwnProperty(d)){var e=this.getPartialMinMax(a.ranges[d],a.sourceColumn,b);if(null===c&&null!==e&&(c=e),null!==e)switch(b){case"min":c=Math.min(c,e);break;case"max":c=Math.max(c,e)}}return null===c?"Not enough data":c},getPartialMinMax:function(a,b,c){var f,d=null,e=a[1]||a[0];do{if(f=this.getCellValue(e,b)||null,null===d)d=f;else if(null!==f)switch(c){case"min":d=Math.min(d,f);break;case"max":d=Math.max(d,f)}e--}while(e>=a[0]);return d},countEmpty:function(a,b){var c,d=0,e=a[1]||a[0];do{c=this.getCellValue(e,b),c||d++,e--}while(e>=a[0]);return d},countEntries:function(a){var b=0,c=a.ranges;for(var d in c)if(c.hasOwnProperty(d)){var e=void 0===c[d][1]?1:c[d][1]-c[d][0]+1,f=this.countEmpty(c[d],a.sourceColumn);b+=e,b-=f}return b},calculateAverage:function(a){return this.calculateSum(a)/this.countEntries(a)},getCellValue:function(a,b){var c=this.endpoints.getVisualRowIndex(a),d=this.endpoints.getVisualColumnIndex(b),e=this.hot.getSourceDataAtCell(a,b);if((this.hot.getCellMeta(c,d).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof e&&(e=e.replace(/,/,".")),e=parseFloat(e)),isNaN(e)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+a+", "+b+") is not in a numeric format. Cannot do the calculation.");return e},onAfterInit:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)},onAfterChange:function(a,b){a&&"ColumnSummary.reset"!==b&&"ColumnSummary.set"!==b&&"loadData"!==b&&this.endpoints.refreshChangedEndpoints(a)},onBeforeRowMove:function(a,b){this.endpoints.resetSetupBeforeStructureAlteration("move_row",a[0],a.length,a,this.pluginName)},onAfterRowMove:function(a,b){this.endpoints.resetSetupAfterStructureAlteration("move_row",b,a.length,a,this.pluginName)}},{},i),p("columnSummary",r)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,endpoints:148}],148:[function(a,b,c){"use strict";Object.defineProperties(c,{Endpoints:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"))&&f.__esModule&&f||{default:f}).getTranslator),j=function(b,c){this.plugin=b,this.hot=this.plugin.hot,this.endpoints=[],this.settings=c,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=i(this.hot)};$traceurRuntime.createClass(j,{getEndpoint:function(a){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[a]:this.endpoints[a]},getAllEndpoints:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints},fillMissingEndpointData:function(a){return this.parseSettings(a.call(this))},parseSettings:function(a){var b=this,c=[];return a||"function"!=typeof this.settings?(a||(a=this.settings),g(a,function(a){var d={};b.assignSetting(a,d,"ranges",[[0,b.hot.countRows()-1]]),b.assignSetting(a,d,"reversedRowCoords",!1),b.assignSetting(a,d,"destinationRow",new Error("You must provide a destination row for the Column Summary plugin in order to work properly!")),b.assignSetting(a,d,"destinationColumn",new Error("You must provide a destination column for the Column Summary plugin in order to work properly!")),b.assignSetting(a,d,"sourceColumn",a.destinationColumn),b.assignSetting(a,d,"type","sum"),b.assignSetting(a,d,"forceNumeric",!1),b.assignSetting(a,d,"suppressDataTypeErrors",!0),b.assignSetting(a,d,"suppressDataTypeErrors",!0),b.assignSetting(a,d,"customFunction",null),b.assignSetting(a,d,"readOnly",!0),b.assignSetting(a,d,"roundFloat",!1),c.push(d)}),c):void(this.settingsType="function")},assignSetting:function(a,b,c,d){if("ranges"===c&&void 0===a[c])return void(b[c]=d);if("ranges"!==c||0!==a[c].length)if(void 0===a[c]){if(d instanceof Error)throw d;b[c]=d}else"destinationRow"===c&&b.reversedRowCoords?b[c]=this.hot.countRows()-a[c]-1:b[c]=a[c]},resetSetupBeforeStructureAlteration:function(a,b,c,d,e){if("function"===this.settingsType){var f=a.indexOf("row")>-1?"row":"col",h=this.getAllEndpoints();g(h,function(d,e,g){"row"===f&&d.destinationRow>=b&&("insert_row"===a?d.alterRowOffset=c:"remove_row"===a&&(d.alterRowOffset=-1*c)),"col"===f&&d.destinationColumn>=b&&("insert_col"===a?d.alterColumnOffset=c:"remove_col"===a&&(d.alterColumnOffset=-1*c))}),this.resetAllEndpoints(h,!1)}},resetSetupAfterStructureAlteration:function(a,b,c,d,e){var f=void 0===arguments[5]||arguments[5],h=this;if("function"===this.settingsType){var i=function(){return h.hot.removeHook("beforeRender",i),h.refreshAllEndpoints(!0)};return void this.hot.addHookOnce("beforeRender",i)}var j=a.indexOf("row")>-1?"row":"col",k=a.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),m=0===a.indexOf("move_row"),n=b;g(l,function(a,b,d){"row"===j&&a.destinationRow>=n&&(a.alterRowOffset=k*c),"col"===j&&a.destinationColumn>=n&&(a.alterColumnOffset=k*c)}),this.resetAllEndpoints(l,!m),m?g(l,function(a,b,c){h.extendEndpointRanges(a,n,d[0],d.length),h.recreatePhysicalRanges(a),h.clearOffsetInformation(a)}):g(l,function(a,b,c){h.shiftEndpointCoordinates(a,n)}),f&&this.refreshAllEndpoints(!0)},clearOffsetInformation:function(a){a.alterRowOffset=void 0,a.alterColumnOffset=void 0},extendEndpointRanges:function(a,b,c,d){g(a.ranges,function(a,e){a[1]&&(b>=a[0]&&b<=a[1]?c>a[1]?a[1]+=d:c<a[0]&&(a[0]-=d):c>=a[0]&&c<=a[1]&&(a[1]-=d,b<=a[0]&&(a[0]++,a[1]++)))})},recreatePhysicalRanges:function(a){var b=this,c=a.ranges,d=[],e=[];g(c,function(a){var c=[];if(a[1])for(var d=a[0];d<=a[1];d++)c.push(b.recordTranslator.toPhysicalRow(d));else c.push(b.recordTranslator.toPhysicalRow(a[0]));e.push(c)}),g(e,function(a){var b=[];g(a,function(c,e){0===e?b.push(c):a[e]!==a[e-1]+1&&(b.push(a[e-1]),d.push(b),b=[],b.push(c)),e===a.length-1&&(b.push(c),d.push(b))})}),a.ranges=d},shiftEndpointCoordinates:function(a,b){a.alterRowOffset&&0!==a.alterRowOffset?(a.destinationRow+=a.alterRowOffset||0,g(a.ranges,function(c,d){g(c,function(d,e){d>=b&&(c[e]+=a.alterRowOffset||0)})})):a.alterColumnOffset&&0!==a.alterColumnOffset&&(a.destinationColumn+=a.alterColumnOffset||0,a.sourceColumn+=a.alterColumnOffset||0)},resetAllEndpoints:function(a){var b=void 0===arguments[1]||arguments[1],c=this;this.cellsToSetCache=[],a||(a=this.getAllEndpoints()),g(a,function(a){c.resetEndpointValue(a,b)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]},refreshAllEndpoints:function(a){var b=this;this.cellsToSetCache=[],g(this.getAllEndpoints(),function(a){b.currentEndpoint=a,b.plugin.calculate(a),b.setEndpointValue(a,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]},refreshChangedEndpoints:function(a){var b=this,c=[];this.cellsToSetCache=[],g(a,function(a,d,e){(a[2]||"")+""!=a[3]+""&&g(b.getAllEndpoints(),function(a,f){b.hot.propToCol(e[d][1])===a.sourceColumn&&-1===c.indexOf(f)&&c.push(f)})}),g(c,function(a){b.refreshEndpoint(b.getEndpoint(a))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]},refreshEndpoint:function(a){this.currentEndpoint=a,this.plugin.calculate(a),this.setEndpointValue(a),this.currentEndpoint=null},resetEndpointValue:function(a){var b,f,g,c=void 0===arguments[1]||arguments[1],d=a.alterRowOffset||0,e=a.alterColumnOffset||0;b=this.recordTranslator.toVisual(a.destinationRow,a.destinationColumn),f=b[0],g=b[1];var h=this.hot.getCellMeta(f,g);h.readOnly=!1,h.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(a.destinationRow+(c?d:0)),this.recordTranslator.toVisualColumn(a.destinationColumn+(c?e:0)),""])},setEndpointValue:function(a,b){var c=void 0!==arguments[2]&&arguments[2],d=-1*a.alterRowOffset||0,e=-1*a.alterColumnOffset||0,f=this.getVisualRowIndex(a.destinationRow),g=this.hot.getCellMeta(this.getVisualRowIndex(a.destinationRow+d),a.destinationColumn+e);if(f>this.hot.countRows()||a.destinationColumn>this.hot.countCols())return void this.throwOutOfBoundsWarning();"init"!==b&&g.readOnly===a.readOnly||(g.readOnly=a.readOnly,g.className="columnSummaryResult"),a.roundFloat&&!isNaN(a.result)&&(a.result=a.result.toFixed(a.roundFloat)),c?this.hot.setDataAtCell(f,a.destinationColumn,a.result,"ColumnSummary.set"):this.cellsToSetCache.push([f,a.destinationColumn,a.result]),a.alterRowOffset=void 0,a.alterColumnOffset=void 0},getVisualRowIndex:function(a){return this.hot.runHooks("unmodifyRow",a,"columnSummary")},getVisualColumnIndex:function(a){return this.hot.runHooks("unmodifyCol",a,"columnSummary")},throwOutOfBoundsWarning:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],149:[function(a,b,c){"use strict";Object.defineProperties(c,{DropdownMenu:{get:function(){return N}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,q=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&e.__esModule&&e||{default:e}).default,r=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,t=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&g.__esModule,((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor"))&&h.__esModule&&h||{default:h}).CommandExecutor),u=((i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&i.__esModule&&i||{default:i}).EventManager,v=(j=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&j.__esModule&&j||{default:j},y=(v.getWindowScrollTop,v.getWindowScrollLeft,v.hasClass),A=(v.closest,((k=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory"))&&k.__esModule&&k||{default:k}).ItemsFactory),B=((l=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"))&&l.__esModule&&l||{default:l}).Menu,C=((m=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&m.__esModule&&m||{default:m}).registerPlugin,D=((n=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&n.__esModule&&n||{default:n}).stopPropagation,E=(o=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"))&&o.__esModule&&o||{default:o},F=E.COLUMN_LEFT,G=E.COLUMN_RIGHT,H=E.REMOVE_COLUMN,I=E.CLEAR_COLUMN,J=E.READ_ONLY,K=E.ALIGNMENT,L=E.SEPARATOR,M="changeType",N=function(b){var c=this;$traceurRuntime.superConstructor(O).call(this,b),this.eventManager=new u(this),this.commandExecutor=new t(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",function(a,b){return c.onAfterGetColHeader(a,b)})},O=N;$traceurRuntime.createClass(N,{isEnabled:function(){return this.hot.getSettings().dropdownMenu},enablePlugin:function(){var a=this;if(!this.enabled){this.itemsFactory=new A(this.hot,O.DEFAULT_ITEMS);var b=this.hot.getSettings().dropdownMenu,c={items:this.itemsFactory.getItems(b)};this.registerEvents(),"function"==typeof b.callback&&this.commandExecutor.setCommonCallback(b.callback),$traceurRuntime.superGet(this,O.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){a.hot.runHooks("afterDropdownMenuDefaultOptions",c),a.itemsFactory.setPredefinedItems(c.items);var d=a.itemsFactory.getItems(b);a.menu=new B(a.hot,{className:"htDropdownMenu",keepInViewport:!0}),a.hot.runHooks("beforeDropdownMenuSetItems",d),a.menu.setMenuItems(d),a.menu.addLocalHook("afterOpen",function(){return a.onMenuAfterOpen()}),a.menu.addLocalHook("afterClose",function(){return a.onMenuAfterClose()}),a.menu.addLocalHook("executeCommand",function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a.executeCommand.apply(a,b)}),r(d,function(b){return a.commandExecutor.registerCommand(b.key,b)})})}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,O.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,O.prototype,"disablePlugin").call(this)},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(b){return a.onTableClick(b)})},open:function(a){this.menu&&(this.menu.open(),a.width&&this.menu.setOffset("left",a.width),this.menu.setPosition(a),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,p.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.commandExecutor.execute.apply(this.commandExecutor,a)},setListening:function(){void 0===arguments[0]||arguments[0]?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten()},onTableClick:function(a){if(D(a),y(a.target,M)&&!this.menu.isOpened()){var b=a.target.getBoundingClientRect();this.open({left:b.left,top:b.top+a.target.offsetHeight+3,width:b.width,height:b.height})}},onAfterGetColHeader:function(a,b){var c=b.parentNode;if(c){var d=c.parentNode.childNodes,e=Array.prototype.indexOf.call(d,c);if(!(a<0||e!==d.length-1)){var f=b.querySelector("."+M);if(!this.enabled||!f){if(!this.enabled)return void(f&&f.parentNode.removeChild(f));var g=document.createElement("button");g.className=M,g.onclick=function(){return!1},b.firstChild.insertBefore(g,b.firstChild.firstChild)}}}},onMenuAfterOpen:function(){this.hot.runHooks("afterDropdownMenuShow",this)},onMenuAfterClose:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)},destroy:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,O.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[F,G,L,H,L,I,L,J,L,K]}},q),N.SEPARATOR={name:L},p.hooks.register("afterDropdownMenuDefaultOptions"),p.hooks.register("afterDropdownMenuShow"),p.hooks.register("afterDropdownMenuHide"),p.hooks.register("afterDropdownMenuExecute"),C("dropdownMenu",N)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor":71,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory":74,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"../../browser":141}],150:[function(a,b,c){"use strict";Object.defineProperties(c,{DataProvider:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,h=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule,(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}),k=(h.extend,h.clone,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach),l=function(b){this.hot=b,this.options={}};$traceurRuntime.createClass(l,{setOptions:function(a){this.options=a},getData:function(){var a=this,b=this._getDataRange(),c=b.startRow,d=b.startCol,e=b.endRow,f=b.endCol,g=this.options,h=[];return k(c,e,function(b){var c=[];var v='';!g.exportHiddenRows&&a._isHiddenRow(b)||(k(d,f,function(d){v=a.hot.getDataAtCell(b,d);if(isNaN(v)){v=v.replace(/<[^>]*href[^>]*>|<\/a>/g, ""); } !g.exportHiddenColumns&&a._isHiddenColumn(d)||c.push(v)}),h.push(c))}),h},getRowHeaders:function(){var a=this,b=[];if(this.options.rowHeaders){var c=this._getDataRange(),d=c.startRow,e=c.endRow,f=this.hot.getRowHeader();k(d,e,function(c){!a.options.exportHiddenRows&&a._isHiddenRow(c)||b.push(f[c])})}return b},getColumnHeaders:function(){var a=this,b=[];if(this.options.columnHeaders){var c=this._getDataRange(),d=c.startCol,e=c.endCol,f=this.hot.getColHeader();k(d,e,function(c){!a.options.exportHiddenColumns&&a._isHiddenColumn(c)||b.push(f[c])})}return b},_getDataRange:function(){var a,b,c,d,e=this.hot.countCols()-1,f=this.hot.countRows()-1,g=this.options.range,h=void 0===(a=g[0])?0:a,i=void 0===(b=g[1])?0:b,j=void 0===(c=g[2])?f:c,k=void 0===(d=g[3])?e:d;return h=Math.max(h,0),i=Math.max(i,0),j=Math.min(j,f),k=Math.min(k,e),{startRow:h,startCol:i,endRow:j,endCol:k}},_isHiddenRow:function(a){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",a)},_isHiddenColumn:function(a){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",a)}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],151:[function(a,b,c){"use strict";Object.defineProperties(c,{ExportFile:{get:function(){return s}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,j=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e},n=(j.objectEach,j.extend,j.clone,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&f.__esModule&&f||{default:f}).registerPlugin),o=((g=a("dataProvider"))&&g.__esModule&&g||{default:g}).DataProvider,p=(h=a("typeFactory"))&&h.__esModule&&h||{default:h},q=p.typeFactory,r=p.EXPORT_TYPES,s=function(b){$traceurRuntime.superConstructor(t).call(this,b)},t=s;$traceurRuntime.createClass(s,{isEnabled:function(){return!0},exportAsString:function(a){var b=void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(a,b).export()},exportAsBlob:function(a){var b=void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(a,b))},downloadFile:function(a){if(dtst)return!1;var b=void 0!==arguments[1]?arguments[1]:{},c=this._createTypeFormatter(a,b),d=this._createBlob(c),e=window.URL||window.webkitURL,f=document.createElement("a"),g=c.options.filename+"."+c.options.fileExtension;if(void 0!==f.download){var h=e.createObjectURL(d);f.style.display="none",f.setAttribute("href",h),f.setAttribute("download",g),document.body.appendChild(f),f.dispatchEvent(new MouseEvent("click")),document.body.removeChild(f),setTimeout(function(){e.revokeObjectURL(h)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(d,g)},_createTypeFormatter:function(a){var b=void 0!==arguments[1]?arguments[1]:{};if(!r[a])throw new Error('Export format type "'+a+'" is not supported.');return q(a,new o(this.hot),b)},_createBlob:function(a){var b=null;return"undefined"!=typeof Blob&&(b=new Blob([a.export()],{type:a.options.mimeType+";charset="+a.options.encoding})),b}},{},i),n("exportFile",s)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:150,typeFactory:152}],152:[function(a,b,c){"use strict";function k(a,b,c){return"function"==typeof j[a]?new j[a](b,c):null}var d;Object.defineProperties(c,{TYPE_CSV:{get:function(){return g}},TYPE_EXCEL:{get:function(){return h}},TYPE_PDF:{get:function(){return i}},EXPORT_TYPES:{get:function(){return j}},typeFactory:{get:function(){return k}},__esModule:{value:!0}});var e,f=((e=a("types/csv.js"))&&e.__esModule&&e||{default:e}).Csv,g="csv",h="excel",i="pdf",j=(d={},Object.defineProperty(d,g,{value:f,configurable:!0,enumerable:!0,writable:!0}),d)},{"types/csv.js":154}],153:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseType:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g,i=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule,(e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}),j=i.extend,k=i.clone,m=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule,(g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&g.__esModule&&g||{default:g}),n=m.substitute,o=m.padStart,p=function(b,c){this.dataProvider=b,this.options=this._mergeOptions(c),this.dataProvider.setOptions(this.options)},q=p;$traceurRuntime.createClass(p,{_mergeOptions:function(a){var b=k(this.constructor.DEFAULT_OPTIONS),c=new Date;return b=j(k(q.DEFAULT_OPTIONS),b),b=j(b,a),b.filename=n(b.filename,{YYYY:c.getFullYear(),MM:o(c.getMonth()+1,2,"0"),DD:o(c.getDate(),2,"0")}),b}},{get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55}],154:[function(a,b,c){"use strict";Object.defineProperties(c,{Csv:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g=((d=a("_base.js"))&&d.__esModule&&d||{default:d}).BaseType,h=(e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e},i=h.arrayEach,j=h.arrayMap,k=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"))&&f.__esModule&&f||{default:f}).stringify,l=String.fromCharCode(13),m=String.fromCharCode(34),n=String.fromCharCode(10),o=function(b,c){$traceurRuntime.superConstructor(p).call(this,b,c)},p=o;$traceurRuntime.createClass(o,{export:function(){var a=this,b=this.options,c=this.dataProvider.getData(),d=this.dataProvider.getColumnHeaders(),e=d.length>0,f=this.dataProvider.getRowHeaders(),g=f.length>0,h="\ufeff\"数据来源：CNABS\"";h+=b.rowDelimiter;return e&&(d=j(d,function(b){return a._escapeCell(b,!0)}),g&&(h+=b.columnDelimiter),h+=d.join(b.columnDelimiter),h+=b.rowDelimiter),i(c,function(c,d){d>0&&(h+=b.rowDelimiter),g&&(h+=a._escapeCell(f[d])+b.columnDelimiter),h+=c.map(function(b){return a._escapeCell(b)}).join(b.columnDelimiter)}),h},_escapeCell:function(a){var b=void 0!==arguments[1]&&arguments[1];return a=k(a),""!==a&&(b||a.indexOf(l)>=0||a.indexOf(m)>=0||a.indexOf(n)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'+a+'"'),a}},{get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}},g)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"_base.js":153}],155:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseComponent:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).mixin,j=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&f.__esModule&&f||{default:f}).localHooks,k=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver"))&&g.__esModule&&g||{default:g}).stateSaver,l=function(b){this.hot=b,this.elements=[],this.hidden=!1};$traceurRuntime.createClass(l,{reset:function(){h(this.elements,function(a){return a.reset()})},hide:function(){this.hidden=!0},show:function(){this.hidden=!1},isHidden:function(){return this.hidden},destroy:function(){this.clearLocalHooks(),h(this.elements,function(a){return a.destroy()}),this.elements=null,this.hot=null}},{}),i(l,j),i(l,k)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver":59}],156:[function(a,b,c){"use strict";Object.defineProperties(c,{ActionBarComponent:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,j=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,k=((f=a("_base"))&&f.__esModule&&f||{default:f}).BaseComponent,l=((g=a("ui/input"))&&g.__esModule&&g||{default:g}).InputUI,n=((h=a("ui/select"))&&h.__esModule,function(b){$traceurRuntime.superConstructor(o).call(this,b),this.elements.push(new l(this.hot,{type:"button",value:"确定",className:"htUIButton htUIButtonOK",identifier:o.BUTTON_OK})),this.elements.push(new l(this.hot,{type:"button",value:"取消",className:"htUIButton htUIButtonCancel",identifier:o.BUTTON_CANCEL})),this.registerHooks()}),o=n;$traceurRuntime.createClass(n,{registerHooks:function(){var a=this;j(this.elements,function(b){b.addLocalHook("click",function(b,c){return a.onButtonClick(b,c)})})},getMenuItemDescriptor:function(){var a=this;return{key:"filter_action_bar",name:"Action bar",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(b,c,d,e,f,g){return i(c.parentNode,"htFiltersMenuActionBar"),j(a.elements,function(a){return c.appendChild(a.element)}),c}}},accept:function(){this.runLocalHooks("accept")},cancel:function(){this.runLocalHooks("cancel")},onButtonClick:function(a,b){b.options.identifier===o.BUTTON_OK?this.accept():this.cancel()}},{get BUTTON_OK(){return"ok"},get BUTTON_CANCEL(){return"cancel"}},k)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,_base:155,"ui/input":187,"ui/select":189}],157:[function(a,b,c){"use strict";Object.defineProperties(c,{ConditionComponent:{get:function(){return C}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,o=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&e.__esModule&&e||{default:e}).stopImmediatePropagation,p=(f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f},q=p.arrayEach,r=p.arrayFilter,t=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&g.__esModule,((h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"))&&h.__esModule&&h||{default:h}).isKey),u=((i=a("_base"))&&i.__esModule&&i||{default:i}).BaseComponent,v=(j=a("constants"))&&j.__esModule&&j||{default:j},w=v.getOptionsList,x=v.FORMULA_NONE,y=v.FORMULA_BY_VALUE,z=((k=a("ui/input"))&&k.__esModule&&k||{default:k}).InputUI,A=((l=a("ui/select"))&&l.__esModule&&l||{default:l}).SelectUI,B=((m=a("formulaRegisterer"))&&m.__esModule&&m||{default:m}).getFormulaDescriptor,C=function(b){$traceurRuntime.superConstructor(D).call(this,b),this.elements.push(new A(this.hot)),this.elements.push(new z(this.hot,{placeholder:"值"})),this.elements.push(new z(this.hot,{placeholder:"第二项值"})),this.registerHooks()},D=C;$traceurRuntime.createClass(C,{registerHooks:function(){var a=this;this.getSelectElement().addLocalHook("select",function(b){return a.onConditionSelect(b)}),q(this.getInputElements(),function(b){b.addLocalHook("keydown",function(b){return a.onInputKeyDown(b)})})},setState:function(a){var b=this;this.reset(),a&&(this.getSelectElement().setValue(a.command),q(a.args,function(c,d){var e=b.getInputElement(d);e.setValue(c),e[a.command.inputsCount>d?"show":"hide"](),d||setTimeout(function(){return e.focus()},10)}))},getState:function(){var a=this.getSelectElement().getValue()||B(x),b=[];return q(this.getInputElements(),function(c,d){a.inputsCount>d&&b.push(c.getValue())}),{command:a,args:b}},updateState:function(a){var b=a.editedFormulaStack.column,c=a.editedFormulaStack.formulas,d=r(c,function(a){return a.name!==y})[0];d&&d.name===y||this.setCachedState(b,{command:B(d?d.name:x),args:d?d.args:[]})},getSelectElement:function(){return this.elements.filter(function(a){return a instanceof A})[0]},getInputElement:function(){var a=void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[a]},getInputElements:function(){return this.elements.filter(function(a){return a instanceof z})},getMenuItemDescriptor:function(){var a=this;return{key:"filter_by_condition",name:"",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(b,c,d,e,f,g){n(c.parentNode,"htFiltersMenuCondition");var h=document.createElement("div");return n(h,"htFiltersMenuLabel"),h.textContent="按条件筛选:",c.appendChild(h),q(a.elements,function(a){return c.appendChild(a.element)}),c}}},reset:function(){var a=this.hot.getPlugin("filters").getSelectedColumn(),b=a&&a.visualIndex,c=this.hot.getDataType.apply(this.hot,this.hot.getSelected()||[0,b]),d=w(c);q(this.getInputElements(),function(a){return a.hide()}),this.getSelectElement().setItems(d),$traceurRuntime.superGet(this,D.prototype,"reset").call(this),this.getSelectElement().setValue(d[0])},onConditionSelect:function(a){q(this.getInputElements(),function(b,c){b[a.inputsCount>c?"show":"hide"](),c||setTimeout(function(){return b.focus()},10)}),this.runLocalHooks("change",a)},onInputKeyDown:function(a){t(a.keyCode,"ENTER")?(this.runLocalHooks("accept"),o(a)):t(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),o(a))}},{},u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,_base:155,constants:159,formulaRegisterer:184,"ui/input":187,"ui/select":189}],158:[function(a,b,c){"use strict";Object.defineProperties(c,{ValueComponent:{get:function(){return L}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d}).addClass,q=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&e.__esModule&&e||{default:e}).stopImmediatePropagation,r=(f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f},s=r.arrayEach,u=(r.arrayUnique,r.arrayFilter),v=r.arrayMap,A=(r.arrayIncludes,(g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort"))&&g.__esModule,(h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&h.__esModule,(i=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&i.__esModule,(j=a("utils"))&&j.__esModule&&j||{default:j}),B=A.unifyColumnValues,C=A.intersectValues,D=A.toEmptyString,E=((k=a("_base"))&&k.__esModule&&k||{default:k}).BaseComponent,F=((l=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"))&&l.__esModule&&l||{default:l}).isKey,G=((m=a("ui/multipleSelect"))&&m.__esModule&&m||{default:m}).MultipleSelectUI,H=(n=a("constants"))&&n.__esModule&&n||{default:n},I=H.FORMULA_BY_VALUE,J=H.FORMULA_NONE,K=((o=a("formulaRegisterer"))&&o.__esModule&&o||{default:o}).getFormulaDescriptor,L=function(b){$traceurRuntime.superConstructor(M).call(this,b),this.elements.push(new G(this.hot)),this.registerHooks()},M=L;$traceurRuntime.createClass(L,{registerHooks:function(){var a=this;this.getMultipleSelectElement().addLocalHook("keydown",function(b){return a.onInputKeyDown(b)})},setState:function(a){if(this.reset(),a&&a.command.key===I){var b=this.getMultipleSelectElement();b.setItems(a.itemsSnapshot),b.setValue(a.args[0])}},getState:function(){var a=this.getMultipleSelectElement(),b=a.getItems();return{command:{key:a.isSelectedAllValues()||!b.length?J:I},args:[a.getValue()],itemsSnapshot:b}},updateState:function(a){var b=this,c=function(a,c,d,e,f){var g=u(c,function(a){return a.name===I})[0],h={};if(g){var i=v(e(a,f),function(a){return a.value});i=B(i),d&&(g.args[0]=d);var j=[],k=C(i,g.args[0],function(a){a.checked&&j.push(a.value)});h.args=[j],h.command=K(I),h.itemsSnapshot=k}else h.args=[],h.command=K(J);b.setCachedState(a,h)};c(a.editedFormulaStack.column,a.editedFormulaStack.formulas,a.formulaArgsChange,a.filteredRowsFactory),a.dependentFormulaStacks.length&&c(a.dependentFormulaStacks[0].column,a.dependentFormulaStacks[0].formulas,a.formulaArgsChange,a.filteredRowsFactory,a.editedFormulaStack)},getMultipleSelectElement:function(){return this.elements.filter(function(a){return a instanceof G})[0]},getMenuItemDescriptor:function(){var a=this;return{key:"filter_by_value",name:"Filter by Value",isCommand:!1,disableSelection:!0,hidden:function(){return a.isHidden()},renderer:function(b,c,d,e,f,g){p(c.parentNode,"htFiltersMenuValue");var h=document.createElement("div");return p(h,"htFiltersMenuLabel"),h.textContent="根据值筛选:",c.appendChild(h),s(a.elements,function(a){return c.appendChild(a.element)}),c}}},reset:function(){var a=B(this._getColumnVisibleValues()),b=C(a,a);this.getMultipleSelectElement().setItems(b),$traceurRuntime.superGet(this,M.prototype,"reset").call(this),this.getMultipleSelectElement().setValue(a)},onInputKeyDown:function(a){F(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),q(a))},_getColumnVisibleValues:function(){var a=this.hot.getPlugin("filters").getSelectedColumn(),b=a&&a.visualIndex;return v(this.hot.getDataAtCol(b),function(a){return D(a)})}},{},E)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort":134,_base:155,constants:159,formulaRegisterer:184,"ui/multipleSelect":188,utils:190}],159:[function(a,b,c){"use strict";function ea(a){var b=[];return da[a]||(a=ba),E(da[a],function(a){var c;c=a===F?{name:F}:D(G(a)),b.push(c)}),b}var d;Object.defineProperties(c,{FORMULA_NONE:{get:function(){return H}},FORMULA_EMPTY:{get:function(){return I}},FORMULA_NOT_EMPTY:{get:function(){return J}},FORMULA_EQUAL:{get:function(){return K}},FORMULA_NOT_EQUAL:{get:function(){return L}},FORMULA_GREATER_THAN:{get:function(){return M}},FORMULA_GREATER_THAN_OR_EQUAL:{get:function(){return N}},FORMULA_LESS_THAN:{get:function(){return O}},FORMULA_LESS_THAN_OR_EQUAL:{get:function(){return P}},FORMULA_BETWEEN:{get:function(){return Q}},FORMULA_NOT_BETWEEN:{get:function(){return R}},FORMULA_BEGINS_WITH:{get:function(){return S}},FORMULA_ENDS_WITH:{get:function(){return T}},FORMULA_CONTAINS:{get:function(){return U}},FORMULA_NOT_CONTAINS:{get:function(){return V}},FORMULA_DATE_BEFORE:{get:function(){return W}},FORMULA_DATE_AFTER:{get:function(){return X}},FORMULA_TOMORROW:{get:function(){return Y}},FORMULA_TODAY:{get:function(){return Z}},FORMULA_YESTERDAY:{get:function(){return $}},FORMULA_BY_VALUE:{get:function(){return _}},TYPE_NUMERIC:{get:function(){return aa}},TYPE_TEXT:{get:function(){return ba}},TYPE_DATE:{get:function(){return ca}},TYPES:{get:function(){return da}},getOptionsList:{get:function(){return ea}},__esModule:{value:!0}});var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).clone,E=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,F=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"))&&g.__esModule&&g||{default:g}).SEPARATOR,G=((h=a("formulaRegisterer"))&&h.__esModule&&h||{default:h}).getFormulaDescriptor,H=((i=a("formula/none"))&&i.__esModule&&i||{default:i}).FORMULA_NAME,I=((j=a("formula/empty"))&&j.__esModule&&j||{default:j}).FORMULA_NAME,J=((k=a("formula/notEmpty"))&&k.__esModule&&k||{default:k}).FORMULA_NAME,K=((l=a("formula/equal"))&&l.__esModule&&l||{default:l}).FORMULA_NAME,L=((m=a("formula/notEqual"))&&m.__esModule&&m||{default:m}).FORMULA_NAME,M=((n=a("formula/greaterThan"))&&n.__esModule&&n||{default:n}).FORMULA_NAME,N=((o=a("formula/greaterThanOrEqual"))&&o.__esModule&&o||{default:o}).FORMULA_NAME,O=((p=a("formula/lessThan"))&&p.__esModule&&p||{default:p}).FORMULA_NAME,P=((q=a("formula/lessThanOrEqual"))&&q.__esModule&&q||{default:q}).FORMULA_NAME,Q=((r=a("formula/between"))&&r.__esModule&&r||{default:r}).FORMULA_NAME,R=((s=a("formula/notBetween"))&&s.__esModule&&s||{default:s}).FORMULA_NAME,S=((t=a("formula/beginsWith"))&&t.__esModule&&t||{default:t}).FORMULA_NAME,T=((u=a("formula/endsWith"))&&u.__esModule&&u||{default:u}).FORMULA_NAME,U=((v=a("formula/contains"))&&v.__esModule&&v||{default:v}).FORMULA_NAME,V=((w=a("formula/notContains"))&&w.__esModule&&w||{default:w}).FORMULA_NAME,W=((x=a("formula/date/before"))&&x.__esModule&&x||{default:x}).FORMULA_NAME,X=((y=a("formula/date/after"))&&y.__esModule&&y||{default:y}).FORMULA_NAME,Y=((z=a("formula/date/tomorrow"))&&z.__esModule&&z||{default:z}).FORMULA_NAME,Z=((A=a("formula/date/today"))&&A.__esModule&&A||{default:A}).FORMULA_NAME,$=((B=a("formula/date/yesterday"))&&B.__esModule&&B||{default:B}).FORMULA_NAME,_=((C=a("formula/byValue"))&&C.__esModule&&C||{default:C}).FORMULA_NAME,aa="numeric",ba="text",ca="date",da=(d={},Object.defineProperty(d,aa,{value:[H,F,I,J,F,K,L,F,M,N,O,P,Q,R],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,ba,{value:[H,F,I,J,F,K,L,F,S,T,F,U,V],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,ca,{value:[H,F,I,J,F,K,L,F,W,X,Q,F,Y,Z,$],configurable:!0,enumerable:!0,writable:!0}),d)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"formula/beginsWith":162,"formula/between":163,"formula/byValue":164,"formula/contains":165,"formula/date/after":166,"formula/date/before":167,"formula/date/today":168,"formula/date/tomorrow":169,"formula/date/yesterday":170,"formula/empty":171,"formula/endsWith":172,"formula/equal":173,"formula/greaterThan":174,"formula/greaterThanOrEqual":175,"formula/lessThan":176,"formula/lessThanOrEqual":177,"formula/none":178,"formula/notBetween":179,"formula/notContains":180,"formula/notEmpty":181,"formula/notEqual":182,formulaRegisterer:184}],160:[function(a,b,c){"use strict";Object.defineProperties(c,{DataFilter:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,g=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,h=function(b){var c=void 0!==arguments[1]?arguments[1]:function(a){return[]};this.formulaCollection=b,this.columnDataFactory=c};$traceurRuntime.createClass(h,{filter:function(){var a=this,b=[];return this.formulaCollection.isEmpty()||g(this.formulaCollection.orderStack,function(c,d){var e=a.columnDataFactory(c);d&&(e=a._getIntersectData(e,b)),b=a.filterByColumn(c,e)}),b},filterByColumn:function(a){var b=void 0!==arguments[1]?arguments[1]:[],c=this,d=[];return g(b,function(b){void 0!==b&&c.formulaCollection.isMatch(b,a)&&d.push(b)}),d},_getIntersectData:function(a,b){var c=[];return g(b,function(b){var d=b.meta.visualRow;void 0!==a[d]&&(c[d]=a[d])}),c}},{}),f.utils.FiltersDataFilter=h},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../browser":141}],161:[function(a,b,c){"use strict";Object.defineProperties(c,{Filters:{get:function(){return Q}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,t=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e},u=t.arrayEach,v=t.arrayMap,x=(t.arrayIncludes,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach),y=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&g.__esModule&&g||{default:g}).EventManager,z=(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&h.__esModule&&h||{default:h},A=z.addClass,B=z.removeClass,C=z.closest,D=((i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&i.__esModule&&i||{default:i}).registerPlugin,E=((j=a("component/condition"))&&j.__esModule&&j||{default:j}).ConditionComponent,F=((k=a("component/value"))&&k.__esModule&&k||{default:k}).ValueComponent,G=((l=a("component/actionBar"))&&l.__esModule&&l||{default:l}).ActionBarComponent,H=((m=a("formulaCollection"))&&m.__esModule&&m||{default:m}).FormulaCollection,I=((n=a("dataFilter"))&&n.__esModule&&n||{default:n}).DataFilter,J=((o=a("formulaUpdateObserver"))&&o.__esModule&&o||{default:o}).FormulaUpdateObserver,K=(p=a("utils"))&&p.__esModule&&p||{default:p},L=K.createArrayAssertion,M=K.toEmptyString,N=K.unifyColumnValues,O=((q=a("constants"))&&q.__esModule&&q||{default:q}).FORMULA_NONE,P=((r=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"))&&r.__esModule&&r||{default:r}).SEPARATOR,Q=function(b){var c=this;$traceurRuntime.superConstructor(R).call(this,b),this.eventManager=new y(this),this.trimRowsPlugin=null,this.dropdownMenuPlugin=null,this.formulaCollection=null,this.formulaUpdateObserver=null,this.conditionComponent=null,this.valueComponent=null,this.actionBarComponent=null,this.lastSelectedColumn=null,this.hot.addHook("afterGetColHeader",function(a,b){return c.onAfterGetColHeader(a,b)})},R=Q;$traceurRuntime.createClass(Q,{isEnabled:function(){return!!this.hot.getSettings().filters},enablePlugin:function(){var a=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var b=function(b){return b.addLocalHook("accept",function(){return a.onActionBarSubmit("accept")}),b.addLocalHook("cancel",function(){return a.onActionBarSubmit("cancel")}),b.addLocalHook("change",function(c){return a.onComponentChange(b,c)}),b};this.conditionComponent||(this.conditionComponent=b(new E(this.hot))),this.valueComponent||(this.valueComponent=b(new F(this.hot))),this.actionBarComponent||(this.actionBarComponent=b(new G(this.hot))),this.formulaCollection||(this.formulaCollection=new H),this.formulaUpdateObserver||(this.formulaUpdateObserver=new J(this.formulaCollection,function(b){return a.getDataMapAtColumn(b)}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.conditionComponent).updateState.apply(b,$traceurRuntime.spread(c))}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a.valueComponent).updateState.apply(b,$traceurRuntime.spread(c))})),this.conditionComponent.show(),this.valueComponent.show(),this.actionBarComponent.show(),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(b){return a.onBeforeDropdownMenuSetItems(b)}),this.addHook("afterDropdownMenuDefaultOptions",function(b){return a.onAfterDropdownMenuDefaultOptions(b)}),this.addHook("afterDropdownMenuShow",function(){return a.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return a.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(b,c){return a.onAfterChange(b)}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),$traceurRuntime.superGet(this,R.prototype,"enablePlugin").call(this)}},registerEvents:function(){var a=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(b){return a.onTableClick(b)})},disablePlugin:function(){this.enabled&&(this.conditionComponent.hide(),this.valueComponent.hide(),this.actionBarComponent.hide(),this.formulaCollection.clean(),this.trimRowsPlugin.untrimAll()),$traceurRuntime.superGet(this,R.prototype,"disablePlugin").call(this)},addFormula:function(a,b,c){var d=this.t.toPhysicalColumn(a);this.formulaCollection.addFormula(d,{command:{key:b},args:c})},removeFormulas:function(a){var b=this.t.toPhysicalColumn(a);this.formulaCollection.removeFormulas(b)},clearFormulas:function(a){var b=this.t.toPhysicalColumn(a);void 0===a?this.formulaCollection.clean():this.formulaCollection.clearFormulas(b)},filter:function(){var a=this._createDataFilter(),b=!this.formulaCollection.isEmpty(),c=[],d=this.formulaCollection.exportAllFormulas();if(!1!==this.hot.runHooks("beforeFilter",d))if(b){var f=[];this.trimRowsPlugin.trimmedRows.length=0,c=v(a.filter(),function(a){return a.meta.visualRow});var g=L(c);x(this.hot.countSourceRows()-1,function(a){g(a)||f.push(a)}),this.trimRowsPlugin.trimRows(f),c.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",d)},getSelectedColumn:function(){return this.lastSelectedColumn},clearColumnSelection:function(){var a=this.hot.getSelected()||[],b=a[0],c=a[1];void 0!==b&&void 0!==c&&this.hot.selectCell(b,c)},getDataMapAtColumn:function(a){var b=this,c=this.t.toVisualColumn(a),d=[];return u(this.hot.getSourceDataAtCol(c),function(a,e){var f=b.hot.getCellMeta(e,c),g=f.row,h=f.col,i=f.visualCol,j=f.visualRow,k=f.type,l=f.instance,m=f.dateFormat;d.push({meta:{row:g,col:h,visualCol:i,visualRow:j,type:k,instance:l,dateFormat:m},value:M(a)})}),d},onAfterChange:function(a){var b=this;a&&u(a,function(a){var c=a[1],d=b.hot.propToCol(c);b.updateValueComponentFormula(d)})},updateValueComponentFormula:function(a){var b=this.hot.getDataAtCol(a),c=N(b);this.formulaUpdateObserver.updateStatesAtColumn(a,c)},onAfterDropdownMenuShow:function(){var a=this.getSelectedColumn(),b=a&&a.physicalIndex,c=this.conditionComponent,d=this.valueComponent;c.isHidden()||c.restoreState(b),d.isHidden()||d.restoreState(b)},onAfterDropdownMenuHide:function(){this.conditionComponent.getSelectElement().closeOptions()},onBeforeDropdownMenuSetItems:function(a){var b=v(a,function(a){return a.key}),c=this.conditionComponent,d=this.valueComponent;c[-1===b.indexOf(c.getMenuItemDescriptor().key)?"hide":"show"](),d[-1===b.indexOf(d.getMenuItemDescriptor().key)?"hide":"show"]()},onAfterDropdownMenuDefaultOptions:function(a){a.items.push({name:P}),a.items.push(this.conditionComponent.getMenuItemDescriptor()),a.items.push(this.valueComponent.getMenuItemDescriptor()),a.items.push(this.actionBarComponent.getMenuItemDescriptor())},onActionBarSubmit:function(a){if("accept"===a){var b=this.getSelectedColumn(),c=b&&b.physicalIndex,d=this.conditionComponent.getState(),e=this.valueComponent.getState();this.formulaUpdateObserver.groupChanges(),this.formulaCollection.clearFormulas(c),d.command.key===O&&e.command.key===O&&this.formulaCollection.removeFormulas(c),d.command.key!==O&&this.formulaCollection.addFormula(c,d),e.command.key!==O&&this.formulaCollection.addFormula(c,e),this.formulaUpdateObserver.flush(),this.conditionComponent.saveState(c),this.valueComponent.saveState(c),this.filter()}this.dropdownMenuPlugin.close()},onComponentChange:function(a,b){a!==this.conditionComponent||b.inputsCount||this.dropdownMenuPlugin.setListening()},onAfterGetColHeader:function(a,b){var c=this.t.toPhysicalColumn(a);this.enabled&&this.formulaCollection.hasFormulas(c)?A(b,"htFiltersActive"):B(b,"htFiltersActive")},onTableClick:function(a){var b=C(a.target,"TH");if(b){var c=this.hot.getCoords(b).col,d=this.t.toPhysicalColumn(c);this.lastSelectedColumn={visualIndex:c,physicalIndex:d}}},destroy:function(){this.enabled&&(this.conditionComponent.destroy(),this.valueComponent.destroy(),this.actionBarComponent.destroy(),this.formulaCollection.destroy(),this.formulaUpdateObserver.destroy()),$traceurRuntime.superGet(this,R.prototype,"destroy").call(this)},_createDataFilter:function(){var a=void 0!==arguments[0]?arguments[0]:this.formulaCollection,b=this;return new I(a,function(a){return b.getDataMapAtColumn(a)})}},{},s),D("filters",Q)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"component/actionBar":156,"component/condition":157,"component/value":158,constants:159,dataFilter:160,formulaCollection:183,formulaUpdateObserver:185,utils:190}],162:[function(a,b,c){"use strict";function k(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return h(i(a.value).toLowerCase(),i(b))}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&e.__esModule&&e||{default:e}).startsWith,i=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"))&&f.__esModule&&f||{default:f}).stringify,j="begins_with";g(j,k,{name:"以...开始",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],163:[function(a,b,c){"use strict";function m(a){var b=void 0!==arguments[1]?arguments[1]:inputValues,c=b[0],d=b[1];if("numeric"===a.meta.type){var e=parseFloat(c,10),f=parseFloat(d,10);c=Math.min(e,f),d=Math.max(e,f)}else if("date"===a.meta.type){var g=i(k,[d]),h=i(j,[c]);return g(a)&&h(a)}return a.value>=c&&a.value<=d}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g=(d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d},h=g.registerFormula,i=g.getFormula,j=((e=a("date/after"))&&e.__esModule&&e||{default:e}).FORMULA_NAME,k=((f=a("date/before"))&&f.__esModule&&f||{default:f}).FORMULA_NAME,l="between";h(l,m,{name:"在...之间",inputsCount:2})},{"date/after":166,"date/before":167,formulaRegisterer:184}],164:[function(a,b,c){"use strict";function i(a){return(0,(void 0!==arguments[1]?arguments[1]:inputValues)[0])(a.value)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("utils"))&&e.__esModule&&e||{default:e}).createArrayAssertion,h="by_value";f(h,i,{name:"根据值",inputsCount:0,inputValuesDecorator:function(){var a=(void 0!==arguments[0]?arguments[0]:inputValues)[0];return[g(a)]}})},{formulaRegisterer:184,utils:190}],165:[function(a,b,c){"use strict";function i(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return g(a.value).toLowerCase().indexOf(g(b))>=0}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"))&&e.__esModule&&e||{default:e}).stringify,h="contains";f(h,i,{name:"包含",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],166:[function(a,b,c){"use strict";function i(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0],c=g(a.value,a.meta.dateFormat),d=g(b,a.meta.dateFormat);return!(!c.isValid()||!d.isValid())&&c.diff(d)>=0}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h="date_after";f(h,i,{name:"在之后",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],167:[function(a,b,c){"use strict";function i(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0],c=g(a.value,a.meta.dateFormat),d=g(b,a.meta.dateFormat);return!(!c.isValid()||!d.isValid())&&c.diff(d)<=0}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h="date_before";f(h,i,{name:"在之前",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],168:[function(a,b,c){"use strict";function i(a){var b=g(a.value,a.meta.dateFormat);return!!b.isValid()&&b.isSame(g().startOf("day"),"d")}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h="date_today";f(h,i,{name:"今天",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],169:[function(a,b,c){"use strict";function i(a){var b=g(a.value,a.meta.dateFormat);return!!b.isValid()&&b.isSame(g().subtract(-1,"days").startOf("day"),"d")}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h="date_tomorrow";f(h,i,{name:"明天",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],170:[function(a,b,c){"use strict";function i(a){var b=g(a.value,a.meta.dateFormat);return!!b.isValid()&&b.isSame(g().subtract(1,"days").startOf("day"),"d")}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,g=((e=a("moment"))&&e.__esModule&&e||{default:e}).default,h="date_yesterday";f(h,i,{name:"昨天",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],171:[function(a,b,c){"use strict";function g(a){return""===a.value||null===a.value||void 0===a.value}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="empty";e(f,g,{name:"为空",inputsCount:0})},{formulaRegisterer:184}],172:[function(a,b,c){"use strict";function k(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return h(i(a.value).toLowerCase(),i(b))}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f,g=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&e.__esModule&&e||{default:e}).endsWith,i=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"))&&f.__esModule&&f||{default:f}).stringify,j="ends_with";g(j,k,{name:"以...结尾",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],173:[function(a,b,c){"use strict";function i(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return f(a.value).toLowerCase()===f(b)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"))&&d.__esModule&&d||{default:d}).stringify,g=((e=a("formulaRegisterer"))&&e.__esModule&&e||{default:e}).registerFormula,h="eq";g(h,i,{name:"等于",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],174:[function(a,b,c){"use strict";function g(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===a.meta.type&&(b=parseFloat(b,10)),a.value>b}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="gt";e(f,g,{name:"大于",inputsCount:1})},{formulaRegisterer:184}],175:[function(a,b,c){"use strict";function g(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===a.meta.type&&(b=parseFloat(b,10)),a.value>=b}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="gte";e(f,g,{name:"大于等于",inputsCount:1})},{formulaRegisterer:184}],176:[function(a,b,c){"use strict";function g(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===a.meta.type&&(b=parseFloat(b,10)),a.value<b}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="lt";e(f,g,{name:"小于",inputsCount:1})},{formulaRegisterer:184}],177:[function(a,b,c){"use strict";function g(a){var b=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===a.meta.type&&(b=parseFloat(b,10)),a.value<=b}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="lte";e(f,g,{name:"小于等于",inputsCount:1})},{formulaRegisterer:184}],178:[function(a,b,c){"use strict";function g(){return!0}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d}).registerFormula,f="none";e(f,g,{name:"无条件",inputsCount:0})},{formulaRegisterer:184}],179:[function(a,b,c){"use strict";function k(a,b){return!h(i,b)(a)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=(d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d},g=f.registerFormula,h=f.getFormula,i=((e=a("between"))&&e.__esModule&&e||{default:e}).FORMULA_NAME,j="not_between";g(j,k,{name:"不在...之间",inputsCount:2})},{between:163,formulaRegisterer:184}],180:[function(a,b,c){"use strict";function k(a,b){return!h(i,b)(a)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=(d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d},g=f.registerFormula,h=f.getFormula,i=((e=a("contains"))&&e.__esModule&&e||{default:e}).FORMULA_NAME,j="not_contains";g(j,k,{name:"不包含",inputsCount:1})},{contains:165,formulaRegisterer:184}],181:[function(a,b,c){"use strict";function k(a,b){return!h(i,b)(a)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=(d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d},g=f.registerFormula,h=f.getFormula,i=((e=a("empty"))&&e.__esModule&&e||{default:e}).FORMULA_NAME,j="not_empty";g(j,k,{name:"非空值",inputsCount:0})},{empty:171,formulaRegisterer:184}],182:[function(a,b,c){"use strict";function k(a,b){return!h(i,b)(a)}Object.defineProperties(c,{FORMULA_NAME:{get:function(){return j}},__esModule:{value:!0}});var d,e,f=(d=a("formulaRegisterer"))&&d.__esModule&&d||{default:d},g=f.registerFormula,h=f.getFormula,i=((e=a("equal"))&&e.__esModule&&e||{default:e}).FORMULA_NAME,j="neq";g(j,k,{name:"不等于",inputsCount:1})},{equal:173,formulaRegisterer:184}],183:[function(a,b,c){"use strict";Object.defineProperties(c,{FormulaCollection:{get:function(){return q}},__esModule:{value:!0}});var d,e,f,g,h=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d},i=h.arrayEach,j=h.arrayMap,k=h.arrayFilter,l=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e},m=l.objectEach,n=l.mixin,o=((f=a("formulaRegisterer"))&&f.__esModule&&f||{default:f}).getFormula,p=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&g.__esModule&&g||{default:g}).localHooks,q=function(){this.formulas=Object.create(null),this.orderStack=[]};$traceurRuntime.createClass(q,{isEmpty:function(){return!this.orderStack.length},isMatch:function(a,b){var c=this,d=!0;return void 0===b?m(this.formulas,function(b){return d=c.isMatchInFormulas(b,a)}):d=this.isMatchInFormulas(this.getFormulas(b),a),d},isMatchInFormulas:function(a,b){var c=!1;return a.length?i(a,function(a){return c=a.func(b)}):c=!0,c},addFormula:function(a,b){var c=j(b.args,function(a){return"string"==typeof a?a.toLowerCase():a}),d=b.name||b.command.key;this.runLocalHooks("beforeAdd",a),-1===this.orderStack.indexOf(a)&&this.orderStack.push(a),this.hasFormulas(a,d)?i(this.getFormulas(a),function(a){if(a.name===d)return a.func=o(a.name,c),a.args=c,!1}):this.getFormulas(a).push({name:d,args:c,func:o(d,c)}),this.runLocalHooks("afterAdd",a)},getFormulas:function(a){return this.formulas[a]||(this.formulas[a]=[]),this.formulas[a]},exportAllFormulas:function(){var a=this,b=[];return i(this.orderStack,function(c){var d=j(a.getFormulas(c),function(){var a=void 0!==arguments[0]?arguments[0]:formula;return{name:a.name,args:a.args}});b.push({column:c,formulas:d})}),b},importAllFormulas:function(a){var b=this;this.clean(),i(a,function(a){b.orderStack.push(a.column),i(a.formulas,function(c){return b.addFormula(a.column,c)})})},removeFormulas:function(a){this.runLocalHooks("beforeRemove",a),this.orderStack.indexOf(a)>=0&&this.orderStack.splice(this.orderStack.indexOf(a),1),this.clearFormulas(a),this.runLocalHooks("afterRemove",a)},clearFormulas:function(a){this.runLocalHooks("beforeClear",a),this.getFormulas(a).length=0,this.runLocalHooks("afterClear",a)},hasFormulas:function(a,b){var d=this.getFormulas(a);return b?k(d,function(a){return a.name===b}).length>0:d.length>0},clean:function(){this.runLocalHooks("beforeClean"),this.formulas=Object.create(null),this.orderStack.length=0,this.runLocalHooks("afterClean")},destroy:function(){this.clearLocalHooks(),this.formulas=null,this.orderStack=null}},{}),n(q,p)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,formulaRegisterer:184}],184:[function(a,b,c){"use strict";function g(a,b){if(!f[a])throw Error('Filter formula "'+a+'" does not exist.');var c=f[a],d=c.formula,e=c.descriptor;return e.inputValuesDecorator&&(b=e.inputValuesDecorator(b)),function(a){return d.apply(a.meta.instance,[].concat([a],[b]))}}function h(a){if(!f[a])throw Error('Filter formula "'+a+'" does not exist.');return f[a].descriptor}function i(a,b,c){c.key=a,f[a]={formula:b,descriptor:c}}Object.defineProperties(c,{getFormula:{get:function(){return g}},getFormulaDescriptor:{get:function(){return h}},registerFormula:{get:function(){return i}},__esModule:{value:!0}});var d,e=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,f={};e.utils.FiltersFormulaRegisterer={getFormula:g,registerFormula:i,getFormulaDescriptor:h,formulas:f}},{"../../browser":141}],185:[function(a,b,c){"use strict";Object.defineProperties(c,{FormulaUpdateObserver:{get:function(){return y}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d},l=k.arrayEach,m=k.arrayMap,n=k.arrayFilter,o=((e=a("formulaCollection"))&&e.__esModule&&e||{default:e}).FormulaCollection,p=((f=a("dataFilter"))&&f.__esModule&&f||{default:f}).DataFilter,q=((g=a("utils"))&&g.__esModule&&g||{default:g}).createArrayAssertion,r=(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&h.__esModule&&h||{default:h},s=r.mixin,t=r.objectEach,u=(i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"))&&i.__esModule&&i||{default:i},v=u.curry,x=(u.debounce,((j=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&j.__esModule&&j||{default:j}).localHooks),y=function(b){var c=void 0!==arguments[1]?arguments[1]:function(a){return[]},d=this;this.formulaCollection=b,this.columnDataFactory=c,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.formulaCollection.addLocalHook("beforeRemove",function(a){return d._onFormulaBeforeModify(a)}),this.formulaCollection.addLocalHook("afterAdd",function(a){return d.updateStatesAtColumn(a)}),this.formulaCollection.addLocalHook("afterClear",function(a){return d.updateStatesAtColumn(a)}),this.formulaCollection.addLocalHook("beforeClean",function(){return d._onFormulaBeforeClean()}),this.formulaCollection.addLocalHook("afterClean",function(){return d._onFormulaAfterClean()})};$traceurRuntime.createClass(y,{groupChanges:function(){this.grouping=!0},flush:function(){var a=this;this.grouping=!1,l(this.changes,function(b){return a.updateStatesAtColumn(b)}),this.changes.length=0},_onFormulaBeforeModify:function(a){this.latestEditedColumnPosition=this.formulaCollection.orderStack.indexOf(a)},updateStatesAtColumn:function(a,b){var c=this;if(this.grouping)return void(-1===this.changes.indexOf(a)&&this.changes.push(a));var d=this.formulaCollection.exportAllFormulas(),e=this.formulaCollection.orderStack.indexOf(a);-1===e&&(e=this.latestEditedColumnPosition);var f=d.slice(0,e),g=d.slice(e);g.length&&g[0].column===a&&g.shift();var h=v(function(a,b){var d=void 0!==arguments[2]?arguments[2]:[],e=new o;a=[].concat(a,d),e.importAllFormulas(a);var g,f=c.columnDataFactory(b);g=e.isEmpty()?f:new p(e,function(a){return c.columnDataFactory(a)}).filter(),g=m(g,function(a){return a.meta.visualRow});var h=q(g);return n(f,function(a){return h(a.meta.visualRow)})})(f),i=[].concat(this.formulaCollection.getFormulas(a));this.runLocalHooks("update",{editedFormulaStack:{column:a,formulas:i},dependentFormulaStacks:g,filteredRowsFactory:h,formulaArgsChange:b})},_onFormulaBeforeClean:function(){this.latestOrderStack=[].concat(this.formulaCollection.orderStack)},_onFormulaAfterClean:function(){var a=this;l(this.latestOrderStack,function(b){return a.updateStatesAtColumn(b)})},destroy:function(){var a=this;this.clearLocalHooks(),t(this,function(b,c){return a[c]=null})}},{}),s(y,x)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,dataFilter:160,formulaCollection:183,utils:190}],186:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseUI:{get:function(){return u}},__esModule:{value:!0}});var d,e,f,g,h,d,i=(d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&d.__esModule&&d||{default:d},j=i.clone,k=i.extend,l=i.mixin,m=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&e.__esModule&&e||{default:e}).localHooks,n=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&f.__esModule&&f||{default:f}).EventManager,o=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&g.__esModule&&g||{default:g}).addClass,p=((h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&h.__esModule&&h||{default:h}).arrayEach,q=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&d.__esModule&&d||{default:d}).objectEach,r="built",s="building",t=["click","input","keydown","keypress","keyup","focus","blur"],u=function(b,c){this.hot=b,this.eventManager=new n(this),this.options=k(v.DEFAULTS,c),this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1},v=u;$traceurRuntime.createClass(u,{setValue:function(a){this.options.value=a,this.update()},getValue:function(){return this.options.value},get element(){return this.buildState===s?this._element:this.buildState===r?(this.update(),this._element):(this.buildState=s,this.build(),this.buildState=r,this._element)},isBuilt:function(){return this.buildState===r},build:function(){var a=this,b=function(b,c){a.eventManager.addEventListener(b,c,function(b){return a.runLocalHooks(c,b,a)})};if(this.buildState||(this.buildState=s),this.options.className&&o(this._element,this.options.className),this.options.children.length)p(this.options.children,function(b){return a._element.appendChild(b.element)});else if(this.options.wrapIt){var c=document.createElement(this.options.tagName);q(this.options,function(a,b){void 0!==c[b]&&"className"!==b&&"tagName"!==b&&"children"!==b&&(c[b]=a)}),this._element.appendChild(c),p(t,function(a){return b(c,a)})}else p(t,function(c){return b(a._element,c)})},update:function(){},reset:function(){this.options.value="",this.update()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},focus:function(){},destroy:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{get DEFAULTS(){return j({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}),l(u,m)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58}],187:[function(a,b,c){"use strict";Object.defineProperties(c,{InputUI:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,i=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&e.__esModule&&e||{default:e}).addClass,j=(f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&f.__esModule&&f||{default:f},k=j.clone,l=j.extend,n=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&g.__esModule,new WeakMap),o=function(b,c){n.set(this,{}),$traceurRuntime.superConstructor(p).call(this,b,l(p.DEFAULTS,c)),this.registerHooks()},p=o;$traceurRuntime.createClass(o,{registerHooks:function(){var a=this;this.addLocalHook("click",function(b){return a.onClick(b)}),this.addLocalHook("keyup",function(b){return a.onKeyup(b)})},build:function(){$traceurRuntime.superGet(this,p.prototype,"build").call(this);var a=n.get(this),b=document.createElement("div");a.input=this._element.firstChild,i(this._element,"htUIInput"),i(b,"htUIInputIcon"),this._element.appendChild(b),this.update()},update:function(){if(this.isBuilt()){var a=n.get(this).input;a.type=this.options.type,a.value=this.options.value}},focus:function(){this.isBuilt()&&n.get(this).input.focus()},onClick:function(a){},onKeyup:function(a){this.options.value=a.target.value}},{get DEFAULTS(){return k({placeholder:"",type:"text",tagName:"input"})}},h)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,_base:186}],188:[function(a,b,c){"use strict";function J(a,b){var c=F(b);return y(a,function(a){return a.checked=c(a.value),a})}function K(a){var b=[];return z(a,function(a){a.checked&&b.push(a.value)}),b}Object.defineProperties(c,{MultipleSelectUI:{get:function(){return H}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o,p=((d=a("../../../browser"))&&d.__esModule&&d||{default:d}).default,q=((e=a("_base"))&&e.__esModule&&e||{default:e}).BaseUI,r=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&f.__esModule&&f||{default:f}).addClass,t=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"))&&g.__esModule,(h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&h.__esModule&&h||{default:h}),u=t.clone,v=t.extend,w=(i=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&i.__esModule&&i||{default:i},x=w.arrayFilter,y=w.arrayMap,z=w.arrayEach,B=((j=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&j.__esModule,((k=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"))&&k.__esModule&&k||{default:k}).isKey),C=((l=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"))&&l.__esModule&&l||{default:l}).partial,D=((m=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&m.__esModule&&m||{default:m}).stopImmediatePropagation,E=((n=a("input"))&&n.__esModule&&n||{default:n}).InputUI,F=((o=a("utils"))&&o.__esModule&&o||{default:o}).createArrayAssertion,G=new WeakMap,H=function(b,c){G.set(this,{}),$traceurRuntime.superConstructor(I).call(this,b,v(I.DEFAULTS,c)),this.searchInput=new E(this.hot,{placeholder:"查找...",className:"htUIMultipleSelectSearch"}),this.selectAllUI=new q(this.hot,{tagName:"a",textContent:"全选",href:"#",className:"htUISelectAll"}),this.clearAllUI=new q(this.hot,{tagName:"a",textContent:"清除",href:"#",className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()},I=H;$traceurRuntime.createClass(H,{registerHooks:function(){var a=this;this.searchInput.addLocalHook("keydown",function(b){return a.onInputKeyDown(b)}),this.searchInput.addLocalHook("input",function(b){return a.onInput(b)}),this.selectAllUI.addLocalHook("click",function(b){return a.onSelectAllClick(b)}),this.clearAllUI.addLocalHook("click",function(b){return a.onClearAllClick(b)})},setItems:function(a){this.items=a,this.itemsBox&&this.itemsBox.loadData(this.items)},getItems:function(){return $traceurRuntime.spread(this.items)},getValue:function(){return K(this.items)},isSelectedAllValues:function(){return this.items.length===this.getValue().length},build:function(){var a=this;$traceurRuntime.superGet(this,I.prototype,"build").call(this);var b=document.createElement("div"),c=new q(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(c.element),this._element.appendChild(b);var d=function(b){a._element&&(a.itemsBox&&a.itemsBox.destroy(),r(b,"htUIMultipleSelectHot"),a.itemsBox=new p(b,{data:a.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],autoWrapCol:!0,colWidths:150,height:110,width:168,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(b){return a.onItemsBoxBeforeKeyDown(b)}}))};d(b),setTimeout(function(){return d(b)},100)},reset:function(){this.searchInput.reset()},update:function(){this.isBuilt()&&(this.itemsBox.loadData(J(this.items,this.options.value)),$traceurRuntime.superGet(this,I.prototype,"update").call(this))},destroy:function(){this.itemsBox&&this.itemsBox.destroy(),this.itemsBox=null,this.searchInput=null,this.items=null,$traceurRuntime.superGet(this,I.prototype,"destroy").call(this)},onInput:function(a){var c,b=a.target.value.toLowerCase();c=""===b?$traceurRuntime.spread(this.items):x(this.items,function(a){return(a.value+"").toLowerCase().indexOf(b)>=0}),this.itemsBox.loadData(c)},onInputKeyDown:function(a){this.runLocalHooks("keydown",a,this),C(B,a.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(D(a),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))},onItemsBoxBeforeKeyDown:function(a){var b=C(B,a.keyCode);b("ESCAPE")&&this.runLocalHooks("keydown",a,this),b("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(D(a),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())},onSelectAllClick:function(a){a.preventDefault(),z(this.itemsBox.getSourceData(),function(a){a.checked=!0}),this.itemsBox.render()},onClearAllClick:function(a){a.preventDefault(),z(this.itemsBox.getSourceData(),function(a){a.checked=!1}),this.itemsBox.render()}},{get DEFAULTS(){return u({className:"htUIMultipleSelect",value:[]})}},q)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../browser":141,_base:186,input:187,utils:190}],189:[function(a,b,c){"use strict";Object.defineProperties(c,{SelectUI:{get:function(){return v}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,k=(e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&e.__esModule&&e||{default:e},o=(k.addClass,k.getWindowScrollTop,k.getWindowScrollLeft,((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"))&&f.__esModule&&f||{default:f}).Menu),p=(g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&g.__esModule&&g||{default:g},q=p.clone,r=p.extend,s=((h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&h.__esModule&&h||{default:h}).arrayEach,t=((i=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"))&&i.__esModule&&i||{default:i}).SEPARATOR,u=new WeakMap,v=function(b,c){u.set(this,{}),$traceurRuntime.superConstructor(w).call(this,b,r(w.DEFAULTS,c)),this.menu=null,this.items=[],this.registerHooks()},w=v;$traceurRuntime.createClass(v,{registerHooks:function(){var a=this;this.addLocalHook("click",function(b){return a.onClick(b)})},setItems:function(a){this.items=a,this.menu&&this.menu.setMenuItems(this.items)},build:function(){var a=this;$traceurRuntime.superGet(this,w.prototype,"build").call(this),this.menu=new o(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var b=new j(this.hot,{className:"htUISelectCaption"}),c=new j(this.hot,{className:"htUISelectDropdown"});u.get(this).caption=b.element,s([b,c],function(b){return a._element.appendChild(b.element)}),this.menu.addLocalHook("select",function(b){return a.onMenuSelect(b)}),this.update()},update:function(){this.isBuilt()&&(u.get(this).caption.textContent=this.options.value?this.options.value.name:"None",$traceurRuntime.superGet(this,w.prototype,"update").call(this))},openOptions:function(){var a=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:a.left-5,top:a.top,width:a.width,height:a.height}))},closeOptions:function(){this.menu&&this.menu.close()},onMenuSelect:function(a){a.name!==t&&(this.options.value=a,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))},onClick:function(a){this.openOptions()},destroy:function(){this.menu&&(this.menu.destroy(),this.menu=null),$traceurRuntime.superGet(this,w.prototype,"destroy").call(this)}},{get DEFAULTS(){return q({className:"htUISelect",wrapIt:!1})}},j)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,_base:186}],190:[function(a,b,c){"use strict";function l(a,b){return"number"==typeof a&&"number"==typeof b?a-b:k(a,b)}function m(a){return""===a&&(a="(空)"),a}function p(a){return n&&(a=new Set(a)),function(b){return n?a.has(b):!!~a.indexOf(b)}}function q(a){return null==a?"":a}function r(a){return a=o?Array.from(new Set(a)):i(a),a=a.sort(function(a,b){return"number"==typeof a&&"number"==typeof b?a-b:a===b?0:a>b?1:-1})}function s(a,b,c){var f,d=[],e=a===b;return e||(f=p(b)),j(a,function(a){var b=!1;(e||f(a))&&(b=!0);var g={checked:b,value:a,visualValue:m(a)};c&&c(g),d.push(g)}),d}Object.defineProperties(c,{sortComparison:{get:function(){return l}},toVisualValue:{get:function(){return m}},createArrayAssertion:{get:function(){return p}},toEmptyString:{get:function(){return q}},unifyColumnValues:{get:function(){return r}},intersectValues:{get:function(){return s}},__esModule:{value:!0}});var d,e,f=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature"))&&d.__esModule&&d||{default:d}).getComparisonFunction,g=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e},i=(g.arrayMap,g.arrayUnique),j=g.arrayEach,k=f(),n=new Set([1]).has(1),o=n&&"function"==typeof Array.from},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature":49}],191:[function(a,b,c){"use strict";function w(a,b){t.has(a)||t.set(a,{prepare:b.prepare||v,operate:b.operate||v})}Object.defineProperties(c,{AlterManager:{get:function(){return u}},registerOperation:{get:function(){return w}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,m=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule,((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).mixin),n=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&f.__esModule&&f||{default:f}).localHooks,o=(g=a("alterOperation/columnSorting"))&&g.__esModule&&g||{default:g},p=(h=a("alterOperation/insertColumn"))&&h.__esModule&&h||{default:h},q=(i=a("alterOperation/insertRow"))&&i.__esModule&&i||{default:i},r=(j=a("alterOperation/removeColumn"))&&j.__esModule&&j||{default:j},s=(k=a("alterOperation/removeRow"))&&k.__esModule&&k||{default:k},t=new Map;w(o.OPERATION_NAME,o),w(p.OPERATION_NAME,p),w(q.OPERATION_NAME,q),w(r.OPERATION_NAME,r),w(s.OPERATION_NAME,s);var u=function(b){this.sheet=b,this.hot=b.hot,this.dataProvider=b.dataProvider,this.matrix=b.matrix};$traceurRuntime.createClass(u,{prepareAlter:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(!t.has(a))throw Error('Alter operation "'+a+'" not exist.');t.get(a).prepare.apply(this,b)},triggerAlter:function(a){for(var b,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(!t.has(a))throw Error('Alter operation "'+a+'" not exist.');t.get(a).operate.apply(this,c),(b=this).runLocalHooks.apply(b,$traceurRuntime.spread(["afterAlter"],c))},destroy:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}},{}),m(u,n);var v=function(){}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"alterOperation/columnSorting":192,"alterOperation/insertColumn":193,"alterOperation/insertRow":194,"alterOperation/removeColumn":195,"alterOperation/removeRow":196}],192:[function(a,b,c){"use strict";function n(){var a=this,b=a.matrix,c=a.dataProvider;m=new WeakMap,h(b.data,function(a){m.set(a,c.t.toVisualRow(a.row))})}function o(){var a=this,b=a.matrix,c=a.dataProvider;b.cellReferences.length=0,h(b.data,function(a){a.setState(j.STATE_OUT_OFF_DATE),a.clearPrecedents();var b=a,d=b.row,e=b.column,f=c.getSourceDataAtCell(d,e);if(i(f)){var g=m.get(a),h=new k(f);h.translate({row:c.t.toVisualRow(d)-g}),c.updateSourceData(d,e,h.toString())}}),m=null}Object.defineProperties(c,{OPERATION_NAME:{get:function(){return l}},prepare:{get:function(){return n}},operate:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,m,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=((e=a("utils"))&&e.__esModule&&e||{default:e}).isFormulaExpression,j=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,k=((g=a("expressionModifier"))&&g.__esModule&&g||{default:g}).ExpressionModifier,l="column_sorting"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],193:[function(a,b,c){"use strict";function o(a,b){var c=void 0===arguments[2]||arguments[2],d=this,e=d.matrix,f=d.dataProvider,g=[0,b];h(e.cellReferences,function(b){var c;b.column>=a&&(c=b).translateTo.apply(c,$traceurRuntime.spread(g))}),h(e.data,function(d){var e,h=d,i=h.row,n=h.column;if(d.column>=a&&((e=d).translateTo.apply(e,$traceurRuntime.spread(g)),d.setState(l.STATE_OUT_OFF_DATE)),c){var o=d,q=o.row,r=o.column,s=f.getSourceDataAtCell(q,r);if(k(s)){var t=j("column",a),u=new m(s);u.useCustomModifier(p),u.translate({column:b},t({row:i,column:n})),f.updateSourceData(q,r,u.toString())}}})}function p(a,b,c,d){var e=a,f=e.start,g=e.end,h=f[b].index,i=g[b].index,j=c,k=c;return d>h&&(j=0),d>i&&(k=0),[j,k,!1]}Object.defineProperties(c,{OPERATION_NAME:{get:function(){return n}},operate:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=(e=a("utils"))&&e.__esModule&&e||{default:e},j=i.cellCoordFactory,k=i.isFormulaExpression,l=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,m=((g=a("expressionModifier"))&&g.__esModule&&g||{default:g}).ExpressionModifier,n="insert_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],194:[function(a,b,c){"use strict";function o(a,b){var c=void 0===arguments[2]||arguments[2],d=this,e=d.matrix,f=d.dataProvider,g=[b,0];h(e.cellReferences,function(b){var c;b.row>=a&&(c=b).translateTo.apply(c,$traceurRuntime.spread(g))}),h(e.data,function(d){var e,h=d,i=h.row,n=h.column;if(d.row>=a&&((e=d).translateTo.apply(e,$traceurRuntime.spread(g)),d.setState(l.STATE_OUT_OFF_DATE)),c){var o=d,q=o.row,r=o.column,s=f.getSourceDataAtCell(q,r);if(k(s)){var t=j("row",a),u=new m(s);u.useCustomModifier(p),u.translate({row:b},t({row:i,column:n})),f.updateSourceData(q,r,u.toString())}}})}function p(a,b,c,d){var e=a,f=e.start,g=e.end,h=f[b].index,i=g[b].index,j=c,k=c;return d>h&&(j=0),d>i&&(k=0),[j,k,!1]}Object.defineProperties(c,{OPERATION_NAME:{get:function(){return n}},operate:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=(e=a("utils"))&&e.__esModule&&e||{default:e},j=i.cellCoordFactory,k=i.isFormulaExpression,l=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,m=((g=a("expressionModifier"))&&g.__esModule&&g||{default:g}).ExpressionModifier,n="insert_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],195:[function(a,b,c){"use strict";function o(a,b){var c=void 0===arguments[2]||arguments[2];b=-b;var d=this,e=d.matrix,f=d.dataProvider,g=d.sheet,i=[0,b],n=Math.abs(b)-1,o=e.removeCellRefsAtRange({column:a},{column:a+n}),q=[];h(e.data,function(b){h(o,function(a){b.hasPrecedent(a)&&(b.removePrecedent(a),b.setState(l.STATE_OUT_OFF_DATE),h(g.getCellDependencies(b.row,b.column),function(a){a.setState(l.STATE_OUT_OFF_DATE)}))}),b.column>=a&&b.column<=a+n&&q.push(b)}),e.remove(q),h(e.cellReferences,function(b){var c;b.column>=a&&(c=b).translateTo.apply(c,$traceurRuntime.spread(i))}),h(e.data,function(d){var e,g=d,h=g.row,n=g.column;if(d.column>=a&&((e=d).translateTo.apply(e,$traceurRuntime.spread(i)),d.setState(l.STATE_OUT_OFF_DATE)),c){var o=d,q=o.row,r=o.column,s=f.getSourceDataAtCell(q,r);if(k(s)){var t=j("column",a),u=new m(s);u.useCustomModifier(p),u.translate({column:b},t({row:h,column:n})),f.updateSourceData(q,r,u.toString())}}})}function p(a,b,c,d){var e=a,f=e.start,g=e.end,h=e.type,i=f[b].index,j=g[b].index,k=Math.abs(c)-1,l=c,m=c,n=!1;return i>=d&&j<=d+k&&(n=!0),n||"cell"!==h||d>=i&&(l=0,m=0),n||"range"!==h||(d>=i&&(l=0),d>j?m=0:j<=d+k&&(m-=Math.min(j-(d+k),0))),i+l<0&&(l-=i+l),[l,m,n]}Object.defineProperties(c,{OPERATION_NAME:{get:function(){return n}},operate:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=(e=a("utils"))&&e.__esModule&&e||{default:e},j=i.cellCoordFactory,k=i.isFormulaExpression,l=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,m=((g=a("expressionModifier"))&&g.__esModule&&g||{default:g}).ExpressionModifier,n="remove_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],196:[function(a,b,c){"use strict";function o(a,b){var c=void 0===arguments[2]||arguments[2];b=-b;var d=this,e=d.matrix,f=d.dataProvider,g=d.sheet,i=[b,0],n=Math.abs(b)-1,o=e.removeCellRefsAtRange({row:a},{row:a+n}),q=[];h(e.data,function(b){h(o,function(a){b.hasPrecedent(a)&&(b.removePrecedent(a),b.setState(l.STATE_OUT_OFF_DATE),h(g.getCellDependencies(b.row,b.column),function(a){a.setState(l.STATE_OUT_OFF_DATE)}))}),b.row>=a&&b.row<=a+n&&q.push(b)}),e.remove(q),h(e.cellReferences,function(b){var c;b.row>=a&&(c=b).translateTo.apply(c,$traceurRuntime.spread(i))}),h(e.data,function(d){var e,g=d,h=g.row,n=g.column;if(d.row>=a&&((e=d).translateTo.apply(e,$traceurRuntime.spread(i)),d.setState(l.STATE_OUT_OFF_DATE)),c){var o=d,q=o.row,r=o.column,s=f.getSourceDataAtCell(q,r);if(k(s)){var t=j("row",a),u=new m(s);u.useCustomModifier(p),u.translate({row:b},t({row:h,column:n})),f.updateSourceData(q,r,u.toString())}}})}function p(a,b,c,d){var e=a,f=e.start,g=e.end,h=e.type,i=f[b].index,j=g[b].index,k=Math.abs(c)-1,l=c,m=c,n=!1;return i>=d&&j<=d+k&&(n=!0),n||"cell"!==h||d>=i&&(l=0,m=0),n||"range"!==h||(d>=i&&(l=0),d>j?m=0:j<=d+k&&(m-=Math.min(j-(d+k),0))),i+l<0&&(l-=i+l),[l,m,n]}Object.defineProperties(c,{OPERATION_NAME:{get:function(){return n}},operate:{get:function(){return o}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,i=(e=a("utils"))&&e.__esModule&&e||{default:e},j=i.cellCoordFactory,k=i.isFormulaExpression,l=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,m=((g=a("expressionModifier"))&&g.__esModule&&g||{default:g}).ExpressionModifier,n="remove_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],197:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseCell:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&d.__esModule&&d||{default:d}).isObject,g=((e=a("hot-formula-parser"))&&e.__esModule&&e||{default:e}).toLabel,h=function(b,c){var d=f(b),e=f(c);this._row=d?b.index:b,this.rowAbsolute=!d||b.isAbsolute,this._column=e?c.index:c,this.columnAbsolute=!e||c.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(a){this._row=a},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(a){this._column=a},enumerable:!0,configurable:!0})};$traceurRuntime.createClass(h,{translateTo:function(a,b){this.row=this.row+a,this.column=this.column+b},isEqual:function(a){return a.row===this.row&&a.column===this.column},toString:function(){return g({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"hot-formula-parser":"hot-formula-parser"}],198:[function(a,b,c){"use strict";Object.defineProperties(c,{CellReference:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseCell,g=((e=a("hot-formula-parser"))&&e.__esModule&&e||{default:e}).toLabel,h=function(b,c){$traceurRuntime.superConstructor(i).call(this,b,c)},i=h;$traceurRuntime.createClass(h,{toString:function(){return g({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}},{},f)},{_base:197,"hot-formula-parser":"hot-formula-parser"}],199:[function(a,b,c){"use strict";Object.defineProperties(c,{CellValue:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseCell,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayFilter,i=((f=a("hot-formula-parser"))&&f.__esModule&&f||{default:f}).ERROR_REF,j=1,k=2,l=3,m=[j,k,l],n=function(b,c){$traceurRuntime.superConstructor(o).call(this,b,c),this.precedents=[],this.value=null,this.error=null,this.state=o.STATE_UP_TO_DATE},o=n;$traceurRuntime.createClass(n,{setValue:function(a){this.value=a},getValue:function(){return this.value},setError:function(a){this.error=a},getError:function(){return this.error},hasError:function(){return null!==this.error},setState:function(a){if(-1===m.indexOf(a))throw Error("Unrecognized state: "+a);this.state=a},isState:function(a){return this.state===a},addPrecedent:function(a){if(this.isEqual(a))throw Error(i);this.hasPrecedent(a)||this.precedents.push(a)},removePrecedent:function(a){if(this.isEqual(a))throw Error(i);this.precedents=h(this.precedents,function(b){return!b.isEqual(a)})},clearPrecedents:function(){this.precedents.length=0},getPrecedents:function(){return this.precedents},hasPrecedents:function(){return this.precedents.length>0},hasPrecedent:function(a){return!!h(this.precedents,function(b){return b.isEqual(a)}).length}},{get STATE_OUT_OFF_DATE(){return 1},get STATE_COMPUTING(){return 2},get STATE_UP_TO_DATE(){return 3}},g)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,_base:197,"hot-formula-parser":"hot-formula-parser"}],200:[function(a,b,c){"use strict";Object.defineProperties(c,{DataProvider:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,j=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&e.__esModule,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"))&&f.__esModule&&f||{default:f}).getTranslator),k=((g=a("utils"))&&g.__esModule&&g||{default:g}).isFormulaExpression,l=function(b){this.hot=b,this.changes={},this.t=j(this.hot)};$traceurRuntime.createClass(l,{collectChanges:function(a,b,c){k(c)||(this.changes[this._coordId(a,b)]=c)},clearChanges:function(){this.changes={}},isInDataRange:function(a,b){return a>=0&&a<this.hot.countRows()&&b>=0&&b<this.hot.countCols()},getDataAtCell:function(a,b){var c,d=(c=this)._coordId.apply(c,$traceurRuntime.spread(this.t.toPhysical(a,b)));return this.changes.hasOwnProperty(d)?this.changes[d]:this.hot.getDataAtCell(a,b)},getDataByRange:function(a,b,c,d){var e=this,f=this.hot.getData(a,b,c,d);return h(f,function(c,d){h(c,function(c,g){var h,i=(h=e)._coordId.apply(h,$traceurRuntime.spread(e.t.toPhysical(d+a,g+b)));e.changes.hasOwnProperty(i)&&(f[d][g]=e.changes[i])})}),f},getSourceDataAtCell:function(a,b){return this.hot.getSourceDataAtCell(a,b)},getRawDataAtCell:function(a,b){var c;return(c=this).getSourceDataAtCell.apply(c,$traceurRuntime.spread(this.t.toPhysical(a,b)))},getSourceDataByRange:function(a,b,c,d){return this.hot.getSourceDataArray(a,b,c,d)},getRawDataByRange:function(a,b,c,d){var e,f=$traceurRuntime.spread(this.t.toPhysical(a,b),this.t.toPhysical(c,d));return(e=this).getSourceDataByRange.apply(e,$traceurRuntime.spread(f))},updateSourceData:function(a,b,c){this.hot.getSourceData()[a][this.hot.colToProp(b)]=c},_coordId:function(a,b){return a+":"+b},destroy:function(){this.hot=null,this.changes=null,this.t=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,utils:206}],201:[function(a,b,c){"use strict";Object.defineProperties(c,{ExpressionModifier:{get:function(){return C}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,l=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e},m=l.arrayEach,n=l.arrayFilter,o=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"))&&f.__esModule&&f||{default:f}).startsWith,p=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&g.__esModule&&g||{default:g}).mixin,q=((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&h.__esModule&&h||{default:h}).localHooks,r=((i=a("utils"))&&i.__esModule&&i||{default:i}).toUpperCaseFormula,s=(j=a("hot-formula-parser"))&&j.__esModule&&j||{default:j},t=s.toLabel,u=s.extractLabel,v=s.error,w=s.ERROR_REF,x=/^\$?[A-Z]+\$?\d+$/,y=/\$?[A-Z]+\$?\d+/,z=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,A=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,B=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,C=function(b){this.expression="",this.cells=[],this.customModifier=null,"string"==typeof b&&this.setExpression(b)};$traceurRuntime.createClass(C,{setExpression:function(a){return this.cells.length=0,this.expression=r(a),this._extractCells(),this._extractCellsRange(),this},useCustomModifier:function(a){this.customModifier=a},translate:function(a){var b=a,c=b.row,d=b.column,e=void 0!==arguments[1]?arguments[1]:{},f=this;return m(this.cells,function(a){null!=c&&f._translateCell(a,"row",c,e.row),null!=d&&f._translateCell(a,"column",d,e.column)}),this},toString:function(){var a=this,b=this.expression.replace(B,function(b,c,d){var e=-1===b.indexOf(":"),f=b,g=b,h=null;e&&(g=x.test(c)?c:d);var i=a._searchCell(g);return i&&(h=i.refError?v(w):i.toLabel(),f=e?b.replace(g,h):h),f});return o(b,"=")||(b="="+b),b},_translateCell:function(a,b,c,d){var e,f=a,g=f.start,h=f.end,i=g[b].index,j=h[b].index,k=c,l=c,m=!1;this.customModifier?(e=this.customModifier(a,b,c,d),k=e[0],l=e[1],m=e[2]):(g[b].isAbsolute&&(k=0),h[b].isAbsolute&&(l=0)),k&&!m&&(i+k<0&&(m=!0),g[b].index=Math.max(i+k,0)),l&&!m&&(j+l<0&&(m=!0),h[b].index=Math.max(j+l,0)),m&&(a.refError=!0)},_extractCells:function(){var a=this,b=this.expression.match(z);b&&m(b,function(b){if(b=b.match(y)){var c=u(b[0]),d=c[0],e=c[1];a.cells.push(a._createCell({row:d,column:e},{row:d,column:e},b[0]))}})},_extractCellsRange:function(){var a=this,b=this.expression.match(A);b&&m(b,function(b){var c=b.split(":"),d=c[0],e=c[1],f=u(d),g=f[0],h=f[1],i=u(e),j=i[0],k=i[1],l={row:g,column:h},m={row:j,column:k};a.cells.push(a._createCell(l,m,b))})},_searchCell:function(a){return n(this.cells,function(b){return b.origLabel===a})[0]||null},_createCell:function(a,b,c){return{start:a,end:b,origLabel:c,type:-1===c.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var a=t(this.start.row,this.start.column);return"range"===this.type&&(a+=":"+t(this.end.row,this.end.column)),a}}}},{}),p(C,q),k.utils.FormulasUtils=k.utils.FormulasUtils||{},k.utils.FormulasUtils.ExpressionModifier=C},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../browser":141,"hot-formula-parser":"hot-formula-parser",utils:206}],202:[function(a,b,c){"use strict";Object.defineProperties(c,{Formulas:{get:function(){return B}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,n=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,o=(f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&f.__esModule&&f||{default:f},p=o.isObject,q=o.objectEach,r=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"))&&g.__esModule&&g||{default:g}).EventManager,s=((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&h.__esModule&&h||{default:h}).registerPlugin,t=(i=a("utils"))&&i.__esModule&&i||{default:i},u=t.isFormulaExpression,v=t.toUpperCaseFormula,w=t.isFormulaExpressionEscaped,x=t.unescapeFormulaExpression,y=((j=a("sheet"))&&j.__esModule&&j||{default:j}).Sheet,z=((k=a("dataProvider"))&&k.__esModule&&k||{default:k}).DataProvider,A=((l=a("undoRedoSnapshot"))&&l.__esModule&&l||{default:l}).UndoRedoSnapshot,B=function(b){$traceurRuntime.superConstructor(C).call(this,b),this.eventManager=new r(this),this.dataProvider=new z(this.hot),this.sheet=new y(this.hot,this.dataProvider),this.undoRedoSnapshot=new A(this.sheet),this._skipRendering=!1},C=B;$traceurRuntime.createClass(B,{isEnabled:function(){return!!this.hot.getSettings().formulas},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().formulas;p(b)&&p(b.variables)&&q(b.variables,function(b,c){return a.setVariable(c,b)}),this.addHook("afterColumnSort",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterColumnSort.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterCreateCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterCreateCol.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterCreateRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterCreateRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterLoadData",function(){return a.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterRemoveCol.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterRemoveRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterRemoveRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterSetDataAtCell",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterSetDataAtCell.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterSetDataAtRowProp",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterSetDataAtCell.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeColumnSort",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeColumnSort.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeCreateCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeCreateCol.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeCreateRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeCreateRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeRemoveCol",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeRemoveCol.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeRemoveRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeRemoveRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeValidate",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeValidate.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeValueRender",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeValueRender.apply(b,$traceurRuntime.spread(c))}),this.addHook("modifyData",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onModifyData.apply(b,$traceurRuntime.spread(c))}),this.sheet.addLocalHook("afterRecalculate",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onSheetAfterRecalculate.apply(b,$traceurRuntime.spread(c))}),$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},getCellValue:function(a,b){var c=this.sheet.getCellAt(a,b);return c?c.getError()||c.getValue():void 0},hasComputedCellValue:function(a,b){return!!this.sheet.getCellAt(a,b)},recalculate:function(){this.sheet.recalculate()},recalculateFull:function(){this.sheet.recalculateFull()},recalculateOptimized:function(){this.sheet.recalculateOptimized()},setVariable:function(a,b){this.sheet.setVariable(a,b)},getVariable:function(a){return this.sheet.getVariable(a)},onSheetAfterRecalculate:function(a,b){if(this._skipRendering)return void(this._skipRendering=!1);var c=this.hot;n(a,function(a){var b=a,d=b.row,e=b.column;c.validateCell(c.getDataAtCell(d,e),c.getCellMeta(d,e),function(){})}),c.render()},onModifyData:function(a,b,c,d){"get"===d&&this.hasComputedCellValue(a,b)?c.value=this.getCellValue(a,b):"set"===d&&u(c.value)&&(c.value=v(c.value))},onBeforeValueRender:function(a){return w(a)&&(a=x(a)),a},onBeforeValidate:function(a,b,c,d){var e=this.hot.propToCol(c);return this.hasComputedCellValue(b,e)&&(a=this.getCellValue(b,e)),a},onAfterSetDataAtCell:function(a,b){var c=this;"loadData"!==b&&(this.dataProvider.clearChanges(),n(a,function(a){var b=a,d=b[0],e=b[1],f=b[2],g=b[3];e=c.hot.propToCol(e),d=c.t.toPhysicalRow(d),u(g)&&(g=v(g)),c.dataProvider.collectChanges(d,e,g),f!==g&&c.sheet.applyChanges(d,e,g)}),this.recalculate())},onBeforeCreateRow:function(a,b,c){"UndoRedo.undo"===c&&this.undoRedoSnapshot.restore()},onAfterCreateRow:function(a,b,c){this.sheet.alterManager.triggerAlter("insert_row",a,b,"UndoRedo.undo"!==c)},onBeforeRemoveRow:function(a,b){this.undoRedoSnapshot.save("row",a,b)},onAfterRemoveRow:function(a,b){this.sheet.alterManager.triggerAlter("remove_row",a,b)},onBeforeCreateCol:function(a,b,c){"UndoRedo.undo"===c&&this.undoRedoSnapshot.restore()},onAfterCreateCol:function(a,b,c){this.sheet.alterManager.triggerAlter("insert_column",a,b,"UndoRedo.undo"!==c)},onBeforeRemoveCol:function(a,b){this.undoRedoSnapshot.save("column",a,b)},onAfterRemoveCol:function(a,b){this.sheet.alterManager.triggerAlter("remove_column",a,b)},onBeforeColumnSort:function(a,b){this.sheet.alterManager.prepareAlter("column_sorting",a,b)},onAfterColumnSort:function(a,b){this.sheet.alterManager.triggerAlter("column_sorting",a,b)},onAfterLoadData:function(){this._skipRendering=!0,this.recalculateFull()},destroy:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,$traceurRuntime.superGet(this,C.prototype,"destroy").call(this)}},{},m),s("formulas",B)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:200,sheet:204,undoRedoSnapshot:205,utils:206}],203:[function(a,b,c){"use strict";Object.defineProperties(c,{Matrix:{get:function(){return k}},__esModule:{value:!0}});var d,e,f=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d},g=f.arrayEach,h=f.arrayFilter,i=f.arrayReduce,j=((e=a("cell/value"))&&e.__esModule&&e||{default:e}).CellValue,k=function(b){this.t=b,this.data=[],this.cellReferences=[]};$traceurRuntime.createClass(k,{getCellAt:function(a,b){var c=null;return g(this.data,function(d){if(d.row===a&&d.column===b)return c=d,!1}),c},getOutOfDateCells:function(){return h(this.data,function(a){return a.isState(j.STATE_OUT_OFF_DATE)})},add:function(a){h(this.data,function(b){return b.isEqual(a)}).length||this.data.push(a)},remove:function(a){var b=Array.isArray(a),c=function(a,c){var d=!1;return b?g(c,function(b){if(a.isEqual(b))return d=!0,!1}):d=a.isEqual(c),d};this.data=h(this.data,function(b){return!c(b,a)})},getDependencies:function(a){var b=this,c=function(a){return i(b.data,function(b,c){return c.hasPrecedent(a)&&-1===b.indexOf(c)&&b.push(c),b},[])},d=function(a){var e=c(a);return e.length&&g(e,function(a){a.hasPrecedents()&&(e=e.concat(d(b.t.toVisual(a))))}),e};return d(a)},registerCellRef:function(a){h(this.cellReferences,function(b){return b.isEqual(a)}).length||this.cellReferences.push(a)},removeCellRefsAtRange:function(a,b){var c=a,d=c.row,e=c.column,f=b,g=f.row,i=f.column,j=[],k=function(a){return void 0===d||a.row>=d&&a.row<=g},l=function(a){return void 0===e||a.column>=e&&a.column<=i};return this.cellReferences=h(this.cellReferences,function(a){return!k(a)||!l(a)||(j.push(a),!1)}),j},reset:function(){this.data.length=0,this.cellReferences.length=0}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199}],204:[function(a,b,c){"use strict";Object.defineProperties(c,{Sheet:{get:function(){return K}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m,n,o=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d},p=o.arrayEach,r=(o.arrayMap,((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&e.__esModule&&e||{default:e}).rangeEach),s=((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue,t=((g=a("cell/reference"))&&g.__esModule&&g||{default:g}).CellReference,u=(h=a("utils"))&&h.__esModule&&h||{default:h},v=u.isFormulaExpression,w=u.toUpperCaseFormula,x=((i=a("matrix"))&&i.__esModule&&i||{default:i}).Matrix,y=((j=a("alterManager"))&&j.__esModule&&j||{default:j}).AlterManager,z=((k=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"))&&k.__esModule&&k||{default:k}).localHooks,A=((l=a("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"))&&l.__esModule&&l||{default:l}).getTranslator,B=(m=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&m.__esModule&&m||{default:m},D=(B.objectEach,B.mixin),E=(n=a("hot-formula-parser"))&&n.__esModule&&n||{default:n},F=E.Parser,G=E.ERROR_REF,H=1,I=2,J=3,K=function(b,c){var d=this;this.hot=b,this.t=A(this.hot),this.dataProvider=c,this.parser=new F,this.matrix=new x(this.t),this.alterManager=new y(this),this._processingCell=null,this._state=J,this.parser.on("callCellValue",function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return(a=d)._onCallCellValue.apply(a,$traceurRuntime.spread(b))}),this.parser.on("callRangeValue",function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return(a=d)._onCallRangeValue.apply(a,$traceurRuntime.spread(b))}),this.alterManager.addLocalHook("afterAlter",function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return(a=d)._onAfterAlter.apply(a,$traceurRuntime.spread(b))})};$traceurRuntime.createClass(K,{recalculate:function(){switch(this._state){case J:this.recalculateFull();break;case I:this.recalculateOptimized()}},recalculateOptimized:function(){var a=this,b=this.matrix.getOutOfDateCells();p(b,function(b){var c=a.dataProvider.getSourceDataAtCell(b.row,b.column);v(c)&&a.parseExpression(b,c.substr(1))}),this._state=H,this.runLocalHooks("afterRecalculate",b,"optimized")},recalculateFull:function(){var a=this,b=this.dataProvider.getSourceDataByRange();this.matrix.reset(),p(b,function(b,c){p(b,function(b,d){v(b)&&a.parseExpression(new s(c,d),b.substr(1))})}),this._state=H,this.runLocalHooks("afterRecalculate",b,"full")},setVariable:function(a,b){this.parser.setVariable(a,b)},getVariable:function(a){return this.parser.getVariable(a)},applyChanges:function(a,b,c){var d;this.matrix.remove({row:a,column:b}),v(c)&&this.parseExpression(new s(a,b),c.substr(1));var e=(d=this).getCellDependencies.apply(d,$traceurRuntime.spread(this.t.toVisual(a,b)));p(e,function(a){a.setState(s.STATE_OUT_OFF_DATE)}),this._state=I},parseExpression:function(a,b){a.setState(s.STATE_COMPUTING),this._processingCell=a;var c=this.parser.parse(w(b)),d=c.error,e=c.result;a.setValue(e),a.setError(d),a.setState(s.STATE_UP_TO_DATE),this.matrix.add(a),this._processingCell=null},getCellAt:function(a,b){return this.matrix.getCellAt(a,b)},getCellDependencies:function(a,b){return this.matrix.getDependencies({row:a,column:b})},_onCallCellValue:function(a,b){var c=a,d=c.row,e=c.column,f=new t(d,e);if(!this.dataProvider.isInDataRange(f.row,f.column))throw Error(G);this.matrix.registerCellRef(f),this._processingCell.addPrecedent(f),b(this.dataProvider.getDataAtCell(d.index,e.index))},_onCallRangeValue:function(a,b,c){var d=a,e=d.row,f=d.column,g=b,h=g.row,i=g.column,j=this;r(e.index,h.index,function(a){r(f.index,i.index,function(b){var c=new t(a,b);j.matrix.registerCellRef(c),j._processingCell.addPrecedent(c)})}),c(this.dataProvider.getDataByRange(e.index,f.index,h.index,i.index))},_onAfterAlter:function(){this.recalculateOptimized()},destroy:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}},{}),D(K,z)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,alterManager:191,"cell/reference":198,"cell/value":199,"hot-formula-parser":"hot-formula-parser",matrix:203,utils:206}],205:[function(a,b,c){"use strict";Object.defineProperties(c,{UndoRedoSnapshot:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,j=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&e.__esModule,((f=a("cell/value"))&&f.__esModule&&f||{default:f}).CellValue),k=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack"))&&g.__esModule&&g||{default:g}).Stack,l=function(b){this.sheet=b,this.stack=new k};$traceurRuntime.createClass(l,{save:function(a,b,c){var d=this.sheet,e=d.matrix,f=d.dataProvider,g=[];h(e.data,function(d){var e=d,h=e.row,i=e.column;if(d[a]<b||d[a]>b+(c-1)){var j=f.getSourceDataAtCell(h,i);g.push({row:h,column:i,value:j})}}),this.stack.push({axis:a,index:b,amount:c,changes:g})},restore:function(){var a=this.sheet,b=a.matrix,c=a.dataProvider,d=this.stack.pop(),e=d.axis,f=d.index,g=d.amount,i=d.changes;i&&h(i,function(a){a[e]>f+(g-1)&&(a[e]-=g);var d=a,h=d.row,i=d.column,k=d.value;c.getSourceDataAtCell(h,i)!==k&&(c.updateSourceData(h,i,k),b.getCellAt(h,i).setState(j.STATE_OUT_OFF_DATE))})},destroy:function(){this.sheet=null,this.stack=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack":129,"cell/value":199}],206:[function(a,b,c){"use strict";function f(a){return!!((a+="")&&a.length>=2&&"="===a.charAt(0))}function g(a){return!(!a||"'"!==(a+"").charAt(0)||"="!==(a+"").charAt(1))}function h(a){return g(a)?a.substr(1):a}function i(a){var b=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,c=a.match(b)||[],d=-1;return a.toUpperCase().replace(b,function(){return++d,c[d]})}function j(a,b){return function(c){return{row:"row"===a?b:c.row,column:"column"===a?b:c.column}}}Object.defineProperties(c,{isFormulaExpression:{get:function(){return f}},isFormulaExpressionEscaped:{get:function(){return g}},unescapeFormulaExpression:{get:function(){return h}},toUpperCaseFormula:{get:function(){return i}},cellCoordFactory:{get:function(){return j}},__esModule:{value:!0}});var d,e=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default;e.utils.FormulasUtils=e.utils.FormulasUtils||{},e.utils.FormulasUtils.isFormulaExpression=f,e.utils.FormulasUtils.isFormulaExpressionEscaped=g,e.utils.FormulasUtils.unescapeFormulaExpression=h,e.utils.FormulasUtils.toUpperCaseFormula=i},{"../../browser":141}],207:[function(a,b,c){"use strict";Object.defineProperties(c,{DateCalculator:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&d.__esModule&&d||{default:d}).arrayEach,g=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).objectEach,h=function(b){this.year=b,this.firstWeekDay="monday",this.weekSectionCount=0,this.monthList=this.calculateMonthData(),this.daysInColumns={},this.calculateWeekStructure()};$traceurRuntime.createClass(h,{setYear:function(a){this.year=a,this.monthList=this.calculateMonthData(),this.calculateWeekStructure()},setFirstWeekDay:function(a){var b=a.toLowerCase();"monday"!==b&&"sunday"!==b&&console.warn("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=b,this.calculateWeekStructure()},countWeekSections:function(){return this.weekSectionCount},getFirstWeekDay:function(){return this.firstWeekDay},getYear:function(){return this.year},getMonthList:function(){return this.monthList},parseDate:function(a){return a instanceof Date||(a=new Date(a),"Invalid Date"!==a.toString())?a:null},dateToColumn:function(a){if(!(a=this.parseDate(a))||a.getFullYear()!==this.year)return!1;var b=a.getMonth(),c=a.getDate()-1,d=this.daysInColumns[b],e=null;return g(d,function(a,b){if(a.indexOf(c+1)>-1)return e=parseInt(b,10),!1}),e},columnToDate:function(a){var b=null;return g(this.daysInColumns,function(c,d){if(c[a])return b=d,!1}),1===this.daysInColumns[b][a].length?new Date(this.year,b,this.daysInColumns[b][a][0]):this.daysInColumns[b][a]},isOnTheEdgeOfWeek:function(a){if(!(a=this.parseDate(a)))return null;var b=a.getMonth(),c=a.getDate()-1,d=this.daysInColumns[b],e=!1;return g(d,function(a){var b=a.indexOf(c+1);return 0===b?(e=[1,0],!1):b===a.length-1?(e=[0,1],!1):void 0}),e},addDaysToCache:function(a,b,c,d){this.daysInColumns[a]||(this.daysInColumns[a]={}),this.daysInColumns[a][b]||(this.daysInColumns[a][b]=[]);for(var e=c;e<=d;e++)this.daysInColumns[a][b].push(e)},isValidRangeBarData:function(a,b){var c=this.parseDate(a),d=this.parseDate(b);return c&&d&&c.getTime()<=d.getTime()},calculateMonthData:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}]},countMonths:function(){return this.monthList.length},countMonthDays:function(a){return this.monthList[a-1].days},countMonthFullWeeks:function(a){return this.monthList[a-1].fullWeeks},calculateWeekStructure:function(){var a=0,b=0,c=this.getFirstWeekDay(),d=this.getMonthList(),e=this.getYear();"monday"===c&&(a=1),f(d,function(c,d){var f=new Date(e,d,1).getDay();c.daysBeforeFullWeeks=(7-f+a)%7,c.fullWeeks=Math.floor((c.days-c.daysBeforeFullWeeks)/7),c.daysAfterFullWeeks=c.days-c.daysBeforeFullWeeks-7*c.fullWeeks,b+=c.fullWeeks+(c.daysBeforeFullWeeks?1:0)+(c.daysAfterFullWeeks?1:0)}),this.weekSectionCount=b}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],208:[function(a,b,c){"use strict";Object.defineProperties(c,{GanttChart:{get:function(){return A}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l,m=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d},n=m.addClass,o=m.removeClass,p=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e},q=p.objectEach,r=p.deepClone,s=p.extend,v=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule,(g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&g.__esModule,((h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data"))&&h.__esModule&&h||{default:h}).createEmptySpreadsheetData),w=((i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"))&&i.__esModule&&i||{default:i}).registerPlugin,x=((j=a("dateCalculator"))&&j.__esModule&&j||{default:j}).DateCalculator,y=((k=a("ganttChartDataFeed"))&&k.__esModule&&k||{default:k}).GanttChartDataFeed,z=((l=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"))&&l.__esModule&&l||{default:l}).default,A=function(b){$traceurRuntime.superConstructor(B).call(this,b),this.settings={},this.dateCalculator=null,this.currentYear=null,this.monthList=[],this.monthHeadersArray=[],this.weekHeadersArray=[],this.rangeBars={},this.rangeList={},this.nestedHeadersPlugin=null,this.hotSource=null,this.overallWeekSectionCount=null,this.initialSettings=null,this.dataFeed=null,this.colorData={},this.rangeBarMeta=Object.create(null)},B=A;$traceurRuntime.createClass(A,{checkDependencies:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")},isEnabled:function(){return!!this.hot.getSettings().ganttChart},enablePlugin:function(){var a=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new x(this.currentYear),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return a.onAfterInit()}),n(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),o(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,B.prototype,"updatePlugin").call(this)},parseSettings:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday")},applyDataSource:function(){if(this.settings.dataSource){var a=this.settings.dataSource;a.instance?this.loadData(a.instance,a.startDateColumn,a.endDateColumn,a.additionalData,a.asyncUpdates):this.loadData(a)}},loadData:function(a,b,c,d,e){a.length>1&&this.hot.alter("insert_row",0,a.length-1,this.pluginName+".loadData"),this.dataFeed=new y(this.hot,a,b,c,d,e),this.hot.render()},clearRangeBars:function(){this.rangeBars={}},clearRangeList:function(){this.rangeList={}},getRangeBarCoordinates:function(a){return this.rangeList[a]},generateHeaderSet:function(a){var b=this,c=[];return q(this.monthList,function(d,e){var f=d.daysBeforeFullWeeks>0?1:0,g=d.daysAfterFullWeeks>0?1:0,h=d.fullWeeks+f+g,i=parseInt(e,10);if("months"===a)c.push({label:d.name,colspan:h});else if("weeks"===a)for(var j=0;j<h;j++)if(f&&0===j){var k=j+1,l=d.daysBeforeFullWeeks;k===l?c.push(k):c.push(k+" - "+l),b.dateCalculator.addDaysToCache(i,c.length-1,k,l)}else if(g&&j===h-1){var m=d.days-d.daysAfterFullWeeks+1,n=d.days;m===n?c.push(m):c.push(m+" - "+n),b.dateCalculator.addDaysToCache(i,c.length-1,m,n)}else{var o=d.daysBeforeFullWeeks+7*(j-f)+1,p=o+6;c.push(o+" - "+p),b.dateCalculator.addDaysToCache(i,c.length-1,o,p)}else if("days"===a)for(var q=0;q<d.days;q++)c.push(q+1)}),c},generateMonthHeaders:function(){return this.generateHeaderSet("months")},generateWeekHeaders:function(){return this.generateHeaderSet("weeks")},generateDayHeaders:function(){return this.generateHeaderSet("days")},assignGanttSettings:function(){var a=this;this.initialSettings=r(this.hot.getSettings());var b={data:v(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(b,c,d,e,f,g,h){return a.uniformBackgroundRenderer(b,c,d,e,f,g,h)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(b),this.internalUpdateSettings=void 0},deassignGanttSettings:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0},cacheRangeBarMeta:function(a,b,c,d){this.rangeBarMeta[a]||(this.rangeBarMeta[a]={}),this.rangeBarMeta[a][b]||(this.rangeBarMeta[a][b]={}),this.rangeBarMeta[a][b][c]=d},applyRangeBarMetaCache:function(){var a=this;q(this.rangeBarMeta,function(b,c){q(b,function(b,d){q(b,function(b,e){a.hot.setCellMeta(c,d,e,b)})})})},addRangeBar:function(a,b,c,d){var e=this,f=this.dateCalculator.dateToColumn(b),g=this.dateCalculator.dateToColumn(c);return!(!this.dateCalculator.isValidRangeBarData(b,c)||null==f||null==g)&&(this.rangeBars[a]||(this.rangeBars[a]={}),this.rangeBars[a][f]={barLength:g-f+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(b)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(c)[1],additionalData:{}},q(d,function(b,c){e.rangeBars[a][f].additionalData[c]=b}),this.colorData[a]&&(this.rangeBars[a][f].colors=this.colorData[a]),this.rangeList[a]=[a,f],this.renderRangeBar(a,f,g,d),[a,f])},getRangeBarData:function(a,b){var c=this.getRangeBarCoordinates(a);if(!c)return!1;var d=this.rangeBars[c[0]][c[1]];return!(!d||a!==c[0]||!(b===c[1]||b>c[1]&&b<c[1]+d.barLength))&&d},updateRangeBarData:function(a,b,c){var d=this.getRangeBarData(a,b);q(c,function(a,b){d[b]!==a&&(d[b]=a)})},renderRangeBar:function(a,b,c,d){for(var e=this.rangeBars[a][b],f=b;f<=c;f++){var g=this.hot.getCellMeta(a,f),h=(g.className||"")+" rangeBar";(f===b&&e.partialStart||f===c&&e.partialEnd)&&(h+=" partial"),f===c&&(h+=" last"),this.hot.setCellMeta(a,f,"originalClassName",g.className),this.hot.setCellMeta(a,f,"className",h),this.hot.setCellMeta(a,f,"additionalData",e.additionalData),this.cacheRangeBarMeta(a,f,"originalClassName",g.className),this.cacheRangeBarMeta(a,f,"className",h),this.cacheRangeBarMeta(a,f,"additionalData",e.additionalData)}},removeRangeBarByDate:function(a,b){var c=this.dateCalculator.dateToColumn(b);this.removeRangeBarByColumn(a,c)},removeRangeBarByColumn:function(a,b){var c=this,d=this.rangeBars[a][b];d&&(this.unrenderRangeBar(a,b,b+d.barLength-1),this.rangeBars[a][b]=null,q(this.rangeList,function(d,e){e=parseInt(e,10),JSON.stringify(d)===JSON.stringify([a,b])&&(c.rangeList[e]=null)}))},removeAllRangeBars:function(){var a=this;q(this.rangeBars,function(b,c){q(b,function(b,d){a.removeRangeBarByColumn(c,d)})})},unrenderRangeBar:function(a,b,c){for(var d=b;d<=c;d++){var e=this.hot.getCellMeta(a,d);this.hot.setCellMeta(a,d,"className",e.originalClassName),this.hot.setCellMeta(a,d,"originalClassName",void 0),this.cacheRangeBarMeta(a,d,"className",e.originalClassName),this.cacheRangeBarMeta(a,d,"originalClassName",void 0)}this.hot.render()},uniformBackgroundRenderer:function(a,b,c,d,e,f,g){var h=this.getRangeBarData(c,d),i=this.getRangeBarCoordinates(c);g.className&&(b.className=g.className);var j="";q(g.additionalData,function(a,b){j+=b+": "+a+"\n"}),j=j.replace(/\n$/,""),b.title=j,h&&h.colors?d===i[1]&&h.partialStart||d===i[1]+h.barLength-1&&h.partialEnd?b.style.background=h.colors[1]:b.style.background=h.colors[0]:b.style.background=""},setRangeBarColors:function(a){var b=this;this.colorData=a,q(a,function(a,c){var d=b.getRangeBarCoordinates(c);d&&b.updateRangeBarData(d[0],d[1],{colors:a})}),this.hot.render()},setYear:function(a){var b=s(this.hot.getSettings().ganttChart,{startYear:a});this.hot.updateSettings({ganttChart:b})},onAfterInit:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()},onUpdateSettings:function(){if(this.internalUpdateSettings)return void this.applyRangeBarMetaCache();$traceurRuntime.superGet(this,B.prototype,"onUpdateSettings").call(this)},destroy:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),$traceurRuntime.superGet(this,B.prototype,"destroy").call(this)}},{},z),w("ganttChart",A)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data":45,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,dateCalculator:207,ganttChartDataFeed:209}],209:[function(a,b,c){"use strict";Object.defineProperties(c,{GanttChartDataFeed:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&d.__esModule&&d||{default:d},h=g.objectEach,j=(g.deepClone,((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach),l=((f=a("dateCalculator"))&&f.__esModule,function(b,c,d,e,f,g){this.data=c,this.chartInstance=b,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(c,d,e,f,g||!1)});$traceurRuntime.createClass(l,{applyData:function(a,b,c,d,e){"[object Array]"===Object.prototype.toString.call(a)?this.loadData(a):a.guid&&this.bindWithHotInstance(a,b,c,d,e)},bindWithHotInstance:function(a,b,c,d,e){this.hotSource={instance:a,startColumn:b,endColumn:c,additionalData:d,asyncUpdates:e},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)},asyncCall:function(a){var b=this;if(!this.hotSource.asyncUpdates)return void a.call(this);this.asyncStart(),setTimeout(function(){a.call(b),b.asyncEnd()},0)},asyncStart:function(){this.ongoingAsync=!0},asyncEnd:function(){this.ongoingAsync=!1},addSourceHotHooks:function(){var a=this;this.sourceHooks={afterLoadData:function(b){return a.onAfterSourceLoadData(b)},afterChange:function(b,c){return a.onAfterSourceChange(b,c)},afterColumnSort:function(b,c){return a.onAfterColumnSort(b,c)}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)},removeSourceHotHooks:function(a){this.sourceHooks.afterLoadData&&a.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&a.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&a.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)},getDataFromSource:function(a){var d,b={},c=this.hotSource,e=[];void 0===a?d=c.instance.getData(0,0,c.instance.countRows()-1,c.instance.countCols()-1):(d=[],d[a]=c.instance.getDataAtRow(a));var f=function(a,f){b={};var g=d[a];if(null===g[c.startColumn]||""===g[c.startColumn])return 0;h(c.additionalData,function(a,c){b[c]=g[a]}),e.push([a,g[c.startColumn],g[c.endColumn],b,a])};a:for(var i=a||0,j=d.length;i<(a?a+1:j);i++)switch(f(i,j)){case 0:continue a}return e},updateFromSource:function(a){var b=this,c=this.getDataFromSource(a);!a&&isNaN(a)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),j(c,function(a){a=b.trimRangeIfNeeded(a),b.chartPlugin.addRangeBar.apply(b.chartPlugin,a)})},loadData:function(a){var b=this;j(a,function(a,c){a=b.trimRangeIfNeeded(a),b.chartPlugin.addRangeBar(c,a.startDate,a.endDate,a.additionalData)})},trimRangeIfNeeded:function(a){var b=null;b=a[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"};var c=new Date(a[b.startDate]),d=new Date(a[b.endDate]);if("string"==typeof c||"string"==typeof d)return!1;var e=c.getFullYear(),f=d.getFullYear();return e<this.chartPlugin.currentYear&&f>=this.chartPlugin.currentYear&&(a[b.startDate]="01/01/"+this.chartPlugin.currentYear),f>this.chartPlugin.currentYear&&e<=this.chartPlugin.currentYear&&(a[b.endDate]="12/31/"+this.chartPlugin.currentYear),a},onAfterSourceChange:function(a,b){var c=this;this.asyncCall(function(){if(a){for(var b={},d=0,e=a.length;d<e;d++){var f=a[d],g=parseInt(f[0],10),i=parseInt(f[1],10);b[g]||(b[g]={}),b[g][i]=[f[2],f[3]]}h(b,function(a,b){b=parseInt(b,10),c.chartPlugin.getRangeBarCoordinates(b)&&c.chartPlugin.removeRangeBarByColumn(b,c.chartPlugin.rangeList[b][1]),c.updateFromSource(b)})}})},onAfterSourceLoadData:function(a){var b=this;this.asyncCall(function(a){b.chartPlugin.removeAllRangeBars(),b.updateFromSource()})},onAfterColumnSort:function(a,b){var c=this;this.asyncCall(function(){c.chartPlugin.removeAllRangeBars(),c.updateFromSource()})}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,dateCalculator:207}],210:[function(a,b,c){"use strict";Object.defineProperties(c,{HeaderTooltips:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js"))&&d.__esModule&&d||{default:d}).outerWidth,i=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"))&&e.__esModule&&e||{default:e}).registerPlugin,j=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,k=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"))&&g.__esModule&&g||{default:g}).default,l=function(b){$traceurRuntime.superConstructor(m).call(this,b),this.settings=null},m=l;$traceurRuntime.createClass(l,{isEnabled:function(){return!!this.hot.getSettings().headerTooltips},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(b,c){return a.onAfterGetHeader(b,c)}),this.addHook("afterGetRowHeader",function(b,c){return a.onAfterGetHeader(b,c)}),$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null,this.clearTitleAttributes(),$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},parseSettings:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})},clearTitleAttributes:function(){var a=this.hot.view.wt.getSetting("columnHeaders").length,b=this.hot.view.wt.wtTable.THEAD,c=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;j(0,a-1,function(a){var e=b.childNodes[a],f=c.childNodes[a],g=d?d.childNodes[a]:null;j(0,e.childNodes.length-1,function(a){e.childNodes[a].removeAttribute("title"),f&&f.childNodes[a]&&f.childNodes[a].removeAttribute("title"),d&&g&&g.childNodes[a]&&g.childNodes[a].removeAttribute("title")})},!0)},onAfterGetHeader:function(a,b){var c=b.querySelector("span"),d="THEAD"===b.parentNode.parentNode.nodeName;(d&&this.settings.columns||!d&&this.settings.rows)&&(this.settings.onlyTrimmed?h(c)>=h(b)&&0!==h(c)&&b.setAttribute("title",c.textContent):b.setAttribute("title",c.textContent))},destroy:function(){this.settings=null,$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)}},{},k),i("headerTooltips",l)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63}],211:[function(a,b,c){"use strict";function f(a){return{key:"hidden_columns_hide",name:"Hide column",callback:function(){var b=this.getSelectedRange(),c=b.from,d=b.to,f=Math.min(c.col,d.col),g=Math.max(c.col,d.col);e(f,g,function(b){return a.hideColumn(b)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}Object.defineProperties(c,{hideColumnItem:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&d.__esModule&&d||{default:d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],212:[function(a,b,c){"use strict";function f(a){var b=[],c=[];return{key:"hidden_columns_show",name:"Show column",callback:function(){var d=this.getSelectedRange(),f=d.from,g=d.to,h=Math.min(f.col,g.col),i=Math.max(f.col,g.col);h===i?(b.length===h&&(a.showColumns(b),b.length=0),c.length===this.countSourceCols()-(h+1)&&(a.showColumns(c),c.length=0)):e(h,i,function(b){return a.showColumn(b)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!a.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;b.length=0,c.length=0;var d=this.getSelectedRange(),f=d.from,g=d.to,h=Math.min(f.col,g.col),i=Math.max(f.col,g.col),j=!1;if(h===i){var k=this.countSourceCols();e(0,k,function(d){if(b.length+c.length===a.hiddenColumns.length)return!1;d<h&&a.isHidden(d)?b.push(d):a.isHidden(d)&&c.push(d)}),k-=1,(b.length===h&&h>0||c.length===k-h&&h<k)&&(j=!0)}else e(h,i,function(b){if(a.isHidden(b))return j=!0,!1});return!j}}}Object.defineProperties(c,{showColumnItem:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&d.__esModule&&d||{default:d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],213:[function(a,b,c){"use strict";function z(a,b){b.textContent=""}Object.defineProperties(c,{HiddenColumns:{get:function(){return x}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,m=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&e.__esModule&&e||{default:e},n=m.addClass,p=(m.removeClass,((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach),q=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&g.__esModule&&g||{default:g}).arrayEach,r=(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&h.__esModule&&h||{default:h},s=r.registerPlugin,u=(r.getPlugin,((i=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"))&&i.__esModule&&i||{default:i}).SEPARATOR),v=((j=a("contextMenuItem/hideColumn"))&&j.__esModule&&j||{default:j}).hideColumnItem,w=((k=a("contextMenuItem/showColumn"))&&k.__esModule&&k||{default:k}).showColumnItem,x=function(b){$traceurRuntime.superConstructor(y).call(this,b),this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1},y=x;$traceurRuntime.createClass(x,{isEnabled:function(){return!!this.hot.getSettings().hiddenColumns},enablePlugin:function(){var a=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(b,c){return a.onAfterGetColHeader(b,c)}):this.addHook("afterRenderer",function(b,c,d){return a.onAfterGetColHeader(d,b)}),this.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)}),this.addHook("afterGetCellMeta",function(b,c,d){return a.onAfterGetCellMeta(b,c,d)}),this.addHook("modifyColWidth",function(b,c){return a.onModifyColWidth(b,c)}),this.addHook("beforeSetRangeStartOnly",function(b){return a.onBeforeSetRangeStart(b)}),this.addHook("beforeSetRangeEnd",function(b){return a.onBeforeSetRangeEnd(b)}),this.addHook("hiddenColumn",function(b){return a.isHidden(b)}),this.addHook("beforeStretchingColumnWidth",function(b,c){return a.onBeforeStretchingColumnWidth(b,c)}),this.addHook("afterCreateCol",function(b,c){return a.onAfterCreateCol(b,c)}),this.addHook("afterRemoveCol",function(b,c){return a.onAfterRemoveCol(b,c)}),this.hot.view&&this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,y.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,y.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),$traceurRuntime.superGet(this,y.prototype,"disablePlugin").call(this),this.resetCellsMeta()},showColumns:function(a){var b=this;q(a,function(a){a=parseInt(a,10),a=b.getLogicalColumnIndex(a),b.isHidden(a,!0)&&b.hiddenColumns.splice(b.hiddenColumns.indexOf(a),1)})},showColumn:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.showColumns(a)},hideColumns:function(a){var b=this;q(a,function(a){a=parseInt(a,10),a=b.getLogicalColumnIndex(a),b.isHidden(a,!0)||b.hiddenColumns.push(a)})},hideColumn:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.hideColumns(a)},isHidden:function(a){return void 0!==arguments[1]&&arguments[1]||(a=this.getLogicalColumnIndex(a)),this.hiddenColumns.indexOf(a)>-1},resetCellsMeta:function(){q(this.hot.getCellsMeta(),function(a){a&&(a.skipColumnOnPaste=!1,null!==a.baseRenderer&&(a.renderer=a.baseRenderer,a.baseRenderer=null))})},getLogicalColumnIndex:function(a){return this.hot.runHooks("modifyCol",a)},onBeforeStretchingColumnWidth:function(a,b){return this.isHidden(b)&&(a=0),a},onModifyColWidth:function(a,b){return this.isHidden(b)?.1:this.settings.indicators&&(this.isHidden(b+1)||this.isHidden(b-1))?a+(this.hot.hasColHeaders()?15:0):void 0},onAfterGetCellMeta:function(a,b,c){if(b=this.hot.runHooks("unmodifyCol",b),!1===this.settings.copyPasteEnabled&&this.isHidden(b)&&(c.skipColumnOnPaste=!0),this.isHidden(b)?(c.renderer!==z&&(c.baseRenderer=c.renderer),c.renderer=z):null!==c.baseRenderer&&(c.renderer=c.baseRenderer,c.baseRenderer=null),this.isHidden(c.visualCol-1)){var d=!0,e=c.visualCol-1;c.className=c.className||"",-1===c.className.indexOf("afterHiddenColumn")&&(c.className+=" afterHiddenColumn");do{if(!this.isHidden(e)){d=!1;break}e--}while(e>=0);d&&-1===c.className.indexOf("firstVisibleColumn")&&(c.className+=" firstVisibleColumn")}else if(c.className){var f=c.className.split(" ");if(f.length){var g=f.indexOf("afterHiddenColumn"),h=f.indexOf("firstVisibleColumn");g>-1&&f.splice(g,1),h>-1&&f.splice(h,1),c.className=f.join(" ")}}},onModifyCopyableRange:function(a){var b=this,c=[],d=function(a,b,d,e){c.push({startRow:a,endRow:b,startCol:d,endCol:e})};return q(a,function(a){var c=!0,e=0;p(a.startCol,a.endCol,function(f){b.isHidden(f)?(c||d(a.startRow,a.endRow,e,f-1),c=!0):(c&&(e=f),f===a.endCol&&d(a.startRow,a.endRow,e,f),c=!1)})}),c},onAfterGetColHeader:function(a,b){if(!this.isHidden(a)){var c=!0,d=a-1;do{if(!this.isHidden(d)){c=!1;break}d--}while(d>=0);c&&n(b,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(a-1)&&n(b,"afterHiddenColumn"),this.isHidden(a+1)&&a>-1&&n(b,"beforeHiddenColumn"))}},onBeforeSetRangeStart:function(a){var b=this;if(!(a.col>0)){a.col=0;var c=function(a){var d=b.getLogicalColumnIndex(a);return b.isHidden(d,!0)&&(a=c(++a)),a};a.col=c(a.col)}},onBeforeSetRangeEnd:function(a){var b=this,c=this.hot.countCols(),d=function(e){var f=b.getLogicalColumnIndex(e);return b.isHidden(f,!0)&&(b.lastSelectedColumn>e||a.col===c-1?e>0?e=d(--e):p(0,b.lastSelectedColumn,function(a){if(!b.isHidden(a))return e=a,!1}):e=d(++e)),e};a.col=d(a.col),this.lastSelectedColumn=a.col},onAfterContextMenuDefaultOptions:function(a){a.items.push({name:u},v(this),w(this))},onAfterCreateCol:function(a,b){var c=[];q(this.hiddenColumns,function(d){d>=a&&(d+=b),c.push(d)}),this.hiddenColumns=c},onAfterRemoveCol:function(a,b){var c=[];q(this.hiddenColumns,function(d){d>=a&&(d-=b),c.push(d)}),this.hiddenColumns=c},onAfterPluginsInitialized:function(){var a=this,b=this.hot.getSettings().hiddenColumns;"object"==typeof b&&(this.settings=b,void 0===b.copyPasteEnabled&&(b.copyPasteEnabled=!0),Array.isArray(b.columns)&&this.hideColumns(b.columns),b.copyPasteEnabled||this.addHook("modifyCopyableRange",function(b){return a.onModifyCopyableRange(b)}))},destroy:function(){$traceurRuntime.superGet(this,y.prototype,"destroy").call(this)}},{},l),s("hiddenColumns",x)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"contextMenuItem/hideColumn":211,"contextMenuItem/showColumn":212}],214:[function(a,b,c){"use strict";function f(a){return{key:"hidden_rows_hide",name:"Hide row",callback:function(){var b=this.getSelectedRange(),c=b.from,d=b.to,f=Math.min(c.row,d.row),g=Math.max(c.row,d.row);e(f,g,function(b){return a.hideRow(b)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}Object.defineProperties(c,{hideRowItem:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&d.__esModule&&d||{default:d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],215:[function(a,b,c){"use strict";function f(a){var b=[],c=[];return{key:"hidden_rows_show",name:"Show row",callback:function(){var d=this.getSelectedRange(),f=d.from,g=d.to,h=Math.min(f.row,g.row),i=Math.max(f.row,g.row);h===i?(b.length===h&&(a.showRows(b),b.length=0),c.length===this.countSourceRows()-(h+1)&&(a.showRows(c),c.length=0)):e(h,i,function(b){return a.showRow(b)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!a.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;b.length=0,c.length=0;var d=this.getSelectedRange(),f=d.from,g=d.to,h=Math.min(f.row,g.row),i=Math.max(f.row,g.row),j=!1;if(h===i){var k=this.countSourceRows();e(0,k,function(d){if(b.length+c.length===a.hiddenRows.length)return!1;d<h?a.isHidden(d)&&b.push(d):a.isHidden(d)&&c.push(d)}),k-=1,(b.length===h&&h>0||c.length===k-h&&h<k)&&(j=!0)}else e(h,i,function(b){if(a.isHidden(b))return j=!0,!1});return!j}}}Object.defineProperties(c,{showRowItem:{get:function(){return f}},__esModule:{value:!0}});var d,e=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&d.__esModule&&d||{default:d}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],216:[function(a,b,c){"use strict";Object.defineProperties(c,{HiddenRows:{get:function(){return x}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,l=(e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&e.__esModule&&e||{default:e},m=l.addClass,n=l.removeClass,o=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,p=(g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&g.__esModule&&g||{default:g},q=p.arrayEach,s=(p.arrayFilter,(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&h.__esModule&&h||{default:h}),t=s.registerPlugin,v=(s.getPlugin,((i=a("contextMenuItem/hideRow"))&&i.__esModule&&i||{default:i}).hideRowItem),w=((j=a("contextMenuItem/showRow"))&&j.__esModule&&j||{default:j}).showRowItem,x=function(b){$traceurRuntime.superConstructor(y).call(this,b),this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1},y=x;$traceurRuntime.createClass(x,{isEnabled:function(){return!!this.hot.getSettings().hiddenRows},enablePlugin:function(){var a=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(b,c){return a.onAfterGetRowHeader(b,c)}):this.addHook("afterRenderer",function(b,c){return a.onAfterGetRowHeader(c,b)}),this.addHook("afterContextMenuDefaultOptions",function(b){return a.onAfterContextMenuDefaultOptions(b)}),this.addHook("afterGetCellMeta",function(b,c,d){return a.onAfterGetCellMeta(b,c,d)}),this.addHook("modifyRowHeight",function(b,c){return a.onModifyRowHeight(b,c)}),this.addHook("beforeSetRangeStartOnly",function(b){return a.onBeforeSetRangeStartOnly(b)}),this.addHook("beforeSetRangeStart",function(b){return a.onBeforeSetRangeStart(b)}),this.addHook("beforeSetRangeEnd",function(b){return a.onBeforeSetRangeEnd(b)}),this.addHook("hiddenRow",function(b){return a.isHidden(b)}),this.addHook("afterCreateRow",function(b,c){return a.onAfterCreateRow(b,c)}),this.addHook("afterRemoveRow",function(b,c){return a.onAfterRemoveRow(b,c)}),this.hot.view&&this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,y.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,y.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,$traceurRuntime.superGet(this,y.prototype,"disablePlugin").call(this),this.resetCellsMeta()},showRows:function(a){var b=this;q(a,function(a){a=parseInt(a,10),a=b.getLogicalRowIndex(a),b.isHidden(a,!0)&&b.hiddenRows.splice(b.hiddenRows.indexOf(a),1)})},showRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.showRows(a)},hideRows:function(a){var b=this;q(a,function(a){a=parseInt(a,10),a=b.getLogicalRowIndex(a),b.isHidden(a,!0)||b.hiddenRows.push(a)})},hideRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.hideRows(a)},isHidden:function(a){return void 0!==arguments[1]&&arguments[1]||(a=this.getLogicalRowIndex(a)),this.hiddenRows.indexOf(a)>-1},resetCellsMeta:function(){q(this.hot.getCellsMeta(),function(a){a&&(a.skipRowOnPaste=!1)})},getLogicalRowIndex:function(a){return this.hot.runHooks("modifyRow",a)},onAfterGetCellMeta:function(a,b,c){if(a=this.hot.runHooks("unmodifyRow",a),!1===this.settings.copyPasteEnabled&&this.isHidden(a)?c.skipRowOnPaste=!0:c.skipRowOnPaste=!1,this.isHidden(a-1)){var d=!0,e=a-1;c.className=c.className||"",-1===c.className.indexOf("afterHiddenRow")&&(c.className+=" afterHiddenRow");do{if(!this.isHidden(e)){d=!1;break}e--}while(e>=0);d&&-1===c.className.indexOf("firstVisibleRow")&&(c.className+=" firstVisibleRow")}else if(c.className){var f=c.className.split(" ");if(f.length){var g=f.indexOf("afterHiddenRow"),h=f.indexOf("firstVisibleRow");g>-1&&f.splice(g,1),h>-1&&f.splice(h,1),c.className=f.join(" ")}}},onAfterGetRowHeader:function(a,b){var c=b.parentNode;c&&(this.isHidden(a)?m(c,"hide"):n(c,"hide"));var d=!0,e=a-1;do{if(!this.isHidden(e)){d=!1;break}e--}while(e>=0);d&&m(b,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(a-1)&&m(b,"afterHiddenRow"),this.isHidden(a+1)&&m(b,"beforeHiddenRow"))},onModifyRowHeight:function(a,b){return this.isHidden(b)?.1:a},onModifyCopyableRange:function(a){var b=this,c=[],d=function(a,b,d,e){c.push({startRow:a,endRow:b,startCol:d,endCol:e})};return q(a,function(a){var c=!0,e=0;o(a.startRow,a.endRow,function(f){b.isHidden(f)?(c||d(e,f-1,a.startCol,a.endCol),c=!0):(c&&(e=f),f===a.endRow&&d(e,f,a.startCol,a.endCol),c=!1)})}),c},onBeforeSetRangeStart:function(a){var b=this,c=this.hot.getSelected()||!1,d=this.hot.countRows()-1,e=function(a){var f=0;return c&&(f=a>c[0]?1:-1,b.lastSelectedRow=c[0]),d<a||a<0?b.lastSelectedRow:(b.isHidden(a)&&(a=e(a+f)),a)};a.row=e(a.row)},onBeforeSetRangeStartOnly:function(a){var b=this;if(!(a.row>0)){a.row=0;var c=function(a){return b.isHidden(a)&&(a=c(++a)),a};a.row=c(a.row)}},onBeforeSetRangeEnd:function(a){var b=this,c=this.hot.countRows(),d=function(e){return b.isHidden(e)&&(b.lastSelectedRow>e||a.row===c-1?e>0?e=d(--e):o(0,b.lastSelectedRow,function(a){if(!b.isHidden(a))return e=a,!1}):e=d(++e)),e};a.row=d(a.row),this.lastSelectedRow=a.row},onAfterContextMenuDefaultOptions:function(a){a.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,v(this),w(this))},onAfterCreateRow:function(a,b){var c=[];q(this.hiddenRows,function(d){d>=a&&(d+=b),c.push(d)}),this.hiddenRows=c},onAfterRemoveRow:function(a,b){var c=[];q(this.hiddenRows,function(d){d>=a&&(d-=b),c.push(d)}),this.hiddenRows=c},onAfterPluginsInitialized:function(){var a=this,b=this.hot.getSettings().hiddenRows;"object"==typeof b&&(this.settings=b,void 0===b.copyPasteEnabled&&(b.copyPasteEnabled=!0),Array.isArray(b.rows)&&this.hideRows(b.rows),b.copyPasteEnabled||this.addHook("modifyCopyableRange",function(b){return a.onModifyCopyableRange(b)}))},destroy:function(){$traceurRuntime.superGet(this,y.prototype,"destroy").call(this)}},{},k),t("hiddenRows",x)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"contextMenuItem/hideRow":214,"contextMenuItem/showRow":215}],217:[function(a,b,c){"use strict";Object.defineProperties(c,{NestedHeaders:{get:function(){return y}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k=(d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d},l=k.addClass,m=k.removeClass,n=k.hasClass,o=k.fastInnerHTML,p=k.empty,q=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&e.__esModule&&e||{default:e}).rangeEach,r=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,s=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&g.__esModule&&g||{default:g}).objectEach,t=(h=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&h.__esModule&&h||{default:h},u=t.registerPlugin,w=(t.getPlugin,((i=a("utils/ghostTable"))&&i.__esModule&&i||{default:i}).GhostTable),x=((j=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&j.__esModule&&j||{default:j}).default,y=function(b){$traceurRuntime.superConstructor(z).call(this,b),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable=new w(this)},z=y;$traceurRuntime.createClass(y,{isEnabled:function(){return!!this.hot.getSettings().nestedHeaders},enablePlugin:function(){var a=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(b){return a.onAfterGetColumnHeaderRenderers(b)}),this.addHook("afterInit",function(){return a.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(b,c,d){return a.onAfterOnCellMouseDown(b,c,d)}),this.addHook("beforeOnCellMouseOver",function(b,c,d,e){return a.onBeforeOnCellMouseOver(b,c,d,e)}),this.addHook("afterViewportColumnCalculatorOverride",function(b){return a.onAfterViewportColumnCalculatorOverride(b)}),this.addHook("modifyColWidth",function(b,c){return a.onModifyColWidth(b,c)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,$traceurRuntime.superGet(this,z.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),$traceurRuntime.superGet(this,z.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,z.prototype,"updatePlugin").call(this),this.ghostTable.buildWidthsMapper()},clearColspans:function(){if(this.hot.view)for(var a=this.hot.view.wt.getSetting("columnHeaders").length,b=this.hot.view.wt.wtTable.THEAD,c=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,e=0;e<a;e++){var f=b.childNodes[e];if(!f)break;for(var g=c.childNodes[e],h=d?d.childNodes[e]:null,i=0,j=f.childNodes.length;i<j;i++)f.childNodes[i].removeAttribute("colspan"),g&&g.childNodes[i]&&g.childNodes[i].removeAttribute("colspan"),d&&h&&h.childNodes[i]&&h.childNodes[i].removeAttribute("colspan")}},checkForFixedColumnsCollision:function(){var a=this,b=this.hot.getSettings().fixedColumnsLeft;r(this.colspanArray,function(c,d){a.getNestedParent(d,b)!==b&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})},checkForOverlappingHeaders:function(){var a=this;r(this.colspanArray,function(b,c){r(a.colspanArray[c],function(b,d){if(b.colspan>1){var e=a.levelToRowCoords(c),f=a.getChildHeaders(e,d);if(f.length>0){var g=0;return r(f,function(b,c){g+=a.getColspan(e+1,b)}),g>b.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1}}})})},setupColspanArray:function(){function b(a,b){a[b]||(a[b]=[])}var a=this;s(this.settings,function(c,d){s(c,function(c,e,f){if(b(a.colspanArray,d),void 0===f[e].colspan)a.colspanArray[d].push({label:f[e]||"",colspan:1,hidden:!1});else{var g=f[e].colspan||1;a.colspanArray[d].push({label:f[e].label||"",colspan:g,hidden:!1}),a.fillColspanArrayWithDummies(g,d)}})})},fillColspanArrayWithDummies:function(a,b){var c=this;q(0,a-2,function(a){c.colspanArray[b].push({label:"",colspan:1,hidden:!0})})},headerRendererFactory:function(a){var b=this;return function(c,d){if(d.removeAttribute("colspan"),m(d,"hiddenHeader"),b.colspanArray[a][c]&&b.colspanArray[a][c].colspan){var e=b.colspanArray[a][c].colspan,f=b.hot.getSettings().fixedColumnsLeft||0,g=b.hot.view.wt.wtOverlays.topLeftCornerOverlay,h=b.hot.view.wt.wtOverlays.leftOverlay,i=!!g&&g.clone.wtTable.THEAD.contains(d),j=!!h&&h.clone.wtTable.THEAD.contains(d);e>1&&d.setAttribute("colspan",i||j?Math.min(e,f-c):e),(i||j&&c===f-1)&&l(d,"overlayEdge")}b.colspanArray[a][c]&&b.colspanArray[a][c].hidden&&l(d,"hiddenHeader"),p(d);var k=document.createElement("DIV");l(k,"relative");var n=document.createElement("SPAN");l(n,"colHeader"),o(n,b.colspanArray[a][c]?b.colspanArray[a][c].label||"":""),k.appendChild(n),d.appendChild(k),b.hot.runHooks("afterGetColHeader",c,d)}},getColspan:function(a,b){var c=this.colspanArray[this.rowCoordsToLevel(a)][b];return c?c.colspan:1},levelToRowCoords:function(a){return a-this.columnHeaderLevelCount},rowCoordsToLevel:function(a){return a+this.columnHeaderLevelCount},getNestedParent:function(a,b){if(a<0)return!1;var c=this.colspanArray[a][b]?this.colspanArray[a][b].colspan:1,d=!!this.colspanArray[a][b]&&this.colspanArray[a][b].hidden;if(c>1||1===c&&!1===d)return b;var e=b-1;do{if(this.colspanArray[a][e].colspan>1)break;e--}while(b>=0);return e},getChildHeaders:function(a,b){var c=this.rowCoordsToLevel(a),d=this.colspanArray[c+1],e=this.getNestedParent(c,b),f=this.colspanArray[c][b].colspan,g=[];return d?(q(e,e+f-1,function(a){d[a]&&d[a].colspan>1&&(f-=d[a].colspan-1),d[a]&&!d[a].hidden&&-1===g.indexOf(a)&&g.push(a)}),g):g},fillTheRemainingColspans:function(){var a=this;s(this.settings,function(b,c){q(a.colspanArray[c].length-1,a.hot.countCols()-1,function(d){a.colspanArray[c].push({label:b[d]||"",colspan:1,hidden:!1})},!0)})},updateHeadersHighlight:function(){var a=this,b=this.hot.getSelected();if(void 0!==b){var c="ht__highlight",d=this.hot.view.wt.wtOverlays,e=this.hot.selection.selectedHeader.cols,f=Math.min(b[1],b[3]),g=Math.max(b[1],b[3]),h=e?-1:this.columnHeaderLevelCount-1;q(f,g,function(b){for(var i=function(i){var j=a.getNestedParent(i,b),k=d.topOverlay?d.topOverlay.clone.wtTable.getColumnHeader(j,i):void 0,o=d.topLeftCornerOverlay?d.topLeftCornerOverlay.clone.wtTable.getColumnHeader(j,i):void 0,p=[k,o],q=a.getColspan(i-a.columnHeaderLevelCount,j),s=j>=f&&j+q-1<=g;r(p,function(a,b,d){if(void 0===a)return!1;!e&&i<h||e&&!s?n(a,c)&&m(a,c):n(a,c)||l(a,c)})},j=a.columnHeaderLevelCount-1;j>-1;j--)i(j)})}},onAfterViewportColumnCalculatorOverride:function(a){var b=this,c=a.startColumn;q(0,Math.max(this.columnHeaderLevelCount-1,0),function(d){var e=b.getNestedParent(d,a.startColumn);if(e<a.startColumn){var f=Math.min(c,e);c=f}}),a.startColumn=c},onAfterOnCellMouseDown:function(a,b,c){if(b.row<0){var d=this.getColspan(b.row,b.col),e=b.col+d-1;if(d>1){var f=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new WalkontableCellCoords(f,e))}}},onBeforeOnCellMouseOver:function(a,b,c,d){var e;if(b.row<0&&b.col>=0&&this.hot.view.isMouseDown()){var f=this.hot.getSelectedRange(),g=f.from,h=f.to,i=this.getColspan(b.row,b.col),j=b.col+i-1,k=!1;g.col<=h.col?(b.col<g.col&&j===h.col||b.col<g.col&&j<g.col||b.col<g.col&&j>=g.col&&j<h.col)&&(k=!0):(b.col<h.col&&j>g.col||b.col>g.col||b.col<=h.col&&j>g.col||b.col>h.col&&j>g.col)&&(k=!0),k&&(e=[h.col,g.col],g.col=e[0],h.col=e[1]),i>1&&(d.column=!0,d.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),g.col===h.col&&(j<=g.col&&b.col<g.col?(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(g.row,h.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(h.row,b.col))):(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(g.row,b.col<g.col?b.col:g.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(h.row,j>h.col?j:h.col)))),g.col<h.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(g.row,b.col<g.col?b.col:g.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(h.row,j))),g.col>h.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(g.row,g.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(h.row,b.col))))}},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()},onAfterGetColumnHeaderRenderers:function(a){if(a){a.length=0;for(var b=this.colspanArray.length,c=b-1;c>=0;c--)a.push(this.headerRendererFactory(c));a.reverse()}this.updateHeadersHighlight()},onModifyColWidth:function(a,b){var c=this.ghostTable.widthsCache[b];return a>c?a:c},destroy:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,$traceurRuntime.superGet(this,z.prototype,"destroy").call(this)}},{},x),u("nestedHeaders",y)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"utils/ghostTable":218}],218:[function(a,b,c){"use strict";Object.defineProperties(c,{GhostTable:{get:function(){return h}},__esModule:{value:!0}});var d,e,f=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&d.__esModule&&d||{default:d}).fastInnerHTML,g=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e}).clone,h=function(b){this.nestedHeaders=b,this.container=void 0,this.widthsCache=[]};$traceurRuntime.createClass(h,{buildWidthsMapper:function(){this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var a=this.container.querySelectorAll("tr:last-of-type th"),b=a.length,c=0;c<b;c++)this.widthsCache.push(a[c].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()},buildGhostTable:function(a){for(var b=document,c=b.createDocumentFragment(),d=b.createElement("table"),e=!1,h=!!this.nestedHeaders.hot.getSettings().dropdownMenu,i=this.nestedHeaders.colspanArray.length,j=this.nestedHeaders.hot.countCols(),k=i-1,l=0;l<i;l++){var m=b.createElement("tr");e=!1;for(var n=0;n<j;n++){var o=b.createElement("th"),p=g(this.nestedHeaders.colspanArray[l][n]);p&&!p.hidden&&(l===k&&(p.colspan>1&&(e=!0),h&&(p.label+='<button class="changeType"></button>')),f(o,p.label),o.colSpan=p.colspan,m.appendChild(o))}d.appendChild(m)}if(e){for(var q=b.createElement("tr"),r=0;r<j;r++){var s=b.createElement("th");q.appendChild(s)}d.appendChild(q)}c.appendChild(d),a.appendChild(c)},clear:function(){this.container=null,this.widthsCache.length=0}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],219:[function(a,b,c){"use strict";Object.defineProperties(c,{DataManager:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&d.__esModule&&d||{default:d}).rangeEach,i=(e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&e.__esModule&&e||{default:e},j=i.objectEach,l=(i.extend,((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach),m=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"))&&g.__esModule&&g||{default:g}).getTranslator,n=function(b,c,d){this.hot=c,this.data=d,this.plugin=b,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=m(this.hot)};$traceurRuntime.createClass(n,{rewriteCache:function(){var a=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},h(0,this.data.length-1,function(b){a.cacheNode(a.data[b],0,null)})},cacheNode:function(a,b,c){var d=this;this.cache.levels[b]||(this.cache.levels[b]=[],this.cache.levelCount++),this.cache.levels[b].push(a),this.cache.rows.push(a),this.cache.nodeInfo.set(a,{parent:c,row:this.cache.rows.length-1,level:b}),this.hasChildren(a)&&l(a.__children,function(c,e){d.cacheNode(c,b+1,a)})},getDataObject:function(a){return null==a?null:this.cache.rows[a]},readTreeNodes:function(a,b,c,d){var e=this,f=!1;return isNaN(b)&&b.end?b:(a||(a={__children:this.data},f=!0,b--),null!=c&&b===c?{result:a,end:!0}:null!=d&&a===d?{result:b,end:!0}:(b++,a.__children&&l(a.__children,function(g,h){if(e.parentReference.set(g,f?null:a),b=e.readTreeNodes(g,b,c,d),isNaN(b)&&b.end)return!1}),b))},updateParentReference:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())},mockParent:function(){var a=this.mockNode();return a.__children=this.data,a},mockNode:function(){var a={};return j(this.data[0],function(b,c){a[c]=null}),a},getRowIndex:function(a){return null==a?null:this.cache.nodeInfo.get(a).row},getRowIndexWithinParent:function(a){var b=null;b=isNaN(a)?a:this.getDataObject(a);var c=this.getRowParent(a);return null==c?this.data.indexOf(b):c.__children.indexOf(b)},countAllRows:function(){var a={__children:this.data};return this.countChildren(a)},countChildren:function(a){var b=this,c=0;return isNaN(a)||(a=this.getDataObject(a)),a&&a.__children?(l(a.__children,function(a,d){c++,a.__children&&(c+=b.countChildren(a))}),c):0},getRowParent:function(a){var b;return b=isNaN(a)?a:this.getDataObject(a),this.getRowObjectParent(b)},getRowObjectParent:function(a){return"object"!=typeof a?null:this.cache.nodeInfo.get(a).parent},getRowLevel:function(a){var b=null;return b=isNaN(a)?a:this.getDataObject(a),b?this.getRowObjectLevel(b):null},getRowObjectLevel:function(a){return null==a?null:this.cache.nodeInfo.get(a).level},hasChildren:function(a){return isNaN(a)||(a=this.getDataObject(a)),!(!a.__children||!a.__children.length)},isParent:function(a){return isNaN(a)||(a=this.getDataObject(a)),!!a.hasOwnProperty("__children")},addChild:function(a,b){this.hot.runHooks("beforeAddChild",a,b);var c=null;a&&(c=this.getRowIndex(a)),this.hot.runHooks("beforeCreateRow",c+this.countChildren(a)+1,1);var d=a;a||(d=this.mockParent()),d.__children||(d.__children=[]),b||(b=this.mockNode()),d.__children.push(b),this.rewriteCache();var e=this.getRowIndex(b);this.hot.runHooks("afterCreateRow",e,1),this.hot.runHooks("afterAddChild",a,b)},addChildAtIndex:function(a,b,c,d){this.hot.runHooks("beforeAddChild",a,c,b),this.hot.runHooks("beforeCreateRow",d+1,1);var e=a;a||(e=this.mockParent()),e.__children||(e.__children=[]),c||(c=this.mockNode()),e.__children.splice(b,null,c),this.rewriteCache(),this.hot.runHooks("afterCreateRow",d+1,1),this.hot.runHooks("afterAddChild",a,c,b)},addSibling:function(a){var b=void 0!==arguments[1]?arguments[1]:"below",c=this.translateTrimmedRow(a),d=this.getRowParent(c),e=this.getRowIndexWithinParent(c);switch(b){case"below":this.addChildAtIndex(d,e+1,null,a);break;case"above":this.addChildAtIndex(d,e,null,a)}},detachFromParent:function(a){var b=void 0===arguments[1]||arguments[1],c=this,d=null,e=[];Array.isArray(a)?(h(a[0],a[2],function(a){var b=c.translateTrimmedRow(a);e.push(c.getDataObject(b))}),h(0,e.length-2,function(a){c.detachFromParent(e[a],!1)}),d=e[e.length-1]):d=a;var f=this.getRowIndex(d),g=this.getRowIndexWithinParent(d),i=this.getRowParent(d),j=this.getRowParent(i),k=this.getRowIndex(j),l=null;this.hot.runHooks("beforeDetachChild",i,d),null!=g&&(this.hot.runHooks("beforeRemoveRow",f,1,[f],this.plugin.pluginName),i.__children.splice(g,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",f,1,[f],this.plugin.pluginName),j?(l=k+this.countChildren(j),this.hot.runHooks("beforeCreateRow",l,1,this.plugin.pluginName),j.__children.push(d)):(l=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",l,1,this.plugin.pluginName),this.data.push(d))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",l,1,this.plugin.pluginName),b&&this.hot.render(),this.hot.runHooks("afterDetachChild",i,d)},filterData:function(a,b,c){var d=this,e=[];l(c,function(a,b){e.push(d.getDataObject(a))}),l(e,function(a,b){var c=d.getRowIndexWithinParent(a),e=d.getRowParent(a);null===e?d.data.splice(c,1):e.__children.splice(c,1)}),this.rewriteCache()},spliceData:function(a,b,c){if(null!=(a=this.translateTrimmedRow(a))){var d=this.getDataObject(a-1),e=null,f=null;d&&d.__children&&0===d.__children.length?(e=d,f=0):(e=this.getRowParent(a),f=this.getRowIndexWithinParent(a)),e?c?e.__children.splice(f,b,c):e.__children.splice(f,b):c?this.data.splice(f,b,c):this.data.splice(f,b),this.rewriteCache()}},moveRow:function(a,b){var c=this.isParent(b),d=this.getRowParent(a),e=this.getRowIndexWithinParent(a),f=this.getRowParent(b);null==f&&(f=this.getRowParent(b-1)),null==f&&(f=this.getDataObject(b-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(b),f.__children=[]);var g=this.getRowParent(b-1),h=c?this.countChildren(g):this.getRowIndexWithinParent(b),i=d.__children.slice(e,e+1);d.__children.splice(e,1),f.__children.splice(h,0,i[0])},moveCellMeta:function(a,b){var c=this.hot.getCellMetaAtRow(a);this.hot.spliceCellsMeta(b,0,c),this.hot.spliceCellsMeta(a+(a<b?0:1),1)},translateTrimmedRow:function(a){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(a):a}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],220:[function(a,b,c){"use strict";Object.defineProperties(c,{NestedRows:{get:function(){return w}},__esModule:{value:!0}});var d,e,f,g,h,i,j,k,l=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,m=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&e.__esModule&&e||{default:e}).registerPlugin,n=(f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f},o=n.rangeEach,q=(n.rangeEachReverse,((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&g.__esModule&&g||{default:g}).arrayEach),r=((h=a("data/dataManager"))&&h.__esModule&&h||{default:h}).DataManager,s=((i=a("ui/collapsing"))&&i.__esModule&&i||{default:i}).CollapsingUI,t=((j=a("ui/headers"))&&j.__esModule&&j||{default:j}).HeadersUI,u=((k=a("ui/contextMenu"))&&k.__esModule&&k||{default:k}).ContextMenuUI,v=new WeakMap,w=function(b){v.set(this,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),this.sourceData=null,this.trimRowsPlugin=null,this.bindRowsWithHeadersPlugin=null,this.dataManager=null,this.headersUI=null,$traceurRuntime.superConstructor(x).call(this,b)},x=w;$traceurRuntime.createClass(w,{isEnabled:function(){return!!this.hot.getSettings().nestedRows},enablePlugin:function(){var a=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new r(this,this.hot,this.sourceData),this.collapsingUI=new s(this,this.hot,this.trimRowsPlugin),this.headersUI=new t(this,this.hot),this.contextMenuUI=new u(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterInit.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeRender",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeRender.apply(b,$traceurRuntime.spread(c))}),this.addHook("modifyRowData",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onModifyRowData.apply(b,$traceurRuntime.spread(c))}),this.addHook("modifySourceLength",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onModifySourceLength.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeDataSplice",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeDataSplice.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeDataFilter",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeDataFilter.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterContextMenuDefaultOptions",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterContextMenuDefaultOptions.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterGetRowHeader",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterGetRowHeader.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeOnCellMouseDown",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeOnCellMouseDown.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterRemoveRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterRemoveRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("modifyRemovedAmount",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onModifyRemovedAmount.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeAddChild",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeAddChild.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterAddChild",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterAddChild.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeDetachChild",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeDetachChild.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterDetachChild",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterDetachChild.apply(b,$traceurRuntime.spread(c))}),this.addHook("modifyRowHeaderWidth",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onModifyRowHeaderWidth.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterCreateRow",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterCreateRow.apply(b,$traceurRuntime.spread(c))}),this.addHook("beforeRowMove",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onBeforeRowMove.apply(b,$traceurRuntime.spread(c))}),this.addHook("afterRowMove",function(){for(var b,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return(b=a).onAfterRowMove.apply(b,$traceurRuntime.spread(c))}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),$traceurRuntime.superGet(this,x.prototype,"enablePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,x.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,x.prototype,"updatePlugin").call(this)},onBeforeRowMove:function(a,b){var c,i,d=v.get(this),e=a.length,f=[],g=this.dataManager.translateTrimmedRow(b),h=!0,j=null,k=null,l=null;for(i=0;i<e;i++)f.push(this.dataManager.translateTrimmedRow(a[i])),this.dataManager.isParent(f[i])&&(h=!1);if(f.indexOf(g)>-1||!h)return!1;if(j=this.dataManager.getRowParent(f[0]),k=this.dataManager.getRowParent(g),null==k&&(k=this.dataManager.getRowParent(g-1)),null==k&&(k=this.dataManager.getDataObject(g-1),d.movedToFirstChild=!0),!k)return!1;for(l=j===k,d.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(k),this.collapsingUI.collapsedRowsStash.stash(),l||((c=Math).max.apply(c,$traceurRuntime.spread(f))<=g?this.collapsingUI.collapsedRowsStash.shiftStash(f[0],-1*a.length):this.collapsingUI.collapsedRowsStash.shiftStash(g,a.length)),d.changeSelection=!0,(f[e-1]<=g&&l||!0===d.movedToFirstChild)&&(a.reverse(),f.reverse(),!0!==d.movedToFirstChild&&g--),i=0;i<e;i++)this.dataManager.moveRow(f[i],g);if(f[f.length-1]<g)for(i=e-1;i>=0;i--)this.dataManager.moveCellMeta(f[i],g);else for(i=0;i<e;i++)this.dataManager.moveCellMeta(f[i],g);return(f[e-1]<=g&&l||this.dataManager.isParent(g))&&a.reverse(),this.dataManager.rewriteCache(),!1},onAfterRowMove:function(a,b){var c,d=v.get(this);if(d.changeSelection){var e=a.length,f=0,g=0,h=null,i=null,j=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),h=this.dataManager.translateTrimmedRow(b),d.movedToFirstChild)d.movedToFirstChild=!1,f=b,g=b+e-1,b>=(c=Math).max.apply(c,$traceurRuntime.spread(a))&&(f-=e,g-=e);else if(d.movedToCollapsed){var k=this.dataManager.getRowParent(h-1);null==k&&(k=this.dataManager.getDataObject(h-1));var l=this.dataManager.getRowIndex(k);f=l,g=f}else a[e-1]<b?(g=b-1,f=g-e+1):(f=b,g=f+e-1);i=this.hot.selection,j=this.hot.countCols()-1,i.setRangeStart(new WalkontableCellCoords(f,0)),i.setRangeEnd(new WalkontableCellCoords(g,j),!0),d.changeSelection=!1}},onBeforeOnCellMouseDown:function(a,b,c){this.collapsingUI.toggleState(a,b,c)},onModifyRowData:function(a){return this.dataManager.getDataObject(a)},onModifySourceLength:function(){return this.dataManager.countAllRows()},onBeforeDataSplice:function(a,b,c){return this.dataManager.spliceData(a,b,c),!1},onBeforeDataFilter:function(a,b,c){var d=[],e=this.dataManager.translateTrimmedRow(a),f=v.get(this);return o(e,e+b-1,function(a){d.push(a)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(e,b),this.collapsingUI.collapsedRowsStash.shiftStash(e,-1*b),this.dataManager.filterData(a,b,d),f.skipRender=!0,!1},onAfterContextMenuDefaultOptions:function(a){return this.contextMenuUI.appendOptions(a)},onAfterGetRowHeader:function(a,b){this.headersUI.appendLevelIndicators(a,b)},onModifyRowHeaderWidth:function(a){return this.headersUI.rowHeaderWidthCache||a},onAfterRemoveRow:function(a,b,c,d){var e=this;if(d!==this.pluginName){var f=v.get(this);setTimeout(function(){f.skipRender=null,e.headersUI.updateRowHeaderWidth(),e.collapsingUI.collapsedRowsStash.applyStash()},0)}},onModifyRemovedAmount:function(a,b){var c=this,d=[],e=0;return o(b,b+a-1,function(a){var b=!1,f=c.collapsingUI.translateTrimmedRow(a),g=c.dataManager.getDataObject(f);c.dataManager.hasChildren(g)&&(d.push(g),q(d,function(a){if(a.__children.indexOf(g)>-1)return b=!0,!1}),b||(e+=c.dataManager.countChildren(g))),b=!1,q(d,function(a){if(a.__children.indexOf(g)>-1)return b=!0,!1}),b&&e--}),a+e},onBeforeAddChild:function(a,b){this.collapsingUI.collapsedRowsStash.stash()},onAfterAddChild:function(a,b){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(b)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()},onBeforeDetachChild:function(a,b){this.collapsingUI.collapsedRowsStash.stash()},onAfterDetachChild:function(a,b){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(b)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()},onAfterCreateRow:function(a,b,c){c!==this.pluginName&&this.dataManager.rewriteCache()},onAfterInit:function(){var a;this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var b=(a=Math).max.apply(a,$traceurRuntime.spread(this.dataManager.cache.levels));b>0&&this.headersUI.updateRowHeaderWidth(b)},onBeforeRender:function(a,b){v.get(this).skipRender&&(b.skipRender=!0)}},{},l),m("nestedRows",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"data/dataManager":219,"ui/collapsing":222,"ui/contextMenu":223,"ui/headers":224}],221:[function(a,b,c){"use strict";Object.defineProperties(c,{BaseUI:{get:function(){return d}},__esModule:{value:!0}});var d=function(b,c){this.hot=c,this.plugin=b};$traceurRuntime.createClass(d,{},{})},{}],222:[function(a,b,c){"use strict";Object.defineProperties(c,{CollapsingUI:{get:function(){return p}},__esModule:{value:!0}});var d,e,f,g,h,i,j=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,k=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"))&&e.__esModule&&e||{default:e}).stopImmediatePropagation,l=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,m=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&g.__esModule&&g||{default:g}).rangeEach,n=((h=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&h.__esModule&&h||{default:h}).hasClass,o=((i=a("headers"))&&i.__esModule&&i||{default:i}).HeadersUI,p=function(b,c){var d=this;$traceurRuntime.superConstructor(q).call(this,b,c),this.trimRowsPlugin=b.trimRowsPlugin,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){d.lastCollapsedRows=d.collapsedRows.slice(0),d.expandMultipleChildren(d.lastCollapsedRows,!1)},shiftStash:function(a){var b=void 0!==arguments[1]?arguments[1]:1;a=d.translateTrimmedRow(a),l(d.lastCollapsedRows,function(c,e){c>a-1&&(d.lastCollapsedRows[e]=c+b)})},applyStash:function(){d.hot.runHooks("skipLengthCache",100),d.collapseMultipleChildren(d.lastCollapsedRows,!0),d.lastCollapsedRows=void 0},trimStash:function(a,b){m(a,a+b-1,function(a){var b=d.lastCollapsedRows.indexOf(a);b>-1&&d.lastCollapsedRows.splice(b,1)})}}},q=p;$traceurRuntime.createClass(p,{collapseChildren:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0===arguments[2]||arguments[2],d=this,e=[],f=null,g=null,h=null;return isNaN(a)?(f=a,g=this.dataManager.getRowIndex(f)):(f=this.dataManager.getDataObject(a),g=a),this.dataManager.hasChildren(f)&&l(f.__children,function(a,b){e.push(d.dataManager.getRowIndex(a))}),h=this.collapseRows(e,!0,!1),c&&this.trimRowsPlugin.trimRows(h),b&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(g)&&this.collapsedRows.push(g),h},collapseMultipleChildren:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0===arguments[2]||arguments[2],d=this,e=[];l(a,function(a,b){e=e.concat(d.collapseChildren(a,!1,!1))}),c&&this.trimRowsPlugin.trimRows(e),b&&this.renderAndAdjust()},collapseRow:function(a){var b=void 0===arguments[1]||arguments[1];this.collapseRows([a],b)},collapseRows:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0!==arguments[2]&&arguments[2],d=this,e=[];return l(a,function(a,c){e.push(a),b&&d.collapseChildRows(a,e)}),c&&this.trimRowsPlugin.trimRows(e),e},collapseChildRows:function(a){var b=void 0!==arguments[1]?arguments[1]:[],d=(void 0===arguments[2]||arguments[2],void 0!==arguments[3]&&arguments[3]),e=this;if(this.dataManager.hasChildren(a)){var f=this.dataManager.getDataObject(a);l(f.__children,function(a,c){var d=e.dataManager.getRowIndex(a);b.push(d),e.collapseChildRows(d,b)})}d&&this.trimRowsPlugin.trimRows(b)},expandRow:function(a){var b=void 0===arguments[1]||arguments[1];this.expandRows([a],b)},expandRows:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0!==arguments[2]&&arguments[2],d=this,e=[];return l(a,function(a,c){e.push(a),b&&d.expandChildRows(a,e)}),c&&this.trimRowsPlugin.untrimRows(e),e},expandChildRows:function(a){var b=void 0!==arguments[1]?arguments[1]:[],d=(void 0===arguments[2]||arguments[2],void 0!==arguments[3]&&arguments[3]),e=this;if(this.dataManager.hasChildren(a)){var f=this.dataManager.getDataObject(a);l(f.__children,function(a,c){if(!e.isAnyParentCollapsed(a)){var d=e.dataManager.getRowIndex(a);b.push(d),e.expandChildRows(d,b)}})}d&&this.trimRowsPlugin.untrimRows(b)},expandChildren:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0===arguments[2]||arguments[2],d=this,e=[],f=null,g=null,h=null;return isNaN(a)?(f=a,g=this.dataManager.getRowIndex(a)):(f=this.dataManager.getDataObject(a),g=a),this.collapsedRows.splice(this.collapsedRows.indexOf(g),1),this.dataManager.hasChildren(f)&&l(f.__children,function(a,b){var c=d.dataManager.getRowIndex(a);e.push(c)}),h=this.expandRows(e,!0,!1),c&&this.trimRowsPlugin.untrimRows(h),b&&this.renderAndAdjust(),h},expandMultipleChildren:function(a){var b=void 0===arguments[1]||arguments[1],c=void 0===arguments[2]||arguments[2],d=this,e=[];l(a,function(a,b){e=e.concat(d.expandChildren(a,!1,!1))}),c&&this.trimRowsPlugin.untrimRows(e),b&&this.renderAndAdjust()},collapseAll:function(){var a=this,b=this.hot.getSourceData(),c=[];l(b,function(b,d){a.dataManager.hasChildren(b)&&c.push(b)}),this.collapseMultipleChildren(c),this.renderAndAdjust()},expandAll:function(){var a=this,b=this.hot.getSourceData(),c=[];l(b,function(b,d){a.dataManager.hasChildren(b)&&c.push(b)}),this.expandMultipleChildren(c),this.renderAndAdjust()},areChildrenCollapsed:function(a){var b=this,c=null,d=!0;return c=isNaN(a)?a:this.dataManager.getDataObject(a),this.dataManager.hasChildren(c)&&l(c.__children,function(a,c){var e=b.dataManager.getRowIndex(a);if(!b.trimRowsPlugin.isTrimmed(e))return d=!1,!1}),d},isAnyParentCollapsed:function(a){for(var b=a;null!==b;){b=this.dataManager.getRowParent(b);var c=this.dataManager.getRowIndex(b);if(this.collapsedRows.indexOf(c)>-1)return!0}return!1},toggleState:function(a,b,c){if(!(b.col>=0)){var d=this.translateTrimmedRow(b.row);n(a.target,o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(d)?this.expandChildren(d):this.collapseChildren(d),k(a))}},translateTrimmedRow:function(a){return this.trimRowsPlugin.rowsMapper.getValueByIndex(a)},renderAndAdjust:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}},{},j)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221,headers:224}],223:[function(a,b,c){"use strict";Object.defineProperties(c,{ContextMenuUI:{get:function(){return k}},__esModule:{value:!0}});var d,e,f,g=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,h=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&e.__esModule&&e||{default:e}).rangeEach,i=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&f.__esModule&&f||{default:f}).arrayEach,j=new WeakMap,k=function(b,c){var d=this;j.set(this,{row_above:function(a,b){d.dataManager.addSibling(b.start.row,"above")},row_below:function(a,b){d.dataManager.addSibling(b.start.row,"below")}}),$traceurRuntime.superConstructor(l).call(this,b,c),this.dataManager=this.plugin.dataManager},l=k;$traceurRuntime.createClass(k,{appendOptions:function(a){var b=this,c=[{key:"add_child",name:function(){return"Insert child row"},callback:function(){var a=b.dataManager.translateTrimmedRow(b.hot.getSelected()[0]),c=b.dataManager.getDataObject(a);b.dataManager.addChild(c)},disabled:function(){var a=b.hot.getSelected();return!a||a[0]<0||b.hot.selection.selectedHeader.cols||b.hot.countRows()>=b.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return"Detach from parent"},callback:function(){var a=b.dataManager.translateTrimmedRow(b.hot.getSelected()[0]);b.dataManager.getDataObject(a);b.dataManager.detachFromParent(b.hot.getSelected())},disabled:function(){var a=b.hot.getSelected(),c=b.dataManager.translateTrimmedRow(a[0]);return!b.dataManager.getRowParent(c)||!a||a[0]<0||b.hot.selection.selectedHeader.cols||b.hot.countRows()>=b.hot.getSettings().maxRows}},Handsontable.plugins.ContextMenu.SEPARATOR];return h(0,a.items.length-1,function(b){if(0===b)return i(c,function(c,d){a.items.splice(b+d,0,c)}),!1}),a=this.modifyRowInsertingOptions(a)},modifyRowInsertingOptions:function(a){var b=j.get(this);return h(0,a.items.length-1,function(c){null!=b[a.items[c].key]&&(a.items[c].callback=b[a.items[c].key])}),a}},{},g)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],224:[function(a,b,c){"use strict";Object.defineProperties(c,{HeadersUI:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("_base"))&&d.__esModule&&d||{default:d}).BaseUI,i=((e=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,j=((f=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,k=((g=a("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"))&&g.__esModule&&g||{default:g}).addClass,l=function(b,c){$traceurRuntime.superConstructor(m).call(this,b,c),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null,this.trimRowsPlugin=b.trimRowsPlugin},m=l;$traceurRuntime.createClass(l,{appendLevelIndicators:function(a,b){a=this.trimRowsPlugin.rowsMapper.getValueByIndex(a);var c=this.dataManager.getRowLevel(a),d=this.dataManager.getDataObject(a),e=b.getElementsByTagName("DIV")[0],f=e.querySelector("span.rowHeader"),g=e.querySelectorAll('[class^="ht_nesting"]');if(i(g,function(a,b){a&&e.removeChild(a)}),k(b,m.CSS_CLASSES.indicatorContainer),c){var h=f.cloneNode(!0);e.innerHTML="",j(0,c-1,function(a){var b=document.createElement("SPAN");k(b,m.CSS_CLASSES.emptyIndicator),e.appendChild(b)}),e.appendChild(h)}if(this.dataManager.hasChildren(d)){var l=document.createElement("DIV");k(b,m.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?k(l,m.CSS_CLASSES.button+" "+m.CSS_CLASSES.expandButton):k(l,m.CSS_CLASSES.button+" "+m.CSS_CLASSES.collapseButton),e.appendChild(l)}},updateRowHeaderWidth:function(a){a||(a=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*a+25),this.hot.render()}},{get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}},h)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],225:[function(a,b,c){"use strict";Object.defineProperties(c,{RowsMapper:{get:function(){return l}},__esModule:{value:!0}});var d,e,f,g,h=((d=a("../../browser"))&&d.__esModule&&d||{default:d}).default,i=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"))&&e.__esModule&&e||{default:e}).arrayMapper,j=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"))&&f.__esModule&&f||{default:f}).mixin,k=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&g.__esModule&&g||{default:g}).rangeEach,l=function(b){this.trimRows=b};$traceurRuntime.createClass(l,{createMap:function(a){var b=this,c=0,d=void 0===a?this._arrayMap.length:a;this._arrayMap.length=0,k(d-1,function(a){b.trimRows.isTrimmed(a)?c++:b._arrayMap[a-c]=a})},destroy:function(){this._arrayMap=null}},{}),j(l,i),h.utils.TrimRowsRowsMapper=l},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],226:[function(a,b,c){"use strict";Object.defineProperties(c,{TrimRows:{get:function(){return n}},__esModule:{value:!0}});var d,e,f,g,h,i=((d=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"))&&d.__esModule&&d||{default:d}).default,j=((e=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"))&&e.__esModule&&e||{default:e}).arrayEach,k=((f=a("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"))&&f.__esModule&&f||{default:f}).rangeEach,l=((g=a("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"))&&g.__esModule&&g||{default:g}).registerPlugin,m=((h=a("rowsMapper"))&&h.__esModule&&h||{default:h}).RowsMapper,n=function(b){$traceurRuntime.superConstructor(o).call(this,b),this.trimmedRows=[],this.removedRows=[],this.rowsMapper=new m(this)},o=n;$traceurRuntime.createClass(n,{isEnabled:function(){return!!this.hot.getSettings().trimRows},enablePlugin:function(){var a=this;if(!this.enabled){var b=this.hot.getSettings().trimRows;Array.isArray(b)&&(this.trimmedRows=b),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(b,c){return a.onModifyRow(b,c)}),this.addHook("unmodifyRow",function(b,c){return a.onUnmodifyRow(b,c)}),this.addHook("afterCreateRow",function(b,c){return a.onAfterCreateRow(b,c)}),this.addHook("beforeRemoveRow",function(b,c){return a.onBeforeRemoveRow(b,c)}),this.addHook("afterRemoveRow",function(b,c){return a.onAfterRemoveRow(b,c)}),this.addHook("afterLoadData",function(b){return a.onAfterLoadData(b)}),$traceurRuntime.superGet(this,o.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var a=this.hot.getSettings().trimRows;Array.isArray(a)&&(this.disablePlugin(),this.enablePlugin()),$traceurRuntime.superGet(this,o.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),$traceurRuntime.superGet(this,o.prototype,"disablePlugin").call(this)},trimRows:function(a){var b=this;j(a,function(a){a=parseInt(a,10),b.isTrimmed(a)||b.trimmedRows.push(a)}),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterTrimRow",a)},trimRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.trimRows(a)},untrimRows:function(a){var b=this;j(a,function(a){a=parseInt(a,10),b.isTrimmed(a)&&b.trimmedRows.splice(b.trimmedRows.indexOf(a),1)}),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterUntrimRow",a)},untrimRow:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.untrimRows(a)},isTrimmed:function(a){return this.trimmedRows.indexOf(a)>-1},untrimAll:function(){this.untrimRows([].concat(this.trimmedRows))},onModifyRow:function(a,b){return b!==this.pluginName&&(a=this.rowsMapper.getValueByIndex(a)),a},onUnmodifyRow:function(a,b){return b!==this.pluginName&&(a=this.rowsMapper.getIndexByValue(a)),a},onAfterCreateRow:function(a,b){this.rowsMapper.shiftItems(a,b)},onBeforeRemoveRow:function(a,b){var c=this;this.removedRows.length=0,!1!==a&&k(a,a+b-1,function(a){c.removedRows.push(c.hot.runHooks("modifyRow",a,c.pluginName))})},onAfterRemoveRow:function(a,b){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function(a){a||this.rowsMapper.createMap(this.hot.countSourceRows())},destroy:function(){this.rowsMapper.destroy(),$traceurRuntime.superGet(this,o.prototype,"destroy").call(this)}},{},i),l("trimRows",n)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,rowsMapper:225}],SheetClip:[function(a,b,c){!function(a){"use strict";function b(a){return a.split('"').length-1}var d={parse:function(a){var c,d,e,h,i,j,k,f=[],g=0;for(e=a.split("\n"),e.length>1&&""===e[e.length-1]&&e.pop(),c=0,d=e.length;c<d;c+=1){for(e[c]=e[c].split("\t"),h=0,i=e[c].length;h<i;h+=1)f[g]||(f[g]=[]),j&&0===h?(k=f[g].length-1,f[g][k]=f[g][k]+"\n"+e[c][0],j&&1&b(e[c][0])&&(j=!1,f[g][k]=f[g][k].substring(0,f[g][k].length-1).replace(/""/g,'"'))):h===i-1&&0===e[c][h].indexOf('"')&&1&b(e[c][h])?(f[g].push(e[c][h].substring(1).replace(/""/g,'"')),j=!0):(f[g].push(e[c][h].replace(/""/g,'"')),j=!1);j||(g+=1)}return f},stringify:function(a){var b,c,d,e,g,f="";for(b=0,c=a.length;b<c;b+=1){for(e=a[b].length,d=0;d<e;d+=1)d>0&&(f+="\t"),g=a[b][d],"string"==typeof g?g.indexOf("\n")>-1?f+='"'+g.replace(/"/g,'""')+'"':f+=g:f+=null===g||void 0===g?"":g;f+="\n"}return f}};void 0!==c?(c.parse=d.parse,c.stringify=d.stringify):a.SheetClip=d}(window)},{}],autoResize:[function(a,b,c){function d(){function l(a){return a.currentStyle||document.defaultView.getComputedStyle(a)}var b,a={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},c=document.body,d=document.createTextNode(""),e=document.createElement("SPAN"),f=function(a,b,c){window.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},g=function(a,b,c){window.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},h=function(f){var g,h;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",void 0!==d.textContent?d.textContent=b.value+f:d.data=b.value+f,e.style.fontSize=l(b).fontSize,e.style.fontFamily=l(b).fontFamily,e.style.whiteSpace="pre",c.appendChild(e),g=e.clientWidth+2,c.removeChild(e),b.style.height=a.minHeight+"px",a.minWidth>g?b.style.width=a.minWidth+"px":g>a.maxWidth?b.style.width=a.maxWidth+"px":b.style.width=g+"px",h=b.scrollHeight?b.scrollHeight-1:0,a.minHeight>h?b.style.height=a.minHeight+"px":a.maxHeight<h?(b.style.height=a.maxHeight+"px",b.style.overflowY="visible"):b.style.height=h+"px"},i=function(){window.setTimeout(h,0)},j=function(c){if(c&&c.minHeight)if("inherit"==c.minHeight)a.minHeight=b.clientHeight;else{var f=parseInt(c.minHeight);isNaN(f)||(a.minHeight=f)}if(c&&c.maxHeight)if("inherit"==c.maxHeight)a.maxHeight=b.clientHeight;else{var g=parseInt(c.maxHeight);isNaN(g)||(a.maxHeight=g)}if(c&&c.minWidth)if("inherit"==c.minWidth)a.minWidth=b.clientWidth;else{var h=parseInt(c.minWidth);isNaN(h)||(a.minWidth=h)}if(c&&c.maxWidth)if("inherit"==c.maxWidth)a.maxWidth=b.clientWidth;else{var i=parseInt(c.maxWidth);isNaN(i)||(a.maxWidth=i)}e.firstChild||(e.className="autoResize",e.style.display="inline-block",e.appendChild(d))},k=function(c,d,e){b=c,j(d),"TEXTAREA"==b.nodeName&&(b.style.resize="none",b.style.overflowY="",b.style.height=a.minHeight+"px",b.style.minWidth=a.minWidth+"px",b.style.maxWidth=a.maxWidth+"px",b.style.overflowY="hidden"),e&&(f(b,"change",h),f(b,"cut",i),f(b,"paste",i),f(b,"drop",i),f(b,"keydown",i),f(b,"focus",h)),h()};return{init:function(a,b,c){k(a,b,c)},unObserve:function(){g(b,"change",h),g(b,"cut",i),g(b,"paste",i),g(b,"drop",i),g(b,"keydown",i),g(b,"focus",h)},resize:h}}void 0!==c&&(b.exports=d)},{}],copyPaste:[function(a,b,c){function e(){return d?d.hasBeenDestroyed()&&d.init():d=new f,d.refCounter++,d}function f(){this.refCounter=0,this.init()}var d;void 0!==c&&(b.exports=e),f.prototype.init=function(){var a,b;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],b=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",a=this.elDiv.style,a.position="fixed",a.top="-10000px",a.left="-10000px",b.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(a){var b,c;"WebkitAppearance"in document.documentElement.style&&(b=a.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(c=b.split("\n"),""===c[c.length-1]&&c.pop(),b=c.join("\n")),this.value=b,a.preventDefault())},a=this.elTextarea.style,a.width="10000px",a.height="10000px",a.overflow="hidden",this.elDiv.appendChild(this.elTextarea),void 0!==a.opacity&&(a.opacity=0)),this.onKeyDownRef=this.onKeyDown.bind(this),document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)},f.prototype.onKeyDown=function(a){function d(){var a=document.activeElement;return a.shadowRoot&&a.shadowRoot.activeElement&&(a=a.shadowRoot.activeElement),["INPUT","SELECT","TEXTAREA"].indexOf(a.nodeName)>-1||"true"===a.contentEditable}var b=this,c=!1;if(a.metaKey?c=!0:a.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(c=!0),c){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||d()))return;this.selectNodeText(this.elTextarea),setTimeout(function(){document.activeElement!==b.elTextarea&&b.selectNodeText(b.elTextarea)},0)}!1===a.isImmediatePropagationEnabled||!c||67!==a.keyCode&&86!==a.keyCode&&88!==a.keyCode||(88===a.keyCode?setTimeout(function(){b.triggerCut(a)},0):86===a.keyCode&&setTimeout(function(){b.triggerPaste(a)},0))},f.prototype.selectNodeText=function(a){a&&a.select()},f.prototype.getSelectionText=function(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(a=document.selection.createRange().text),a},f.prototype.copyable=function(a){if("string"!=typeof a&&void 0===a.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=a,this.selectNodeText(this.elTextarea)},f.prototype.onCut=function(a){this.cutCallbacks.push(a)},f.prototype.onPaste=function(a){this.pasteCallbacks.push(a)},f.prototype.removeCallback=function(a){var b,c;for(b=0,c=this.copyCallbacks.length;b<c;b++)if(this.copyCallbacks[b]===a)return this.copyCallbacks.splice(b,1),!0;for(b=0,c=this.cutCallbacks.length;b<c;b++)if(this.cutCallbacks[b]===a)return this.cutCallbacks.splice(b,1),!0;for(b=0,c=this.pasteCallbacks.length;b<c;b++)if(this.pasteCallbacks[b]===a)return this.pasteCallbacks.splice(b,1),!0;return!1},f.prototype.triggerCut=function(a){var b=this;b.cutCallbacks&&setTimeout(function(){for(var c=0,d=b.cutCallbacks.length;c<d;c++)b.cutCallbacks[c](a)},50)},f.prototype.triggerPaste=function(a,b){var c=this;c.pasteCallbacks&&setTimeout(function(){for(var d=b||c.elTextarea.value,e=0,f=c.pasteCallbacks.length;e<f;e++)c.pasteCallbacks[e](d,a)},50)},f.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef),this.onKeyDownRef=null)},f.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],es6collections:[function(a,b,c){!function(a){"use strict";function e(a,b){function d(a){if(!this||this.constructor!==d)return new d(a);this._keys=[],this._values=[],this._itp=[],this.objectOnly=b,a&&f.call(this,a)}return b||c(a,"size",{get:t}),a.constructor=d,d.prototype=a,d}function f(a){this.add?a.forEach(this.add,this):a.forEach(function(a){this.set(a[0],a[1])},this)}function g(a){return this.has(a)&&(this._keys.splice(b,1),this._values.splice(b,1),this._itp.forEach(function(a){b<a[0]&&a[0]--})),-1<b}function h(a){return this.has(a)?this._values[b]:void 0}function i(a,c){if(this.objectOnly&&c!==Object(c))throw new TypeError("Invalid value used as weak collection key");if(c!=c||0===c)for(b=a.length;b--&&!d(a[b],c););else b=a.indexOf(c);return-1<b}function j(a){return i.call(this,this._values,a)}function k(a){return i.call(this,this._keys,a)}function l(a,c){return this.has(a)?this._values[b]=c:this._values[this._keys.push(a)-1]=c,this}function m(a){return this.has(a)||this._values.push(a),this}function n(){this._values.length=0}function o(){return s(this._itp,this._keys)}function p(){return s(this._itp,this._values)}function q(){return s(this._itp,this._keys,this._values)}function r(){return s(this._itp,this._values,this._values)}function s(a,b,c){var d=[0],e=!1;return a.push(d),{next:function(){var f,g=d[0];return!e&&g<b.length?(f=c?[b[g],c[g]]:b[g],d[0]++):(e=!0,a.splice(a.indexOf(d),1)),{done:e,value:f}}}}function t(){return this._values.length}function u(a,b){for(var c=this.entries();;){var d=c.next();if(d.done)break;a.call(b,d.value[1],d.value[0],this)}}var b,c=Object.defineProperty,d=function(a,b){return isNaN(a)?isNaN(b):a===b};"undefined"==typeof WeakMap&&(a.WeakMap=e({delete:g,clear:n,get:h,has:k,set:l},!0)),"undefined"==typeof Map&&(a.Map=e({delete:g,has:k,get:h,set:l,keys:o,values:p,entries:q,forEach:u,clear:n})),"undefined"==typeof Set&&(a.Set=e({has:j,add:m,delete:g,clear:n,keys:p,values:p,entries:r,forEach:u})),"undefined"==typeof WeakSet&&(a.WeakSet=e({delete:g,add:m,clear:n,has:j},!0))}(void 0!==c&&"undefined"!=typeof global?global:window)},{}],"hot-formula-parser":[function(_dereq_,module,exports){!function(b,c){"object"==typeof exports&&"object"==typeof module?module.exports=c():"function"==typeof define&&define.amd?define([],c):"object"==typeof exports?exports.formulaParser=c():b.formulaParser=c()}(this,function(){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var b={};return c.m=a,c.c=b,c.i=function(a){return a},c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:d})},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=81)}([function(a,b){b.nil=new Error("#NULL!"),b.div0=new Error("#DIV/0!"),b.value=new Error("#VALUE!"),b.ref=new Error("#REF!"),b.name=new Error("#NAME?"),b.num=new Error("#NUM!"),b.na=new Error("#N/A"),b.error=new Error("#ERROR!"),b.data=new Error("#GETTING_DATA")},function(a,b,c){"use strict";function n(a){var b=void 0;return a=(a+"").replace(/#|!|\?/g,""),m[a]&&(b=m[a]),b||null}function o(a){var b=!1;for(var c in m)if(Object.prototype.hasOwnProperty.call(m,c)&&m[c]===a){b=!0;break}return b}b.__esModule=!0;var d;b.default=n,b.isValidStrict=o;var e=b.ERROR="ERROR",f=b.ERROR_DIV_ZERO="DIV/0",g=b.ERROR_NAME="NAME",h=b.ERROR_NOT_AVAILABLE="N/A",i=b.ERROR_NULL="NULL",j=b.ERROR_NUM="NUM",k=b.ERROR_REF="REF",l=b.ERROR_VALUE="VALUE",m=(d={},d[e]="#ERROR!",d[f]="#DIV/0!",d[g]="#NAME?",d[h]="#N/A",d[i]="#NULL!",d[j]="#NUM!",d[k]="#REF!",d[l]="#VALUE!",d)},function(a,b,c){var d=c(0);b.flattenShallow=function(a){return a&&a.reduce?a.reduce(function(a,b){var c=Array.isArray(a),d=Array.isArray(b);return c&&d?a.concat(b):c?(a.push(b),a):d?[a].concat(b):[a,b]}):a},b.isFlat=function(a){if(!a)return!1;for(var b=0;b<a.length;++b)if(Array.isArray(a[b]))return!1;return!0},b.flatten=function(){for(var a=b.argsToArray.apply(null,arguments);!b.isFlat(a);)a=b.flattenShallow(a);return a},b.argsToArray=function(a){var c=[];return b.arrayEach(a,function(a){c.push(a)}),c},b.numbers=function(){return this.flatten.apply(null,arguments).filter(function(a){return"number"==typeof a})},b.cleanFloat=function(a){var b=1e14;return Math.round(a*b)/b},b.parseBool=function(a){if("boolean"==typeof a)return a;if(a instanceof Error)return a;if("number"==typeof a)return 0!==a;if("string"==typeof a){var b=a.toUpperCase();if("TRUE"===b)return!0;if("FALSE"===b)return!1}return a instanceof Date&&!isNaN(a)||d.value},b.parseNumber=function(a){return void 0===a||""===a?d.value:isNaN(a)?d.value:parseFloat(a)},b.parseNumberArray=function(a){var c;if(!a||0===(c=a.length))return d.value;for(var e;c--;){if((e=b.parseNumber(a[c]))===d.value)return e;a[c]=e}return a},b.parseMatrix=function(a){if(!a||0===a.length)return d.value;for(var e,f=0;f<a.length;f++)if(e=b.parseNumberArray(a[f]),a[f]=e,e instanceof Error)return e;return a};var e=new Date(1900,0,1);b.parseDate=function(a){if(!isNaN(a)){if(a instanceof Date)return new Date(a);var b=parseInt(a,10);return b<0?d.num:b<=60?new Date(e.getTime()+864e5*(b-1)):new Date(e.getTime()+864e5*(b-2))}return"string"!=typeof a||(a=new Date(a),isNaN(a))?d.value:a},b.parseDateArray=function(a){for(var c,b=a.length;b--;){if((c=this.parseDate(a[b]))===d.value)return c;a[b]=c}return a},b.anyIsError=function(){for(var a=arguments.length;a--;)if(arguments[a]instanceof Error)return!0;return!1},b.arrayValuesToNumbers=function(a){for(var c,b=a.length;b--;)if("number"!=typeof(c=a[b]))if(!0!==c)if(!1!==c){if("string"==typeof c){var d=this.parseNumber(c);d instanceof Error?a[b]=0:a[b]=d}}else a[b]=0;else a[b]=1;return a},b.rest=function(a,b){return b=b||1,a&&"function"==typeof a.slice?a.slice(b):a},b.initial=function(a,b){return b=b||1,a&&"function"==typeof a.slice?a.slice(0,a.length-b):a},b.arrayEach=function(a,b){for(var c=-1,d=a.length;++c<d&&!1!==b(a[c],c,a););return a}},function(a,b,c){"use strict";function d(a){var b=void 0;return"number"==typeof a?b=a:"string"==typeof a&&(b=a.indexOf(".")>-1?parseFloat(a):parseInt(a,10)),b}function e(a){return-1*d(a)}b.__esModule=!0,b.toNumber=d,b.invertNumber=e},function(module,exports,__webpack_require__){var utils=__webpack_require__(2),error=__webpack_require__(0),statistical=__webpack_require__(5),information=__webpack_require__(7);exports.ABS=function(a){return(a=utils.parseNumber(a))instanceof Error?a:Math.abs(a)},exports.ACOS=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.acos(a);return isNaN(b)&&(b=error.num),b},exports.ACOSH=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.log(a+Math.sqrt(a*a-1));return isNaN(b)&&(b=error.num),b},exports.ACOT=function(a){return(a=utils.parseNumber(a))instanceof Error?a:Math.atan(1/a)},exports.ACOTH=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=.5*Math.log((a+1)/(a-1));return isNaN(b)&&(b=error.num),b},exports.AGGREGATE=function(a,b,c,d){if(a=utils.parseNumber(a),b=utils.parseNumber(a),utils.anyIsError(a,b))return error.value;switch(a){case 1:return statistical.AVERAGE(c);case 2:return statistical.COUNT(c);case 3:return statistical.COUNTA(c);case 4:return statistical.MAX(c);case 5:return statistical.MIN(c);case 6:return exports.PRODUCT(c);case 7:return statistical.STDEV.S(c);case 8:return statistical.STDEV.P(c);case 9:return exports.SUM(c);case 10:return statistical.VAR.S(c);case 11:return statistical.VAR.P(c);case 12:return statistical.MEDIAN(c);case 13:return statistical.MODE.SNGL(c);case 14:return statistical.LARGE(c,d);case 15:return statistical.SMALL(c,d);case 16:return statistical.PERCENTILE.INC(c,d);case 17:return statistical.QUARTILE.INC(c,d);case 18:return statistical.PERCENTILE.EXC(c,d);case 19:return statistical.QUARTILE.EXC(c,d)}},exports.ARABIC=function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return error.value;var b=0;return a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){b+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),b},exports.ASIN=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.asin(a);return isNaN(b)&&(b=error.num),b},exports.ASINH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))},exports.ATAN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.atan(a)},exports.ATAN2=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.atan2(a,b)},exports.ATANH=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.log((1+a)/(1-a))/2;return isNaN(b)&&(b=error.num),b},exports.BASE=function(a,b,c){if(c=c||0,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;c=void 0===c?0:c;var d=a.toString(b);return new Array(Math.max(c+1-d.length,0)).join("0")+d},exports.CEILING=function(a,b,c){if(b=void 0===b?1:Math.abs(b),c=c||0,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;if(0===b)return 0;var d=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.ceil(a/b)*b,d):0===c?-exports.ROUND(Math.floor(Math.abs(a)/b)*b,d):-exports.ROUND(Math.ceil(Math.abs(a)/b)*b,d)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:exports.FACT(a)/(exports.FACT(b)*exports.FACT(a-b))},exports.COMBINA=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:0===a&&0===b?1:exports.COMBIN(a+b-1,a-1)},exports.COS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.cos(a)},exports.COSH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2},exports.COT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.tan(a)},exports.COTH=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.exp(2*a);return(b+1)/(b-1)},exports.CSC=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.sin(a)},exports.CSCH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))},exports.DECIMAL=function(a,b){return arguments.length<1?error.value:parseInt(a,b)},exports.DEGREES=function(a){return a=utils.parseNumber(a),a instanceof Error?a:180*a/Math.PI},exports.EVEN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:exports.CEILING(a,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.floor(a);return 0===b||1===b?1:MEMOIZED_FACT[b]>0?MEMOIZED_FACT[b]:(MEMOIZED_FACT[b]=exports.FACT(b-1)*b,MEMOIZED_FACT[b])},exports.FACTDOUBLE=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.floor(a);return b<=0?1:b*exports.FACTDOUBLE(b-2)},exports.FLOOR=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;if(0===b)return 0;if(!(a>0&&b>0||a<0&&b<0))return error.num;b=Math.abs(b);var c=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.floor(a/b)*b,c):-exports.ROUND(Math.ceil(Math.abs(a)/b),c)},exports.FLOOR.MATH=function(a,b,c){if(b=void 0===b?1:b,c=void 0===c?0:c,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;if(0===b)return 0;b=b?Math.abs(b):1;var d=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.floor(a/b)*b,d):0===c||void 0===c?-exports.ROUND(Math.ceil(Math.abs(a)/b)*b,d):-exports.ROUND(Math.floor(Math.abs(a)/b)*b,d)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,c=a[0],d=c<0?-c:c,e=1;e<b;e++){for(var f=a[e],g=f<0?-f:f;d&&g;)d>g?d%=g:g%=d;d+=g}return d},exports.INT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.floor(a)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b,c,d,e,f=1;void 0!==(d=a.pop());)for(;d>1;){if(d%2){for(b=3,c=Math.floor(Math.sqrt(d));b<=c&&d%b;b+=2);e=b<=c?b:d}else e=2;for(d/=e,f*=e,b=a.length;b;a[--b]%e==0&&1==(a[b]/=e)&&a.splice(b,1));}return f},exports.LN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a)},exports.LN10=function(){return Math.log(10)},exports.LN2=function(){return Math.log(2)},exports.LOG10E=function(){return Math.LOG10E},exports.LOG2E=function(){return Math.LOG2E},exports.LOG=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:(b=void 0===b?10:b,Math.log(a)/Math.log(b))},exports.LOG10=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a)/Math.log(10)},exports.MOD=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;if(0===b)return error.div0;var c=Math.abs(a%b);return b>0?c:-c},exports.MROUND=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a*b<0?error.num:Math.round(a/b)*b},exports.MULTINOMIAL=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=0,c=1,d=0;d<a.length;d++)b+=a[d],c*=exports.FACT(a[d]);return exports.FACT(b)/c},exports.ODD=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.ceil(Math.abs(a));return b=1&b?b:b+1,a>0?b:-b},exports.PI=function(){return Math.PI},exports.E=function(){return Math.E},exports.POWER=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=Math.pow(a,b);return isNaN(c)?error.num:c},exports.PRODUCT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=1,c=0;c<a.length;c++)b*=a[c];return b},exports.QUOTIENT=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:parseInt(a/b,10)},exports.RADIANS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:a*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a+Math.ceil((b-a+1)*Math.random())-1},exports.ROMAN=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;for(var b=String(a).split(""),c=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],d="",e=3;e--;)d=(c[+b.pop()+10*e]||"")+d;return new Array(+b.join("")+1).join("M")+d},exports.ROUND=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.round(a*Math.pow(10,b))/Math.pow(10,b)},exports.ROUNDDOWN=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:(a>0?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},exports.ROUNDUP=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:(a>0?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},exports.SEC=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.cos(a)},exports.SECH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))},exports.SERIESSUM=function(a,b,c,d){if(a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumberArray(d),utils.anyIsError(a,b,c,d))return error.value;for(var e=d[0]*Math.pow(a,b),f=1;f<d.length;f++)e+=d[f]*Math.pow(a,b+f*c);return e},exports.SIGN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:a<0?-1:0===a?0:1},exports.SIN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.sin(a)},exports.SINH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2},exports.SQRT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:a<0?error.num:Math.sqrt(a)},exports.SQRTPI=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.sqrt(a*Math.PI)},exports.SQRT1_2=function(){return 1/Math.sqrt(2)},exports.SQRT2=function(){return Math.sqrt(2)},exports.SUBTOTAL=function(a,b){if((a=utils.parseNumber(a))instanceof Error)return a;switch(a){case 1:return statistical.AVERAGE(b);case 2:return statistical.COUNT(b);case 3:return statistical.COUNTA(b);case 4:return statistical.MAX(b);case 5:return statistical.MIN(b);case 6:return exports.PRODUCT(b);case 7:return statistical.STDEV.S(b);case 8:return statistical.STDEV.P(b);case 9:return exports.SUM(b);case 10:return statistical.VAR.S(b);case 11:return statistical.VAR.P(b);case 101:return statistical.AVERAGE(b);case 102:return statistical.COUNT(b);case 103:return statistical.COUNTA(b);case 104:return statistical.MAX(b);case 105:return statistical.MIN(b);case 106:return exports.PRODUCT(b);case 107:return statistical.STDEV.S(b);case 108:return statistical.STDEV.P(b);case 109:return exports.SUM(b);case 110:return statistical.VAR.S(b);case 111:return statistical.VAR.P(b)}},exports.ADD=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a+b)},exports.MINUS=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a-b)},exports.DIVIDE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:0===b?error.div0:a/b)},exports.MULTIPLY=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a*b)},exports.GTE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:a>=b)},exports.LT=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:a<b)},exports.LTE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:a<=b)},exports.EQ=function(a,b){return 2!==arguments.length?error.na:a===b},exports.NE=function(a,b){return 2!==arguments.length?error.na:a!==b},exports.POW=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:exports.POWER(a,b))},exports.SUM=function(){var a=0;return utils.arrayEach(utils.argsToArray(arguments),function(b){if("number"==typeof b)a+=b;else if("string"==typeof b){var c=parseFloat(b);!isNaN(c)&&(a+=c)}else Array.isArray(b)&&(a+=exports.SUM.apply(null,b))}),a},exports.SUMIF=function(range,criteria){if((range=utils.parseNumberArray(utils.flatten(range)))instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var c,d,e,f,a=arguments.length+1,b=0,g=0;g<arguments[0].length;g++)if(arguments[0][g]instanceof Array)for(var h=0;h<arguments[0][g].length;h++){for(c=1,d=1;d<a;d++){if((f=utils.parseNumber(arguments[d-1][g][h]))instanceof Error)return f;c*=f}b+=c}else{for(c=1,d=1;d<a;d++){if((e=utils.parseNumber(arguments[d-1][g]))instanceof Error)return e;c*=e}b+=c}return b},exports.SUMSQ=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=0,c=a.length,d=0;d<c;d++)b+=information.ISNUMBER(a[d])?a[d]*a[d]:0;return b},exports.SUMX2MY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=0,d=0;d<a.length;d++)c+=a[d]*a[d]-b[d]*b[d];return c},exports.SUMX2PY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var c=0;a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b));for(var d=0;d<a.length;d++)c+=a[d]*a[d]+b[d]*b[d];return c},exports.SUMXMY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var c=0;a=utils.flatten(a),b=utils.flatten(b);for(var d=0;d<a.length;d++)c+=Math.pow(a[d]-b[d],2);return c},exports.TAN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.tan(a)},exports.TANH=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.exp(2*a);return(b-1)/(b+1)},exports.TRUNC=function(a,b){return b=void 0===b?0:b,a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:(a>0?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(4),text=__webpack_require__(8),jStat=__webpack_require__(13).jStat,utils=__webpack_require__(2),error=__webpack_require__(0),misc=__webpack_require__(12);exports.AVEDEV=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:jStat.sum(jStat(a).subtract(jStat.mean(a)).abs()[0])/a.length},exports.AVERAGE=function(){for(var e,a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=0,f=0;f<b;f++)c+=a[f],d+=1;return e=c/d,isNaN(e)&&(e=error.num),e},exports.AVERAGEA=function(){for(var e,a=utils.flatten(arguments),b=a.length,c=0,d=0,f=0;f<b;f++){var g=a[f];"number"==typeof g&&(c+=g),!0===g&&c++,null!==g&&d++}return e=c/d,isNaN(e)&&(e=error.num),e},exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1)return error.na;if(average_range=average_range||range,range=utils.flatten(range),(average_range=utils.parseNumberArray(utils.flatten(average_range)))instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(a,b,c,d,e,f){return arguments.length<4?error.value:(e=void 0===e?0:e,f=void 0===f?1:f,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),e=utils.parseNumber(e),f=utils.parseNumber(f),utils.anyIsError(a,b,c,e,f)?error.value:(a=(a-e)/(f-e),d?jStat.beta.cdf(a,b,c):jStat.beta.pdf(a,b,c)))},exports.BETA.INV=function(a,b,c,d,e){return d=void 0===d?0:d,e=void 0===e?1:e,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),e=utils.parseNumber(e),utils.anyIsError(a,b,c,d,e)?error.value:jStat.beta.inv(a,b,c)*(e-d)+d},exports.BINOM={},exports.BINOM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d)?error.value:d?jStat.binomial.cdf(a,b,c):jStat.binomial.pdf(a,b,c)},exports.BINOM.DIST.RANGE=function(a,b,c,d){if(d=void 0===d?c:d,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d))return error.value;for(var e=0,f=c;f<=d;f++)e+=mathTrig.COMBIN(a,f)*Math.pow(b,f)*Math.pow(1-b,a-f);return e},exports.BINOM.INV=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;for(var d=0;d<=a;){if(jStat.binomial.cdf(d,a,b)>=c)return d;d++}},exports.CHISQ={},exports.CHISQ.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.chisquare.cdf(a,b):jStat.chisquare.pdf(a,b)},exports.CHISQ.DIST.RT=function(a,b){return!a|!b?error.na:a<1||b>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b?error.value:1-jStat.chisquare.cdf(a,b)},exports.CHISQ.INV=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:jStat.chisquare.inv(a,b)},exports.CHISQ.INV.RT=function(a,b){return!a|!b?error.na:a<0||a>1||b<1||b>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b?error.value:jStat.chisquare.inv(1-a,b)},exports.CHISQ.TEST=function(a,b){function k(a,b){var c=Math.exp(-.5*a);b%2==1&&(c*=Math.sqrt(2*a/j));for(var d=b;d>=2;)c=c*a/d,d-=2;for(var e=c,f=b;e>1e-10*c;)f+=2,e=e*a/f,c+=e;return 1-c}if(2!==arguments.length)return error.na;if(!(a instanceof Array&&b instanceof Array))return error.value;if(a.length!==b.length)return error.value;if(a[0]&&b[0]&&a[0].length!==b[0].length)return error.value;var d,e,f,c=a.length;for(e=0;e<c;e++)a[e]instanceof Array||(d=a[e],a[e]=[],a[e].push(d)),b[e]instanceof Array||(d=b[e],b[e]=[],b[e].push(d));var g=a[0].length,h=1===g?c-1:(c-1)*(g-1),i=0,j=Math.PI;for(e=0;e<c;e++)for(f=0;f<g;f++)i+=Math.pow(a[e][f]-b[e][f],2)/b[e][f];return Math.round(1e6*k(i,h))/1e6},exports.COLUMN=function(a,b){return 2!==arguments.length?error.na:b<0?error.num:a instanceof Array&&"number"==typeof b?0!==a.length?jStat.col(a,b):void 0:error.value},exports.COLUMNS=function(a){return 1!==arguments.length?error.na:a instanceof Array?0===a.length?0:jStat.cols(a):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.normalci(1,a,b,c)[1]-1},exports.CONFIDENCE.T=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.tci(1,a,b,c)[1]-1},exports.CORREL=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:jStat.corrcoeff(a,b)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var a=utils.flatten(arguments);return a.length-exports.COUNTBLANK(a)},exports.COUNTIN=function(a,b){var c=0;a=utils.flatten(a);for(var d=0;d<a.length;d++)a[d]===b&&c++;return c},exports.COUNTBLANK=function(){for(var c,a=utils.flatten(arguments),b=0,d=0;d<a.length;d++)null!==(c=a[d])&&""!==c||b++;return b},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=0,f=a.length,g=0;g<f;g++)e+=(a[g]-c)*(b[g]-d);return e/f},exports.COVARIANCE.S=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:jStat.covariance(a,b)},exports.DEVSQ=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return c},exports.EXPON={},exports.EXPON.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.exponential.cdf(a,b):jStat.exponential.pdf(a,b)},exports.F={},exports.F.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.centralF.cdf(a,b,c):jStat.centralF.pdf(a,b,c)},exports.F.DIST.RT=function(a,b,c){return 3!==arguments.length?error.na:a<0||b<1||c<1?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:1-jStat.centralF.cdf(a,b,c)},exports.F.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:a<=0||a>1?error.num:jStat.centralF.inv(a,b,c)},exports.F.INV.RT=function(a,b,c){return 3!==arguments.length?error.na:a<0||a>1||b<1||b>Math.pow(10,10)||c<1||c>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:jStat.centralF.inv(1-a,b,c)},exports.F.TEST=function(a,b){if(!a||!b)return error.na;if(!(a instanceof Array&&b instanceof Array))return error.na;if(a.length<2||b.length<2)return error.div0;var c=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return c},d=mathTrig.SUM(a)/a.length,e=mathTrig.SUM(b)/b.length;return c(a,d)/(a.length-1)/(c(b,e)/(b.length-1))},exports.FISHER=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log((1+a)/(1-a))/2},exports.FISHERINV=function(a){if((a=utils.parseNumber(a))instanceof Error)return a;var b=Math.exp(2*a);return(b-1)/(b+1)},exports.FORECAST=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumberArray(utils.flatten(c)),utils.anyIsError(a,b,c))return error.value;for(var d=jStat.mean(c),e=jStat.mean(b),f=c.length,g=0,h=0,i=0;i<f;i++)g+=(c[i]-d)*(b[i]-e),h+=Math.pow(c[i]-d,2);var j=g/h;return e-j*d+j*a},exports.FREQUENCY=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=a.length,d=b.length,e=[],f=0;f<=d;f++){e[f]=0;for(var g=0;g<c;g++)0===f?a[g]<=b[0]&&(e[0]+=1):f<d?a[g]>b[f-1]&&a[g]<=b[f]&&(e[f]+=1):f===d&&a[g]>b[d-1]&&(e[d]+=1)}return e},exports.GAMMA=function(a){return a=utils.parseNumber(a),a instanceof Error?a:0===a?error.num:parseInt(a,10)===a&&a<0?error.num:jStat.gammafn(a)},exports.GAMMA.DIST=function(a,b,c,d){return 4!==arguments.length?error.na:a<0||b<=0||c<=0?error.value:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:d?jStat.gamma.cdf(a,b,c,!0):jStat.gamma.pdf(a,b,c,!1)},exports.GAMMA.INV=function(a,b,c){return 3!==arguments.length?error.na:a<0||a>1||b<=0||c<=0?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:jStat.gamma.inv(a,b,c)},exports.GAMMALN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:jStat.gammaln(a)},exports.GAMMALN.PRECISE=function(a){return 1!==arguments.length?error.na:a<=0?error.num:"number"!=typeof a?error.value:jStat.gammaln(a)},exports.GAUSS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:jStat.normal.cdf(a,0,1)-.5},exports.GEOMEAN=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:jStat.geomean(a)},exports.GROWTH=function(a,b,c,d){if((a=utils.parseNumberArray(a))instanceof Error)return a;var e;if(void 0===b)for(b=[],e=1;e<=a.length;e++)b.push(e);if(void 0===c)for(c=[],e=1;e<=a.length;e++)c.push(e);if(b=utils.parseNumberArray(b),c=utils.parseNumberArray(c),utils.anyIsError(b,c))return error.value;void 0===d&&(d=!0);var f=a.length,g=0,h=0,i=0,j=0;for(e=0;e<f;e++){var k=b[e],l=Math.log(a[e]);g+=k,h+=l,i+=k*l,j+=k*k}g/=f,h/=f,i/=f,j/=f;var m,n;d?(m=(i-g*h)/(j-g*g),n=h-m*g):(m=i/j,n=0);var o=[];for(e=0;e<c.length;e++)o.push(Math.exp(n+m*c[e]));return o},exports.HARMEAN=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,c=0,d=0;d<b;d++)c+=1/a[d];return b/c},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(a,b,c,d,e){function f(a,b,c,d){return mathTrig.COMBIN(c,a)*mathTrig.COMBIN(d-c,b-a)/mathTrig.COMBIN(d,b)}function g(a,b,c,d){for(var e=0,g=0;g<=a;g++)e+=f(g,b,c,d);return e}return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d)?error.value:e?g(a,b,c,d):f(a,b,c,d)},exports.INTERCEPT=function(a,b){return a=utils.parseNumberArray(a),b=utils.parseNumberArray(b),utils.anyIsError(a,b)?error.value:a.length!==b.length?error.na:exports.FORECAST(0,a,b)},exports.KURT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0;e<c;e++)d+=Math.pow(a[e]-b,4);return d/=Math.pow(jStat.stdev(a,!0),4),c*(c+1)/((c-1)*(c-2)*(c-3))*d-3*(c-1)*(c-1)/((c-2)*(c-3))},exports.LARGE=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b)?a:a.sort(function(a,b){return b-a})[b-1]},exports.LINEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=b.length,f=0,g=0,h=0;h<e;h++)f+=(b[h]-d)*(a[h]-c),g+=Math.pow(b[h]-d,2);var i=f/g;return[i,c-i*d]},exports.LOGEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=0;c<a.length;c++)a[c]=Math.log(a[c]);var d=exports.LINEST(a,b);return d[0]=Math.round(1e6*Math.exp(d[0]))/1e6,d[1]=Math.round(1e6*Math.exp(d[1]))/1e6,d},exports.LOGNORM={},exports.LOGNORM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.lognormal.cdf(a,b,c):jStat.lognormal.pdf(a,b,c)},exports.LOGNORM.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.lognormal.inv(a,b,c)},exports.MAX=function(){var a=utils.numbers(utils.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)},exports.MAXA=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)},exports.MEDIAN=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments)),b=jStat.median(a);return isNaN(b)&&(b=error.num),b},exports.MIN=function(){var a=utils.numbers(utils.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)},exports.MINA=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)},exports.MODE={},exports.MODE.MULT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var f,b=a.length,c={},d=[],e=0,g=0;g<b;g++)f=a[g],c[f]=c[f]?c[f]+1:1,c[f]>e&&(e=c[f],d=[]),c[f]===e&&(d[d.length]=f);return d},exports.MODE.SNGL=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:exports.MODE.MULT(a).sort(function(a,b){return a-b})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.negbin.cdf(a,b,c):jStat.negbin.pdf(a,b,c)},exports.NORM={},exports.NORM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:c<=0?error.num:d?jStat.normal.cdf(a,b,c):jStat.normal.pdf(a,b,c)},exports.NORM.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.normal.inv(a,b,c)},exports.NORM.S={},exports.NORM.S.DIST=function(a,b){return a=utils.parseNumber(a),a instanceof Error?error.value:b?jStat.normal.cdf(a,0,1):jStat.normal.pdf(a,0,1)},exports.NORM.S.INV=function(a){return a=utils.parseNumber(a),a instanceof Error?error.value:jStat.normal.inv(a,0,1)},exports.PEARSON=function(a,b){if(b=utils.parseNumberArray(utils.flatten(b)),a=utils.parseNumberArray(utils.flatten(a)),utils.anyIsError(b,a))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=a.length,f=0,g=0,h=0,i=0;i<e;i++)f+=(a[i]-c)*(b[i]-d),g+=Math.pow(a[i]-c,2),h+=Math.pow(b[i]-d,2);return f/Math.sqrt(g*h)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;a=a.sort(function(a,b){return a-b});var c=a.length;if(b<1/(c+1)||b>1-1/(c+1))return error.num;var d=b*(c+1)-1,e=Math.floor(d);return utils.cleanFloat(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))},exports.PERCENTILE.INC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;a=a.sort(function(a,b){return a-b});var c=a.length,d=b*(c-1),e=Math.floor(d);return utils.cleanFloat(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(a,b,c){if(c=void 0===c?3:c,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;a=a.sort(function(a,b){return a-b});for(var d=misc.UNIQUE.apply(null,a),e=a.length,f=d.length,g=Math.pow(10,c),h=0,i=!1,j=0;!i&&j<f;)b===d[j]?(h=(a.indexOf(d[j])+1)/(e+1),i=!0):b>=d[j]&&(b<d[j+1]||j===f-1)&&(h=(a.indexOf(d[j])+1+(b-d[j])/(d[j+1]-d[j]))/(e+1),i=!0),j++;return Math.floor(h*g)/g},exports.PERCENTRANK.INC=function(a,b,c){if(c=void 0===c?3:c,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;a=a.sort(function(a,b){return a-b});for(var d=misc.UNIQUE.apply(null,a),e=a.length,f=d.length,g=Math.pow(10,c),h=0,i=!1,j=0;!i&&j<f;)b===d[j]?(h=a.indexOf(d[j])/(e-1),i=!0):b>=d[j]&&(b<d[j+1]||j===f-1)&&(h=(a.indexOf(d[j])+(b-d[j])/(d[j+1]-d[j]))/(e-1),i=!0),j++;return Math.floor(h*g)/g},exports.PERMUT=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:mathTrig.FACT(a)/mathTrig.FACT(a-b)},exports.PERMUTATIONA=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.pow(a,b)},exports.PHI=function(a){return a=utils.parseNumber(a),a instanceof Error?error.value:Math.exp(-.5*a*a)/2.5066282746310002},exports.POISSON={},exports.POISSON.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.poisson.cdf(a,b):jStat.poisson.pdf(a,b)},exports.PROB=function(a,b,c,d){if(void 0===c)return 0;if(d=void 0===d?c:d,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d))return error.value;if(c===d)return a.indexOf(c)>=0?b[a.indexOf(c)]:0;for(var e=a.sort(function(a,b){return a-b}),f=e.length,g=0,h=0;h<f;h++)e[h]>=c&&e[h]<=d&&(g+=b[a.indexOf(e[h])]);return g},exports.QUARTILE={},exports.QUARTILE.EXC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;switch(b){case 1:return exports.PERCENTILE.EXC(a,.25);case 2:return exports.PERCENTILE.EXC(a,.5);case 3:return exports.PERCENTILE.EXC(a,.75);default:return error.num}},exports.QUARTILE.INC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;switch(b){case 1:return exports.PERCENTILE.INC(a,.25);case 2:return exports.PERCENTILE.INC(a,.5);case 3:return exports.PERCENTILE.INC(a,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;b=utils.flatten(b),c=c||!1;var d=c?function(a,b){return a-b}:function(a,b){return b-a};b=b.sort(d);for(var e=b.length,f=0,g=0;g<e;g++)b[g]===a&&f++;return f>1?(2*b.indexOf(a)+f+1)/2:b.indexOf(a)+1},exports.RANK.EQ=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;c=c||!1;var d=c?function(a,b){return a-b}:function(a,b){return b-a};return b=b.sort(d),b.indexOf(a)+1},exports.ROW=function(a,b){return 2!==arguments.length?error.na:b<0?error.num:a instanceof Array&&"number"==typeof b?0!==a.length?jStat.row(a,b):void 0:error.value},exports.ROWS=function(a){return 1!==arguments.length?error.na:a instanceof Array?0===a.length?0:jStat.rows(a):error.value},exports.RSQ=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:Math.pow(exports.PEARSON(a,b),2)},exports.SKEW=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0;e<c;e++)d+=Math.pow(a[e]-b,3);return c*d/((c-1)*(c-2)*Math.pow(jStat.stdev(a,!0),3))},exports.SKEW.P=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0,f=0;f<c;f++)e+=Math.pow(a[f]-b,3),d+=Math.pow(a[f]-b,2);return e/=c,d/=c,e/Math.pow(d,1.5)},exports.SLOPE=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,h=0;h<e;h++)f+=(b[h]-c)*(a[h]-d),g+=Math.pow(b[h]-c,2);return f/g},exports.SMALL=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b)?a:a.sort(function(a,b){return a-b})[b-1]},exports.STANDARDIZE=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:(a-b)/c},exports.STDEV={},exports.STDEV.P=function(){var a=exports.VAR.P.apply(this,arguments),b=Math.sqrt(a);return isNaN(b)&&(b=error.num),b},exports.STDEV.S=function(){var a=exports.VAR.S.apply(this,arguments);return Math.sqrt(a)},exports.STDEVA=function(){var a=exports.VARA.apply(this,arguments);return Math.sqrt(a)},exports.STDEVPA=function(){var a=exports.VARPA.apply(this,arguments),b=Math.sqrt(a);return isNaN(b)&&(b=error.num),b},exports.STEYX=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,h=0,i=0;i<e;i++)f+=Math.pow(a[i]-d,2),g+=(b[i]-c)*(a[i]-d),h+=Math.pow(b[i]-c,2);return Math.sqrt((f-g*g/h)/(e-2))},exports.TRANSPOSE=function(a){return a?jStat.transpose(a):error.na},exports.T=text.T,exports.T.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.studentt.cdf(a,b):jStat.studentt.pdf(a,b)},exports.T.DIST["2T"]=function(a,b){return 2!==arguments.length?error.na:a<0||b<1?error.num:"number"!=typeof a||"number"!=typeof b?error.value:2*(1-jStat.studentt.cdf(a,b))},exports.T.DIST.RT=function(a,b){return 2!==arguments.length?error.na:a<0||b<1?error.num:"number"!=typeof a||"number"!=typeof b?error.value:1-jStat.studentt.cdf(a,b)},exports.T.INV=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:jStat.studentt.inv(a,b)},exports.T.INV["2T"]=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),a<=0||a>1||b<1?error.num:utils.anyIsError(a,b)?error.value:Math.abs(jStat.studentt.inv(a/2,b))},exports.T.TEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var g,c=jStat.mean(a),d=jStat.mean(b),e=0,f=0;for(g=0;g<a.length;g++)e+=Math.pow(a[g]-c,2);for(g=0;g<b.length;g++)f+=Math.pow(b[g]-d,2);e/=a.length-1,f/=b.length-1;var h=Math.abs(c-d)/Math.sqrt(e/a.length+f/b.length);return exports.T.DIST["2T"](h,a.length+b.length-2)},exports.TREND=function(a,b,c){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumberArray(utils.flatten(c)),utils.anyIsError(a,b,c))return error.value;var d=exports.LINEST(a,b),e=d[0],f=d[1],g=[];return c.forEach(function(a){g.push(e*a+f)}),g},exports.TRIMMEAN=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=mathTrig.FLOOR(a.length*b,2)/2;return jStat.mean(utils.initial(utils.rest(a.sort(function(a,b){return a-b}),c),c))},exports.VAR={},exports.VAR.P=function(){for(var e,a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=exports.AVERAGE(a),f=0;f<b;f++)c+=Math.pow(a[f]-d,2);return e=c/b,isNaN(e)&&(e=error.num),e},exports.VAR.S=function(){for(var a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=exports.AVERAGE(a),e=0;e<b;e++)c+=Math.pow(a[e]-d,2);return c/(b-1)},exports.VARA=function(){for(var a=utils.flatten(arguments),b=a.length,c=0,d=0,e=exports.AVERAGEA(a),f=0;f<b;f++){var g=a[f];c+="number"==typeof g?Math.pow(g-e,2):!0===g?Math.pow(1-e,2):Math.pow(0-e,2),null!==g&&d++}return c/(d-1)},exports.VARPA=function(){for(var f,a=utils.flatten(arguments),b=a.length,c=0,d=0,e=exports.AVERAGEA(a),g=0;g<b;g++){var h=a[g];c+="number"==typeof h?Math.pow(h-e,2):!0===h?Math.pow(1-e,2):Math.pow(0-e,2),null!==h&&d++}return f=c/d,isNaN(f)&&(f=error.num),f},exports.WEIBULL={},exports.WEIBULL.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?1-Math.exp(-Math.pow(a/c,b)):Math.pow(a,b-1)*Math.exp(-Math.pow(a/c,b))*b/Math.pow(c,b)},exports.Z={},exports.Z.TEST=function(a,b,c){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;c=c||exports.STDEV.S(a);var d=a.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(a)-b)/(c/Math.sqrt(d)),!0)}},function(a,b,c){function j(a){return 1===new Date(a,1,29).getMonth()}function k(a,b){return Math.ceil((b-a)/1e3/60/60/24)}function l(a){return(a-f)/864e5+(a>-22038912e5?2:1)}var d=c(0),e=c(2),f=new Date(1900,0,1),g=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],h=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],i=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];b.DATE=function(a,b,c){return a=e.parseNumber(a),b=e.parseNumber(b),c=e.parseNumber(c),e.anyIsError(a,b,c)?d.value:a<0||b<0||c<0?d.num:new Date(a,b-1,c)},b.DATEVALUE=function(a){if("string"!=typeof a)return d.value;var b=Date.parse(a);return isNaN(b)?d.value:b<=-22038912e5?(b-f)/864e5+1:(b-f)/864e5+2},b.DAY=function(a){var b=e.parseDate(a);return b instanceof Error?b:b.getDate()},b.DAYS=function(a,b){return a=e.parseDate(a),b=e.parseDate(b),a instanceof Error?a:b instanceof Error?b:l(a)-l(b)},b.DAYS360=function(a,b,c){if(c=e.parseBool(c),a=e.parseDate(a),b=e.parseDate(b),a instanceof Error)return a;if(b instanceof Error)return b;if(c instanceof Error)return c;var g,h,d=a.getMonth(),f=b.getMonth();if(c)g=31===a.getDate()?30:a.getDate(),h=31===b.getDate()?30:b.getDate();else{var i=new Date(a.getFullYear(),d+1,0).getDate(),j=new Date(b.getFullYear(),f+1,0).getDate();g=a.getDate()===i?30:a.getDate(),b.getDate()===j?g<30?(f++,h=1):h=30:h=b.getDate()}return 360*(b.getFullYear()-a.getFullYear())+30*(f-d)+(h-g)},b.EDATE=function(a,b){return(a=e.parseDate(a))instanceof Error?a:isNaN(b)?d.value:(b=parseInt(b,10),a.setMonth(a.getMonth()+b),l(a))},b.EOMONTH=function(a,b){return(a=e.parseDate(a))instanceof Error?a:isNaN(b)?d.value:(b=parseInt(b,10),l(new Date(a.getFullYear(),a.getMonth()+b+1,0)))},b.HOUR=function(a){return a=e.parseDate(a),a instanceof Error?a:a.getHours()},b.INTERVAL=function(a){if("number"!=typeof a&&"string"!=typeof a)return d.value;a=parseInt(a,10);var b=Math.floor(a/94608e4);a%=94608e4;var c=Math.floor(a/2592e3);a%=2592e3;var e=Math.floor(a/86400);a%=86400;var f=Math.floor(a/3600);a%=3600;var g=Math.floor(a/60);a%=60;var h=a;return b=b>0?b+"Y":"",c=c>0?c+"M":"",e=e>0?e+"D":"",f=f>0?f+"H":"",g=g>0?g+"M":"",h=h>0?h+"S":"","P"+b+c+e+"T"+f+g+h},b.ISOWEEKNUM=function(a){if((a=e.parseDate(a))instanceof Error)return a;a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864e5+1)/7)},b.MINUTE=function(a){return a=e.parseDate(a),a instanceof Error?a:a.getMinutes()},b.MONTH=function(a){return a=e.parseDate(a),a instanceof Error?a:a.getMonth()+1},b.NETWORKDAYS=function(a,b,c){return this.NETWORKDAYS.INTL(a,b,1,c)},b.NETWORKDAYS.INTL=function(a,b,c,f){if((a=e.parseDate(a))instanceof Error)return a;if((b=e.parseDate(b))instanceof Error)return b;if(!((c=void 0===c?i[1]:i[c])instanceof Array))return d.value;void 0===f?f=[]:f instanceof Array||(f=[f]);for(var g=0;g<f.length;g++){var h=e.parseDate(f[g]);if(h instanceof Error)return h;f[g]=h}var j=(b-a)/864e5+1,k=j,l=a;for(g=0;g<j;g++){var m=(new Date).getTimezoneOffset()>0?l.getUTCDay():l.getDay(),n=!1;m!==c[0]&&m!==c[1]||(n=!0);for(var o=0;o<f.length;o++){var p=f[o];if(p.getDate()===l.getDate()&&p.getMonth()===l.getMonth()&&p.getFullYear()===l.getFullYear()){n=!0;break}}n&&k--,l.setDate(l.getDate()+1)}return k},b.NOW=function(){return new Date},b.SECOND=function(a){return a=e.parseDate(a),a instanceof Error?a:a.getSeconds()},b.TIME=function(a,b,c){return a=e.parseNumber(a),b=e.parseNumber(b),c=e.parseNumber(c),e.anyIsError(a,b,c)?d.value:a<0||b<0||c<0?d.num:(3600*a+60*b+c)/86400},b.TIMEVALUE=function(a){return a=e.parseDate(a),a instanceof Error?a:(3600*a.getHours()+60*a.getMinutes()+a.getSeconds())/86400},b.TODAY=function(){return new Date},b.WEEKDAY=function(a,b){if((a=e.parseDate(a))instanceof Error)return a;void 0===b&&(b=1);var c=a.getDay();return h[b][c]},b.WEEKNUM=function(a,b){if((a=e.parseDate(a))instanceof Error)return a;if(void 0===b&&(b=1),21===b)return this.ISOWEEKNUM(a);var c=g[b],d=new Date(a.getFullYear(),0,1),f=d.getDay()<c?1:0;return d-=24*Math.abs(d.getDay()-c)*60*60*1e3,Math.floor((a-d)/864e5/7+1)+f},b.WORKDAY=function(a,b,c){return this.WORKDAY.INTL(a,b,1,c)},b.WORKDAY.INTL=function(a,b,c,f){if((a=e.parseDate(a))instanceof Error)return a;if((b=e.parseNumber(b))instanceof Error)return b;if(b<0)return d.num;if(!((c=void 0===c?i[1]:i[c])instanceof Array))return d.value;void 0===f?f=[]:f instanceof Array||(f=[f]);for(var g=0;g<f.length;g++){var h=e.parseDate(f[g]);if(h instanceof Error)return h;f[g]=h}for(var j=0;j<b;){a.setDate(a.getDate()+1);var k=a.getDay();if(k!==c[0]&&k!==c[1]){for(var l=0;l<f.length;l++){var m=f[l];if(m.getDate()===a.getDate()&&m.getMonth()===a.getMonth()&&m.getFullYear()===a.getFullYear()){j--;break}}j++}}return a},b.YEAR=function(a){return a=e.parseDate(a),a instanceof Error?a:a.getFullYear()},b.YEARFRAC=function(a,b,c){if((a=e.parseDate(a))instanceof Error)return a;if((b=e.parseDate(b))instanceof Error)return b;c=c||0;var d=a.getDate(),f=a.getMonth()+1,g=a.getFullYear(),h=b.getDate(),i=b.getMonth()+1,l=b.getFullYear();switch(c){case 0:return 31===d&&31===h?(d=30,h=30):31===d?d=30:30===d&&31===h&&(h=30),(h+30*i+360*l-(d+30*f+360*g))/360;case 1:var m=function(a,b){var c=a.getFullYear(),d=new Date(c,2,1);if(j(c)&&a<d&&b>=d)return!0;var e=b.getFullYear(),f=new Date(e,2,1);return j(e)&&b>=f&&a<f},n=365;if(g===l||g+1===l&&(f>i||f===i&&d>=h))return(g===l&&j(g)||m(a,b)||1===i&&29===h)&&(n=366),k(a,b)/n;var o=l-g+1,p=(new Date(l+1,0,1)-new Date(g,0,1))/1e3/60/60/24,q=p/o;return k(a,b)/q;case 2:return k(a,b)/360;case 3:return k(a,b)/365;case 4:return(h+30*i+360*l-(d+30*f+360*g))/360}}},function(a,b,c){var d=c(0);b.CELL=function(){throw new Error("CELL is not implemented")},b.ERROR={},b.ERROR.TYPE=function(a){switch(a){case d.nil:return 1;case d.div0:return 2;case d.value:return 3;case d.ref:return 4;case d.name:return 5;case d.num:return 6;case d.na:return 7;case d.data:return 8}return d.na},b.INFO=function(){throw new Error("INFO is not implemented")},b.ISBLANK=function(a){return null===a},b.ISBINARY=function(a){return/^[01]{1,10}$/.test(a)},b.ISERR=function(a){return[d.value,d.ref,d.div0,d.num,d.name,d.nil].indexOf(a)>=0||"number"==typeof a&&(isNaN(a)||!isFinite(a))},b.ISERROR=function(a){return b.ISERR(a)||a===d.na},b.ISEVEN=function(a){return!(1&Math.floor(Math.abs(a)))},b.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},b.ISLOGICAL=function(a){return!0===a||!1===a},b.ISNA=function(a){return a===d.na},b.ISNONTEXT=function(a){return"string"!=typeof a},b.ISNUMBER=function(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)},b.ISODD=function(a){return!!(1&Math.floor(Math.abs(a)))},b.ISREF=function(){throw new Error("ISREF is not implemented")},b.ISTEXT=function(a){return"string"==typeof a},b.N=function(a){return this.ISNUMBER(a)?a:a instanceof Date?a.getTime():!0===a?1:!1===a?0:this.ISERROR(a)?a:0},b.NA=function(){return d.na},b.SHEET=function(){throw new Error("SHEET is not implemented")},b.SHEETS=function(){throw new Error("SHEETS is not implemented")},b.TYPE=function(a){return this.ISNUMBER(a)?1:this.ISTEXT(a)?2:this.ISLOGICAL(a)?4:this.ISERROR(a)?16:Array.isArray(a)?64:void 0}},function(a,b,c){var d=c(2),e=c(0),f=c(14);b.ASC=function(){throw new Error("ASC is not implemented")},b.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},b.CHAR=function(a){return a=d.parseNumber(a),a instanceof Error?a:String.fromCharCode(a)},b.CLEAN=function(a){a=a||"";var b=/[\0-\x1F]/g;return a.replace(b,"")},b.CODE=function(a){a=a||"";var b=a.charCodeAt(0);return isNaN(b)&&(b=e.na),b},b.CONCATENATE=function(){for(var a=d.flatten(arguments),b=0;(b=a.indexOf(!0))>-1;)a[b]="TRUE";for(var c=0;(c=a.indexOf(!1))>-1;)a[c]="FALSE";return a.join("")},b.DBCS=function(){throw new Error("DBCS is not implemented")},b.DOLLAR=function(a,b){if(b=void 0===b?2:b,a=d.parseNumber(a),b=d.parseNumber(b),d.anyIsError(a,b))return e.value;var c="";return b<=0?(a=Math.round(a*Math.pow(10,b))/Math.pow(10,b),c="($0,0)"):b>0&&(c="($0,0."+new Array(b+1).join("0")+")"),f(a).format(c)},b.EXACT=function(a,b){return 2!==arguments.length?e.na:a===b},b.FIND=function(a,b,c){return arguments.length<2?e.na:(c=void 0===c?0:c,b?b.indexOf(a,c-1)+1:null)},b.FIXED=function(a,b,c){if(b=void 0===b?2:b,c=void 0!==c&&c,a=d.parseNumber(a),b=d.parseNumber(b),d.anyIsError(a,b))return e.value;var g=c?"0":"0,0";return b<=0?a=Math.round(a*Math.pow(10,b))/Math.pow(10,b):b>0&&(g+="."+new Array(b+1).join("0")),f(a).format(g)},b.HTML2TEXT=function(a){var b="";return a&&(a instanceof Array?a.forEach(function(a){""!==b&&(b+="\n"),b+=a.replace(/<(?:.|\n)*?>/gm,"")}):b=a.replace(/<(?:.|\n)*?>/gm,"")),b},b.LEFT=function(a,b){return b=void 0===b?1:b,b=d.parseNumber(b),b instanceof Error||"string"!=typeof a?e.value:a?a.substring(0,b):null},b.LEN=function(a){return 0===arguments.length?e.error:"string"==typeof a?a?a.length:0:a.length?a.length:e.value},b.LOWER=function(a){return"string"!=typeof a?e.value:a?a.toLowerCase():a},b.MID=function(a,b,c){if(b=d.parseNumber(b),c=d.parseNumber(c),d.anyIsError(b,c)||"string"!=typeof a)return c;var e=b-1,f=e+c;return a.substring(e,f)},b.NUMBERVALUE=function(a,b,c){return b=void 0===b?".":b,c=void 0===c?",":c,Number(a.replace(b,".").replace(c,""))},b.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},b.PROPER=function(a){return void 0===a||0===a.length?e.value:(!0===a&&(a="TRUE"),!1===a&&(a="FALSE"),isNaN(a)&&"number"==typeof a?e.value:("number"==typeof a&&(a=""+a),a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})))},b.REGEXEXTRACT=function(a,b){if(arguments.length<2)return e.na;var c=a.match(new RegExp(b));return c?c[c.length>1?c.length-1:0]:null},b.REGEXMATCH=function(a,b,c){if(arguments.length<2)return e.na;var d=a.match(new RegExp(b));return c?d:!!d},b.REGEXREPLACE=function(a,b,c){return arguments.length<3?e.na:a.replace(new RegExp(b),c)},b.REPLACE=function(a,b,c,f){return b=d.parseNumber(b),c=d.parseNumber(c),d.anyIsError(b,c)||"string"!=typeof a||"string"!=typeof f?e.value:a.substr(0,b-1)+f+a.substr(b-1+c)},b.REPT=function(a,b){return b=d.parseNumber(b),b instanceof Error?b:new Array(b+1).join(a)},b.RIGHT=function(a,b){return b=void 0===b?1:b,b=d.parseNumber(b),b instanceof Error?b:a?a.substring(a.length-b):e.na},b.SEARCH=function(a,b,c){var d;return"string"!=typeof a||"string"!=typeof b?e.value:(c=void 0===c?0:c,d=b.toLowerCase().indexOf(a.toLowerCase(),c-1)+1,0===d?e.value:d)},b.SPLIT=function(a,b){return a.split(b)},b.SUBSTITUTE=function(a,b,c,d){if(arguments.length<2)return e.na;if(!(a&&b&&c))return a;if(void 0===d)return a.replace(new RegExp(b,"g"),c);for(var f=0,g=0;a.indexOf(b,f)>0;)if(f=a.indexOf(b,f+1),++g===d)return a.substring(0,f)+c+a.substring(f+b.length)},b.T=function(a){return"string"==typeof a?a:""},b.TEXT=function(a,b){return a=d.parseNumber(a),d.anyIsError(a)?e.na:f(a).format(b)},b.TRIM=function(a){return"string"!=typeof a?e.value:a.replace(/ +/g," ").trim()},b.UNICHAR=b.CHAR,b.UNICODE=b.CODE,b.UPPER=function(a){return"string"!=typeof a?e.value:a.toUpperCase()},b.VALUE=function(a){if("string"!=typeof a)return e.value;var b=f().unformat(a);return void 0===b?0:b}},function(a,b,c){"use strict";function d(a){var b=parseInt(a,10);return b=isNaN(b)?-1:Math.max(b-1,-1)}function e(a){var b="";return a>=0&&(b=""+(a+1)),b}function h(a){var b=0;if("string"==typeof a){a=a.toUpperCase();for(var c=0,d=a.length-1;c<a.length;c+=1,d-=1)b+=Math.pow(g,d)*(f.indexOf(a[c])+1)}return--b}function i(a){for(var b="";a>=0;)b=String.fromCharCode(a%g+97)+b,a=Math.floor(a/g)-1;return b.toUpperCase()}function k(a){if("string"!=typeof a||!j.test(a))return[];var b=a.toUpperCase().match(j),c=b[1],e=b[2],f=b[3],g=b[4];return[{index:d(g),label:g,isAbsolute:"$"===f},{index:h(e),label:e,isAbsolute:"$"===c}]}function l(a,b){var c=(a.isAbsolute?"$":"")+e(a.index);return(b.isAbsolute?"$":"")+i(b.index)+c}b.__esModule=!0,b.rowLabelToIndex=d,b.rowIndexToLabel=e,b.columnLabelToIndex=h,b.columnIndexToLabel=i,b.extractLabel=k,b.toLabel=l;var f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",g=f.length,j=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(a,b,c){"use strict";b.__esModule=!0;var d=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"];b.default=d},function(a,b,c){function i(a){return/^[01]{1,10}$/.test(a)}var d=c(0),e=c(13).jStat,f=c(8),g=c(2),h=c(32);b.BESSELI=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:h.besseli(a,b)},b.BESSELJ=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:h.besselj(a,b)},b.BESSELK=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:h.besselk(a,b)},b.BESSELY=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:h.bessely(a,b)},b.BIN2DEC=function(a){if(!i(a))return d.num;var b=parseInt(a,2),c=a.toString();return 10===c.length&&"1"===c.substring(0,1)?parseInt(c.substring(1),2)-512:b},b.BIN2HEX=function(a,b){if(!i(a))return d.num;var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);var e=parseInt(a,2).toString(16);return void 0===b?e:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=e.length?f.REPT("0",b-e.length)+e:d.num)},b.BIN2OCT=function(a,b){if(!i(a))return d.num;var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(1073741312+parseInt(c.substring(1),2)).toString(8);var e=parseInt(a,2).toString(8);return void 0===b?e:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=e.length?f.REPT("0",b-e.length)+e:d.num)},b.BITAND=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a<0||b<0?d.num:Math.floor(a)!==a||Math.floor(b)!==b?d.num:a>0xffffffffffff||b>0xffffffffffff?d.num:a&b},b.BITLSHIFT=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a<0?d.num:Math.floor(a)!==a?d.num:a>0xffffffffffff?d.num:Math.abs(b)>53?d.num:b>=0?a<<b:a>>-b},b.BITOR=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a<0||b<0?d.num:Math.floor(a)!==a||Math.floor(b)!==b?d.num:a>0xffffffffffff||b>0xffffffffffff?d.num:a|b},b.BITRSHIFT=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a<0?d.num:Math.floor(a)!==a?d.num:a>0xffffffffffff?d.num:Math.abs(b)>53?d.num:b>=0?a>>b:a<<-b},b.BITXOR=function(a,b){return a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a<0||b<0?d.num:Math.floor(a)!==a||Math.floor(b)!==b?d.num:a>0xffffffffffff||b>0xffffffffffff?d.num:a^b},b.COMPLEX=function(a,b,c){if(a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b))return a;if("i"!==(c=void 0===c?"i":c)&&"j"!==c)return d.value;if(0===a&&0===b)return 0;if(0===a)return 1===b?c:b.toString()+c;if(0===b)return a.toString();var e=b>0?"+":"";return a.toString()+e+(1===b?c:b.toString()+c)},b.CONVERT=function(a,b,c){if((a=g.parseNumber(a))instanceof Error)return a;for(var o,e=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},h={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},i=null,j=null,k=b,l=c,m=1,n=1,p=0;p<e.length;p++)o=null===e[p][2]?[]:e[p][2],(e[p][1]===k||o.indexOf(k)>=0)&&(i=e[p]),(e[p][1]===l||o.indexOf(l)>=0)&&(j=e[p]);if(null===i){var q=f[b.substring(0,2)],r=h[b.substring(0,1)];"da"===b.substring(0,2)&&(r=["dekao",10,"da"]),q?(m=q[2],k=b.substring(2)):r&&(m=r[1],k=b.substring(r[2].length));for(var s=0;s<e.length;s++)o=null===e[s][2]?[]:e[s][2],(e[s][1]===k||o.indexOf(k)>=0)&&(i=e[s])}if(null===j){var t=f[c.substring(0,2)],u=h[c.substring(0,1)];"da"===c.substring(0,2)&&(u=["dekao",10,"da"]),t?(n=t[2],l=c.substring(2)):u&&(n=u[1],l=c.substring(u[2].length));for(var v=0;v<e.length;v++)o=null===e[v][2]?[]:e[v][2],(e[v][1]===l||o.indexOf(l)>=0)&&(j=e[v])}return null===i||null===j?d.na:i[3]!==j[3]?d.na:a*i[6]*m/(j[6]*n)},b.DEC2BIN=function(a,b){if((a=g.parseNumber(a))instanceof Error)return a;if(!/^-?[0-9]{1,3}$/.test(a)||a<-512||a>511)return d.num;if(a<0)return"1"+f.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var c=parseInt(a,10).toString(2);return void 0===b?c:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=c.length?f.REPT("0",b-c.length)+c:d.num)},b.DEC2HEX=function(a,b){if((a=g.parseNumber(a))instanceof Error)return a;if(!/^-?[0-9]{1,12}$/.test(a)||a<-549755813888||a>549755813887)return d.num;if(a<0)return(1099511627776+a).toString(16);var c=parseInt(a,10).toString(16);return void 0===b?c:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=c.length?f.REPT("0",b-c.length)+c:d.num)},b.DEC2OCT=function(a,b){if((a=g.parseNumber(a))instanceof Error)return a;if(!/^-?[0-9]{1,9}$/.test(a)||a<-536870912||a>536870911)return d.num;if(a<0)return(1073741824+a).toString(8);var c=parseInt(a,10).toString(8);return void 0===b?c:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=c.length?f.REPT("0",b-c.length)+c:d.num)},b.DELTA=function(a,b){return b=void 0===b?0:b,a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:a===b?1:0},b.ERF=function(a,b){return b=void 0===b?0:b,a=g.parseNumber(a),b=g.parseNumber(b),g.anyIsError(a,b)?d.value:e.erf(a)},b.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},b.ERFC=function(a){return isNaN(a)?d.value:e.erfc(a)},b.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},b.GESTEP=function(a,b){return b=b||0,a=g.parseNumber(a),g.anyIsError(b,a)?a:a>=b?1:0},b.HEX2BIN=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return d.num;var c=10===a.length&&"f"===a.substring(0,1).toLowerCase(),e=c?parseInt(a,16)-1099511627776:parseInt(a,16);if(e<-512||e>511)return d.num;if(c)return"1"+f.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var g=e.toString(2);return void 0===b?g:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=g.length?f.REPT("0",b-g.length)+g:d.num)},b.HEX2DEC=function(a){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return d.num;var b=parseInt(a,16);return b>=549755813888?b-1099511627776:b},b.HEX2OCT=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return d.num;var c=parseInt(a,16);if(c>536870911&&c<0xffe0000000)return d.num;if(c>=0xffe0000000)return(c-0xffc0000000).toString(8);var e=c.toString(8);return void 0===b?e:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=e.length?f.REPT("0",b-e.length)+e:d.num)},b.IMABS=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:Math.sqrt(Math.pow(c,2)+Math.pow(e,2))},b.IMAGINARY=function(a){if(void 0===a||!0===a||!1===a)return d.value;if(0===a||"0"===a)return 0;if(["i","j"].indexOf(a)>=0)return 1;a=a.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var b=a.indexOf("+"),c=a.indexOf("-");0===b&&(b=a.indexOf("+",1)),0===c&&(c=a.indexOf("-",1));var e=a.substring(a.length-1,a.length),f="i"===e||"j"===e;return b>=0||c>=0?f?b>=0?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?d.num:Number(a.substring(b+1,a.length-1)):isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?d.num:-Number(a.substring(c+1,a.length-1)):d.num:f?isNaN(a.substring(0,a.length-1))?d.num:a.substring(0,a.length-1):isNaN(a)?d.num:0},b.IMARGUMENT=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:0===c&&0===e?d.div0:0===c&&e>0?Math.PI/2:0===c&&e<0?-Math.PI/2:0===e&&c>0?0:0===e&&c<0?-Math.PI:c>0?Math.atan(e/c):c<0&&e>=0?Math.atan(e/c)+Math.PI:Math.atan(e/c)-Math.PI},b.IMCONJUGATE=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",0!==e?b.COMPLEX(c,-e,f):a},b.IMCOS=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(c)*(Math.exp(e)+Math.exp(-e))/2,-Math.sin(c)*(Math.exp(e)-Math.exp(-e))/2,f)},b.IMCOSH=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(e)*(Math.exp(c)+Math.exp(-c))/2,Math.sin(e)*(Math.exp(c)-Math.exp(-c))/2,f)},b.IMCOT=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:b.IMDIV(b.IMCOS(a),b.IMSIN(a))},b.IMDIV=function(a,c){var e=b.IMREAL(a),f=b.IMAGINARY(a),h=b.IMREAL(c),i=b.IMAGINARY(c);if(g.anyIsError(e,f,h,i))return d.value;var j=a.substring(a.length-1),k=c.substring(c.length-1),l="i";if("j"===j?l="j":"j"===k&&(l="j"),0===h&&0===i)return d.num;var m=h*h+i*i;return b.COMPLEX((e*h+f*i)/m,(f*h-e*i)/m,l)},b.IMEXP=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);f="i"===f||"j"===f?f:"i";var h=Math.exp(c);return b.COMPLEX(h*Math.cos(e),h*Math.sin(e),f)},b.IMLN=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+e*e)),Math.atan(e/c),f)},b.IMLOG10=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+e*e))/Math.log(10),Math.atan(e/c)/Math.log(10),f)},b.IMLOG2=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+e*e))/Math.log(2),Math.atan(e/c)/Math.log(2),f)},b.IMPOWER=function(a,c){c=g.parseNumber(c);var e=b.IMREAL(a),f=b.IMAGINARY(a);if(g.anyIsError(c,e,f))return d.value;var h=a.substring(a.length-1);h="i"===h||"j"===h?h:"i";var i=Math.pow(b.IMABS(a),c),j=b.IMARGUMENT(a);return b.COMPLEX(i*Math.cos(c*j),i*Math.sin(c*j),h)},b.IMPRODUCT=function(){var a=arguments[0];if(!arguments.length)return d.value;for(var c=1;c<arguments.length;c++){var e=b.IMREAL(a),f=b.IMAGINARY(a),h=b.IMREAL(arguments[c]),i=b.IMAGINARY(arguments[c]);if(g.anyIsError(e,f,h,i))return d.value;a=b.COMPLEX(e*h-f*i,e*i+f*h)}return a},b.IMREAL=function(a){if(void 0===a||!0===a||!1===a)return d.value;if(0===a||"0"===a)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(a)>=0)return 0;var b=a.indexOf("+"),c=a.indexOf("-");0===b&&(b=a.indexOf("+",1)),0===c&&(c=a.indexOf("-",1));var e=a.substring(a.length-1,a.length),f="i"===e||"j"===e;return b>=0||c>=0?f?b>=0?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?d.num:Number(a.substring(0,b)):isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?d.num:Number(a.substring(0,c)):d.num:f?isNaN(a.substring(0,a.length-1))?d.num:0:isNaN(a)?d.num:a},b.IMSEC=function(a){if(!0===a||!1===a)return d.value;var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:b.IMDIV("1",b.IMCOS(a))},b.IMSECH=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:b.IMDIV("1",b.IMCOSH(a))},b.IMSIN=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.sin(c)*(Math.exp(e)+Math.exp(-e))/2,Math.cos(c)*(Math.exp(e)-Math.exp(-e))/2,f)},b.IMSINH=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(e)*(Math.exp(c)-Math.exp(-c))/2,Math.sin(e)*(Math.exp(c)+Math.exp(-c))/2,f)},b.IMSQRT=function(a){var c=b.IMREAL(a),e=b.IMAGINARY(a);if(g.anyIsError(c,e))return d.value;var f=a.substring(a.length-1);f="i"===f||"j"===f?f:"i";var h=Math.sqrt(b.IMABS(a)),i=b.IMARGUMENT(a);return b.COMPLEX(h*Math.cos(i/2),h*Math.sin(i/2),f)},b.IMCSC=function(a){if(!0===a||!1===a)return d.value;var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.num:b.IMDIV("1",b.IMSIN(a))},b.IMCSCH=function(a){if(!0===a||!1===a)return d.value;var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.num:b.IMDIV("1",b.IMSINH(a))},b.IMSUB=function(a,b){var c=this.IMREAL(a),e=this.IMAGINARY(a),f=this.IMREAL(b),h=this.IMAGINARY(b);if(g.anyIsError(c,e,f,h))return d.value;var i=a.substring(a.length-1),j=b.substring(b.length-1),k="i";return"j"===i?k="j":"j"===j&&(k="j"),this.COMPLEX(c-f,e-h,k)},b.IMSUM=function(){if(!arguments.length)return d.value;for(var a=g.flatten(arguments),b=a[0],c=1;c<a.length;c++){var e=this.IMREAL(b),f=this.IMAGINARY(b),h=this.IMREAL(a[c]),i=this.IMAGINARY(a[c]);if(g.anyIsError(e,f,h,i))return d.value;b=this.COMPLEX(e+h,f+i)}return b},b.IMTAN=function(a){if(!0===a||!1===a)return d.value;var c=b.IMREAL(a),e=b.IMAGINARY(a);return g.anyIsError(c,e)?d.value:this.IMDIV(this.IMSIN(a),this.IMCOS(a))},b.OCT2BIN=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return d.num;var c=10===a.length&&"7"===a.substring(0,1),e=c?parseInt(a,8)-1073741824:parseInt(a,8);if(e<-512||e>511)return d.num;if(c)return"1"+f.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var g=e.toString(2);return void 0===b?g:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=g.length?f.REPT("0",b-g.length)+g:d.num)},b.OCT2DEC=function(a){if(!/^[0-7]{1,10}$/.test(a))return d.num;var b=parseInt(a,8);return b>=536870912?b-1073741824:b},b.OCT2HEX=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return d.num;var c=parseInt(a,8);if(c>=536870912)return"ff"+(c+3221225472).toString(16);var e=c.toString(16);return void 0===b?e:isNaN(b)?d.value:b<0?d.num:(b=Math.floor(b),b>=e.length?f.REPT("0",b-e.length)+e:d.num)}},function(a,b,c){var d=c(2),e=c(14),f=c(0);b.UNIQUE=function(){for(var a=[],b=0;b<arguments.length;++b){for(var c=!1,d=arguments[b],e=0;e<a.length&&!(c=a[e]===d);++e);c||a.push(d)}return a},b.FLATTEN=d.flatten,b.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},b.REFERENCE=function(a,b){if(!arguments.length)return f.error;try{for(var c=b.split("."),d=a,e=0;e<c.length;++e){var g=c[e];if("]"===g[g.length-1]){var h=g.indexOf("["),i=g.substring(h+1,g.length-1);d=d[g.substring(0,h)][i]}else d=d[g]}return d}catch(a){}},b.JOIN=function(a,b){return a.join(b)},b.NUMBERS=function(){return d.flatten(arguments).filter(function(a){return"number"==typeof a})},b.NUMERAL=function(a,b){return e(a).format(b)}},function(a,b){this.j$=this.jStat=function(a,b){function f(b,c){var d=b>c?b:c;return a.pow(10,17-~~(a.log(d>0?d:-d)*a.LOG10E))}function h(a){return"[object Function]"===e.call(a)}function j(a){return"number"==typeof a&&a===a}function k(a){return c.apply([],a)}function l(){return new l._init(arguments)}function m(){return 0}function n(){return 1}function o(a,b){return a===b?1:0}var c=Array.prototype.concat,d=Array.prototype.slice,e=Object.prototype.toString,g=Array.isArray||function(b){return"[object Array]"===e.call(b)};l.fn=l.prototype,l._init=function(b){var c;if(g(b[0]))if(g(b[0][0])){h(b[1])&&(b[0]=l.map(b[0],b[1]));for(var c=0;c<b[0].length;c++)this[c]=b[0][c];this.length=b[0].length}else this[0]=h(b[1])?l.map(b[0],b[1]):b[0],this.length=1;else if(j(b[0]))this[0]=l.seq.apply(null,b),this.length=1;else{if(b[0]instanceof l)return l(b[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:f,isArray:g,isFunction:h,isNumber:j,toVector:k},l.extend=function(b){var c,d;if(1===arguments.length){for(d in b)l[d]=b[d];return this}for(var c=1;c<arguments.length;c++)for(d in arguments[c])b[d]=arguments[c][d];return b},l.rows=function(b){return b.length||1},l.cols=function(b){return b[0].length||1},l.dimensions=function(b){return{rows:l.rows(b),cols:l.cols(b)}},l.row=function(b,c){return g(c)?c.map(function(a){return l.row(b,a)}):b[c]},l.rowa=function(b,c){return l.row(b,c)},l.col=function(b,c){if(g(c)){var d=l.arange(b.length).map(function(a){return new Array(c.length)});return c.forEach(function(a,c){l.arange(b.length).forEach(function(e){d[e][c]=b[e][a]})}),d}for(var e=new Array(b.length),f=0;f<b.length;f++)e[f]=[b[f][c]];return e},l.cola=function(b,c){return l.col(b,c).map(function(a){return a[0]})},l.diag=function(b){for(var c=l.rows(b),d=new Array(c),e=0;e<c;e++)d[e]=[b[e][e]];return d},l.antidiag=function(b){for(var c=l.rows(b)-1,d=new Array(c),e=0;c>=0;c--,e++)d[e]=[b[e][c]];return d},l.transpose=function(b){var d,e,f,h,i,c=[];g(b[0])||(b=[b]),e=b.length,f=b[0].length;for(var i=0;i<f;i++){for(d=new Array(e),h=0;h<e;h++)d[h]=b[h][i];c.push(d)}return 1===c.length?c[0]:c},l.map=function(b,c,d){var e,f,h,i,j;for(g(b[0])||(b=[b]),f=b.length,h=b[0].length,i=d?b:new Array(f),e=0;e<f;e++)for(i[e]||(i[e]=new Array(h)),j=0;j<h;j++)i[e][j]=c(b[e][j],e,j);return 1===i.length?i[0]:i},l.cumreduce=function(b,c,d){var e,f,h,i,j;for(g(b[0])||(b=[b]),f=b.length,h=b[0].length,i=d?b:new Array(f),e=0;e<f;e++)for(i[e]||(i[e]=new Array(h)),h>0&&(i[e][0]=b[e][0]),j=1;j<h;j++)i[e][j]=c(i[e][j-1],b[e][j]);return 1===i.length?i[0]:i},l.alter=function(b,c){return l.map(b,c,!0)},l.create=function(b,c,d){var f,g,e=new Array(b);h(c)&&(d=c,c=b);for(var f=0;f<b;f++)for(e[f]=new Array(c),g=0;g<c;g++)e[f][g]=d(f,g);return e},l.zeros=function(b,c){return j(c)||(c=b),l.create(b,c,m)},l.ones=function(b,c){return j(c)||(c=b),l.create(b,c,n)},l.rand=function(c,d){return j(d)||(d=c),l.create(c,d,a.random)},l.identity=function(b,c){return j(c)||(c=b),l.create(b,c,o)},l.symmetric=function(b){var e,f,d=b.length;if(b.length!==b[0].length)return!1;for(e=0;e<d;e++)for(f=0;f<d;f++)if(b[f][e]!==b[e][f])return!1;return!0},l.clear=function(b){return l.alter(b,m)},l.seq=function(b,c,d,e){h(e)||(e=!1);var l,g=[],i=f(b,c),j=(c*i-b*i)/((d-1)*i),k=b;for(l=0;k<=c;l++,k=(b*i+j*i*l)/i)g.push(e?e(k,l):k);return g},l.arange=function(c,d,e){var f=[];if(e=e||1,d===b&&(d=c,c=0),c===d||0===e)return[];if(c<d&&e<0)return[];if(c>d&&e>0)return[];if(e>0)for(i=c;i<d;i+=e)f.push(i);else for(i=c;i>d;i+=e)f.push(i);return f},l.slice=function(){function a(a,c,d,e){var f,g=[],h=a.length;if(c===b&&d===b&&e===b)return l.copy(a);if(c=c||0,d=d||a.length,c=c>=0?c:h+c,d=d>=0?d:h+d,e=e||1,c===d||0===e)return[];if(c<d&&e<0)return[];if(c>d&&e>0)return[];if(e>0)for(f=c;f<d;f+=e)g.push(a[f]);else for(f=c;f>d;f+=e)g.push(a[f]);return g}function c(b,c){if(c=c||{},j(c.row)){if(j(c.col))return b[c.row][c.col];var d=l.rowa(b,c.row),e=c.col||{};return a(d,e.start,e.end,e.step)}if(j(c.col)){var f=l.cola(b,c.col),g=c.row||{};return a(f,g.start,g.end,g.step)}var g=c.row||{},e=c.col||{};return a(b,g.start,g.end,g.step).map(function(b){return a(b,e.start,e.end,e.step)})}return c}(),l.sliceAssign=function(d,e,f){if(j(e.row)){if(j(e.col))return d[e.row][e.col]=f;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||d[0].length,e.col.step=e.col.step||1;var g=l.arange(e.col.start,a.min(d.length,e.col.end),e.col.step),h=e.row;return g.forEach(function(a,b){d[h][a]=f[b]}),d}if(j(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||d.length,e.row.step=e.row.step||1;var i=l.arange(e.row.start,a.min(d[0].length,e.row.end),e.row.step),k=e.col;return i.forEach(function(a,b){d[a][k]=f[b]}),d}f[0].length===b&&(f=[f]),e.row.start=e.row.start||0,e.row.end=e.row.end||d.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||d[0].length,e.col.step=e.col.step||1;var i=l.arange(e.row.start,a.min(d.length,e.row.end),e.row.step),g=l.arange(e.col.start,a.min(d[0].length,e.col.end),e.col.step);return i.forEach(function(a,b){g.forEach(function(c,e){d[a][c]=f[b][e]})}),d},l.diagonal=function(b){var c=l.zeros(b.length,b.length);return b.forEach(function(a,b){c[b][b]=a}),c},l.copy=function(b){return b.map(function(a){return j(a)?a:a.map(function(a){return a})})};var p=l.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?d.call(this):d.call(this)[0]},p.map=function(b,c){return l(l.map(this,b,c))},p.cumreduce=function(b,c){return l(l.cumreduce(this,b,c))},p.alter=function(b){return l.alter(this,b),this},function(a){for(var b=0;b<a.length;b++)!function(a){p[a]=function(b){var d,c=this;return b?(setTimeout(function(){b.call(c,p[a].call(c))}),this):(d=l[a](this),g(d)?l(d):d)}}(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(a){for(var b=0;b<a.length;b++)!function(a){p[a]=function(b,c){var d=this;return c?(setTimeout(function(){c.call(d,p[a].call(d,b))}),this):l(l[a](this,b))}}(a[b])}("row col".split(" ")),function(a){for(var b=0;b<a.length;b++)!function(a){p[a]=new Function("return jStat(jStat."+a+".apply(null, arguments));")}(a[b])}("create zeros ones rand identity".split(" ")),l}(Math),function(a,b){function d(a,b){return a-b}function e(a,c,d){return b.max(c,b.min(a,d))}var c=a.utils.isFunction;a.sum=function(b){for(var a=0,c=b.length;--c>=0;)a+=b[c];return a},a.sumsqrd=function(b){for(var c=0,d=b.length;--d>=0;)c+=b[d]*b[d];return c},a.sumsqerr=function(c){for(var g,d=a.mean(c),e=0,f=c.length;--f>=0;)g=c[f]-d,e+=g*g;return e},a.sumrow=function(b){for(var c=0,d=b.length;--d>=0;)c+=b[d];return c},a.product=function(b){for(var c=1,d=b.length;--d>=0;)c*=b[d];return c},a.min=function(b){for(var c=b[0],d=0;++d<b.length;)b[d]<c&&(c=b[d]);return c},a.max=function(b){for(var c=b[0],d=0;++d<b.length;)b[d]>c&&(c=b[d]);return c},a.unique=function(b){for(var c={},d=[],e=0;e<b.length;e++)c[b[e]]||(c[b[e]]=!0,d.push(b[e]));return d},a.mean=function(c){return a.sum(c)/c.length},a.meansqerr=function(c){return a.sumsqerr(c)/c.length},a.geomean=function(d){return b.pow(a.product(d),1/d.length)},a.median=function(b){var c=b.length,e=b.slice().sort(d);return 1&c?e[c/2|0]:(e[c/2-1]+e[c/2])/2},a.cumsum=function(c){return a.cumreduce(c,function(a,b){return a+b})},a.cumprod=function(c){return a.cumreduce(c,function(a,b){return a*b})},a.diff=function(b){for(var e,c=[],d=b.length,e=1;e<d;e++)c.push(b[e]-b[e-1]);return c},a.rank=function(a){for(var b=a.length,c=a.slice().sort(d),e=new Array(b),f=0;f<b;f++){var g=c.indexOf(a[f]),h=c.lastIndexOf(a[f]);if(g===h)var i=g;else var i=(g+h)/2;e[f]=i+1}return e},a.mode=function(b){for(var j,c=b.length,e=b.slice().sort(d),f=1,g=0,h=0,i=[],j=0;j<c;j++)e[j]===e[j+1]?f++:(f>g?(i=[e[j]],g=f,h=0):f===g&&(i.push(e[j]),h++),f=1);return 0===h?i[0]:i},a.range=function(c){return a.max(c)-a.min(c)},a.variance=function(c,d){return a.sumsqerr(c)/(c.length-(d?1:0))},a.deviation=function(b){for(var c=a.mean(b),d=b.length,e=new Array(d),f=0;f<d;f++)e[f]=b[f]-c;return e},a.stdev=function(d,e){return b.sqrt(a.variance(d,e))},a.meandev=function(d){for(var g,e=0,f=a.mean(d),g=d.length-1;g>=0;g--)e+=b.abs(d[g]-f);return e/d.length},a.meddev=function(d){for(var g,e=0,f=a.median(d),g=d.length-1;g>=0;g--)e+=b.abs(d[g]-f);return e/d.length},a.coeffvar=function(c){return a.stdev(c)/a.mean(c)},a.quartiles=function(c){var e=c.length,f=c.slice().sort(d);return[f[b.round(e/4)-1],f[b.round(e/2)-1],f[b.round(3*e/4)-1]]},a.quantiles=function(c,f,g,h){var l,m,n,o,p,q,i=c.slice().sort(d),j=[f.length],k=c.length;void 0===g&&(g=3/8),void 0===h&&(h=3/8);for(var l=0;l<f.length;l++)m=f[l],n=g+m*(1-g-h),o=k*m+n,p=b.floor(e(o,1,k-1)),q=e(o-p,0,1),j[l]=(1-q)*i[p-1]+q*i[p];return j},a.percentile=function(b,c){var e=b.slice().sort(d),f=c*(e.length-1),g=parseInt(f),h=f-g;return g+1<e.length?e[g]*(1-h)+e[g+1]*h:e[g]},a.percentileOfScore=function(b,c,d){var h,i,e=0,f=b.length,g=!1;"strict"===d&&(g=!0);for(var i=0;i<f;i++)h=b[i],(g&&h<c||!g&&h<=c)&&e++;return e/f},a.histogram=function(d,e){for(var j,f=a.min(d),g=e||4,h=(a.max(d)-f)/g,i=d.length,e=[],j=0;j<g;j++)e[j]=0;for(var j=0;j<i;j++)e[b.min(b.floor((d[j]-f)/h),g-1)]+=1;return e},a.covariance=function(c,d){for(var i,e=a.mean(c),f=a.mean(d),g=c.length,h=new Array(g),i=0;i<g;i++)h[i]=(c[i]-e)*(d[i]-f);return a.sum(h)/(g-1)},a.corrcoeff=function(c,d){return a.covariance(c,d)/a.stdev(c,1)/a.stdev(d,1)},a.spearmancoeff=function(c,d){c=a.rank(c),d=a.rank(d);var e=a.deviation(c),f=a.deviation(d);return a.sum(e.map(function(a,b){return a*f[b]}))/b.sqrt(a.sum(e.map(function(a){return b.pow(a,2)}))*a.sum(f.map(function(a){return b.pow(a,2)})))},a.stanMoment=function(d,e){for(var f=a.mean(d),g=a.stdev(d),h=d.length,i=0,j=0;j<h;j++)i+=b.pow((d[j]-f)/g,e);return i/d.length},a.skewness=function(c){return a.stanMoment(c,3)},a.kurtosis=function(c){return a.stanMoment(c,4)-3};var f=a.prototype;!function(b){for(var d=0;d<b.length;d++)!function(b){f[b]=function(d,e){var g=[],h=0,i=this;if(c(d)&&(e=d,d=!1),e)return setTimeout(function(){e.call(i,f[b].call(i,d))}),this;if(this.length>1){for(i=!0===d?this:this.transpose();h<i.length;h++)g[h]=a[b](i[h]);return g}return a[b](this[0],d)}}(b[d])}("cumsum cumprod".split(" ")),function(b){for(var d=0;d<b.length;d++)!function(b){f[b]=function(d,e){var g=[],h=0,i=this;if(c(d)&&(e=d,d=!1),e)return setTimeout(function(){e.call(i,f[b].call(i,d))}),this;if(this.length>1){for("sumrow"!==b&&(i=!0===d?this:this.transpose());h<i.length;h++)g[h]=a[b](i[h]);return!0===d?a[b](a.utils.toVector(g)):g}return a[b](this[0],d)}}(b[d])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(b){for(var d=0;d<b.length;d++)!function(b){f[b]=function(){var d=[],e=0,g=this,h=Array.prototype.slice.call(arguments);if(c(h[h.length-1])){var i=h[h.length-1],j=h.slice(0,h.length-1);return setTimeout(function(){i.call(g,f[b].apply(g,j))}),this}var i=void 0,k=function(d){return a[b].apply(g,[d].concat(h))};if(this.length>1){for(g=g.transpose();e<g.length;e++)d[e]=k(g[e]);return d}return k(this[0])}}(b[d])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(a,b){a.gammaln=function(c){var g,h,i,d=0,e=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015;for(i=(h=g=c)+5.5,i-=(g+.5)*b.log(i);d<6;d++)f+=e[d]/++h;return b.log(2.5066282746310007*f/g)-i},a.gammafn=function(c){var k,l,m,n,d=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],e=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,g=0,h=0,i=0,j=c;if(j<=0){if(!(n=j%1+3.6e-16))return 1/0;f=(1&j?-1:1)*b.PI/b.sin(b.PI*n),j=1-j}m=j,l=j<1?j++:(j-=g=(0|j)-1)-1;for(var k=0;k<8;++k)i=(i+d[k])*l,h=h*l+e[k];if(n=i/h+1,m<j)n/=m;else if(m>j)for(var k=0;k<g;++k)n*=j,j++;return f&&(n=f/n),n},a.gammap=function(c,d){return a.lowRegGamma(c,d)*a.gammafn(c)},a.lowRegGamma=function(d,e){var p,f=a.gammaln(d),g=d,h=1/d,i=h,j=e+1-d,k=1/1e-30,l=1/j,m=l,n=1,o=-~(8.5*b.log(d>=1?d:1/d)+.4*d+17);if(e<0||d<=0)return NaN;if(e<d+1){for(;n<=o;n++)h+=i*=e/++g;return h*b.exp(-e+d*b.log(e)-f)}for(;n<=o;n++)p=-n*(n-d),j+=2,l=p*l+j,k=j+p/k,l=1/l,m*=l*k;return 1-m*b.exp(-e+d*b.log(e)-f)},a.factorialln=function(c){return c<0?NaN:a.gammaln(c+1)},a.factorial=function(c){return c<0?NaN:a.gammafn(c+1)},a.combination=function(d,e){return d>170||e>170?b.exp(a.combinationln(d,e)):a.factorial(d)/a.factorial(e)/a.factorial(d-e)},a.combinationln=function(c,d){return a.factorialln(c)-a.factorialln(d)-a.factorialln(c-d)},a.permutation=function(c,d){return a.factorial(c)/a.factorial(c-d)},a.betafn=function(d,e){if(!(d<=0||e<=0))return d+e>170?b.exp(a.betaln(d,e)):a.gammafn(d)*a.gammafn(e)/a.gammafn(d+e)},a.betaln=function(c,d){return a.gammaln(c)+a.gammaln(d)-a.gammaln(c+d)},a.betacf=function(c,d,e){var m,n,o,p,f=1e-30,g=1,h=d+e,i=d+1,j=d-1,k=1,l=1-h*c/i;for(b.abs(l)<f&&(l=f),l=1/l,p=l;g<=100&&(m=2*g,n=g*(e-g)*c/((j+m)*(d+m)),l=1+n*l,b.abs(l)<f&&(l=f),k=1+n/k,b.abs(k)<f&&(k=f),l=1/l,p*=l*k,n=-(d+g)*(h+g)*c/((d+m)*(i+m)),l=1+n*l,b.abs(l)<f&&(l=f),k=1+n/k,b.abs(k)<f&&(k=f),l=1/l,o=l*k,p*=o,!(b.abs(o-1)<3e-7));g++);return p},a.gammapinv=function(d,e){var j,k,l,m,n,o,p,f=0,g=e-1,h=1e-8,i=a.gammaln(e);if(d>=1)return b.max(100,e+100*b.sqrt(e));if(d<=0)return 0;for(e>1?(o=b.log(g),p=b.exp(g*(o-1)-i),n=d<.5?d:1-d,l=b.sqrt(-2*b.log(n)),j=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l,d<.5&&(j=-j),j=b.max(.001,e*b.pow(1-1/(9*e)-j/(3*b.sqrt(e)),3))):(l=1-e*(.253+.12*e),j=d<l?b.pow(d/l,1/e):1-b.log(1-(d-l)/(1-l)));f<12;f++){if(j<=0)return 0;if(k=a.lowRegGamma(e,j)-d,l=e>1?p*b.exp(-(j-g)+g*(b.log(j)-o)):b.exp(-j+g*b.log(j)-i),m=k/l,j-=l=m/(1-.5*b.min(1,m*((e-1)/j-1))),j<=0&&(j=.5*(j+l)),b.abs(l)<h*j)break}return j},a.erf=function(c){var i,j,k,l,d=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],e=d.length-1,f=!1,g=0,h=0;for(c<0&&(c=-c,f=!0),i=2/(2+c),j=4*i-2;e>0;e--)k=g,g=j*g-h+d[e],h=k;return l=i*b.exp(-c*c+.5*(d[0]+j*g)-h),f?l-1:1-l},a.erfc=function(c){return 1-a.erf(c)},a.erfcinv=function(d){var f,g,h,i,e=0;if(d>=2)return-100;if(d<=0)return 100;for(i=d<1?d:2-d,h=b.sqrt(-2*b.log(i/2)),f=-.70711*((2.30753+.27061*h)/(1+h*(.99229+.04481*h))-h);e<2;e++)g=a.erfc(f)-i,f+=g/(1.1283791670955126*b.exp(-f*f)-f*g);return d<1?f:-f},a.ibetainv=function(d,e,f){var k,l,m,n,o,p,q,r,s,t,u,g=1e-8,h=e-1,i=f-1,j=0;if(d<=0)return 0;if(d>=1)return 1;for(e>=1&&f>=1?(m=d<.5?d:1-d,n=b.sqrt(-2*b.log(m)),q=(2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n,d<.5&&(q=-q),r=(q*q-3)/6,s=2/(1/(2*e-1)+1/(2*f-1)),t=q*b.sqrt(r+s)/s-(1/(2*f-1)-1/(2*e-1))*(r+5/6-2/(3*s)),q=e/(e+f*b.exp(2*t))):(k=b.log(e/(e+f)),l=b.log(f/(e+f)),n=b.exp(e*k)/e,o=b.exp(f*l)/f,t=n+o,q=d<n/t?b.pow(e*t*d,1/e):1-b.pow(f*t*(1-d),1/f)),u=-a.gammaln(e)-a.gammaln(f)+a.gammaln(e+f);j<10;j++){if(0===q||1===q)return q;if(p=a.ibeta(q,e,f)-d,n=b.exp(h*b.log(q)+i*b.log(1-q)+u),o=p/n,q-=n=o/(1-.5*b.min(1,o*(h/q-i/(1-q)))),q<=0&&(q=.5*(q+n)),q>=1&&(q=.5*(q+n+1)),b.abs(n)<g*q&&j>0)break}return q},a.ibeta=function(d,e,f){var g=0===d||1===d?0:b.exp(a.gammaln(e+f)-a.gammaln(e)-a.gammaln(f)+e*b.log(d)+f*b.log(1-d));return!(d<0||d>1)&&(d<(e+1)/(e+f+2)?g*a.betacf(d,e,f)/e:1-g*a.betacf(1-d,f,e)/f)},a.randn=function(d,e){var f,g,h,i,j;if(e||(e=d),d)return a.create(d,e,function(){return a.randn()});do{f=b.random(),g=1.7156*(b.random()-.5),h=f-.449871,i=b.abs(g)+.386595,j=h*h+i*(.196*i-.25472*h)}while(j>.27597&&(j>.27846||g*g>-4*b.log(f)*f*f));return g/f},a.randg=function(d,e,f){var h,i,j,k,l,m,g=d;if(f||(f=e),d||(d=1),e)return m=a.zeros(e,f),m.alter(function(){return a.randg(d)}),m;d<1&&(d+=1),h=d-1/3,i=1/b.sqrt(9*h);do{do{l=a.randn(),k=1+i*l}while(k<=0);k*=k*k,j=b.random()}while(j>1-.331*b.pow(l,4)&&b.log(j)>.5*l*l+h*(1-k+b.log(k)));if(d==g)return h*k;do{j=b.random()}while(0===j);return b.pow(j,1/g)*h*k},function(b){for(var c=0;c<b.length;c++)!function(b){a.fn[b]=function(){return a(a.map(this,function(c){return a[b](c)}))}}(b[c])}("gammaln gammafn factorial factorialln".split(" ")),function(b){for(var c=0;c<b.length;c++)!function(b){a.fn[b]=function(){return a(a[b].apply(null,arguments))}}(b[c])}("randn".split(" "))}(this.jStat,Math),function(a,b){function c(a){return a/b.abs(a)}!function(b){for(var c=0;c<b.length;c++)!function(b){a[b]=function(a,b,c){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=c,this):new arguments.callee(a,b,c)},a.fn[b]=function(c,d,e){var f=a[b](c,d,e);return f.data=this,f},a[b].prototype.sample=function(c){var d=this._a,e=this._b,f=this._c;return c?a.alter(c,function(){return a[b].sample(d,e,f)}):a[b].sample(d,e,f)},function(c){for(var d=0;d<c.length;d++)!function(c){a[b].prototype[c]=function(d){var e=this._a,f=this._b,g=this._c;return d||0===d||(d=this.data),"number"!=typeof d?a.fn.map.call(d,function(d){return a[b][c](d,e,f,g)}):a[b][c](d,e,f,g)}}(c[d])}("pdf cdf inv".split(" ")),function(c){for(var d=0;d<c.length;d++)!function(c){a[b].prototype[c]=function(){return a[b][c](this._a,this._b,this._c)}}(c[d])}("mean median mode variance".split(" "))}(b[c])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular".split(" ")),a.extend(a.beta,{pdf:function(d,e,f){return d>1||d<0?0:1==e&&1==f?1:e<512&&f<512?b.pow(d,e-1)*b.pow(1-d,f-1)/a.betafn(e,f):b.exp((e-1)*b.log(d)+(f-1)*b.log(1-d)-a.betaln(e,f))},cdf:function(c,d,e){return c>1||c<0?1*(c>1):a.ibeta(c,d,e)},inv:function(c,d,e){return a.ibetainv(c,d,e)},mean:function(b,c){return b/(b+c)},median:function(c,d){return a.ibetainv(.5,c,d)},mode:function(b,c){return(b-1)/(b+c-2)},sample:function(c,d){var e=a.randg(c);return e/(e+a.randg(d))},variance:function(c,d){return c*d/(b.pow(c+d,2)*(c+d+1))}}),a.extend(a.centralF,{pdf:function(d,e,f){var g,h;return d<0?0:e<=2?0===d&&e<2?1/0:0===d&&2===e?1:b.sqrt(b.pow(e*d,e)*b.pow(f,f)/b.pow(e*d+f,e+f))/(d*a.betafn(e/2,f/2)):(g=e*d/(f+d*e),h=f/(f+d*e),e*h/2*a.binomial.pdf((e-2)/2,(e+f-2)/2,g))},cdf:function(c,d,e){return c<0?0:a.ibeta(d*c/(d*c+e),d/2,e/2)},inv:function(c,d,e){return e/(d*(1/a.ibetainv(c,d/2,e/2)-1))},mean:function(b,c){return c>2?c/(c-2):void 0},mode:function(b,c){return b>2?c*(b-2)/(b*(c+2)):void 0},sample:function(c,d){return 2*a.randg(c/2)/c/(2*a.randg(d/2)/d)},variance:function(b,c){if(!(c<=4))return 2*c*c*(b+c-2)/(b*(c-2)*(c-2)*(c-4))}}),a.extend(a.cauchy,{pdf:function(c,d,e){return e<0?0:e/(b.pow(c-d,2)+b.pow(e,2))/b.PI},cdf:function(c,d,e){return b.atan((c-d)/e)/b.PI+.5},inv:function(a,c,d){return c+d*b.tan(b.PI*(a-.5))},median:function(b,c){return b},mode:function(b,c){return b},sample:function(d,e){return a.randn()*b.sqrt(1/(2*a.randg(.5)))*e+d}}),a.extend(a.chisquare,{pdf:function(d,e){return d<0?0:0===d&&2===e?.5:b.exp((e/2-1)*b.log(d)-d/2-e/2*b.log(2)-a.gammaln(e/2))},cdf:function(c,d){return c<0?0:a.lowRegGamma(d/2,c/2)},inv:function(b,c){return 2*a.gammapinv(b,.5*c)},mean:function(a){return a},median:function(c){return c*b.pow(1-2/(9*c),3)},mode:function(b){return b-2>0?b-2:0},sample:function(c){return 2*a.randg(c/2)},variance:function(b){return 2*b}}),a.extend(a.exponential,{pdf:function(c,d){return c<0?0:d*b.exp(-d*c)},cdf:function(c,d){return c<0?0:1-b.exp(-d*c)},inv:function(a,c){return-b.log(1-a)/c},mean:function(a){return 1/a},median:function(a){return 1/a*b.log(2)},mode:function(b){return 0},sample:function(c){return-1/c*b.log(b.random())},variance:function(a){return b.pow(a,-2)}}),a.extend(a.gamma,{pdf:function(d,e,f){return d<0?0:0===d&&1===e?1/f:b.exp((e-1)*b.log(d)-d/f-a.gammaln(e)-e*b.log(f))},cdf:function(c,d,e){return c<0?0:a.lowRegGamma(d,c/e)},inv:function(b,c,d){return a.gammapinv(b,c)*d},mean:function(a,b){return a*b},mode:function(b,c){if(b>1)return(b-1)*c},sample:function(c,d){return a.randg(c)*d},variance:function(b,c){return b*c*c}}),a.extend(a.invgamma,{pdf:function(d,e,f){return d<=0?0:b.exp(-(e+1)*b.log(d)-f/d-a.gammaln(e)+e*b.log(f))},cdf:function(c,d,e){return c<=0?0:1-a.lowRegGamma(d,e/c)},inv:function(b,c,d){return d/a.gammapinv(1-b,c)},mean:function(a,b){return a>1?b/(a-1):void 0},mode:function(b,c){return c/(b+1)},sample:function(c,d){return d/a.randg(c)},variance:function(b,c){if(!(b<=2))return c*c/((b-1)*(b-1)*(b-2))}}),a.extend(a.kumaraswamy,{pdf:function(c,d,e){return 0===c&&1===d?e:1===c&&1===e?d:b.exp(b.log(d)+b.log(e)+(d-1)*b.log(c)+(e-1)*b.log(1-b.pow(c,d)))},cdf:function(c,d,e){return c<0?0:c>1?1:1-b.pow(1-b.pow(c,d),e)},inv:function(c,d,e){return b.pow(1-b.pow(1-c,1/e),1/d)},mean:function(b,c){return c*a.gammafn(1+1/b)*a.gammafn(c)/a.gammafn(1+1/b+c)},median:function(c,d){return b.pow(1-b.pow(2,-1/d),1/c)},mode:function(c,d){if(c>=1&&d>=1&&1!==c&&1!==d)return b.pow((c-1)/(c*d-1),1/c)},variance:function(b,c){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(c,d,e){return c<=0?0:b.exp(-b.log(c)-.5*b.log(2*b.PI)-b.log(e)-b.pow(b.log(c)-d,2)/(2*e*e))},cdf:function(d,e,f){return d<0?0:.5+.5*a.erf((b.log(d)-e)/b.sqrt(2*f*f))},inv:function(c,d,e){return b.exp(-1.4142135623730951*e*a.erfcinv(2*c)+d)},mean:function(c,d){return b.exp(c+d*d/2)},median:function(c,d){return b.exp(c)},mode:function(c,d){return b.exp(c-d*d)},sample:function(d,e){return b.exp(a.randn()*e+d)},variance:function(c,d){return(b.exp(d*d)-1)*b.exp(2*c+d*d)}}),a.extend(a.noncentralt,{pdf:function(d,e,f){var g=1e-14;return b.abs(f)<g?a.studentt.pdf(d,e):b.abs(d)<g?b.exp(a.gammaln((e+1)/2)-f*f/2-.5*b.log(b.PI*e)-a.gammaln(e/2)):e/d*(a.noncentralt.cdf(d*b.sqrt(1+2/e),e+2,f)-a.noncentralt.cdf(d,e,f))},cdf:function(d,e,f){var g=1e-14,h=200;if(b.abs(f)<g)return a.studentt.cdf(d,e);var i=!1;d<0&&(i=!0,f=-f);for(var j=a.normal.cdf(-f,0,1),k=g+1,l=k,m=d*d/(d*d+e),n=0,o=b.exp(-f*f/2),p=b.exp(-f*f/2-.5*b.log(2)-a.gammaln(1.5))*f;n<h||l>g||k>g;)l=k,n>0&&(o*=f*f/(2*n),p*=f*f/(2*(n+.5))),k=o*a.beta.cdf(m,n+.5,e/2)+p*a.beta.cdf(m,n+1,e/2),j+=.5*k,n++;return i?1-j:j}}),a.extend(a.normal,{pdf:function(c,d,e){return b.exp(-.5*b.log(2*b.PI)-b.log(e)-b.pow(c-d,2)/(2*e*e))},cdf:function(d,e,f){return.5*(1+a.erf((d-e)/b.sqrt(2*f*f)))},inv:function(b,c,d){return-1.4142135623730951*d*a.erfcinv(2*b)+c},mean:function(a,b){return a},median:function(b,c){return b},mode:function(a,b){return a},sample:function(c,d){return a.randn()*d+c},variance:function(a,b){return b*b}}),a.extend(a.pareto,{pdf:function(c,d,e){return c<d?0:e*b.pow(d,e)/b.pow(c,e+1)},cdf:function(c,d,e){return c<d?0:1-b.pow(d/c,e)},inv:function(c,d,e){return d/b.pow(1-c,1/e)},mean:function(c,d){if(!(d<=1))return d*b.pow(c,d)/(d-1)},median:function(c,d){return c*(d*b.SQRT2)},mode:function(b,c){return b},variance:function(a,c){if(!(c<=2))return a*a*c/(b.pow(c-1,2)*(c-2))}}),a.extend(a.studentt,{pdf:function(d,e){return e=e>1e100?1e100:e,1/(b.sqrt(e)*a.betafn(.5,e/2))*b.pow(1+d*d/e,-(e+1)/2)},cdf:function(d,e){var f=e/2;return a.ibeta((d+b.sqrt(d*d+e))/(2*b.sqrt(d*d+e)),f,f)},inv:function(c,d){var e=a.ibetainv(2*b.min(c,1-c),.5*d,.5);return e=b.sqrt(d*(1-e)/e),c>.5?e:-e},mean:function(b){return b>1?0:void 0},median:function(b){return 0},mode:function(b){return 0},sample:function(d){return a.randn()*b.sqrt(d/(2*a.randg(d/2)))},variance:function(b){return b>2?b/(b-2):b>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(c,d,e){return c<0||d<0||e<0?0:e/d*b.pow(c/d,e-1)*b.exp(-b.pow(c/d,e))},cdf:function(c,d,e){return c<0?0:1-b.exp(-b.pow(c/d,e))},inv:function(a,c,d){return c*b.pow(-b.log(1-a),1/d)},mean:function(b,c){return b*a.gammafn(1+1/c)},median:function(c,d){return c*b.pow(b.log(2),1/d)},mode:function(c,d){return d<=1?0:c*b.pow((d-1)/d,1/d)},sample:function(c,d){return c*b.pow(-b.log(b.random()),1/d)},variance:function(d,e){return d*d*a.gammafn(1+2/e)-b.pow(a.weibull.mean(d,e),2)}}),a.extend(a.uniform,{pdf:function(b,c,d){return b<c||b>d?0:1/(d-c)},cdf:function(b,c,d){return b<c?0:b<d?(b-c)/(d-c):1},inv:function(a,b,c){return b+a*(c-b)},mean:function(b,c){return.5*(b+c)},median:function(c,d){return a.mean(c,d)},mode:function(b,c){throw new Error("mode is not yet implemented")},sample:function(c,d){return c/2+d/2+(d/2-c/2)*(2*b.random()-1)},variance:function(c,d){return b.pow(d-c,2)/12}}),a.extend(a.binomial,{pdf:function(d,e,f){return 0===f||1===f?e*f===d?1:0:a.combination(e,d)*b.pow(f,d)*b.pow(1-f,e-d)},cdf:function(c,d,e){var f=[],g=0;if(c<0)return 0;if(c<d){for(;g<=c;g++)f[g]=a.binomial.pdf(g,d,e);return a.sum(f)}return 1}}),a.extend(a.negbin,{pdf:function(d,e,f){return d===d>>>0&&(d<0?0:a.combination(d+e-1,e-1)*b.pow(1-f,d)*b.pow(f,e))},cdf:function(c,d,e){var f=0,g=0;if(c<0)return 0;for(;g<=c;g++)f+=a.negbin.pdf(g,d,e);return f}}),a.extend(a.hypgeom,{pdf:function(d,e,f,g){if(d!==d|0)return!1;if(d<0||d<f-(e-g))return 0;if(d>g||d>f)return 0;if(2*f>e)return 2*g>e?a.hypgeom.pdf(e-f-g+d,e,e-f,e-g):a.hypgeom.pdf(g-d,e,e-f,g);if(2*g>e)return a.hypgeom.pdf(f-d,e,f,e-g);if(f<g)return a.hypgeom.pdf(d,e,g,f);for(var h=1,i=0,j=0;j<d;j++){for(;h>1&&i<g;)h*=1-f/(e-i),i++;h*=(g-j)*(f-j)/((j+1)*(e-f-g+j+1))}for(;i<g;i++)h*=1-f/(e-i);return b.min(1,b.max(0,h))},cdf:function(d,e,f,g){if(d<0||d<f-(e-g))return 0;if(d>=g||d>=f)return 1;if(2*f>e)return 2*g>e?a.hypgeom.cdf(e-f-g+d,e,e-f,e-g):1-a.hypgeom.cdf(g-d-1,e,e-f,g);if(2*g>e)return 1-a.hypgeom.cdf(f-d-1,e,f,e-g);if(f<g)return a.hypgeom.cdf(d,e,g,f);for(var h=1,i=1,j=0,k=0;k<d;k++){for(;h>1&&j<g;){var l=1-f/(e-j);i*=l,h*=l,j++}i*=(g-k)*(f-k)/((k+1)*(e-f-g+k+1)),h+=i}for(;j<g;j++)h*=1-f/(e-j);return b.min(1,b.max(0,h))}}),a.extend(a.poisson,{pdf:function(d,e){return e<0||d%1!=0||d<0?0:b.pow(e,d)*b.exp(-e)/a.factorial(d)},cdf:function(c,d){var e=[],f=0;if(c<0)return 0;for(;f<=c;f++)e.push(a.poisson.pdf(f,d));return a.sum(e)},mean:function(a){return a},variance:function(a){return a},sample:function(c){var d=1,e=0,f=b.exp(-c);do{e++,d*=b.random()}while(d>f);return e-1}}),a.extend(a.triangular,{pdf:function(b,c,d,e){return d<=c||e<c||e>d?NaN:b<c||b>d?0:b<e?2*(b-c)/((d-c)*(e-c)):b===e?2/(d-c):2*(d-b)/((d-c)*(d-e))},cdf:function(c,d,e,f){return e<=d||f<d||f>e?NaN:c<=d?0:c>=e?1:c<=f?b.pow(c-d,2)/((e-d)*(f-d)):1-b.pow(e-c,2)/((e-d)*(e-f))},inv:function(c,d,e,f){return e<=d||f<d||f>e?NaN:c<=(f-d)/(e-d)?d+(e-d)*b.sqrt(c*((f-d)/(e-d))):d+(e-d)*(1-b.sqrt((1-c)*(1-(f-d)/(e-d))))},mean:function(b,c,d){return(b+c+d)/3},median:function(c,d,e){return e<=(c+d)/2?d-b.sqrt((d-c)*(d-e))/b.sqrt(2):e>(c+d)/2?c+b.sqrt((d-c)*(e-c))/b.sqrt(2):void 0},mode:function(b,c,d){return d},sample:function(c,d,e){var f=b.random();return f<(e-c)/(d-c)?c+b.sqrt(f*(d-c)*(e-c)):d-b.sqrt((1-f)*(d-c)*(d-e))},variance:function(b,c,d){return(b*b+c*c+d*d-b*c-b*d-c*d)/18}}),a.extend(a.laplace,{pdf:function(c,d,e){return e<=0?0:b.exp(-b.abs(c-d)/e)/(2*e)},cdf:function(c,d,e){return e<=0?0:c<d?.5*b.exp((c-d)/e):1-.5*b.exp(-(c-d)/e)},mean:function(a,b){return a},median:function(a,b){return a},mode:function(a,b){return a},variance:function(a,b){return 2*b*b},sample:function(d,e){var f=b.random()-.5;return d-e*c(f)*b.log(1-2*b.abs(f))}})}(this.jStat,Math),function(a,b){function f(b){return e(b)||b instanceof a}var d=Array.prototype.push,e=a.utils.isArray;a.extend({add:function(c,d){return f(d)?(f(d[0])||(d=[d]),a.map(c,function(a,b,c){return a+d[b][c]})):a.map(c,function(a){return a+d})},subtract:function(c,d){return f(d)?(f(d[0])||(d=[d]),a.map(c,function(a,b,c){return a-d[b][c]||0})):a.map(c,function(a){return a-d})},divide:function(c,d){return f(d)?(f(d[0])||(d=[d]),a.multiply(c,a.inv(d))):a.map(c,function(a){return a/d})},multiply:function(c,d){var e,g,h,i,j,k,l,m;if(void 0===c.length&&void 0===d.length)return c*d;if(j=c.length,k=c[0].length,l=a.zeros(j,h=f(d)?d[0].length:k),m=0,f(d)){for(;m<h;m++)for(e=0;e<j;e++){for(i=0,g=0;g<k;g++)i+=c[e][g]*d[g][m];l[e][m]=i}return 1===j&&1===m?l[0][0]:l}return a.map(c,function(a){return a*d})},outer:function(c,d){return a.multiply(c.map(function(a){return[a]}),[d])},dot:function(c,d){f(c[0])||(c=[c]),f(d[0])||(d=[d]);for(var l,m,e=1===c[0].length&&1!==c.length?a.transpose(c):c,g=1===d[0].length&&1!==d.length?a.transpose(d):d,h=[],i=0,j=e.length,k=e[0].length;i<j;i++){for(h[i]=[],l=0,m=0;m<k;m++)l+=e[i][m]*g[i][m];h[i]=l}return 1===h.length?h[0]:h},pow:function(d,e){return a.map(d,function(a){return b.pow(a,e)})},exp:function(d){return a.map(d,function(a){return b.exp(a)})},log:function(d){return a.map(d,function(a){return b.log(a)})},abs:function(d){return a.map(d,function(a){return b.abs(a)})},norm:function(c,d){var e=0,g=0;for(isNaN(d)&&(d=2),f(c[0])&&(c=c[0]);g<c.length;g++)e+=b.pow(b.abs(c[g]),d);return b.pow(e,1/d)},angle:function(d,e){return b.acos(a.dot(d,e)/(a.norm(d)*a.norm(e)))},aug:function(b,c){for(var e=[],f=0;f<b.length;f++)e.push(b[f].slice());for(var f=0;f<e.length;f++)d.apply(e[f],c[f]);return e},inv:function(c){for(var j,d=c.length,e=c[0].length,f=a.identity(d,e),g=a.gauss_jordan(c,f),h=[],i=0;i<d;i++)for(h[i]=[],j=e;j<g[0].length;j++)h[i][j-e]=g[i][j];return h},det:function(b){var l,c=b.length,d=2*c,e=new Array(d),f=c-1,g=d-1,h=f-c+1,i=g,j=0,k=0;if(2===c)return b[0][0]*b[1][1]-b[0][1]*b[1][0];for(;j<d;j++)e[j]=1;for(var j=0;j<c;j++){for(l=0;l<c;l++)e[h<0?h+c:h]*=b[j][l],e[i<c?i+c:i]*=b[j][l],h++,i--;h=--f-c+1,i=--g}for(var j=0;j<c;j++)k+=e[j];for(;j<d;j++)k-=e[j];return k},gauss_elimination:function(d,e){var m,n,o,p,f=0,g=0,h=d.length,i=d[0].length,j=1,k=0,l=[];d=a.aug(d,e),m=d[0].length;for(var f=0;f<h;f++){for(n=d[f][f],g=f,p=f+1;p<i;p++)n<b.abs(d[p][f])&&(n=d[p][f],g=p);if(g!=f)for(p=0;p<m;p++)o=d[f][p],d[f][p]=d[g][p],d[g][p]=o;for(g=f+1;g<h;g++)for(j=d[g][f]/d[f][f],p=f;p<m;p++)d[g][p]=d[g][p]-j*d[f][p]}for(var f=h-1;f>=0;f--){for(k=0,g=f+1;g<=h-1;g++)k+=l[g]*d[f][g];l[f]=(d[f][m-1]-k)/d[f][f]}return l},gauss_jordan:function(e,f){for(var g=a.aug(e,f),h=g.length,i=g[0].length,j=0;j<h;j++){for(var k=j,l=j+1;l<h;l++)b.abs(g[l][j])>b.abs(g[k][j])&&(k=l);var m=g[j];g[j]=g[k],g[k]=m;for(var l=j+1;l<h;l++){c=g[l][j]/g[j][j];for(var n=j;n<i;n++)g[l][n]-=g[j][n]*c}}for(var j=h-1;j>=0;j--){c=g[j][j];for(var l=0;l<j;l++)for(var n=i-1;n>j-1;n--)g[l][n]-=g[j][n]*g[l][j]/c;g[j][j]/=c;for(var n=h;n<i;n++)g[j][n]/=c}return g},triaUpSolve:function(c,d){var g,e=c[0].length,f=a.zeros(1,e)[0],h=!1;return void 0!=d[0].length&&(d=d.map(function(a){return a[0]}),h=!0),a.arange(e-1,-1,-1).forEach(function(b){g=a.arange(b+1,e).map(function(a){return f[a]*c[b][a]}),f[b]=(d[b]-a.sum(g))/c[b][b]}),h?f.map(function(a){return[a]}):f},triaLowSolve:function(c,d){var g,e=c[0].length,f=a.zeros(1,e)[0],h=!1;return void 0!=d[0].length&&(d=d.map(function(a){return a[0]}),h=!0),a.arange(e).forEach(function(b){g=a.arange(b).map(function(a){return c[b][a]*f[a]}),f[b]=(d[b]-a.sum(g))/c[b][b]}),h?f.map(function(a){return[a]}):f},lu:function(c){var g,d=c.length,e=a.identity(d),f=a.zeros(c.length,c[0].length);return a.arange(d).forEach(function(a){f[0][a]=c[0][a]}),a.arange(1,d).forEach(function(b){a.arange(b).forEach(function(d){g=a.arange(d).map(function(a){return e[b][a]*f[a][d]}),e[b][d]=(c[b][d]-a.sum(g))/f[d][d]}),a.arange(b,d).forEach(function(d){g=a.arange(b).map(function(a){return e[b][a]*f[a][d]}),f[b][d]=c[i][d]-a.sum(g)})}),[e,f]},cholesky:function(d){var g,e=d.length,f=a.zeros(d.length,d[0].length);return a.arange(e).forEach(function(c){g=a.arange(c).map(function(a){return b.pow(f[c][a],2)}),f[c][c]=b.sqrt(d[c][c]-a.sum(g)),a.arange(c+1,e).forEach(function(b){g=a.arange(c).map(function(a){return f[c][a]*f[b][a]}),f[b][c]=(d[c][b]-a.sum(g))/f[c][c]})}),f},gauss_jacobi:function(d,e,f,g){for(var n,o,p,q,h=0,i=0,j=d.length,k=[],l=[],m=[];h<j;h++)for(k[h]=[],l[h]=[],m[h]=[],i=0;i<j;i++)h>i?(k[h][i]=d[h][i],l[h][i]=m[h][i]=0):h<i?(l[h][i]=d[h][i],k[h][i]=m[h][i]=0):(m[h][i]=d[h][i],k[h][i]=l[h][i]=0);for(p=a.multiply(a.multiply(a.inv(m),a.add(k,l)),-1),o=a.multiply(a.inv(m),e),n=f,q=a.add(a.multiply(p,f),o),h=2;b.abs(a.norm(a.subtract(q,n)))>g;)n=q,q=a.add(a.multiply(p,n),o),h++;return q},gauss_seidel:function(d,e,f,g){for(var m,n,o,p,q,h=0,i=d.length,j=[],k=[],l=[];h<i;h++)for(j[h]=[],k[h]=[],l[h]=[],m=0;m<i;m++)h>m?(j[h][m]=d[h][m],k[h][m]=l[h][m]=0):h<m?(k[h][m]=d[h][m],j[h][m]=l[h][m]=0):(l[h][m]=d[h][m],j[h][m]=k[h][m]=0);for(p=a.multiply(a.multiply(a.inv(a.add(l,j)),k),-1),o=a.multiply(a.inv(a.add(l,j)),e),n=f,q=a.add(a.multiply(p,f),o),h=2;b.abs(a.norm(a.subtract(q,n)))>g;)n=q,q=a.add(a.multiply(p,n),o),h+=1;return q},SOR:function(d,e,f,g,h){for(var n,o,p,q,r,i=0,j=d.length,k=[],l=[],m=[];i<j;i++)for(k[i]=[],l[i]=[],m[i]=[],n=0;n<j;n++)i>n?(k[i][n]=d[i][n],l[i][n]=m[i][n]=0):i<n?(l[i][n]=d[i][n],k[i][n]=m[i][n]=0):(m[i][n]=d[i][n],k[i][n]=l[i][n]=0);for(q=a.multiply(a.inv(a.add(m,a.multiply(k,h))),a.subtract(a.multiply(m,1-h),a.multiply(l,h))),p=a.multiply(a.multiply(a.inv(a.add(m,a.multiply(k,h))),e),h),o=f,r=a.add(a.multiply(q,f),p),i=2;b.abs(a.norm(a.subtract(r,o)))>g;)o=r,r=a.add(a.multiply(q,o),p),i++;return r},householder:function(d){for(var j,k,l,m,n,e=d.length,f=d[0].length,g=0,h=[],i=[];g<e-1;g++){for(j=0,m=g+1;m<f;m++)j+=d[m][g]*d[m][g];for(n=d[g+1][g]>0?-1:1,j=n*b.sqrt(j),k=b.sqrt((j*j-d[g+1][g]*j)/2),h=a.zeros(e,1),h[g+1][0]=(d[g+1][g]-j)/(2*k),l=g+2;l<e;l++)h[l][0]=d[l][g]/(2*k);i=a.subtract(a.identity(e,f),a.multiply(a.multiply(h,a.transpose(h)),2)),d=a.multiply(i,a.multiply(d,i))}return d},QR:function(){function b(b){var c=b.length,d=a.norm(b,2),e=a.zeros(1,c)[0];e[0]=1;var f=a.add(a.multiply(a.multiply(e,d),-1),b),g=a.norm(f,2),h=a.divide(f,g);return a.subtract(a.identity(c),a.multiply(a.outer(h,h),2))}function c(c){var d=c[0].length,e=[];return a.arange(d).forEach(function(d){var f=a.slice(c,{row:{start:d},col:d}),g=b(f),h=a.identity(c.length);h=a.sliceAssign(h,{row:{start:d},col:{start:d}},g),c=a.multiply(h,c),e.push(h)}),[e.reduce(function(b,c){return a.multiply(b,c)}),c]}return c}(),lstsq:function(b,c){function d(b){b=a.copy(b);var c=b.length,d=a.identity(c);return a.arange(c-1,-1,-1).forEach(function(c){a.sliceAssign(d,{row:c},a.divide(a.slice(d,{row:c}),b[c][c])),a.sliceAssign(b,{row:c},a.divide(a.slice(b,{row:c}),b[c][c])),a.arange(c).forEach(function(e){var f=a.multiply(b[e][c],-1),g=a.slice(b,{row:e}),h=a.multiply(a.slice(b,{row:c}),f);a.sliceAssign(b,{row:e},a.add(g,h));var i=a.slice(d,{row:e}),j=a.multiply(a.slice(d,{row:c}),f);a.sliceAssign(d,{row:e},a.add(i,j))})}),d}function e(b,c){var e=!1;void 0===c[0].length&&(c=c.map(function(a){return[a]}),e=!0);var f=a.QR(b),g=f[0],h=f[1],i=b[0].length,j=a.slice(g,{col:{end:i}}),k=a.slice(h,{row:{end:i}}),l=d(k),m=a.multiply(a.multiply(l,a.transpose(j)),c);return e?m.map(function(a){return a[0]}):m}return e}(),jacobi:function(d){for(var j,k,l,m,n,o,p,q,e=1,f=0,g=d.length,h=a.identity(g,g),i=[];1===e;){f++,o=d[0][1],m=0,n=1;for(var k=0;k<g;k++)for(l=0;l<g;l++)k!=l&&o<b.abs(d[k][l])&&(o=b.abs(d[k][l]),m=k,n=l);p=d[m][m]===d[n][n]?d[m][n]>0?b.PI/4:-b.PI/4:b.atan(2*d[m][n]/(d[m][m]-d[n][n]))/2,q=a.identity(g,g),q[m][m]=b.cos(p),q[m][n]=-b.sin(p),q[n][m]=b.sin(p),q[n][n]=b.cos(p),h=a.multiply(h,q),j=a.multiply(a.multiply(a.inv(q),d),q),d=j,e=0;for(var k=1;k<g;k++)for(l=1;l<g;l++)k!=l&&b.abs(d[k][l])>.001&&(e=1)}for(var k=0;k<g;k++)i.push(d[k][k]);return[h,i]},rungekutta:function(b,c,d,e,f,g){var h,i,j,k,l;if(2===g)for(;e<=d;)h=c*b(e,f),i=c*b(e+c,f+h),j=f+(h+i)/2,f=j,e+=c;if(4===g)for(;e<=d;)h=c*b(e,f),i=c*b(e+c/2,f+h/2),k=c*b(e+c/2,f+i/2),l=c*b(e+c,f+k),j=f+(h+2*i+2*k+l)/6,f=j,e+=c;return f},romberg:function(c,d,e,f){for(var l,m,n,o,p,g=0,h=(e-d)/2,i=[],j=[],k=[];g<f/2;){for(p=c(d),n=d,o=0;n<=e;n+=h,o++)i[o]=n;for(l=i.length,n=1;n<l-1;n++)p+=(n%2!=0?4:2)*c(i[n]);p=h/3*(p+c(e)),k[g]=p,h/=2,g++}for(m=k.length,l=1;1!==m;){for(n=0;n<m-1;n++)j[n]=(b.pow(4,l)*k[n+1]-k[n])/(b.pow(4,l)-1);m=j.length,k=j,j=[],l++}return k},richardson:function(c,d,e,f){function g(a,b){for(var e,c=0,d=a.length;c<d;c++)a[c]===b&&(e=c);return e}for(var m,n,o,p,q,i=(c.length,b.abs(e-c[g(c,e)+1])),j=0,k=[],l=[];f>=i;)m=g(c,e+f),n=g(c,e),k[j]=(d[m]-2*d[n]+d[2*n-m])/(f*f),f/=2,j++;for(p=k.length,o=1;1!=p;){for(q=0;q<p-1;q++)l[q]=(b.pow(4,o)*k[q+1]-k[q])/(b.pow(4,o)-1);p=l.length,k=l,l=[],o++}return k},simpson:function(b,c,d,e){for(var l,f=(d-c)/e,g=b(c),h=[],i=c,j=0,k=1;i<=d;i+=f,j++)h[j]=i;for(l=h.length;k<l-1;k++)g+=(k%2!=0?4:2)*b(h[k]);return f/3*(g+b(d))},hermite:function(b,c,d,e){for(var m,f=b.length,g=0,h=0,i=[],j=[],k=[],l=[];h<f;h++){for(i[h]=1,m=0;m<f;m++)h!=m&&(i[h]*=(e-b[m])/(b[h]-b[m]));for(j[h]=0,m=0;m<f;m++)h!=m&&(j[h]+=1/(b[h]-b[m]));k[h]=(1-2*(e-b[h])*j[h])*(i[h]*i[h]),l[h]=(e-b[h])*(i[h]*i[h]),g+=k[h]*c[h]+l[h]*d[h]}return g},lagrange:function(b,c,d){for(var g,h,e=0,f=0,i=b.length;f<i;f++){for(h=c[f],g=0;g<i;g++)f!=g&&(h*=(d-b[g])/(b[f]-b[g]));e+=h}return e},cubic_spline:function(c,d,e){for(var h,f=c.length,g=0,i=[],j=[],k=[],l=[],m=[],n=[],o=[];g<f-1;g++)m[g]=c[g+1]-c[g];k[0]=0;for(var g=1;g<f-1;g++)k[g]=3/m[g]*(d[g+1]-d[g])-3/m[g-1]*(d[g]-d[g-1]);for(var g=1;g<f-1;g++)i[g]=[],j[g]=[],i[g][g-1]=m[g-1],i[g][g]=2*(m[g-1]+m[g]),i[g][g+1]=m[g],j[g][0]=k[g];for(l=a.multiply(a.inv(i),j),h=0;h<f-1;h++)n[h]=(d[h+1]-d[h])/m[h]-m[h]*(l[h+1][0]+2*l[h][0])/3,o[h]=(l[h+1][0]-l[h][0])/(3*m[h]);for(h=0;h<f&&!(c[h]>e);h++);return h-=1,d[h]+(e-c[h])*n[h]+a.sq(e-c[h])*l[h]+(e-c[h])*a.sq(e-c[h])*o[h]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(c){for(var h,i,d=c.length,e=c[0].length,g=0,j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[],s=[],g=0;g<d;g++)j[g]=a.sum(c[g])/e;for(var g=0;g<e;g++)for(p[g]=[],h=0;h<d;h++)p[g][h]=c[h][g]-j[h];p=a.transpose(p);for(var g=0;g<d;g++)for(q[g]=[],h=0;h<d;h++)q[g][h]=a.dot([p[g]],[p[h]])/(e-1);l=a.jacobi(q),r=l[0],k=l[1],s=a.transpose(r);for(var g=0;g<k.length;g++)for(h=g;h<k.length;h++)k[g]<k[h]&&(i=k[g],k[g]=k[h],k[h]=i,m=s[g],s[g]=s[h],s[h]=m);o=a.transpose(p);for(var g=0;g<d;g++)for(n[g]=[],h=0;h<o.length;h++)n[g][h]=a.dot([s[g]],[o[h]]);return[c,k,s,n]}}),function(b){for(var c=0;c<b.length;c++)!function(b){a.fn[b]=function(c,d){var e=this;return d?(setTimeout(function(){d.call(e,a.fn[b].call(e,c))},15),this):"number"==typeof a[b](this,c)?a[b](this,c):a(a[b](this,c))}}(b[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(this.jStat,Math),function(a,b){function f(a,c,d,e){if(a>1||d>1||a<=0||d<=0)throw new Error("Proportions should be greater than 0 and less than 1");var f=(a*c+d*e)/(c+e);return(a-d)/b.sqrt(f*(1-f)*(1/c+1/e))}var c=[].slice,d=a.utils.isNumber,e=a.utils.isArray;a.extend({zscore:function(){var e=c.call(arguments);return d(e[1])?(e[0]-e[1])/e[2]:(e[0]-a.mean(e[1]))/a.stdev(e[1],e[2])},ztest:function(){var g,f=c.call(arguments);return e(f[1])?(g=a.zscore(f[0],f[1],f[3]),1===f[2]?a.normal.cdf(-b.abs(g),0,1):2*a.normal.cdf(-b.abs(g),0,1)):f.length>2?(g=a.zscore(f[0],f[1],f[2]),1===f[3]?a.normal.cdf(-b.abs(g),0,1):2*a.normal.cdf(-b.abs(g),0,1)):(g=f[0],1===f[1]?a.normal.cdf(-b.abs(g),0,1):2*a.normal.cdf(-b.abs(g),0,1))}}),a.extend(a.fn,{zscore:function(b,c){return(b-this.mean())/this.stdev(c)},ztest:function(d,e,f){var g=b.abs(this.zscore(d,f));return 1===e?a.normal.cdf(-g,0,1):2*a.normal.cdf(-g,0,1)}}),a.extend({tscore:function(){var e=c.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/b.sqrt(e[3])):(e[0]-a.mean(e[1]))/(a.stdev(e[1],!0)/b.sqrt(e[1].length))},ttest:function(){var g,f=c.call(arguments);return 5===f.length?(g=b.abs(a.tscore(f[0],f[1],f[2],f[3])),1===f[4]?a.studentt.cdf(-g,f[3]-1):2*a.studentt.cdf(-g,f[3]-1)):d(f[1])?(g=b.abs(f[0]),1==f[2]?a.studentt.cdf(-g,f[1]-1):2*a.studentt.cdf(-g,f[1]-1)):(g=b.abs(a.tscore(f[0],f[1])),1==f[2]?a.studentt.cdf(-g,f[1].length-1):2*a.studentt.cdf(-g,f[1].length-1))}}),a.extend(a.fn,{tscore:function(c){return(c-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(d,e){return 1===e?1-a.studentt.cdf(b.abs(this.tscore(d)),this.cols()-1):2*a.studentt.cdf(-b.abs(this.tscore(d)),this.cols()-1)}}),a.extend({anovafscore:function(){var f,g,h,i,j,k,l,m,e=c.call(arguments);if(1===e.length){j=new Array(e[0].length);for(var l=0;l<e[0].length;l++)j[l]=e[0][l];e=j}if(2===e.length)return a.variance(e[0])/a.variance(e[1]);g=new Array;for(var l=0;l<e.length;l++)g=g.concat(e[l]);h=a.mean(g),f=0;for(var l=0;l<e.length;l++)f+=e[l].length*b.pow(a.mean(e[l])-h,2);f/=e.length-1,k=0;for(var l=0;l<e.length;l++)for(i=a.mean(e[l]),m=0;m<e[l].length;m++)k+=b.pow(e[l][m]-i,2);return k/=g.length-e.length,f/k},anovaftest:function(){var f,g,h,i,e=c.call(arguments);if(d(e[0]))return 1-a.centralF.cdf(e[0],e[1],e[2]);anovafscore=a.anovafscore(e),f=e.length-1,h=0;for(var i=0;i<e.length;i++)h+=e[i].length;return g=h-f-1,1-a.centralF.cdf(anovafscore,f,g)},ftest:function(c,d,e){return 1-a.centralF.cdf(c,d,e)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){for(var d,c=0,d=0;d<this.length;d++)c+=this[d].length;return a.ftest(this.anovafscore(),this.length-1,c-this.length)}}),a.extend({normalci:function(){var g,e=c.call(arguments),f=new Array(2);return g=4===e.length?b.abs(a.normal.inv(e[1]/2,0,1)*e[2]/b.sqrt(e[3])):b.abs(a.normal.inv(e[1]/2,0,1)*a.stdev(e[2])/b.sqrt(e[2].length)),f[0]=e[0]-g,f[1]=e[0]+g,f},tci:function(){var g,e=c.call(arguments),f=new Array(2);return g=4===e.length?b.abs(a.studentt.inv(e[1]/2,e[3]-1)*e[2]/b.sqrt(e[3])):b.abs(a.studentt.inv(e[1]/2,e[2].length-1)*a.stdev(e[2],!0)/b.sqrt(e[2].length)),f[0]=e[0]-g,f[1]=e[0]+g,f},significant:function(b,c){return b<c}}),a.extend(a.fn,{normalci:function(c,d){return a.normalci(c,d,this.toArray())},tci:function(c,d){return a.tci(c,d,this.toArray())}}),a.extend(a.fn,{oneSidedDifferenceOfProportions:function(c,d,e,g){var h=f(c,d,e,g);return a.ztest(h,1)},twoSidedDifferenceOfProportions:function(c,d,e,g){var h=f(c,d,e,g);return a.ztest(h,2)}})}(this.jStat,Math),this.jStat.models=function(){function a(a,c){return b(a,c)}function a(a){var c=a[0].length;return jStat.arange(c).map(function(d){var e=jStat.arange(c).filter(function(a){return a!==d});return b(jStat.col(a,d).map(function(a){return a[0]}),jStat.col(a,e))})}function b(a,b){var c=a.length,d=b[0].length-1,e=c-d-1,f=jStat.lstsq(b,a),g=jStat.multiply(b,f.map(function(a){return[a]})).map(function(a){return a[0]}),h=jStat.subtract(a,g),i=jStat.mean(a),j=jStat.sum(g.map(function(a){return Math.pow(a-i,2)})),k=jStat.sum(a.map(function(a,b){return Math.pow(a-g[b],2)})),l=j+k;return{exog:b,endog:a,nobs:c,df_model:d,df_resid:e,coef:f,predict:g,resid:h,ybar:i,SST:l,SSE:j,SSR:k,R2:j/l}}function c(b){var c=a(b.exog),d=Math.sqrt(b.SSR/b.df_resid),e=c.map(function(a){var b=a.SST,c=a.R2;return d/Math.sqrt(b*(1-c))}),f=b.coef.map(function(a,b){return(a-0)/e[b]}),g=f.map(function(a){var c=jStat.studentt.cdf(a,b.df_resid);return 2*(c>.5?1-c:c)}),h=jStat.studentt.inv(.975,b.df_resid),i=b.coef.map(function(a,b){var c=h*e[b];return[a-c,a+c]});return{se:e,t:f,p:g,sigmaHat:d,interval95:i}}function d(a){var b=a.R2/a.df_model/((1-a.R2)/a.df_resid);return{F_statistic:b,pvalue:1-function(a,b,c){return jStat.beta.cdf(a/(c/b+a),b/2,c/2)}(b,a.df_model,a.df_resid)}}function e(a,e){var f=b(a,e),g=c(f),h=d(f),i=1-(1-f.rsquared)*((f.nobs-1)/f.df_resid);return f.t=g,f.f=h,f.adjust_R2=i,f}return{ols:e}}()},function(a,b,c){(function(d){var e,f;(function(){"use strict";function u(a){this._value=a}function v(a){var b,c="";for(b=0;b<a;b++)c+="0";return c}function w(a,b){var c,d,e,f,g,h,i,j;return j=a.toString(),c=j.split("e")[0],f=j.split("e")[1],d=c.split(".")[0],e=c.split(".")[1]||"",+f>0?j=d+e+v(f-e.length):(g=+d<0?"-0":"0",b>0&&(g+="."),i=v(-1*f-1),h=(i+Math.abs(d)+e).substr(0,b),j=g+h),+f>0&&b>0&&(j+="."+v(b)),j}function x(a,b,c,d){var f,g,e=Math.pow(10,b);return a.toString().indexOf("e")>-1?(g=w(a,b),"-"===g.charAt(0)&&+g>=0&&(g=g.substr(1))):g=(c(a+"e+"+b)/e).toFixed(b),d&&(f=new RegExp("0{1,"+d+"}$"),g=g.replace(f,"")),g}function y(a,b,c){var e=b.replace(/\{[^\{\}]*\}/g,"");return e.indexOf("$")>-1?A(a,m[o].currency.symbol,b,c):e.indexOf("%")>-1?C(a,b,c):e.indexOf(":")>-1?D(a,b):G(a._value,b,c)}function z(a,b){var d,e,f,g,k,c=b,h=!1;if(b.indexOf(":")>-1)a._value=E(b);else if(b===p)a._value=0;else{for("."!==m[o].delimiters.decimal&&(b=b.replace(/\./g,"").replace(m[o].delimiters.decimal,".")),d=new RegExp("[^a-zA-Z]"+m[o].abbreviations.thousand+"(?:\\)|(\\"+m[o].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+m[o].abbreviations.million+"(?:\\)|(\\"+m[o].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+m[o].abbreviations.billion+"(?:\\)|(\\"+m[o].currency.symbol+")?(?:\\))?)?$"),g=new RegExp("[^a-zA-Z]"+m[o].abbreviations.trillion+"(?:\\)|(\\"+m[o].currency.symbol+")?(?:\\))?)?$"),k=1;k<i.length&&!h;++k)b.indexOf(i[k])>-1?h=Math.pow(1024,k):b.indexOf(j[k])>-1&&(h=Math.pow(1e3,k));var l=b.replace(/[^0-9\.]+/g,"");""===l?a._value=NaN:(a._value=(h||1)*(c.match(d)?Math.pow(10,3):1)*(c.match(e)?Math.pow(10,6):1)*(c.match(f)?Math.pow(10,9):1)*(c.match(g)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(l),a._value=h?Math.ceil(a._value):a._value)}return a._value}function A(a,b,c,d){var l,n,e=c,f=e.indexOf("$"),g=e.indexOf("("),h=e.indexOf("+"),i=e.indexOf("-"),j="",k="";if(-1===e.indexOf("$")?"infix"===m[o].currency.position?(k=b,m[o].currency.spaceSeparated&&(k=" "+k+" ")):m[o].currency.spaceSeparated&&(j=" "):e.indexOf(" $")>-1?(j=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(j=" ",e=e.replace("$ ","")):e=e.replace("$",""),n=G(a._value,e,d,k),-1===c.indexOf("$"))switch(m[o].currency.position){case"postfix":n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,j+b),n=n.join("")):n=n+j+b;break;case"infix":break;case"prefix":n.indexOf("(")>-1||n.indexOf("-")>-1?(n=n.split(""),l=Math.max(g,i)+1,n.splice(l,0,b+j),n=n.join("")):n=b+j+n;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else f<=1?n.indexOf("(")>-1||n.indexOf("+")>-1||n.indexOf("-")>-1?(n=n.split(""),l=1,(f<g||f<h||f<i)&&(l=0),n.splice(l,0,b+j),n=n.join("")):n=b+j+n:n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,j+b),n=n.join("")):n=n+j+b;return n}function B(a,b,c,d){return A(a,b,c,d)}function C(a,b,c){var e,d="",f=100*a._value;return b.indexOf(" %")>-1?(d=" ",b=b.replace(" %","")):b=b.replace("%",""),e=G(f,b,c),e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,d+"%"),e=e.join("")):e=e+d+"%",e}function D(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(c<10?"0"+c:c)+":"+(d<10?"0"+d:d)}function E(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function F(a,b,c){var e,f,g,d=b[0],h=Math.abs(a);if(h>=c){for(e=1;e<b.length;++e)if(f=Math.pow(c,e),g=Math.pow(c,e+1),h>=f&&h<g){d=b[e],a/=f;break}d===b[0]&&(a/=Math.pow(c,b.length-1),d=b[b.length-1])}return{value:a,suffix:d}}function G(a,b,c,d){var s,t,y,z,A,B,C,D,E,G,H,I,M,N,O,Q,R,e=!1,f=!1,g=!1,h="",i=!1,j=!1,k=!1,n=!1,q=!1,r="",u="",w=Math.abs(a),J="",K=!1,L=!1,P="";if(0===a&&null!==p)return p;if(!isFinite(a))return""+a;if(0===b.indexOf("{")){var S=b.indexOf("}");if(-1===S)throw Error('Format should also contain a "}"');G=b.slice(1,S),b=b.slice(S+1)}else G="";if(b.indexOf("}")===b.length-1){var T=b.indexOf("{");if(-1===T)throw Error('Format should also contain a "{"');H=b.slice(T+1,-1),b=b.slice(0,T+1)}else H="";var U;for(U=-1===b.indexOf(".")?b.match(/([0-9]+).*/):b.match(/([0-9]+)\..*/),Q=null===U?-1:U[1].length,-1!==b.indexOf("-")&&(K=!0),b.indexOf("(")>-1?(e=!0,b=b.slice(1,-1)):b.indexOf("+")>-1&&(f=!0,b=b.replace(/\+/g,"")),b.indexOf("a")>-1&&(D=b.split(".")[0].match(/[0-9]+/g)||["0"],D=parseInt(D[0],10),i=b.indexOf("aK")>=0,j=b.indexOf("aM")>=0,k=b.indexOf("aB")>=0,n=b.indexOf("aT")>=0,q=i||j||k||n,b.indexOf(" a")>-1?(h=" ",b=b.replace(" a","")):b=b.replace("a",""),y=Math.floor(Math.log(w)/Math.LN10)+1,A=y%3,A=0===A?3:A,D&&0!==w&&(z=Math.floor(Math.log(w)/Math.LN10)+1-D,B=3*~~((Math.min(D,y)-A)/3),w/=Math.pow(10,B),-1===b.indexOf(".")&&D>3&&(b+="[.]",N=0===z?0:3*~~(z/3)-z,N=N<0?N+3:N,b+=v(N))),Math.floor(Math.log(Math.abs(a))/Math.LN10)+1!==D&&(w>=Math.pow(10,12)&&!q||n?(h+=m[o].abbreviations.trillion,a/=Math.pow(10,12)):w<Math.pow(10,12)&&w>=Math.pow(10,9)&&!q||k?(h+=m[o].abbreviations.billion,a/=Math.pow(10,9)):w<Math.pow(10,9)&&w>=Math.pow(10,6)&&!q||j?(h+=m[o].abbreviations.million,a/=Math.pow(10,6)):(w<Math.pow(10,6)&&w>=Math.pow(10,3)&&!q||i)&&(h+=m[o].abbreviations.thousand,a/=Math.pow(10,3)))),R=0;R<l.length;++R)if(s=l[R],b.indexOf(s.marker)>-1){b.indexOf(" "+s.marker)>-1&&(r=" "),b=b.replace(r+s.marker,""),t=F(a,s.suffixes,s.scale),a=t.value,r+=t.suffix;break}if(b.indexOf("o")>-1&&(b.indexOf(" o")>-1?(u=" ",b=b.replace(" o","")):b=b.replace("o",""),m[o].ordinal&&(u+=m[o].ordinal(a))),b.indexOf("[.]")>-1&&(g=!0,b=b.replace("[.]",".")),C=a.toString().split(".")[0],E=b.split(".")[1],I=b.indexOf(","),E){if(-1!==E.indexOf("*")?J=x(a,a.toString().split(".")[1].length,c):E.indexOf("[")>-1?(E=E.replace("]",""),E=E.split("["),J=x(a,E[0].length+E[1].length,c,E[1].length)):J=x(a,E.length,c),C=J.split(".")[0],J.split(".")[1].length){J=(d?h+d:m[o].delimiters.decimal)+J.split(".")[1]}else J="";g&&0===Number(J.slice(1))&&(J="")}else C=x(a,0,c);return C.indexOf("-")>-1&&(C=C.slice(1),L=!0),C.length<Q&&(C=v(Q-C.length)+C),I>-1&&(C=C.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+m[o].delimiters.thousands)),0===b.indexOf(".")&&(C=""),M=b.indexOf("("),O=b.indexOf("-"),P=M<O?(e&&L?"(":"")+(K&&L||!e&&L?"-":""):(K&&L||!e&&L?"-":"")+(e&&L?"(":""),G+P+(!L&&f&&0!==a?"+":"")+C+J+(u||"")+(h&&!d?h:"")+(r||"")+(e&&L?")":"")+H}function H(a,b){m[a]=b}function I(a){o=a;var b=m[a].defaults;b&&b.format&&g.defaultFormat(b.format),b&&b.currencyFormat&&g.defaultCurrencyFormat(b.currencyFormat)}function J(){return void 0!==d&&void 0===d.browser&&d.title&&(0===d.title.indexOf("node")||d.title.indexOf("meteor-tool")>0||"grunt"===d.title||"gulp"===d.title)&&!0}function K(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function L(){return Array.prototype.slice.call(arguments).reduce(function(a,b){var c=K(a),d=K(b);return c>d?c:d},-1/0)}var g,i=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],j=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k={general:{scale:1024,suffixes:j,marker:"bd"},binary:{scale:1024,suffixes:i,marker:"b"},decimal:{scale:1e3,suffixes:j,marker:"d"}},l=[k.general,k.binary,k.decimal],m={},n=m,o="en-US",p=null,q="0,0",r="0$",s=void 0!==a&&a.exports,t={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};g=function(a){return g.isNumbro(a)?a=a.value():0===a||void 0===a?a=0:Number(a)||(a=g.fn.unformat(a)),new u(Number(a))},g.version="1.9.3",g.isNumbro=function(a){return a instanceof u},g.setLanguage=function(a,b){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var c=a,d=a.split("-")[0],e=null;n[c]||(Object.keys(n).forEach(function(a){e||a.split("-")[0]!==d||(e=a)}),c=e||b||"en-US"),I(c)},g.setCulture=function(a,b){var c=a,d=a.split("-")[1],e=null;m[c]||(d&&Object.keys(m).forEach(function(a){e||a.split("-")[1]!==d||(e=a)}),c=e||b||"en-US"),I(c)},g.language=function(a,b){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!a)return o;if(a&&!b){if(!n[a])throw new Error("Unknown language : "+a);I(a)}return!b&&n[a]||H(a,b),g},g.culture=function(a,b){if(!a)return o;if(a&&!b){if(!m[a])throw new Error("Unknown culture : "+a);I(a)}return!b&&m[a]||H(a,b),g},g.languageData=function(a){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!a)return n[o];if(!n[a])throw new Error("Unknown language : "+a);return n[a]},g.cultureData=function(a){if(!a)return m[o];if(!m[a])throw new Error("Unknown culture : "+a);return m[a]},g.culture("en-US",t),g.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),n},g.cultures=function(){return m},g.zeroFormat=function(a){p="string"==typeof a?a:null},g.defaultFormat=function(a){q="string"==typeof a?a:"0.0"},g.defaultCurrencyFormat=function(a){r="string"==typeof a?a:"0$"},g.validate=function(a,b){var c,d,e,f,h,i,j,k;if("string"!=typeof a&&(a+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",a)),a=a.trim(),a=a.replace(/^[+-]?/,""),a.match(/^\d+$/))return!0;if(""===a)return!1;try{j=g.cultureData(b)}catch(a){j=g.cultureData(g.culture())}return e=j.currency.symbol,h=j.abbreviations,c=j.delimiters.decimal,d="."===j.delimiters.thousands?"\\.":j.delimiters.thousands,!(null!==(k=a.match(/^[^\d\.\,]+/))&&(a=a.substr(1),k[0]!==e)||null!==(k=a.match(/[^\d]+$/))&&(a=a.slice(0,-1),k[0]!==h.thousand&&k[0]!==h.million&&k[0]!==h.billion&&k[0]!==h.trillion)||(i=new RegExp(d+"{2}"),a.match(/[^\d.,]/g)||(f=a.split(c),f.length>2||(f.length<2?!f[0].match(/^\d+.*\d$/)||f[0].match(i):""===f[0]?f[0].match(i)||!f[1].match(/^\d+$/):1===f[0].length?!f[0].match(/^\d+$/)||f[0].match(i)||!f[1].match(/^\d+$/):!f[0].match(/^\d+.*\d$/)||f[0].match(i)||!f[1].match(/^\d+$/)))))},g.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),g.loadCulturesInNode()},g.loadCulturesInNode=function(){var a=c(58);for(var b in a)b&&g.culture(b,a[b])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),g.fn=u.prototype={clone:function(){return g(this)},format:function(a,b){return y(this,a||q,void 0!==b?b:Math.round)},formatCurrency:function(a,b){return A(this,m[o].currency.symbol,a||r,void 0!==b?b:Math.round)},formatForeignCurrency:function(a,b,c){return B(this,a,b||r,void 0!==c?c:Math.round)},unformat:function(a){if("number"==typeof a)return a;if("string"==typeof a){var b=z(this,a);return isNaN(b)?void 0:b}},binaryByteUnits:function(){return F(this._value,k.binary.suffixes,k.binary.scale).suffix},byteUnits:function(){return F(this._value,k.general.suffixes,k.general.scale).suffix},decimalByteUnits:function(){return F(this._value,k.decimal.suffixes,k.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function c(a,c){return a+b*c}var b=L.call(null,this._value,a);return this._value=[this._value,a].reduce(c,0)/b,this},subtract:function(a){function c(a,c){return a-b*c}var b=L.call(null,this._value,a);return this._value=[a].reduce(c,this._value*b)/b,this},multiply:function(a){function b(a,b){var c=L(a,b),d=a*c;return d*=b*c,d/=c*c}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=L(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(g(this._value).subtract(a).value())}},J()&&g.loadCulturesInNode(),s?a.exports=g:("undefined"==typeof ender&&(this.numbro=g),e=[],void 0!==(f=function(){return g}.apply(b,e))&&(a.exports=f))}).call("undefined"==typeof window?this:window)}).call(b,c(15))},function(a,b){function f(){throw new Error("setTimeout has not been defined")}function g(){throw new Error("clearTimeout has not been defined")}function h(a){if(d===setTimeout)return setTimeout(a,0);if((d===f||!d)&&setTimeout)return d=setTimeout,setTimeout(a,0);try{return d(a,0)}catch(b){try{return d.call(null,a,0)}catch(b){return d.call(this,a,0)}}}function i(a){if(e===clearTimeout)return clearTimeout(a);if((e===g||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(a);try{return e(a)}catch(b){try{return e.call(null,a)}catch(b){return e.call(this,a)}}}function n(){k&&l&&(k=!1,l.length?j=l.concat(j):m=-1,j.length&&o())}function o(){if(!k){var a=h(n);k=!0;for(var b=j.length;b;){for(l=j,j=[];++m<b;)l&&l[m].run();m=-1,b=j.length}l=null,k=!1,i(a)}}function p(a,b){this.fun=a,this.array=b}function q(){}var d,e,c=a.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:f}catch(a){d=f}try{e="function"==typeof clearTimeout?clearTimeout:g}catch(a){e=g}}();var l,j=[],k=!1,m=-1;c.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new p(a,b)),1!==j.length||k||h(o)},p.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=q,c.addListener=q,c.once=q,c.off=q,c.removeListener=q,c.removeAllListeners=q,c.emit=q,c.binding=function(a){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(a){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(a,b,c){"use strict";function n(a){return a&&a.__esModule?a:{default:a}}function o(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function p(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function q(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.__esModule=!0;var d=c(78),e=n(d),f=c(17),g=n(f),h=c(80),i=c(31),j=c(3),k=c(1),l=n(k),m=c(9),r=function(a){function b(){o(this,b);var c=p(this,a.call(this));return c.parser=new h.Parser,c.parser.yy={toNumber:j.toNumber,trimEdges:i.trimEdges,invertNumber:j.invertNumber,throwError:function(b){return c._throwError(b)},callVariable:function(b){return c._callVariable(b)},evaluateByOperator:g.default,callFunction:g.default,cellValue:function(b){return c._callCellValue(b)},rangeValue:function(b,d){return c._callRangeValue(b,d)}},c.variables=Object.create(null),c.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),c}return q(b,a),b.prototype.parse=function(b){var c=null,d=null;try{c=""===b?"":this.parser.parse(b)}catch(a){var e=(0,l.default)(a.message);d=e||(0,l.default)(k.ERROR)}return c instanceof Error&&(d=(0,l.default)(c.message)||(0,l.default)(k.ERROR),c=null),{error:d,result:c}},b.prototype.setVariable=function(b,c){return this.variables[b]=c,this},b.prototype.getVariable=function(b){return this.variables[b]},b.prototype._callVariable=function(b){var c=this.getVariable(b);if(this.emit("callVariable",b,function(a){void 0!==a&&(c=a)}),void 0===c)throw Error(k.ERROR_NAME);return c},b.prototype._callCellValue=function(b){b=b.toUpperCase();var c=(0,m.extractLabel)(b),d=c[0],e=c[1],f=void 0;return this.emit("callCellValue",{label:b,row:d,column:e},function(a){f=a}),f},b.prototype._callRangeValue=function(b,c){b=b.toUpperCase(),c=c.toUpperCase();var d=(0,m.extractLabel)(b),e=d[0],f=d[1],g=(0,m.extractLabel)(c),h=g[0],i=g[1],j={},k={};e.index<=h.index?(j.row=e,k.row=h):(j.row=h,k.row=e),f.index<=i.index?(j.column=f,k.column=i):(j.column=i,k.column=f),j.label=(0,m.toLabel)(j.row,j.column),k.label=(0,m.toLabel)(k.row,k.column);var l=[];return this.emit("callRangeValue",j,k,function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];l=a}),l},b.prototype._throwError=function(b){if((0,k.isValidStrict)(b))throw Error(b);throw Error(k.ERROR)},b}(e.default);b.default=r},function(a,b,c){"use strict";function E(a){return a&&a.__esModule?a:{default:a}}function G(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(a=a.toUpperCase(),!F[a])throw Error(D.ERROR_NAME);return F[a].apply(F,b)}function H(a,b){Array.isArray(a)||(a=[a.toUpperCase()]),a.forEach(function(a){b.isFactory?F[a]=b(a):F[a]=b})}b.__esModule=!0,b.default=G,b.registerOperation=H;var d=c(18),e=E(d),f=c(19),g=E(f),h=c(20),i=E(h),j=c(21),k=E(j),l=c(22),m=E(l),n=c(24),o=E(n),p=c(23),q=E(p),r=c(26),s=E(r),t=c(25),u=E(t),v=c(27),w=E(v),x=c(28),y=E(x),z=c(29),A=E(z),B=c(30),C=E(B),D=c(1),F=Object.create(null);H(e.default.SYMBOL,e.default),H(g.default.SYMBOL,g.default),H(i.default.SYMBOL,i.default),H(k.default.SYMBOL,k.default),H(C.default.SYMBOL,C.default),H(m.default.SYMBOL,m.default),H(o.default.SYMBOL,o.default),H(q.default.SYMBOL,q.default),H(s.default.SYMBOL,s.default),H(u.default.SYMBOL,u.default),H(y.default.SYMBOL,y.default),H(A.default.SYMBOL,A.default),H(w.default.SYMBOL,w.default)},function(a,b,c){"use strict";function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),f=1;f<b;f++)c[f-1]=arguments[f];var g=c.reduce(function(a,b){return a+(0,d.toNumber)(b)},(0,d.toNumber)(a));if(isNaN(g))throw Error(e.ERROR_VALUE);return g}b.__esModule=!0,b.SYMBOL=void 0,b.default=g;var d=c(3),e=c(1),f=b.SYMBOL="+";g.SYMBOL=f},function(a,b,c){"use strict";function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return a+b.toString()},"")}b.__esModule=!0,b.default=e;var d=b.SYMBOL="&";e.SYMBOL=d},function(a,b,c){"use strict";function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),f=1;f<b;f++)c[f-1]=arguments[f];var g=c.reduce(function(a,b){return a/(0,d.toNumber)(b)},(0,d.toNumber)(a));if(g===1/0)throw Error(e.ERROR_DIV_ZERO);if(isNaN(g))throw Error(e.ERROR_VALUE);return g}b.__esModule=!0,b.SYMBOL=void 0,b.default=g;var d=c(3),e=c(1),f=b.SYMBOL="/";g.SYMBOL=f},function(a,b,c){"use strict";function e(a,b){return a===b}b.__esModule=!0,b.default=e;var d=b.SYMBOL="=";e.SYMBOL=d},function(a,b,c){"use strict";function i(a){return a&&a.__esModule?a:{default:a}}function j(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function l(a){return function(){a=a.toUpperCase();var c=a.split("."),d=!1,f=void 0;if(1===c.length)e[c[0]]&&(d=!0,f=e[c[0]].apply(e,arguments));else{for(var g=c.length,i=0,j=e;i<g;)if(j=j[c[i]],i++,!j){j=null;break}j&&(d=!0,f=j.apply(void 0,arguments))}if(!d)throw Error(h.ERROR_NAME);return f}}b.__esModule=!0,b.SYMBOL=void 0,b.default=l;var d=c(33),e=j(d),f=c(10),g=i(f),h=c(1),k=b.SYMBOL=g.default;l.isFactory=!0,l.SYMBOL=k},function(a,b,c){"use strict";function e(a,b){return a>=b}b.__esModule=!0,b.default=e;var d=b.SYMBOL=">=";e.SYMBOL=d},function(a,b,c){"use strict";function e(a,b){return a>b}b.__esModule=!0,b.default=e;var d=b.SYMBOL=">";e.SYMBOL=d},function(a,b,c){"use strict";function e(a,b){return a<=b}b.__esModule=!0,b.default=e;var d=b.SYMBOL="<=";e.SYMBOL=d},function(a,b,c){"use strict";function e(a,b){return a<b}b.__esModule=!0,b.default=e;var d=b.SYMBOL="<";e.SYMBOL=d},function(a,b,c){"use strict";function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),f=1;f<b;f++)c[f-1]=arguments[f];var g=c.reduce(function(a,b){return a-(0,d.toNumber)(b)},(0,d.toNumber)(a));if(isNaN(g))throw Error(e.ERROR_VALUE);return g}b.__esModule=!0,b.SYMBOL=void 0,b.default=g;var d=c(3),e=c(1),f=b.SYMBOL="-";g.SYMBOL=f},function(a,b,c){"use strict";function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),f=1;f<b;f++)c[f-1]=arguments[f];var g=c.reduce(function(a,b){return a*(0,d.toNumber)(b)},(0,d.toNumber)(a));if(isNaN(g))throw Error(e.ERROR_VALUE);return g}b.__esModule=!0,b.SYMBOL=void 0,b.default=g;var d=c(3),e=c(1),f=b.SYMBOL="*";g.SYMBOL=f},function(a,b,c){"use strict";function e(a,b){return a!==b}b.__esModule=!0,b.default=e;var d=b.SYMBOL="<>";e.SYMBOL=d},function(a,b,c){"use strict";function g(a,b){var c=Math.pow((0,d.toNumber)(a),(0,d.toNumber)(b));if(isNaN(c))throw Error(e.ERROR_VALUE);return c}b.__esModule=!0,b.SYMBOL=void 0,b.default=g;var d=c(3),e=c(1),f=b.SYMBOL="^";g.SYMBOL=f},function(a,b,c){"use strict";function d(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return a=a.substring(b,a.length-b)}b.__esModule=!0,b.trimEdges=d},function(a,b,c){function e(a,b){return a.reduce(function(a,c){return b*a+c},0)}function f(a,b,c,d,e){e||(e=-1);var g,f=2/a;if(0===b)return c;if(1===b)return d;for(var h=1;h!=b;++h)g=d*h*f+e*c,c=d,d=g;return d}function g(a,b,c,d,e){return function(h,i){if(0===i)return a(h);if(1===i)return b(h);if(i<0)throw c+": Order ("+i+") must be nonnegative";if(1==d&&0===h)throw c+": Undefined when x == 0";if(2==d&&h<=0)throw c+": Undefined when x <= 0";return f(h,i,a(h),b(h),e)}}var d=Math,h=function(){function i(f){var i,j,k,l=f*f,m=d.abs(f)-.785398164;return d.abs(f)<8?(j=e(a,l),k=e(b,l),i=j/k):(l=64/l,j=e(c,l),k=e(g,l),i=d.sqrt(h/d.abs(f))*(d.cos(m)*j-d.sin(m)*k*8/d.abs(f))),i}function n(a){var b,c,f,g=a*a,i=d.abs(a)-2.356194491;return Math.abs(a)<8?(c=a*e(j,g),f=e(k,g),b=c/f):(g=64/g,c=e(l,g),f=e(m,g),b=d.sqrt(h/d.abs(a))*(d.cos(i)*c-d.sin(i)*f*8/d.abs(a)),a<0&&(b=-b)),b}var a=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),b=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),c=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),h=.636619772,j=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),k=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(b,c){if(0===(c=Math.round(c)))return i(d.abs(b));if(1===c)return n(d.abs(b));if(c<0)throw"BESSELJ: Order ("+c+") must be nonnegative";if(0===d.abs(b))return 0;var e,g,j,k,l,m,o,p,h=2/d.abs(b);if(d.abs(b)>c)e=f(b,c,i(d.abs(b)),n(d.abs(b)),-1);else{for(j=2*d.floor((c+d.floor(d.sqrt(40*c)))/2),k=0,m=e=l=0,o=1,g=j;g>0;g--)p=g*h*o-m,m=o,o=p,d.abs(o)>1e10&&(o*=1e-10,m*=1e-10,e*=1e-10,l*=1e-10),k&&(l+=o),k=!k,g==c&&(e=m);l=2*l-o,e/=l}return b<0&&c%2?-e:e}}(),i=function(){function j(g){var j,k,l,m=g*g,n=g-.785398164;return g<8?(k=e(a,m),l=e(b,m),j=k/l+i*h(g,0)*d.log(g)):(m=64/m,k=e(c,m),l=e(f,m),j=d.sqrt(i/g)*(d.sin(n)*k+d.cos(n)*l*8/g)),j}function o(a){var b,c,f,g=a*a,j=a-2.356194491;return a<8?(c=a*e(k,g),f=e(l,g),b=c/f+i*(h(a,1)*d.log(a)-1/a)):(g=64/g,c=e(m,g),f=e(n,g),b=d.sqrt(i/a)*(d.sin(j)*c+d.cos(j)*f*8/a)),b}var a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),b=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),c=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),i=.636619772,k=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),n=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return g(j,o,"BESSELY",1,-1)}(),j=function(){function c(c){return c<=3.75?e(a,c*c/14.0625):d.exp(d.abs(c))/d.sqrt(d.abs(c))*e(b,3.75/d.abs(c))}function h(a){return a<3.75?a*e(f,a*a/14.0625):(a<0?-1:1)*d.exp(d.abs(a))/d.sqrt(d.abs(a))*e(g,3.75/d.abs(a))}var a=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),b=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function a(b,e){if(0===(e=Math.round(e)))return c(b);if(1==e)return h(b);if(e<0)throw"BESSELI Order ("+e+") must be nonnegative";if(0===d.abs(b))return 0;var f,g,j,k,l,m,i=2/d.abs(b);for(j=2*d.round((e+d.round(d.sqrt(40*e)))/2),k=f=0,l=1,g=j;g>0;g--)m=g*i*l+k,k=l,l=m,d.abs(l)>1e10&&(l*=1e-10,k*=1e-10,f*=1e-10),g==e&&(f=k);return f*=a(b,0)/l,b<0&&e%2?-f:f}}(),k=function(){function c(c){return c<=2?-d.log(c/2)*j(c,0)+e(a,c*c/4):d.exp(-c)/d.sqrt(c)*e(b,2/c)}function i(a){return a<=2?d.log(a/2)*j(a,1)+1/a*e(f,a*a/4):d.exp(-a)/d.sqrt(a)*e(h,2/a)}var a=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),b=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),f=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),h=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return g(c,i,"BESSELK",2,1)}();b.besselj=h,b.bessely=i,b.besseli=j,b.besselk=k},function(a,b,c){var d=[c(34),c(35),c(11),c(37),c(4),c(8),c(6),c(36),c(7),c(38),c(5),c(12)];for(var e in d){var f=d[e];for(var g in f)b[g]=b[g]||f[g]}},function(a,b,c){function h(a,b){if(b)for(var c in b)a[c]=b[c];return a}var d=c(4),e=c(5),f=c(11),g=c(6);b.BETADIST=e.BETA.DIST,b.BETAINV=e.BETA.INV,b.BINOMDIST=e.BINOM.DIST,b.CEILING=b.ISOCEILING=h(d.CEILING.MATH,d.CEILING),b.CEILINGMATH=d.CEILING.MATH,b.CEILINGPRECISE=d.CEILING.PRECISE,b.CHIDIST=e.CHISQ.DIST,b.CHIDISTRT=e.CHISQ.DIST.RT,b.CHIINV=e.CHISQ.INV,b.CHIINVRT=e.CHISQ.INV.RT,b.CHITEST=e.CHISQ.TEST,b.CONFIDENCE=h(e.CONFIDENCE.NORM,e.CONFIDENCE),b.COVAR=e.COVARIANCE.P,b.COVARIANCEP=e.COVARIANCE.P,b.COVARIANCES=e.COVARIANCE.S,b.CRITBINOM=e.BINOM.INV,b.EXPONDIST=e.EXPON.DIST,b.ERFCPRECISE=f.ERFC.PRECISE,b.ERFPRECISE=f.ERF.PRECISE,b.FDIST=e.F.DIST,b.FDISTRT=e.F.DIST.RT,b.FINVRT=e.F.INV.RT,b.FINV=e.F.INV,b.FLOOR=h(d.FLOOR.MATH,d.FLOOR),b.FLOORMATH=d.FLOOR.MATH,b.FLOORPRECISE=d.FLOOR.PRECISE,b.FTEST=e.F.TEST,b.GAMMADIST=e.GAMMA.DIST,b.GAMMAINV=e.GAMMA.INV,b.GAMMALNPRECISE=e.GAMMALN.PRECISE,b.HYPGEOMDIST=e.HYPGEOM.DIST,b.LOGINV=e.LOGNORM.INV,b.LOGNORMINV=e.LOGNORM.INV,b.LOGNORMDIST=e.LOGNORM.DIST,b.MODE=h(e.MODE.SNGL,e.MODE),b.MODEMULT=e.MODE.MULT,b.MODESNGL=e.MODE.SNGL,b.NEGBINOMDIST=e.NEGBINOM.DIST,b.NETWORKDAYSINTL=g.NETWORKDAYS.INTL,b.NORMDIST=e.NORM.DIST,b.NORMINV=e.NORM.INV,b.NORMSDIST=e.NORM.S.DIST,b.NORMSINV=e.NORM.S.INV,b.PERCENTILE=h(e.PERCENTILE.EXC,e.PERCENTILE),b.PERCENTILEEXC=e.PERCENTILE.EXC,b.PERCENTILEINC=e.PERCENTILE.INC,b.PERCENTRANK=h(e.PERCENTRANK.INC,e.PERCENTRANK),b.PERCENTRANKEXC=e.PERCENTRANK.EXC,b.PERCENTRANKINC=e.PERCENTRANK.INC,b.POISSON=h(e.POISSON.DIST,e.POISSON),b.POISSONDIST=e.POISSON.DIST,b.QUARTILE=h(e.QUARTILE.INC,e.QUARTILE),b.QUARTILEEXC=e.QUARTILE.EXC,b.QUARTILEINC=e.QUARTILE.INC,b.RANK=h(e.RANK.EQ,e.RANK),b.RANKAVG=e.RANK.AVG,b.RANKEQ=e.RANK.EQ,b.SKEWP=e.SKEW.P,b.STDEV=h(e.STDEV.S,e.STDEV),b.STDEVP=e.STDEV.P,b.STDEVS=e.STDEV.S,b.TDIST=e.T.DIST,b.TDISTRT=e.T.DIST.RT,b.TINV=e.T.INV,b.TTEST=e.T.TEST,b.VAR=h(e.VAR.S,e.VAR),b.VARP=e.VAR.P,b.VARS=e.VAR.S,b.WEIBULL=h(e.WEIBULL.DIST,e.WEIBULL),b.WEIBULLDIST=e.WEIBULL.DIST,b.WORKDAYINTL=g.WORKDAY.INTL,b.ZTEST=e.Z.TEST},function(module,exports,__webpack_require__){function compact(a){var b=[];return utils.arrayEach(a,function(a){a&&b.push(a)}),b}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(0),stats=__webpack_require__(5),maths=__webpack_require__(4),utils=__webpack_require__(2);exports.FINDFIELD=function(a,b){var c=null;return utils.arrayEach(a,function(a,d){if(a[0]===b)return c=d,!1}),null==c?error.value:c},exports.DAVERAGE=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=0;return utils.arrayEach(d,function(a){g+=e[a]}),0===d.length?error.div0:g/d.length},exports.DCOUNT=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),stats.COUNT(g)},exports.DCOUNTA=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),stats.COUNTA(g)},exports.DGET=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);return 0===d.length?error.value:d.length>1?error.num:e[d[0]]},exports.DMAX=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=e[d[0]];return utils.arrayEach(d,function(a){g<e[a]&&(g=e[a])}),g},exports.DMIN=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=e[d[0]];return utils.arrayEach(d,function(a){g>e[a]&&(g=e[a])}),g},exports.DPRODUCT=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];utils.arrayEach(d,function(a){g.push(e[a])}),g=compact(g);var h=1;return utils.arrayEach(g,function(a){h*=a}),h},exports.DSTDEV=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),g=compact(g),stats.STDEV.S(g)},exports.DSTDEVP=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),g=compact(g),stats.STDEV.P(g)},exports.DSUM=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),maths.SUM(g)},exports.DVAR=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),stats.VAR.S(g)},exports.DVARP=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);var g=[];return utils.arrayEach(d,function(a){g.push(e[a])}),stats.VAR.P(g)}},function(a,b,c){function g(a){return a&&a.getTime&&!isNaN(a.getTime())}function h(a){return a instanceof Date?a:new Date(a)}var d=c(0),e=c(6),f=c(2);b.ACCRINT=function(a,b,c,f,i,j,k){return a=h(a),b=h(b),c=h(c),g(a)&&g(b)&&g(c)?f<=0||i<=0?d.num:-1===[1,2,4].indexOf(j)?d.num:-1===[0,1,2,3,4].indexOf(k)?d.num:c<=a?d.num:(i=i||0,k=k||0,i*f*e.YEARFRAC(a,c,k)):d.value},b.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},b.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},b.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},b.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},b.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},b.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},b.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},b.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},b.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},b.CUMIPMT=function(a,c,e,g,h,i){if(a=f.parseNumber(a),c=f.parseNumber(c),e=f.parseNumber(e),f.anyIsError(a,c,e))return d.value;if(a<=0||c<=0||e<=0)return d.num;if(g<1||h<1||g>h)return d.num;if(0!==i&&1!==i)return d.num;var j=b.PMT(a,c,e,0,i),k=0;1===g&&0===i&&(k=-e,g++);for(var l=g;l<=h;l++)k+=1===i?b.FV(a,l-2,j,e,1)-j:b.FV(a,l-1,j,e,0);return k*=a},b.CUMPRINC=function(a,c,e,g,h,i){if(a=f.parseNumber(a),c=f.parseNumber(c),e=f.parseNumber(e),f.anyIsError(a,c,e))return d.value;if(a<=0||c<=0||e<=0)return d.num;if(g<1||h<1||g>h)return d.num;if(0!==i&&1!==i)return d.num;var j=b.PMT(a,c,e,0,i),k=0;1===g&&(k=0===i?j+e*a:j,g++);for(var l=g;l<=h;l++)k+=i>0?j-(b.FV(a,l-2,j,e,1)-j)*a:j-b.FV(a,l-1,j,e,0)*a;return k},b.DB=function(a,b,c,e,g){if(g=void 0===g?12:g,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g))return d.value;if(a<0||b<0||c<0||e<0)return d.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(g))return d.num;if(e>c)return d.num;if(b>=a)return 0;for(var h=(1-Math.pow(b/a,1/c)).toFixed(3),i=a*h*g/12,j=i,k=0,l=e===c?c-1:e,m=2;m<=l;m++)k=(a-j)*h,j+=k;return 1===e?i:e===c?(a-j)*h:k},b.DDB=function(a,b,c,e,g){if(g=void 0===g?2:g,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g))return d.value;if(a<0||b<0||c<0||e<0||g<=0)return d.num;if(e>c)return d.num;if(b>=a)return 0;for(var h=0,i=0,j=1;j<=e;j++)i=Math.min(g/c*(a-h),a-b-h),h+=i;return i},b.DISC=function(){throw new Error("DISC is not implemented")},b.DOLLARDE=function(a,b){if(a=f.parseNumber(a),b=f.parseNumber(b),f.anyIsError(a,b))return d.value;if(b<0)return d.num;if(b>=0&&b<1)return d.div0;b=parseInt(b,10);var c=parseInt(a,10);c+=a%1*Math.pow(10,Math.ceil(Math.log(b)/Math.LN10))/b;var e=Math.pow(10,Math.ceil(Math.log(b)/Math.LN2)+1);return c=Math.round(c*e)/e},b.DOLLARFR=function(a,b){if(a=f.parseNumber(a),b=f.parseNumber(b),f.anyIsError(a,b))return d.value;if(b<0)return d.num;if(b>=0&&b<1)return d.div0;b=parseInt(b,10);var c=parseInt(a,10);return c+=a%1*Math.pow(10,-Math.ceil(Math.log(b)/Math.LN10))*b},b.DURATION=function(){throw new Error("DURATION is not implemented")},b.EFFECT=function(a,b){return a=f.parseNumber(a),b=f.parseNumber(b),f.anyIsError(a,b)?d.value:a<=0||b<1?d.num:(b=parseInt(b,10),Math.pow(1+a/b,b)-1)},b.FV=function(a,b,c,e,g){if(e=e||0,g=g||0,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g))return d.value;var h;if(0===a)h=e+c*b;else{var i=Math.pow(1+a,b);h=1===g?e*i+c*(1+a)*(i-1)/a:e*i+c*(i-1)/a}return-h},b.FVSCHEDULE=function(a,b){if(a=f.parseNumber(a),b=f.parseNumberArray(f.flatten(b)),f.anyIsError(a,b))return d.value;for(var c=b.length,e=a,g=0;g<c;g++)e*=1+b[g];return e},b.INTRATE=function(){throw new Error("INTRATE is not implemented")},b.IPMT=function(a,c,e,g,h,i){if(h=h||0,i=i||0,a=f.parseNumber(a),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),h=f.parseNumber(h),i=f.parseNumber(i),f.anyIsError(a,c,e,g,h,i))return d.value;var j=b.PMT(a,e,g,h,i);return(1===c?1===i?0:-g:1===i?b.FV(a,c-2,j,g,1)-j:b.FV(a,c-1,j,g,0))*a},b.IRR=function(a,b){if(b=b||0,a=f.parseNumberArray(f.flatten(a)),b=f.parseNumber(b),f.anyIsError(a,b))return d.value;for(var c=function(a,b,c){for(var d=c+1,e=a[0],f=1;f<a.length;f++)e+=a[f]/Math.pow(d,(b[f]-b[0])/365);return e},e=function(a,b,c){for(var d=c+1,e=0,f=1;f<a.length;f++){var g=(b[f]-b[0])/365;e-=g*a[f]/Math.pow(d,g+1)}return e},g=[],h=!1,i=!1,j=0;j<a.length;j++)g[j]=0===j?0:g[j-1]+365,a[j]>0&&(h=!0),a[j]<0&&(i=!0);if(!h||!i)return d.num;b=void 0===b?.1:b;var m,n,o,k=b,l=1e-10,p=!0;do{o=c(a,g,k),m=k-o/e(a,g,k),n=Math.abs(m-k),k=m,p=n>l&&Math.abs(o)>l}while(p);return k},b.ISPMT=function(a,b,c,e){return a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),f.anyIsError(a,b,c,e)?d.value:e*a*(b/c-1)},b.MDURATION=function(){throw new Error("MDURATION is not implemented")},b.MIRR=function(a,c,e){if(a=f.parseNumberArray(f.flatten(a)),c=f.parseNumber(c),e=f.parseNumber(e),f.anyIsError(a,c,e))return d.value;for(var g=a.length,h=[],i=[],j=0;j<g;j++)a[j]<0?h.push(a[j]):i.push(a[j]);var k=-b.NPV(e,i)*Math.pow(1+e,g-1),l=b.NPV(c,h)*(1+c);return Math.pow(k/l,1/(g-1))-1},b.NOMINAL=function(a,b){return a=f.parseNumber(a),b=f.parseNumber(b),f.anyIsError(a,b)?d.value:a<=0||b<1?d.num:(b=parseInt(b,10),(Math.pow(a+1,1/b)-1)*b)},b.NPER=function(a,b,c,e,g){if(g=void 0===g?0:g,e=void 0===e?0:e,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g))return d.value;var h=b*(1+a*g)-e*a,i=c*a+b*(1+a*g);return Math.log(h/i)/Math.log(1+a)},b.NPV=function(){var a=f.parseNumberArray(f.flatten(arguments));if(a instanceof Error)return a;for(var b=a[0],c=0,d=1;d<a.length;d++)c+=a[d]/Math.pow(1+b,d);return c},b.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},b.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},b.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},b.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},b.PDURATION=function(a,b,c){return a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:a<=0?d.num:(Math.log(c)-Math.log(b))/Math.log(1+a)},b.PMT=function(a,b,c,e,g){if(e=e||0,g=g||0,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g))return d.value;var h;if(0===a)h=(c+e)/b;else{var i=Math.pow(1+a,b);h=1===g?(e*a/(i-1)+c*a/(1-1/i))/(1+a):e*a/(i-1)+c*a/(1-1/i)}return-h},b.PPMT=function(a,c,e,g,h,i){return h=h||0,i=i||0,a=f.parseNumber(a),e=f.parseNumber(e),g=f.parseNumber(g),h=f.parseNumber(h),i=f.parseNumber(i),f.anyIsError(a,e,g,h,i)?d.value:b.PMT(a,e,g,h,i)-b.IPMT(a,c,e,g,h,i)},b.PRICE=function(){throw new Error("PRICE is not implemented")},b.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},b.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},b.PV=function(a,b,c,e,g){return e=e||0,g=g||0,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),f.anyIsError(a,b,c,e,g)?d.value:0===a?-c*b-e:((1-Math.pow(1+a,b))/a*c*(1+a*g)-e)/Math.pow(1+a,b)},b.RATE=function(a,b,c,e,g,h){if(h=void 0===h?.01:h,e=void 0===e?0:e,g=void 0===g?0:g,a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),g=f.parseNumber(g),h=f.parseNumber(h),f.anyIsError(a,b,c,e,g,h))return d.value;var k,l,m,n,i=1e-10,j=50,o=0,p=0,q=0,r=h;for(Math.abs(r)<i?k=c*(1+a*r)+b*(1+r*g)*a+e:(p=Math.exp(a*Math.log(1+r)),k=c*p+b*(1/r+g)*(p-1)+e),l=c+b*a+e,m=c*p+b*(1/r+g)*(p-1)+e,q=n=0,o=r;Math.abs(l-m)>i&&q<j;)r=(m*n-l*o)/(m-l),n=o,o=r,Math.abs(r)<i?k=c*(1+a*r)+b*(1+r*g)*a+e:(p=Math.exp(a*Math.log(1+r)),k=c*p+b*(1/r+g)*(p-1)+e),l=m,m=k,++q;return r},b.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},b.RRI=function(a,b,c){return a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:0===a||0===b?d.num:Math.pow(c/b,1/a)-1},b.SLN=function(a,b,c){return a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:0===c?d.num:(a-b)/c},b.SYD=function(a,b,c,e){return a=f.parseNumber(a),b=f.parseNumber(b),c=f.parseNumber(c),e=f.parseNumber(e),f.anyIsError(a,b,c,e)?d.value:0===c?d.num:e<1||e>c?d.num:(e=parseInt(e,10),(a-b)*(c-e+1)*2/(c*(c+1)))},b.TBILLEQ=function(a,b,c){return a=f.parseDate(a),b=f.parseDate(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:c<=0?d.num:a>b?d.num:b-a>31536e6?d.num:365*c/(360-c*e.DAYS360(a,b,!1))},b.TBILLPRICE=function(a,b,c){return a=f.parseDate(a),b=f.parseDate(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:c<=0?d.num:a>b?d.num:b-a>31536e6?d.num:100*(1-c*e.DAYS360(a,b,!1)/360)},b.TBILLYIELD=function(a,b,c){return a=f.parseDate(a),b=f.parseDate(b),c=f.parseNumber(c),f.anyIsError(a,b,c)?d.value:c<=0?d.num:a>b?d.num:b-a>31536e6?d.num:360*(100-c)/(c*e.DAYS360(a,b,!1))},b.VDB=function(){throw new Error("VDB is not implemented")},b.XNPV=function(a,b,c){if(a=f.parseNumber(a),b=f.parseNumberArray(f.flatten(b)),c=f.parseDateArray(f.flatten(c)),f.anyIsError(a,b,c))return d.value;for(var g=0,h=0;h<b.length;h++)g+=b[h]/Math.pow(1+a,e.DAYS(c[h],c[0])/365);return g},b.YIELD=function(){throw new Error("YIELD is not implemented")},b.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},b.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(a,b,c){var d=c(0),e=c(2),f=c(7);b.AND=function(){for(var a=e.flatten(arguments),b=!0,c=0;c<a.length;c++)a[c]||(b=!1);return b},b.CHOOSE=function(){if(arguments.length<2)return d.na;var a=arguments[0];return a<1||a>254?d.value:arguments.length<a+1?d.value:arguments[a]},b.FALSE=function(){return!1},b.IF=function(a,b,c){return a?b:c},b.IFERROR=function(a,b){return f.ISERROR(a)?b:a},b.IFNA=function(a,b){return a===d.na?b:a},b.NOT=function(a){return!a},b.OR=function(){for(var a=e.flatten(arguments),b=!1,c=0;c<a.length;c++)a[c]&&(b=!0);return b},b.TRUE=function(){return!0},b.XOR=function(){for(var a=e.flatten(arguments),b=0,c=0;c<a.length;c++)a[c]&&b++;return!!(1&Math.floor(Math.abs(b)))},b.SWITCH=function(){var a;if(arguments.length>0){var b=arguments[0],c=arguments.length-1,e=Math.floor(c/2),f=!1,g=c%2!=0,h=c%2==0?null:arguments[arguments.length-1];if(e)for(var i=0;i<e;i++)if(b===arguments[2*i+1]){a=arguments[2*i+2],f=!0;break}f||(a=g?h:d.na)}else a=d.value;return a}},function(a,b,c){var d=c(0);b.MATCH=function(a,b,c){if(!a&&!b)return d.na;if(2===arguments.length&&(c=1),!(b instanceof Array))return d.na;if(-1!==c&&0!==c&&1!==c)return d.na;for(var e,f,g=0;g<b.length;g++)if(1===c){if(b[g]===a)return g+1;b[g]<a&&(f?b[g]>f&&(e=g+1,f=b[g]):(e=g+1,f=b[g]))}else if(0===c){if("string"==typeof a){if(a=a.replace(/\?/g,"."),b[g].toLowerCase().match(a.toLowerCase()))return g+1}else if(b[g]===a)return g+1}else if(-1===c){if(b[g]===a)return g+1;b[g]>a&&(f?b[g]<f&&(e=g+1,f=b[g]):(e=g+1,f=b[g]))}return e||d.na}},function(a,b){(function(){"use strict";var b={langLocaleCode:"cs-CZ",cultureCode:"cs-CZ",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"Kč",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"da-DK",cultureCode:"da-DK",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mio",billion:"mia",trillion:"b"},ordinal:function(){return"."},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"de-CH",cultureCode:"de-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"de-DE",cultureCode:"de-DE",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"en-AU",cultureCode:"en-AU",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"en-GB",cultureCode:"en-GB",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"£",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"en-NZ",cultureCode:"en-NZ",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"en-ZA",cultureCode:"en-ZA",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"R",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"es-AR",cultureCode:"es-AR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===b||3===b?"er":2===b?"do":7===b||0===b?"mo":8===b?"vo":9===b?"no":"to"},currency:{symbol:"$",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"es-ES",cultureCode:"es-ES",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===b||3===b?"er":2===b?"do":7===b||0===b?"mo":8===b?"vo":9===b?"no":"to"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"et-EE",cultureCode:"et-EE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tuh",million:" mln",billion:" mld",trillion:" trl"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fa-IR",cultureCode:"fa-IR",delimiters:{thousands:"،",decimal:"."},abbreviations:{thousand:"هزار",million:"میلیون",billion:"میلیارد",trillion:"تریلیون"},ordinal:function(){return"ام"},currency:{symbol:"﷼"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fi-FI",cultureCode:"fi-FI",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fil-PH",cultureCode:"fil-PH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"₱"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fr-CA",cultureCode:"fr-CA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"$",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fr-CH",cultureCode:"fr-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"fr-FR",cultureCode:"fr-FR",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"he-IL",cultureCode:"he-IL",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"אלף",million:"מליון",billion:"בליון",trillion:"טריליון"},currency:{symbol:"₪",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"₪ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"₪ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"hu-HU",cultureCode:"hu-HU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"E",million:"M",billion:"Mrd",trillion:"T"},ordinal:function(){return"."},currency:{symbol:" Ft",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b,c){b["cs-CZ"]=c(39),b["da-DK"]=c(40),b["de-CH"]=c(41),b["de-DE"]=c(42),b["en-AU"]=c(43),b["en-GB"]=c(44),b["en-NZ"]=c(45),b["en-ZA"]=c(46),b["es-AR"]=c(47),b["es-ES"]=c(48),b["et-EE"]=c(49),b["fa-IR"]=c(50),b["fi-FI"]=c(51),b["fil-PH"]=c(52),b["fr-CA"]=c(53),b["fr-CH"]=c(54),b["fr-FR"]=c(55),b["he-IL"]=c(56),b["hu-HU"]=c(57),b["it-IT"]=c(59),b["ja-JP"]=c(60),b["ko-KR"]=c(61),b["lv-LV"]=c(62),b["nb-NO"]=c(63),b["nl-BE"]=c(64),b["nl-NL"]=c(65),b["pl-PL"]=c(66),b["pt-BR"]=c(67),b["pt-PT"]=c(68),b["ru-RU"]=c(69),b["ru-UA"]=c(70),b["sk-SK"]=c(71),b["sv-SE"]=c(72),b["th-TH"]=c(73),b["tr-TR"]=c(74),b["uk-UA"]=c(75),b["zh-CN"]=c(76),b["zh-TW"]=c(77)},function(a,b){(function(){"use strict";var b={langLocaleCode:"it-IT",cultureCode:"it-IT",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mila",million:"mil",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"ja-JP",cultureCode:"ja-JP",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百万",billion:"十億",trillion:"兆"},ordinal:function(){return"."},currency:{symbol:"¥",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"ko-KR",cultureCode:"ko-KR",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"천",million:"백만",billion:"십억",trillion:"일조"},ordinal:function(){return"."},currency:{symbol:"₩"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"lv-LV",cultureCode:"lv-LV",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tūkst.",million:" milj.",billion:" mljrd.",trillion:" trilj."},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"nb-NO",cultureCode:"nb-NO",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"t"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"nl-BE",cultureCode:"nl-BE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(a){var b=a%100;return 0!==a&&b<=1||8===b||b>=20?"ste":"de"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"nl-NL",cultureCode:"nl-NL",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mrd",trillion:"bln"},ordinal:function(a){var b=a%100;return 0!==a&&b<=1||8===b||b>=20?"ste":"de"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"pl-PL",cultureCode:"pl-PL",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tys.",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(){return"."},currency:{symbol:" zł",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"pt-BR",cultureCode:"pt-BR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mil",million:"milhões",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"R$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"pt-PT",cultureCode:"pt-PT",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"ru-RU",cultureCode:"ru-RU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тыс.",million:"млн",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"руб.",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"ru-UA",cultureCode:"ru-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тыс.",million:"млн",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"₴",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"sk-SK",cultureCode:"sk-SK",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"sv-SE",cultureCode:"sv-SE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"tmd"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"th-TH",cultureCode:"th-TH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"พัน",million:"ล้าน",billion:"พันล้าน",trillion:"ล้านล้าน"},ordinal:function(){return"."},currency:{symbol:"฿",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"},c={langLocaleCode:"tr-TR",cultureCode:"tr-TR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"bin",million:"milyon",billion:"milyar",trillion:"trilyon"},ordinal:function(a){if(0===a)return"'ıncı";var c=a%10,d=a%100-c,e=a>=100?100:null;return b[c]||b[d]||b[e]},currency:{symbol:"₺",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=c),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(c.cultureCode,c)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"uk-UA",cultureCode:"uk-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тис.",million:"млн",billion:"млрд",trillion:"блн"},ordinal:function(){return""},currency:{symbol:"₴",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"zh-CN",cultureCode:"zh-CN",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百万",billion:"十亿",trillion:"兆"},ordinal:function(){return"."},currency:{symbol:"¥",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){(function(){"use strict";var b={langLocaleCode:"zh-TW",cultureCode:"zh-TW",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百萬",billion:"十億",trillion:"兆"},ordinal:function(){return"第"},currency:{symbol:"NT$"}};void 0!==a&&a.exports&&(a.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}).call("undefined"==typeof window?this:window)},function(a,b){function c(){}c.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function e(){d.off(a,e),b.apply(c,arguments)}var d=this;return e._=b,this.on(a,e,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},a.exports=c},function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},function(module,exports,__webpack_require__){(function(module,process){var grammarParser=function(){function Parser(){this.yy={}}var o=function(a,b,c,d){for(c=c||{},d=a.length;d--;c[a[d]]=b);return c},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(a){result.push(a)}),this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 46:this.$=.01*$$[$0-1];break;case 47:this.$=yy.throwError($$[$0])}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function(b,c){function d(a,b){this.message=a,this.hash=b}if(!c.recoverable)throw d.prototype=Error,new d(b,c);this.trace(b)},parse:function(b){function u(a){d.length=d.length-2*a,f.length=f.length-a,g.length=g.length-a}function J(a){for(var b=d.length-1,c=0;;){if(m.toString()in h[a])return c;if(0===a||b<2)return!1;b-=2,a=d[b],++c}}var c=this,d=[0],f=[null],g=[],h=this.table,i="",j=0,k=0,l=0,m=2,n=1,o=g.slice.call(arguments,1),p=Object.create(this.lexer),q={yy:{}};for(var r in this.yy)Object.prototype.hasOwnProperty.call(this.yy,r)&&(q.yy[r]=this.yy[r]);p.setInput(b,q.yy),q.yy.lexer=p,q.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var s=p.yylloc;g.push(s);var t=p.options&&p.options.ranges;"function"==typeof q.yy.parseError?this.parseError=q.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var w,x,y,z,B,D,E,F,G,v=function(){var a;return a=p.lex()||n,"number"!=typeof a&&(a=c.symbols_[a]||a),a},C={};;){if(y=d[d.length-1],this.defaultActions[y]?z=this.defaultActions[y]:(null!==w&&void 0!==w||(w=v()),z=h[y]&&h[y][w]),void 0===z||!z.length||!z[0]){var H,I="";if(l)x!==n&&(H=J(y));else{H=J(y),G=[];for(D in h[y])this.terminals_[D]&&D>m&&G.push("'"+this.terminals_[D]+"'");I=p.showPosition?"Parse error on line "+(j+1)+":\n"+p.showPosition()+"\nExpecting "+G.join(", ")+", got '"+(this.terminals_[w]||w)+"'":"Parse error on line "+(j+1)+": Unexpected "+(w==n?"end of input":"'"+(this.terminals_[w]||w)+"'"),this.parseError(I,{text:p.match,token:this.terminals_[w]||w,line:p.yylineno,loc:s,expected:G,recoverable:!1!==H})}if(3==l){if(w===n||x===n)throw new Error(I||"Parsing halted while starting to recover from another error.");k=p.yyleng,i=p.yytext,j=p.yylineno,s=p.yylloc,w=v()}if(!1===H)throw new Error(I||"Parsing halted. No suitable error recovery rule available.");u(H),x=w==m?null:w,w=m,y=d[d.length-1],z=h[y]&&h[y][m],l=3}if(z[0]instanceof Array&&z.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+w);switch(z[0]){case 1:d.push(w),f.push(p.yytext),g.push(p.yylloc),d.push(z[1]),w=null,x?(w=x,x=null):(k=p.yyleng,i=p.yytext,j=p.yylineno,s=p.yylloc,l>0&&l--);break;case 2:if(E=this.productions_[z[1]][1],C.$=f[f.length-E],C._$={first_line:g[g.length-(E||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(E||1)].first_column,last_column:g[g.length-1].last_column},t&&(C._$.range=[g[g.length-(E||1)].range[0],g[g.length-1].range[1]]),void 0!==(B=this.performAction.apply(C,[i,k,j,q.yy,z[1],f,g].concat(o))))return B;E&&(d=d.slice(0,-1*E*2),f=f.slice(0,-1*E),g=g.slice(0,-1*E)),d.push(this.productions_[z[1]][0]),f.push(C.$),g.push(C._$),F=h[d[d.length-2]][d[d.length-1]],d.push(F);break;case 3:return!0}}return!0}},lexer=function(){return{EOF:1,parseError:function(b,c){if(!this.yy.parser)throw new Error(b);this.yy.parser.parseError(b,c)},setInput:function(a,b){return this.yy=b||this.yy||{},this._input=a,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];return this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a,a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c,d,e;if(this.options.backtrack_lexer&&(e={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(e.yylloc.range=this.yylloc.range.slice(0))),d=a[0].match(/(?:\r\n?|\n).*/g),d&&(this.yylineno+=d.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:d?d[d.length-1].length-d[d.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length},this.yytext+=a[0],this.match+=a[0],this.matches=a,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(a[0].length),this.matched+=a[0],c=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),c)return c;if(this._backtrack){for(var f in e)this[f]=e[f];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d;this._more||(this.yytext="",this.match="");for(var e=this._currentRules(),f=0;f<e.length;f++)if((c=this._input.match(this.rules[e[f]]))&&(!b||c[0].length>b[0].length)){if(b=c,d=f,this.options.backtrack_lexer){if(!1!==(a=this.test_match(c,e[f])))return a;if(this._backtrack){b=!1;continue}return!1}if(!this.options.flex)break}return b?!1!==(a=this.test_match(b,e[d]))&&a:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return b||this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(b){return b=this.conditionStack.length-1-Math.abs(b||0),b>=0?this.conditionStack[b]:"INITIAL"},pushState:function(b){this.begin(b)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(b,c,d,e){switch(d){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}}}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();exports.parser=grammarParser,exports.Parser=grammarParser.Parser,exports.parse=function(){return grammarParser.parse.apply(grammarParser,arguments)},void 0!==module&&__webpack_require__.c[__webpack_require__.s]===module&&exports.main(process.argv.slice(1))}).call(exports,__webpack_require__(79)(module),__webpack_require__(15))},function(a,b,c){"use strict";function k(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0,b.rowLabelToIndex=b.rowIndexToLabel=b.columnLabelToIndex=b.columnIndexToLabel=b.toLabel=b.extractLabel=b.error=b.Parser=b.ERROR_VALUE=b.ERROR_REF=b.ERROR_NUM=b.ERROR_NULL=b.ERROR_NOT_AVAILABLE=b.ERROR_NAME=b.ERROR_DIV_ZERO=b.ERROR=b.SUPPORTED_FORMULAS=void 0;var d=c(16),e=k(d),f=c(10),g=k(f),h=c(1),i=k(h),j=c(9);b.SUPPORTED_FORMULAS=g.default,b.ERROR=h.ERROR,b.ERROR_DIV_ZERO=h.ERROR_DIV_ZERO,b.ERROR_NAME=h.ERROR_NAME,b.ERROR_NOT_AVAILABLE=h.ERROR_NOT_AVAILABLE,b.ERROR_NULL=h.ERROR_NULL,b.ERROR_NUM=h.ERROR_NUM,b.ERROR_REF=h.ERROR_REF,b.ERROR_VALUE=h.ERROR_VALUE,b.Parser=e.default,b.error=i.default,b.extractLabel=j.extractLabel,b.toLabel=j.toLabel,b.columnIndexToLabel=j.columnIndexToLabel,b.columnLabelToIndex=j.columnLabelToIndex,b.rowIndexToLabel=j.rowIndexToLabel,b.rowLabelToIndex=j.rowLabelToIndex}])})},{}],jsonpatch:[function(a,b,c){var f,d=this&&this.__extends||function(a,b){function d(){this.constructor=a}for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)},e=Error;!function(a){function c(a,d){switch(typeof a){case"undefined":case"boolean":case"string":case"number":return a===d;case"object":if(null===a)return null===d;if(x(a)){if(!x(d)||a.length!==d.length)return!1;for(var e=0,f=a.length;e<f;e++)if(!c(a[e],d[e]))return!1;return!0}var g=b(d),h=g.length;if(b(a).length!==h)return!1;for(var e=0;e<h;e++)if(!c(a[e],d[e]))return!1;return!0;default:return!1}}function j(a){return-1===a.indexOf("/")&&-1===a.indexOf("~")?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function p(a){for(var b=0,c=m.length;b<c;b++)if(m[b].obj===a)return m[b]}function q(a,b){for(var c=0,d=a.observers.length;c<d;c++)if(a.observers[c].callback===b)return a.observers[c].observer}function r(a,b){for(var c=0,d=a.observers.length;c<d;c++)if(a.observers[c].observer===b)return void a.observers.splice(c,1)}function s(a,b){b.unobserve()}function t(a){return"object"==typeof a?JSON.parse(JSON.stringify(a)):a}function u(a,b){var f,c=[],g=p(a);if(g?f=q(g,b):(g=new n(a),m.push(g)),f)return f;if(f={},g.value=t(a),b){f.callback=b,f.next=null;var h=this.intervals||[100,1e3,1e4,6e4];if(void 0===h.push)throw new e("jsonpatch.intervals must be an array");var i=0,j=function(){v(f)},k=function(){clearTimeout(f.next),f.next=setTimeout(function(){j(),i=0,f.next=setTimeout(l,h[i++])},0)},l=function(){j(),i==h.length&&(i=h.length-1),f.next=setTimeout(l,h[i++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",k),window.addEventListener("mouseup",k),window.addEventListener("keydown",k)):(document.documentElement.attachEvent("onmousedown",k),document.documentElement.attachEvent("onmouseup",k),document.documentElement.attachEvent("onkeydown",k))),f.next=setTimeout(l,h[i++])}return f.patches=c,f.object=a,f.unobserve=function(){v(f),clearTimeout(f.next),r(g,f),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",k),window.removeEventListener("mouseup",k),window.removeEventListener("keydown",k)):(document.documentElement.detachEvent("onmousedown",k),document.documentElement.detachEvent("onmouseup",k),document.documentElement.detachEvent("onkeydown",k)))},g.observers.push(new o(b,f)),f}function v(a){for(var b,c=0,d=m.length;c<d;c++)if(m[c].obj===a.object){b=m[c];break}w(b.value,a.object,a.patches,""),a.patches.length&&z(b.value,a.patches);var e=a.patches;return e.length>0&&(a.patches=[],a.callback&&a.callback(e)),e}function w(a,c,d,e){for(var f=b(c),g=b(a),i=!1,k=g.length-1;k>=0;k--){var l=g[k],m=a[l];if(c.hasOwnProperty(l)){var n=c[l];"object"==typeof m&&null!=m&&"object"==typeof n&&null!=n?w(m,n,d,e+"/"+j(l)):m!=n&&(!0,d.push({op:"replace",path:e+"/"+j(l),value:t(n)}))}else d.push({op:"remove",path:e+"/"+j(l)}),i=!0}if(i||f.length!=g.length)for(var k=0;k<f.length;k++){var l=f[k];a.hasOwnProperty(l)||d.push({op:"add",path:e+"/"+j(l),value:t(c[l])})}}function y(a){for(var d,b=0,c=a.length;b<c;){d=a.charCodeAt(b);{if(!(d>=48&&d<=57))return!1;b++}}return!0}function z(a,b,c){for(var j,k,d=!1,e=0,i=b.length;e<i;){j=b[e],e++;for(var l=j.path||"",m=l.split("/"),n=a,o=1,p=m.length,q=void 0;;){if(k=m[o],c&&void 0===q&&(void 0===n[k]?q=m.slice(0,o).join("/"):o==p-1&&(q=j.path),void 0!==q&&this.validator(j,e-1,a,q)),o++,void 0===k&&o>=p){d=h[j.op].call(j,n,k,a);break}if(x(n)){if("-"===k)k=n.length;else{if(c&&!y(k))throw new B("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",e-1,j.path,j);k=parseInt(k,10)}if(o>=p){if(c&&"add"===j.op&&k>n.length)throw new B("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",e-1,j.path,j);d=g[j.op].call(j,n,k,a);break}}else if(k&&-1!=k.indexOf("~")&&(k=k.replace(/~1/g,"/").replace(/~0/g,"~")),o>=p){d=f[j.op].call(j,n,k,a);break}n=n[k]}}return d}function A(a,b){var c=[];return w(a,b,c,""),c}function C(a){if(void 0===a)return!0;if("array"==typeof a||"object"==typeof a)for(var b in a)if(C(a[b]))return!0;return!1}function D(b,c,d,e){if("object"!=typeof b||null===b||x(b))throw new B("Operation is not an object","OPERATION_NOT_AN_OBJECT",c,b,d);if(!f[b.op])throw new B("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",c,b,d);if("string"!=typeof b.path)throw new B("Operation `path` property is not a string","OPERATION_PATH_INVALID",c,b,d);if(("move"===b.op||"copy"===b.op)&&"string"!=typeof b.from)throw new B("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&void 0===b.value)throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&C(b.value))throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",c,b,d);if(d)if("add"==b.op){var g=b.path.split("/").length,h=e.split("/").length;if(g!==h+1&&g!==h)throw new B("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",c,b,d)}else if("replace"===b.op||"remove"===b.op||"_get"===b.op){if(b.path!==e)throw new B("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",c,b,d)}else if("move"===b.op||"copy"===b.op){var i={op:"_get",path:b.from,value:void 0},j=a.validate([i],d);if(j&&"OPERATION_PATH_UNRESOLVABLE"===j.name)throw new B("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",c,b,d)}}function E(a,b){try{if(!x(a))throw new B("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(b)b=JSON.parse(JSON.stringify(b)),z.call(this,b,a,!0);else for(var c=0;c<a.length;c++)this.validator(a[c],c)}catch(a){if(a instanceof B)return a;throw a}}var b=function(a){if(x(a)){for(var b=new Array(a.length),c=0;c<b.length;c++)b[c]=""+c;return b}if(Object.keys)return Object.keys(a);var b=[];for(var d in a)a.hasOwnProperty(d)&&b.push(d);return b},f={add:function(a,b){return a[b]=this.value,!0},remove:function(a,b){return delete a[b],!0},replace:function(a,b){return a[b]=this.value,!0},move:function(a,b,c){var d={op:"_get",path:this.from};return z(c,[d]),z(c,[{op:"remove",path:this.from}]),z(c,[{op:"add",path:this.path,value:d.value}]),!0},copy:function(a,b,c){var d={op:"_get",path:this.from};return z(c,[d]),z(c,[{op:"add",path:this.path,value:d.value}]),!0},test:function(a,b){return c(a[b],this.value)},_get:function(a,b){this.value=a[b]}},g={add:function(a,b){return a.splice(b,0,this.value),!0},remove:function(a,b){return a.splice(b,1),!0},replace:function(a,b){return a[b]=this.value,!0},move:f.move,copy:f.copy,test:f.test,_get:f._get},h={add:function(a){h.remove.call(this,a);for(var b in this.value)this.value.hasOwnProperty(b)&&(a[b]=this.value[b]);return!0},remove:function(a){for(var b in a)a.hasOwnProperty(b)&&f.remove.call(this,a,b);return!0},replace:function(a){return z(a,[{op:"remove",path:this.path}]),z(a,[{op:"add",path:this.path,value:this.value}]),!0},move:f.move,copy:f.copy,test:function(a){return JSON.stringify(a)===JSON.stringify(this.value)},_get:function(a){this.value=a}},m=[],n=function(){function a(a){this.observers=[],this.obj=a}return a}(),o=function(){function a(a,b){this.callback=a,this.observer=b}return a}();a.unobserve=s,a.observe=u,a.generate=v;var x;x=Array.isArray?Array.isArray:function(a){return a.push&&"number"==typeof a.length},a.apply=z,a.compare=A;var B=function(a){function b(b,c,d,e,f){a.call(this,b),this.message=b,this.name=c,this.index=d,this.operation=e,this.tree=f}return d(b,a),b}(e);a.JsonPatchError=B,a.Error=B,a.validator=D,a.validate=E}(f||(f={})),void 0!==c&&(c.apply=f.apply,c.observe=f.observe,c.unobserve=f.unobserve,c.generate=f.generate,c.compare=f.compare,c.validate=f.validate,c.validator=f.validator,c.JsonPatchError=f.JsonPatchError,c.Error=f.Error)},{}],moment:[function(a,b,c){!function(a,d){"object"==typeof c&&void 0!==b?b.exports=d():"function"==typeof define&&define.amd?define(d):a.moment=d()}(this,function(){"use strict";function d(){return c.apply(null,arguments)}function e(a){c=a}function f(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function g(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function h(a){var b;for(b in a)return!1;return!0}function i(a){return void 0===a}function j(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function k(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function l(a,b){var d,c=[];for(d=0;d<a.length;++d)c.push(b(a[d],d));return c}function m(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function n(a,b){for(var c in b)m(b,c)&&(a[c]=b[c]);return m(b,"toString")&&(a.toString=b.toString),m(b,"valueOf")&&(a.valueOf=b.valueOf),a}function o(a,b,c,d){return Qc(a,b,c,d,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function q(a){return null==a._pf&&(a._pf=p()),a._pf}function t(a){if(null==a._isValid){var b=q(a),c=s.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);if(a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour),null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function u(a){var b=o(NaN);return null!=a?n(q(b),a):q(b).userInvalidated=!0,b}function w(a,b){var c,d,e;if(i(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject),i(b._i)||(a._i=b._i),i(b._f)||(a._f=b._f),i(b._l)||(a._l=b._l),i(b._strict)||(a._strict=b._strict),i(b._tzm)||(a._tzm=b._tzm),i(b._isUTC)||(a._isUTC=b._isUTC),i(b._offset)||(a._offset=b._offset),i(b._pf)||(a._pf=q(b)),i(b._locale)||(a._locale=b._locale),v.length>0)for(c=0;c<v.length;c++)d=v[c],e=b[d],i(e)||(a[d]=e);return a}function y(a){w(this,a),this._d=new Date(null!=a._d?a._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===x&&(x=!0,d.updateOffset(this),x=!1)}function z(a){return a instanceof y||null!=a&&null!=a._isAMomentObject}function A(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function B(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=A(b)),c}function C(a,b,c){var g,d=Math.min(a.length,b.length),e=Math.abs(a.length-b.length),f=0;for(g=0;g<d;g++)(c&&a[g]!==b[g]||!c&&B(a[g])!==B(b[g]))&&f++;return f+e}function D(a){!1===d.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function E(a,b){var c=!0;return n(function(){if(null!=d.deprecationHandler&&d.deprecationHandler(null,a),c){for(var f,e=[],g=0;g<arguments.length;g++){if(f="","object"==typeof arguments[g]){f+="\n["+g+"] ";for(var h in arguments[0])f+=h+": "+arguments[0][h]+", ";f=f.slice(0,-2)}else f=arguments[g];e.push(f)}D(a+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack),c=!1}return b.apply(this,arguments)},b)}function G(a,b){null!=d.deprecationHandler&&d.deprecationHandler(a,b),F[a]||(D(b),F[a]=!0)}function H(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function I(a){var b,c;for(c in a)b=a[c],H(b)?this[c]=b:this["_"+c]=b;this._config=a,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function J(a,b){var d,c=n({},a);for(d in b)m(b,d)&&(g(a[d])&&g(b[d])?(c[d]={},n(c[d],a[d]),n(c[d],b[d])):null!=b[d]?c[d]=b[d]:delete c[d]);for(d in a)m(a,d)&&!m(b,d)&&g(a[d])&&(c[d]=n({},c[d]));return c}function K(a){null!=a&&this.set(a)}function O(a,b,c){var d=this._calendar[a]||this._calendar.sameElse;return H(d)?d.call(b,c):d}function Q(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function S(){return this._invalidDate}function V(a){return this._ordinal.replace("%d",a)}function X(a,b,c,d){var e=this._relativeTime[c];return H(e)?e(a,b,c,d):e.replace(/%d/i,a)}function Y(a,b){var c=this._relativeTime[a>0?"future":"past"];return H(c)?c(b):c.replace(/%s/i,b)}function $(a,b){var c=a.toLowerCase();Z[c]=Z[c+"s"]=Z[b]=a}function _(a){return"string"==typeof a?Z[a]||Z[a.toLowerCase()]:void 0}function aa(a){var c,d,b={};for(d in a)m(a,d)&&(c=_(d))&&(b[c]=a[d]);return b}function ca(a,b){ba[a]=b}function da(a){var b=[];for(var c in a)b.push({unit:c,priority:ba[c]});return b.sort(function(a,b){return a.priority-b.priority}),b}function ea(a,b){return function(c){return null!=c?(ga(this,a,c),d.updateOffset(this,b),this):fa(this,a)}}function fa(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function ga(a,b,c){a.isValid()&&a._d["set"+(a._isUTC?"UTC":"")+b](c)}function ha(a){return a=_(a),H(this[a])?this[a]():this}function ia(a,b){if("object"==typeof a){a=aa(a);for(var c=da(a),d=0;d<c.length;d++)this[c[d].unit](a[c[d].unit])}else if(a=_(a),H(this[a]))return this[a](b);return this}function ja(a,b,c){var d=""+Math.abs(a),e=b-d.length;return(a>=0?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function oa(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(na[a]=e),b&&(na[b[0]]=function(){return ja(e.apply(this,arguments),b[1],b[2])}),c&&(na[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function pa(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function qa(a){var c,d,b=a.match(ka);for(c=0,d=b.length;c<d;c++)na[b[c]]?b[c]=na[b[c]]:b[c]=pa(b[c]);return function(c){var f,e="";for(f=0;f<d;f++)e+=H(b[f])?b[f].call(c,a):b[f];return e}}function ra(a,b){return a.isValid()?(b=sa(b,a.localeData()),ma[b]=ma[b]||qa(b),ma[b](a)):a.localeData().invalidDate()}function sa(a,b){function d(a){return b.longDateFormat(a)||a}var c=5;for(la.lastIndex=0;c>=0&&la.test(a);)a=a.replace(la,d),la.lastIndex=0,c-=1;return a}function La(a,b,c){Ka[a]=H(b)?b:function(a,d){return a&&c?c:b}}function Ma(a,b){return m(Ka,a)?Ka[a](b._strict,b._locale):new RegExp(Na(a))}function Na(a){return Oa(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}))}function Oa(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qa(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),j(b)&&(d=function(a,c){c[b]=B(a)}),c=0;c<a.length;c++)Pa[a[c]]=d}function Ra(a,b){Qa(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function Sa(a,b,c){null!=b&&m(Pa,a)&&Pa[a](b,c._a,c,a)}function cb(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function fb(a,b){return a?f(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||db).test(b)?"format":"standalone"][a.month()]:f(this._months)?this._months:this._months.standalone}function hb(a,b){return a?f(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[db.test(b)?"format":"standalone"][a.month()]:f(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ib(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;d<12;++d)f=o([2e3,d]),this._shortMonthsParse[d]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(f,"").toLocaleLowerCase();return c?"MMM"===b?(e=bb.call(this._shortMonthsParse,g),-1!==e?e:null):(e=bb.call(this._longMonthsParse,g),-1!==e?e:null):"MMM"===b?-1!==(e=bb.call(this._shortMonthsParse,g))?e:(e=bb.call(this._longMonthsParse,g),-1!==e?e:null):-1!==(e=bb.call(this._longMonthsParse,g))?e:(e=bb.call(this._shortMonthsParse,g),-1!==e?e:null)}function jb(a,b,c){var d,e,f;if(this._monthsParseExact)return ib.call(this,a,b,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;d<12;d++){if(e=o([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function kb(a,b){var c;if(!a.isValid())return a;if("string"==typeof b)if(/^\d+$/.test(b))b=B(b);else if(b=a.localeData().monthsParse(b),!j(b))return a;return c=Math.min(a.date(),cb(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a}function lb(a){return null!=a?(kb(this,a),d.updateOffset(this,!0),this):fa(this,"Month")}function mb(){return cb(this.year(),this.month())}function ob(a){return this._monthsParseExact?(m(this,"_monthsRegex")||rb.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=nb),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function qb(a){return this._monthsParseExact?(m(this,"_monthsRegex")||rb.call(this),a?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=pb),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function rb(){function a(a,b){return b.length-a.length}var e,f,b=[],c=[],d=[];for(e=0;e<12;e++)f=o([2e3,e]),b.push(this.monthsShort(f,"")),c.push(this.months(f,"")),d.push(this.months(f,"")),d.push(this.monthsShort(f,""));for(b.sort(a),c.sort(a),d.sort(a),e=0;e<12;e++)b[e]=Oa(b[e]),c[e]=Oa(c[e]);for(e=0;e<24;e++)d[e]=Oa(d[e]);this._monthsRegex=new RegExp("^("+d.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+b.join("|")+")","i")}function sb(a){return tb(a)?366:365}function tb(a){return a%4==0&&a%100!=0||a%400==0}function vb(){return tb(this.year())}function wb(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<100&&a>=0&&isFinite(h.getFullYear())&&h.setFullYear(a),h}function xb(a){var b=new Date(Date.UTC.apply(null,arguments));return a<100&&a>=0&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a),b}function yb(a,b,c){var d=7+b-c;return-(7+xb(a,0,d).getUTCDay()-b)%7+d-1}function zb(a,b,c,d,e){var i,j,f=(7+c-d)%7,g=yb(a,d,e),h=1+7*(b-1)+f+g;return h<=0?(i=a-1,j=sb(i)+h):h>sb(a)?(i=a+1,j=h-sb(a)):(i=a,j=h),{year:i,dayOfYear:j}}function Ab(a,b,c){var f,g,d=yb(a.year(),b,c),e=Math.floor((a.dayOfYear()-d-1)/7)+1;return e<1?(g=a.year()-1,f=e+Bb(g,b,c)):e>Bb(a.year(),b,c)?(f=e-Bb(a.year(),b,c),g=a.year()+1):(g=a.year(),f=e),{week:f,year:g}}function Bb(a,b,c){var d=yb(a,b,c),e=yb(a+1,b,c);return(sb(a)-d+e)/7}function Cb(a){return Ab(a,this._week.dow,this._week.doy).week}function Eb(){return this._week.dow}function Fb(){return this._week.doy}function Gb(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function Hb(a){var b=Ab(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function Ib(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Jb(a,b){return"string"==typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a}function Lb(a,b){return a?f(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:f(this._weekdays)?this._weekdays:this._weekdays.standalone}function Nb(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort}function Pb(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin}function Qb(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;d<7;++d)f=o([2e3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(f,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(f,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(f,"").toLocaleLowerCase();return c?"dddd"===b?(e=bb.call(this._weekdaysParse,g),-1!==e?e:null):"ddd"===b?(e=bb.call(this._shortWeekdaysParse,g),-1!==e?e:null):(e=bb.call(this._minWeekdaysParse,g),-1!==e?e:null):"dddd"===b?-1!==(e=bb.call(this._weekdaysParse,g))?e:-1!==(e=bb.call(this._shortWeekdaysParse,g))?e:(e=bb.call(this._minWeekdaysParse,g),-1!==e?e:null):"ddd"===b?-1!==(e=bb.call(this._shortWeekdaysParse,g))?e:-1!==(e=bb.call(this._weekdaysParse,g))?e:(e=bb.call(this._minWeekdaysParse,g),-1!==e?e:null):-1!==(e=bb.call(this._minWeekdaysParse,g))?e:-1!==(e=bb.call(this._weekdaysParse,g))?e:(e=bb.call(this._shortWeekdaysParse,g),-1!==e?e:null)}function Rb(a,b,c){var d,e,f;if(this._weekdaysParseExact)return Qb.call(this,a,b,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),d=0;d<7;d++){if(e=o([2e3,1]).day(d),c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(f="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(f.replace(".",""),"i")),c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a))return d;if(c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a))return d;if(c&&"dd"===b&&this._minWeekdaysParse[d].test(a))return d;if(!c&&this._weekdaysParse[d].test(a))return d}}function Sb(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Ib(a,this.localeData()),this.add(a-b,"d")):b}function Tb(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Ub(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=Jb(a,this.localeData());return this.day(this.day()%7?b:b-7)}return this.day()||7}function Wb(a){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||_b.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=Vb),this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex)}function Yb(a){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||_b.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Xb),this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function $b(a){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||_b.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Zb),this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function _b(){function a(a,b){return b.length-a.length}var f,g,h,i,j,b=[],c=[],d=[],e=[];for(f=0;f<7;f++)g=o([2e3,1]).day(f),h=this.weekdaysMin(g,""),i=this.weekdaysShort(g,""),j=this.weekdays(g,""),b.push(h),c.push(i),d.push(j),e.push(h),e.push(i),e.push(j);for(b.sort(a),c.sort(a),d.sort(a),e.sort(a),f=0;f<7;f++)c[f]=Oa(c[f]),d[f]=Oa(d[f]),e[f]=Oa(e[f]);this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+b.join("|")+")","i")}function ac(){return this.hours()%12||12}function bc(){return this.hours()||24}function cc(a,b){oa(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function dc(a,b){return b._meridiemParse}function ec(a){return"p"===(a+"").toLowerCase().charAt(0)}function gc(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function mc(a){return a?a.toLowerCase().replace("_","-"):a}function nc(a){for(var c,d,e,f,b=0;b<a.length;){for(f=mc(a[b]).split("-"),c=f.length,d=mc(a[b+1]),d=d?d.split("-"):null;c>0;){if(e=oc(f.slice(0,c).join("-")))return e;if(d&&d.length>=c&&C(f,d,!0)>=c-1)break;c--}b++}return null}function oc(c){var d=null;if(!jc[c]&&void 0!==b&&b&&b.exports)try{d=lc._abbr,a("./locale/"+c),pc(d)}catch(a){}return jc[c]}function pc(a,b){var c;return a&&(c=i(b)?sc(a):qc(a,b))&&(lc=c),lc._abbr}function qc(a,b){if(null!==b){var c=ic;if(b.abbr=a,null!=jc[a])G("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=jc[a]._config;else if(null!=b.parentLocale){if(null==jc[b.parentLocale])return kc[b.parentLocale]||(kc[b.parentLocale]=[]),kc[b.parentLocale].push({name:a,config:b}),null;c=jc[b.parentLocale]._config}return jc[a]=new K(J(c,b)),kc[a]&&kc[a].forEach(function(a){qc(a.name,a.config)}),pc(a),jc[a]}return delete jc[a],null}function rc(a,b){if(null!=b){var c,d=ic;null!=jc[a]&&(d=jc[a]._config),b=J(d,b),c=new K(b),c.parentLocale=jc[a],jc[a]=c,pc(a)}else null!=jc[a]&&(null!=jc[a].parentLocale?jc[a]=jc[a].parentLocale:null!=jc[a]&&delete jc[a]);return jc[a]}function sc(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return lc;if(!f(a)){if(b=oc(a))return b;a=[a]}return nc(a)}function tc(){return M(jc)}function uc(a){var b,c=a._a;return c&&-2===q(a).overflow&&(b=c[Ua]<0||c[Ua]>11?Ua:c[Va]<1||c[Va]>cb(c[Ta],c[Ua])?Va:c[Wa]<0||c[Wa]>24||24===c[Wa]&&(0!==c[Xa]||0!==c[Ya]||0!==c[Za])?Wa:c[Xa]<0||c[Xa]>59?Xa:c[Ya]<0||c[Ya]>59?Ya:c[Za]<0||c[Za]>999?Za:-1,q(a)._overflowDayOfYear&&(b<Ta||b>Va)&&(b=Va),q(a)._overflowWeeks&&-1===b&&(b=$a),q(a)._overflowWeekday&&-1===b&&(b=_a),q(a).overflow=b),a}function Bc(a){var b,c,f,g,h,i,d=a._i,e=vc.exec(d)||wc.exec(d);if(e){for(q(a).iso=!0,b=0,c=yc.length;b<c;b++)if(yc[b][1].exec(e[1])){g=yc[b][0],f=!1!==yc[b][2];break}if(null==g)return void(a._isValid=!1);if(e[3]){for(b=0,c=zc.length;b<c;b++)if(zc[b][1].exec(e[3])){h=(e[2]||" ")+zc[b][0];break}if(null==h)return void(a._isValid=!1)}if(!f&&null!=h)return void(a._isValid=!1);if(e[4]){if(!xc.exec(e[4]))return void(a._isValid=!1);i="Z"}a._f=g+(h||"")+(i||""),Jc(a)}else a._isValid=!1}function Dc(a){var b,c,d,e,f,g,j,k,h={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},i="YXWVUTSRQPONZABCDEFGHIKLM";if(b=a._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),c=Cc.exec(b)){if(d=c[1]?"ddd"+(5===c[1].length?", ":" "):"",e="D MMM "+(c[2].length>10?"YYYY ":"YY "),f="HH:mm"+(c[4]?":ss":""),c[1]){var l=new Date(c[2]),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()];if(c[1].substr(0,3)!==m)return q(a).weekdayMismatch=!0,void(a._isValid=!1)}switch(c[5].length){case 2:0===k?j=" +0000":(k=i.indexOf(c[5][1].toUpperCase())-12,j=(k<0?" -":" +")+(""+k).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:j=h[c[5]];break;default:j=h[" GMT"]}c[5]=j,a._i=c.splice(1).join(""),g=" ZZ",a._f=d+e+f+g,Jc(a),q(a).rfc2822=!0}else a._isValid=!1}function Ec(a){var b=Ac.exec(a._i);if(null!==b)return void(a._d=new Date(+b[1]));Bc(a),!1===a._isValid&&(delete a._isValid,Dc(a),!1===a._isValid&&(delete a._isValid,d.createFromInputFallback(a)))}function Fc(a,b,c){return null!=a?a:null!=b?b:c}function Gc(a){var b=new Date(d.now());return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function Hc(a){var b,c,e,f,d=[];if(!a._d){for(e=Gc(a),a._w&&null==a._a[Va]&&null==a._a[Ua]&&Ic(a),null!=a._dayOfYear&&(f=Fc(a._a[Ta],e[Ta]),(a._dayOfYear>sb(f)||0===a._dayOfYear)&&(q(a)._overflowDayOfYear=!0),c=xb(f,0,a._dayOfYear),a._a[Ua]=c.getUTCMonth(),a._a[Va]=c.getUTCDate()),b=0;b<3&&null==a._a[b];++b)a._a[b]=d[b]=e[b];for(;b<7;b++)a._a[b]=d[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[Wa]&&0===a._a[Xa]&&0===a._a[Ya]&&0===a._a[Za]&&(a._nextDay=!0,a._a[Wa]=0),a._d=(a._useUTC?xb:wb).apply(null,d),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[Wa]=24)}}function Ic(a){var b,c,d,e,f,g,h,i;if(b=a._w,null!=b.GG||null!=b.W||null!=b.E)f=1,g=4,c=Fc(b.GG,a._a[Ta],Ab(Rc(),1,4).year),d=Fc(b.W,1),((e=Fc(b.E,1))<1||e>7)&&(i=!0);else{f=a._locale._week.dow,g=a._locale._week.doy;var j=Ab(Rc(),f,g);c=Fc(b.gg,a._a[Ta],j.year),d=Fc(b.w,j.week),null!=b.d?((e=b.d)<0||e>6)&&(i=!0):null!=b.e?(e=b.e+f,(b.e<0||b.e>6)&&(i=!0)):e=f}d<1||d>Bb(c,f,g)?q(a)._overflowWeeks=!0:null!=i?q(a)._overflowWeekday=!0:(h=zb(c,d,e,f,g),a._a[Ta]=h.year,a._dayOfYear=h.dayOfYear)}function Jc(a){if(a._f===d.ISO_8601)return void Bc(a);if(a._f===d.RFC_2822)return void Dc(a);a._a=[],q(a).empty=!0;var c,e,f,g,h,b=""+a._i,i=b.length,j=0;for(f=sa(a._f,a._locale).match(ka)||[],c=0;c<f.length;c++)g=f[c],e=(b.match(Ma(g,a))||[])[0],e&&(h=b.substr(0,b.indexOf(e)),h.length>0&&q(a).unusedInput.push(h),b=b.slice(b.indexOf(e)+e.length),j+=e.length),na[g]?(e?q(a).empty=!1:q(a).unusedTokens.push(g),Sa(g,e,a)):a._strict&&!e&&q(a).unusedTokens.push(g);q(a).charsLeftOver=i-j,b.length>0&&q(a).unusedInput.push(b),a._a[Wa]<=12&&!0===q(a).bigHour&&a._a[Wa]>0&&(q(a).bigHour=void 0),q(a).parsedDateParts=a._a.slice(0),q(a).meridiem=a._meridiem,a._a[Wa]=Kc(a._locale,a._a[Wa],a._meridiem),Hc(a),uc(a)}function Kc(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&b<12&&(b+=12),d||12!==b||(b=0),b):b}function Lc(a){var b,c,d,e,f;if(0===a._f.length)return q(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=w({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],Jc(b),t(b)&&(f+=q(b).charsLeftOver,f+=10*q(b).unusedTokens.length,q(b).score=f,(null==d||f<d)&&(d=f,c=b));n(a,c||b)}function Mc(a){if(!a._d){var b=aa(a._i);a._a=l([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)}),Hc(a)}}function Nc(a){var b=new y(uc(Oc(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function Oc(a){var b=a._i,c=a._f;return a._locale=a._locale||sc(a._l),null===b||void 0===c&&""===b?u({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),z(b)?new y(uc(b)):(k(b)?a._d=b:f(c)?Lc(a):c?Jc(a):Pc(a),t(a)||(a._d=null),a))}function Pc(a){var b=a._i;i(b)?a._d=new Date(d.now()):k(b)?a._d=new Date(b.valueOf()):"string"==typeof b?Ec(a):f(b)?(a._a=l(b.slice(0),function(a){return parseInt(a,10)}),Hc(a)):g(b)?Mc(a):j(b)?a._d=new Date(b):d.createFromInputFallback(a)}function Qc(a,b,c,d,e){var i={};return!0!==c&&!1!==c||(d=c,c=void 0),(g(a)&&h(a)||f(a)&&0===a.length)&&(a=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=e,i._l=c,i._i=a,i._f=b,i._strict=d,Nc(i)}function Rc(a,b,c,d){return Qc(a,b,c,d,!1)}function Uc(a,b){var c,d;if(1===b.length&&f(b[0])&&(b=b[0]),!b.length)return Rc();for(c=b[0],d=1;d<b.length;++d)b[d].isValid()&&!b[d][a](c)||(c=b[d]);return c}function Vc(){return Uc("isBefore",[].slice.call(arguments,0))}function Wc(){return Uc("isAfter",[].slice.call(arguments,0))}function Zc(a){for(var b in a)if(-1===Yc.indexOf(b)||null!=a[b]&&isNaN(a[b]))return!1;for(var c=!1,d=0;d<Yc.length;++d)if(a[Yc[d]]){if(c)return!1;parseFloat(a[Yc[d]])!==B(a[Yc[d]])&&(c=!0)}return!0}function $c(){return this._isValid}function _c(){return vd(NaN)}function ad(a){var b=aa(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._isValid=Zc(b),this._milliseconds=+k+1e3*j+6e4*i+1e3*h*60*60,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=sc(),this._bubble()}function bd(a){return a instanceof ad}function cd(a){return a<0?-1*Math.round(-1*a):Math.round(a)}function dd(a,b){oa(a,0,0,function(){var a=this.utcOffset(),c="+";return a<0&&(a=-a,c="-"),c+ja(~~(a/60),2)+b+ja(~~a%60,2)})}function fd(a,b){var c=(b||"").match(a);if(null===c)return null;var d=c[c.length-1]||[],e=(d+"").match(ed)||["-",0,0],f=60*e[1]+B(e[2]);return 0===f?0:"+"===e[0]?f:-f}function gd(a,b){var c,e;return b._isUTC?(c=b.clone(),e=(z(a)||k(a)?a.valueOf():Rc(a).valueOf())-c.valueOf(),c._d.setTime(c._d.valueOf()+e),d.updateOffset(c,!1),c):Rc(a).local()}function hd(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function id(a,b,c){var f,e=this._offset||0;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"==typeof a){if(null===(a=fd(Ha,a)))return this}else Math.abs(a)<16&&!c&&(a*=60);return!this._isUTC&&b&&(f=hd(this)),this._offset=a,this._isUTC=!0,null!=f&&this.add(f,"m"),e!==a&&(!b||this._changeInProgress?Ad(this,vd(a-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,d.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?e:hd(this)}function jd(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function kd(a){return this.utcOffset(0,a)}function ld(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(hd(this),"m")),this}function md(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var a=fd(Ga,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this}function nd(a){return!!this.isValid()&&(a=a?Rc(a).utcOffset():0,(this.utcOffset()-a)%60==0)}function od(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pd(){if(!i(this._isDSTShifted))return this._isDSTShifted;var a={};if(w(a,this),a=Oc(a),a._a){var b=a._isUTC?o(a._a):Rc(a._a);this._isDSTShifted=this.isValid()&&C(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function qd(){return!!this.isValid()&&!this._isUTC}function rd(){return!!this.isValid()&&this._isUTC}function sd(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function vd(a,b){var e,f,g,c=a,d=null;return bd(a)?c={ms:a._milliseconds,d:a._days,M:a._months}:j(a)?(c={},b?c[b]=a:c.milliseconds=a):(d=td.exec(a))?(e="-"===d[1]?-1:1,c={y:0,d:B(d[Va])*e,h:B(d[Wa])*e,m:B(d[Xa])*e,s:B(d[Ya])*e,ms:B(cd(1e3*d[Za]))*e}):(d=ud.exec(a))?(e="-"===d[1]?-1:1,c={y:wd(d[2],e),M:wd(d[3],e),w:wd(d[4],e),d:wd(d[5],e),h:wd(d[6],e),m:wd(d[7],e),s:wd(d[8],e)}):null==c?c={}:"object"==typeof c&&("from"in c||"to"in c)&&(g=yd(Rc(c.from),Rc(c.to)),c={},c.ms=g.milliseconds,c.M=g.months),f=new ad(c),bd(a)&&m(a,"_locale")&&(f._locale=a._locale),f}function wd(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function xd(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function yd(a,b){var c;return a.isValid()&&b.isValid()?(b=gd(b,a),a.isBefore(b)?c=xd(a,b):(c=xd(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function zd(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(G(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=vd(c,d),Ad(this,e,a),this}}function Ad(a,b,c,e){var f=b._milliseconds,g=cd(b._days),h=cd(b._months);a.isValid()&&(e=null==e||e,f&&a._d.setTime(a._d.valueOf()+f*c),g&&ga(a,"Date",fa(a,"Date")+g*c),h&&kb(a,fa(a,"Month")+h*c),e&&d.updateOffset(a,g||h))}function Dd(a,b){var c=a.diff(b,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function Ed(a,b){var c=a||Rc(),e=gd(c,this).startOf("day"),f=d.calendarFormat(this,e)||"sameElse",g=b&&(H(b[f])?b[f].call(this,c):b[f]);return this.format(g||this.localeData().calendar(f,this,Rc(c)))}function Fd(){return new y(this)}function Gd(a,b){var c=z(a)?a:Rc(a);return!(!this.isValid()||!c.isValid())&&(b=_(i(b)?"millisecond":b),"millisecond"===b?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(b).valueOf())}function Hd(a,b){var c=z(a)?a:Rc(a);return!(!this.isValid()||!c.isValid())&&(b=_(i(b)?"millisecond":b),"millisecond"===b?this.valueOf()<c.valueOf():this.clone().endOf(b).valueOf()<c.valueOf())}function Id(a,b,c,d){return d=d||"()",("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))}function Jd(a,b){var d,c=z(a)?a:Rc(a);return!(!this.isValid()||!c.isValid())&&(b=_(b||"millisecond"),"millisecond"===b?this.valueOf()===c.valueOf():(d=c.valueOf(),this.clone().startOf(b).valueOf()<=d&&d<=this.clone().endOf(b).valueOf()))}function Kd(a,b){return this.isSame(a,b)||this.isAfter(a,b)}function Ld(a,b){return this.isSame(a,b)||this.isBefore(a,b)}function Md(a,b,c){var d,e,f,g;return this.isValid()?(d=gd(a,this),d.isValid()?(e=6e4*(d.utcOffset()-this.utcOffset()),b=_(b),"year"===b||"month"===b||"quarter"===b?(g=Nd(this,d),"quarter"===b?g/=3:"year"===b&&(g/=12)):(f=this-d,g="second"===b?f/1e3:"minute"===b?f/6e4:"hour"===b?f/36e5:"day"===b?(f-e)/864e5:"week"===b?(f-e)/6048e5:f),c?g:A(g)):NaN):NaN}function Nd(a,b){var e,f,c=12*(b.year()-a.year())+(b.month()-a.month()),d=a.clone().add(c,"months");return b-d<0?(e=a.clone().add(c-1,"months"),f=(b-d)/(d-e)):(e=a.clone().add(c+1,"months"),f=(b-d)/(e-d)),-(c+f)||0}function Od(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Pd(){if(!this.isValid())return null;var a=this.clone().utc();return a.year()<0||a.year()>9999?ra(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):H(Date.prototype.toISOString)?this.toDate().toISOString():ra(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function Qd(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var c="["+a+'("]',d=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",f=b+'[")]';return this.format(c+d+"-MM-DD[T]HH:mm:ss.SSS"+f)}function Rd(a){a||(a=this.isUtc()?d.defaultFormatUtc:d.defaultFormat);var b=ra(this,a);return this.localeData().postformat(b)}function Sd(a,b){return this.isValid()&&(z(a)&&a.isValid()||Rc(a).isValid())?vd({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function Td(a){return this.from(Rc(),a)}function Ud(a,b){return this.isValid()&&(z(a)&&a.isValid()||Rc(a).isValid())?vd({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function Vd(a){return this.to(Rc(),a)}function Wd(a){var b;return void 0===a?this._locale._abbr:(b=sc(a),null!=b&&(this._locale=b),this)}function Yd(){return this._locale}function Zd(a){switch(a=_(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function $d(a){return void 0===(a=_(a))||"millisecond"===a?this:("date"===a&&(a="day"),this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms"))}function _d(){return this._d.valueOf()-6e4*(this._offset||0)}function ae(){return Math.floor(this.valueOf()/1e3)}function be(){return new Date(this.valueOf())}function ce(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function de(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function ee(){return this.isValid()?this.toISOString():null}function fe(){return t(this)}function ge(){return n({},q(this))}function he(){return q(this).overflow}function ie(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function je(a,b){oa(0,[a,a.length],0,b)}function ke(a){return oe.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function le(a){return oe.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)}function me(){return Bb(this.year(),1,4)}function ne(){var a=this.localeData()._week;return Bb(this.year(),a.dow,a.doy)}function oe(a,b,c,d,e){var f;return null==a?Ab(this,d,e).year:(f=Bb(a,d,e),b>f&&(b=f),pe.call(this,a,b,c,d,e))}function pe(a,b,c,d,e){var f=zb(a,b,c,d,e),g=xb(f.year,0,f.dayOfYear);return this.year(g.getUTCFullYear()),this.month(g.getUTCMonth()),this.date(g.getUTCDate()),this}function qe(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function se(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function we(a,b){b[Za]=B(1e3*("0."+a))}function ye(){return this._isUTC?"UTC":""}function ze(){return this._isUTC?"Coordinated Universal Time":""}function Be(a){return Rc(1e3*a)}function Ce(){return Rc.apply(null,arguments).parseZone()}function De(a){return a}function Fe(a,b,c,d){var e=sc(),f=o().set(d,b);return e[c](f,a)}function Ge(a,b,c){if(j(a)&&(b=a,a=void 0),a=a||"",null!=b)return Fe(a,b,c,"month");var d,e=[];for(d=0;d<12;d++)e[d]=Fe(a,d,c,"month");return e}function He(a,b,c,d){"boolean"==typeof a?(j(b)&&(c=b,b=void 0),b=b||""):(b=a,c=b,a=!1,j(b)&&(c=b,b=void 0),b=b||"");var e=sc(),f=a?e._week.dow:0;if(null!=c)return Fe(b,(c+f)%7,d,"day");var g,h=[];for(g=0;g<7;g++)h[g]=Fe(b,(g+f)%7,d,"day");return h}function Ie(a,b){return Ge(a,b,"months")}function Je(a,b){return Ge(a,b,"monthsShort")}function Ke(a,b,c){return He(a,b,c,"weekdays")}function Le(a,b,c){return He(a,b,c,"weekdaysShort")}function Me(a,b,c){return He(a,b,c,"weekdaysMin")}function Oe(){var a=this._data;return this._milliseconds=Ne(this._milliseconds),this._days=Ne(this._days),this._months=Ne(this._months),a.milliseconds=Ne(a.milliseconds),a.seconds=Ne(a.seconds),a.minutes=Ne(a.minutes),a.hours=Ne(a.hours),a.months=Ne(a.months),a.years=Ne(a.years),this}function Pe(a,b,c,d){var e=vd(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function Qe(a,b){return Pe(this,a,b,1)}function Re(a,b){return Pe(this,a,b,-1)}function Se(a){return a<0?Math.floor(a):Math.ceil(a)}function Te(){var e,f,g,h,i,a=this._milliseconds,b=this._days,c=this._months,d=this._data;return a>=0&&b>=0&&c>=0||a<=0&&b<=0&&c<=0||(a+=864e5*Se(Ve(c)+b),b=0,c=0),d.milliseconds=a%1e3,e=A(a/1e3),d.seconds=e%60,f=A(e/60),d.minutes=f%60,g=A(f/60),d.hours=g%24,b+=A(g/24),i=A(Ue(b)),c+=i,b-=Se(Ve(i)),h=A(c/12),c%=12,d.days=b,d.months=c,d.years=h,this}function Ue(a){return 4800*a/146097}function Ve(a){return 146097*a/4800}function We(a){if(!this.isValid())return NaN;var b,c,d=this._milliseconds;if("month"===(a=_(a))||"year"===a)return b=this._days+d/864e5,c=this._months+Ue(b),"month"===a?c:c/12;switch(b=this._days+Math.round(Ve(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function Xe(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*B(this._months/12):NaN}function Ye(a){return function(){return this.as(a)}}function ff(a){return a=_(a),this.isValid()?this[a+"s"]():NaN}function gf(a){return function(){return this.isValid()?this._data[a]:NaN}}function pf(){return A(this.days()/7)}function sf(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function tf(a,b,c){var d=vd(a).abs(),e=qf(d.as("s")),f=qf(d.as("m")),g=qf(d.as("h")),h=qf(d.as("d")),i=qf(d.as("M")),j=qf(d.as("y")),k=e<=rf.ss&&["s",e]||e<rf.s&&["ss",e]||f<=1&&["m"]||f<rf.m&&["mm",f]||g<=1&&["h"]||g<rf.h&&["hh",g]||h<=1&&["d"]||h<rf.d&&["dd",h]||i<=1&&["M"]||i<rf.M&&["MM",i]||j<=1&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,sf.apply(null,k)}function uf(a){return void 0===a?qf:"function"==typeof a&&(qf=a,!0)}function vf(a,b){return void 0!==rf[a]&&(void 0===b?rf[a]:(rf[a]=b,"s"===a&&(rf.ss=b-1),!0))}function wf(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),c=tf(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function yf(){if(!this.isValid())return this.localeData().invalidDate();var d,e,f,a=xf(this._milliseconds)/1e3,b=xf(this._days),c=xf(this._months);d=A(a/60),e=A(d/60),a%=60,d%=60,f=A(c/12),c%=12;var g=f,h=c,i=b,j=e,k=d,l=a,m=this.asSeconds();return m?(m<0?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var c,r;r=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var s=r,v=d.momentProperties=[],x=!1,F={};d.suppressDeprecationWarnings=!1,d.deprecationHandler=null;var L;L=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)m(a,b)&&c.push(b);return c};var ab,M=L,N={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},P={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},R="Invalid date",T="%d",U=/\d{1,2}/,W={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Z={},ba={},ka=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,la=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ma={},na={},ta=/\d/,ua=/\d\d/,va=/\d{3}/,wa=/\d{4}/,xa=/[+-]?\d{6}/,ya=/\d\d?/,za=/\d\d\d\d?/,Aa=/\d\d\d\d\d\d?/,Ba=/\d{1,3}/,Ca=/\d{1,4}/,Da=/[+-]?\d{1,6}/,Ea=/\d+/,Fa=/[+-]?\d+/,Ga=/Z|[+-]\d\d:?\d\d/gi,Ha=/Z|[+-]\d\d(?::?\d\d)?/gi,Ia=/[+-]?\d+(\.\d{1,3})?/,Ja=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ka={},Pa={},Ta=0,Ua=1,Va=2,Wa=3,Xa=4,Ya=5,Za=6,$a=7,_a=8;ab=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};var bb=ab;oa("M",["MM",2],"Mo",function(){return this.month()+1}),oa("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),oa("MMMM",0,0,function(a){return this.localeData().months(this,a)}),$("month","M"),ca("month",8),La("M",ya),La("MM",ya,ua),La("MMM",function(a,b){return b.monthsShortRegex(a)}),La("MMMM",function(a,b){return b.monthsRegex(a)}),Qa(["M","MM"],function(a,b){b[Ua]=B(a)-1}),Qa(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[Ua]=e:q(c).invalidMonth=a});var db=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,eb="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),gb="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nb=Ja,pb=Ja;oa("Y",0,0,function(){var a=this.year();return a<=9999?""+a:"+"+a}),oa(0,["YY",2],0,function(){return this.year()%100}),oa(0,["YYYY",4],0,"year"),oa(0,["YYYYY",5],0,"year"),oa(0,["YYYYYY",6,!0],0,"year"),$("year","y"),ca("year",1),La("Y",Fa),La("YY",ya,ua),La("YYYY",Ca,wa),La("YYYYY",Da,xa),La("YYYYYY",Da,xa),Qa(["YYYYY","YYYYYY"],Ta),Qa("YYYY",function(a,b){b[Ta]=2===a.length?d.parseTwoDigitYear(a):B(a)}),Qa("YY",function(a,b){b[Ta]=d.parseTwoDigitYear(a)}),Qa("Y",function(a,b){b[Ta]=parseInt(a,10)}),d.parseTwoDigitYear=function(a){return B(a)+(B(a)>68?1900:2e3)};var ub=ea("FullYear",!0);oa("w",["ww",2],"wo","week"),oa("W",["WW",2],"Wo","isoWeek"),$("week","w"),$("isoWeek","W"),ca("week",5),ca("isoWeek",5),La("w",ya),La("ww",ya,ua),La("W",ya),La("WW",ya,ua),Ra(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=B(a)});var Db={dow:0,doy:6};oa("d",0,"do","day"),oa("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),oa("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),oa("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),oa("e",0,0,"weekday"),oa("E",0,0,"isoWeekday"),$("day","d"),$("weekday","e"),$("isoWeekday","E"),ca("day",11),ca("weekday",11),ca("isoWeekday",11),La("d",ya),La("e",ya),La("E",ya),La("dd",function(a,b){return b.weekdaysMinRegex(a)}),La("ddd",function(a,b){return b.weekdaysShortRegex(a)}),La("dddd",function(a,b){return b.weekdaysRegex(a)}),Ra(["dd","ddd","dddd"],function(a,b,c,d){var e=c._locale.weekdaysParse(a,d,c._strict);null!=e?b.d=e:q(c).invalidWeekday=a}),Ra(["d","e","E"],function(a,b,c,d){b[d]=B(a)});var Kb="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Mb="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ob="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Vb=Ja,Xb=Ja,Zb=Ja;oa("H",["HH",2],0,"hour"),oa("h",["hh",2],0,ac),oa("k",["kk",2],0,bc),oa("hmm",0,0,function(){return""+ac.apply(this)+ja(this.minutes(),2)}),oa("hmmss",0,0,function(){return""+ac.apply(this)+ja(this.minutes(),2)+ja(this.seconds(),2)}),oa("Hmm",0,0,function(){return""+this.hours()+ja(this.minutes(),2)}),oa("Hmmss",0,0,function(){return""+this.hours()+ja(this.minutes(),2)+ja(this.seconds(),2)}),cc("a",!0),cc("A",!1),$("hour","h"),ca("hour",13),La("a",dc),La("A",dc),La("H",ya),La("h",ya),La("k",ya),La("HH",ya,ua),La("hh",ya,ua),La("kk",ya,ua),La("hmm",za),La("hmmss",Aa),La("Hmm",za),La("Hmmss",Aa),Qa(["H","HH"],Wa),Qa(["k","kk"],function(a,b,c){var d=B(a);b[Wa]=24===d?0:d}),Qa(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),Qa(["h","hh"],function(a,b,c){b[Wa]=B(a),q(c).bigHour=!0}),Qa("hmm",function(a,b,c){var d=a.length-2;b[Wa]=B(a.substr(0,d)),b[Xa]=B(a.substr(d)),q(c).bigHour=!0}),Qa("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[Wa]=B(a.substr(0,d)),b[Xa]=B(a.substr(d,2)),b[Ya]=B(a.substr(e)),q(c).bigHour=!0}),Qa("Hmm",function(a,b,c){var d=a.length-2;b[Wa]=B(a.substr(0,d)),b[Xa]=B(a.substr(d))}),Qa("Hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[Wa]=B(a.substr(0,d)),b[Xa]=B(a.substr(d,2)),b[Ya]=B(a.substr(e))});var lc,fc=/[ap]\.?m?\.?/i,hc=ea("Hours",!0),ic={calendar:N,longDateFormat:P,invalidDate:R,ordinal:T,dayOfMonthOrdinalParse:U,relativeTime:W,months:eb,monthsShort:gb,week:Db,weekdays:Kb,weekdaysMin:Ob,weekdaysShort:Mb,meridiemParse:fc},jc={},kc={},vc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xc=/Z|[+-]\d\d(?::?\d\d)?/,yc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],zc=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ac=/^\/?Date\((\-?\d+)/i,Cc=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;d.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),d.ISO_8601=function(){},d.RFC_2822=function(){};var Sc=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=Rc.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:u()}),Tc=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=Rc.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:u()}),Xc=function(){return Date.now?Date.now():+new Date},Yc=["year","quarter","month","week","day","hour","minute","second","millisecond"];dd("Z",":"),dd("ZZ",""),La("Z",Ha),La("ZZ",Ha),Qa(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=fd(Ha,a)});var ed=/([\+\-]|\d\d)/gi;d.updateOffset=function(){};var td=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,ud=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;vd.fn=ad.prototype,vd.invalid=_c;var Bd=zd(1,"add"),Cd=zd(-1,"subtract");d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xd=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});oa(0,["gg",2],0,function(){return this.weekYear()%100}),oa(0,["GG",2],0,function(){return this.isoWeekYear()%100}),je("gggg","weekYear"),je("ggggg","weekYear"),je("GGGG","isoWeekYear"),je("GGGGG","isoWeekYear"),$("weekYear","gg"),$("isoWeekYear","GG"),ca("weekYear",1),ca("isoWeekYear",1),La("G",Fa),La("g",Fa),La("GG",ya,ua),La("gg",ya,ua),La("GGGG",Ca,wa),La("gggg",Ca,wa),La("GGGGG",Da,xa),La("ggggg",Da,xa),Ra(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=B(a)}),Ra(["gg","GG"],function(a,b,c,e){b[e]=d.parseTwoDigitYear(a)}),oa("Q",0,"Qo","quarter"),$("quarter","Q"),ca("quarter",7),La("Q",ta),Qa("Q",function(a,b){b[Ua]=3*(B(a)-1)}),oa("D",["DD",2],"Do","date"),$("date","D"),ca("date",9),La("D",ya),La("DD",ya,ua),La("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient}),Qa(["D","DD"],Va),Qa("Do",function(a,b){b[Va]=B(a.match(ya)[0],10)});var re=ea("Date",!0);oa("DDD",["DDDD",3],"DDDo","dayOfYear"),$("dayOfYear","DDD"),ca("dayOfYear",4),La("DDD",Ba),La("DDDD",va),Qa(["DDD","DDDD"],function(a,b,c){c._dayOfYear=B(a)}),oa("m",["mm",2],0,"minute"),$("minute","m"),ca("minute",14),La("m",ya),La("mm",ya,ua),Qa(["m","mm"],Xa);var te=ea("Minutes",!1);oa("s",["ss",2],0,"second"),$("second","s"),ca("second",15),La("s",ya),La("ss",ya,ua),Qa(["s","ss"],Ya);var ue=ea("Seconds",!1);oa("S",0,0,function(){return~~(this.millisecond()/100)}),oa(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),oa(0,["SSS",3],0,"millisecond"),oa(0,["SSSS",4],0,function(){return 10*this.millisecond()}),oa(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),oa(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),oa(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),oa(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),oa(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),$("millisecond","ms"),ca("millisecond",16),La("S",Ba,ta),La("SS",Ba,ua),La("SSS",Ba,va);var ve;for(ve="SSSS";ve.length<=9;ve+="S")La(ve,Ea);for(ve="S";ve.length<=9;ve+="S")Qa(ve,we);var xe=ea("Milliseconds",!1);oa("z",0,0,"zoneAbbr"),oa("zz",0,0,"zoneName");var Ae=y.prototype;Ae.add=Bd,Ae.calendar=Ed,Ae.clone=Fd,Ae.diff=Md,Ae.endOf=$d,Ae.format=Rd,Ae.from=Sd,Ae.fromNow=Td,Ae.to=Ud,Ae.toNow=Vd,Ae.get=ha,Ae.invalidAt=he,Ae.isAfter=Gd,Ae.isBefore=Hd,Ae.isBetween=Id,Ae.isSame=Jd,Ae.isSameOrAfter=Kd,Ae.isSameOrBefore=Ld,Ae.isValid=fe,Ae.lang=Xd,Ae.locale=Wd,Ae.localeData=Yd,Ae.max=Tc,Ae.min=Sc,Ae.parsingFlags=ge,Ae.set=ia,Ae.startOf=Zd,Ae.subtract=Cd,Ae.toArray=ce,Ae.toObject=de,Ae.toDate=be,Ae.toISOString=Pd,Ae.inspect=Qd,Ae.toJSON=ee,Ae.toString=Od,Ae.unix=ae,Ae.valueOf=_d,Ae.creationData=ie,Ae.year=ub,Ae.isLeapYear=vb,Ae.weekYear=ke,Ae.isoWeekYear=le,Ae.quarter=Ae.quarters=qe,Ae.month=lb,Ae.daysInMonth=mb,Ae.week=Ae.weeks=Gb,Ae.isoWeek=Ae.isoWeeks=Hb,Ae.weeksInYear=ne,Ae.isoWeeksInYear=me,Ae.date=re,Ae.day=Ae.days=Sb,Ae.weekday=Tb,Ae.isoWeekday=Ub,Ae.dayOfYear=se,Ae.hour=Ae.hours=hc,Ae.minute=Ae.minutes=te,Ae.second=Ae.seconds=ue,Ae.millisecond=Ae.milliseconds=xe,Ae.utcOffset=id,Ae.utc=kd,Ae.local=ld,Ae.parseZone=md,Ae.hasAlignedHourOffset=nd,Ae.isDST=od,Ae.isLocal=qd,Ae.isUtcOffset=rd,Ae.isUtc=sd,Ae.isUTC=sd,Ae.zoneAbbr=ye,Ae.zoneName=ze,Ae.dates=E("dates accessor is deprecated. Use date instead.",re),Ae.months=E("months accessor is deprecated. Use month instead",lb),Ae.years=E("years accessor is deprecated. Use year instead",ub),Ae.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jd),Ae.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pd);var Ee=K.prototype;Ee.calendar=O,Ee.longDateFormat=Q,Ee.invalidDate=S,Ee.ordinal=V,Ee.preparse=De,Ee.postformat=De,Ee.relativeTime=X,Ee.pastFuture=Y,Ee.set=I,Ee.months=fb,Ee.monthsShort=hb,Ee.monthsParse=jb,Ee.monthsRegex=qb,Ee.monthsShortRegex=ob,Ee.week=Cb,Ee.firstDayOfYear=Fb,Ee.firstDayOfWeek=Eb,Ee.weekdays=Lb,Ee.weekdaysMin=Pb,Ee.weekdaysShort=Nb,Ee.weekdaysParse=Rb,Ee.weekdaysRegex=Wb,Ee.weekdaysShortRegex=Yb,Ee.weekdaysMinRegex=$b,Ee.isPM=ec,Ee.meridiem=gc,pc("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10;return a+(1===B(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),d.lang=E("moment.lang is deprecated. Use moment.locale instead.",pc),d.langData=E("moment.langData is deprecated. Use moment.localeData instead.",sc);var Ne=Math.abs,Ze=Ye("ms"),$e=Ye("s"),_e=Ye("m"),af=Ye("h"),bf=Ye("d"),cf=Ye("w"),df=Ye("M"),ef=Ye("y"),hf=gf("milliseconds"),jf=gf("seconds"),kf=gf("minutes"),lf=gf("hours"),mf=gf("days"),nf=gf("months"),of=gf("years"),qf=Math.round,rf={ss:44,s:45,m:45,h:22,d:26,M:11},xf=Math.abs,zf=ad.prototype;return zf.isValid=$c,zf.abs=Oe,zf.add=Qe,zf.subtract=Re,zf.as=We,zf.asMilliseconds=Ze,zf.asSeconds=$e,zf.asMinutes=_e,zf.asHours=af,zf.asDays=bf,zf.asWeeks=cf,zf.asMonths=df,zf.asYears=ef,zf.valueOf=Xe,zf._bubble=Te,zf.get=ff,zf.milliseconds=hf,zf.seconds=jf,zf.minutes=kf,zf.hours=lf,zf.days=mf,zf.weeks=pf,zf.months=nf,zf.years=of,zf.humanize=wf,zf.toISOString=yf,zf.toString=yf,zf.toJSON=yf,zf.locale=Wd,zf.localeData=Yd,zf.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",yf),zf.lang=Xd,oa("X",0,0,"unix"),oa("x",0,0,"valueOf"),La("x",Fa),La("X",Ia),Qa("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),Qa("x",function(a,b,c){c._d=new Date(B(a))}),d.version="2.18.1",e(Rc),d.fn=Ae,d.min=Vc,d.max=Wc,d.now=Xc,d.utc=o,d.unix=Be,d.months=Ie,d.isDate=k,d.locale=pc,d.invalid=u,d.duration=vd,d.isMoment=z,d.weekdays=Ke,d.parseZone=Ce,d.localeData=sc,d.isDuration=bd,d.monthsShort=Je,d.weekdaysMin=Me,d.defineLocale=qc,d.updateLocale=rc,d.locales=tc,d.weekdaysShort=Le,d.normalizeUnits=_,d.relativeTimeRounding=uf,d.relativeTimeThreshold=vf,d.calendarFormat=Dd,d.prototype=Ae,d})},{}],numbro:[function(a,b,c){(function(){"use strict";function q(a){this._value=a}function r(a){return 0===a?1:Math.floor(Math.log(Math.abs(a))/Math.LN10)+1}function s(a){var b,c="";for(b=0;b<a;b++)c+="0";return c}function t(a,b){var c,d,e,f,g,h,i,j;return j=a.toString(),c=j.split("e")[0],f=j.split("e")[1],d=c.split(".")[0],e=c.split(".")[1]||"",+f>0?j=d+e+s(f-e.length):(g=+d<0?"-0":"0",b>0&&(g+="."),i=s(-1*f-1),h=(i+Math.abs(d)+e).substr(0,b),j=g+h),+f>0&&b>0&&(j+="."+s(b)),j}function u(a,b,c,d){var f,g,e=Math.pow(10,b);return a.toString().indexOf("e")>-1?(g=t(a,b),"-"===g.charAt(0)&&+g>=0&&(g=g.substr(1))):g=(c(a+"e+"+b)/e).toFixed(b),d&&(f=new RegExp("0{1,"+d+"}$"),g=g.replace(f,"")),g}function v(a,b,c){var e=b.replace(/\{[^\{\}]*\}/g,"");return e.indexOf("$")>-1?x(a,i[k].currency.symbol,b,c):e.indexOf("%")>-1?z(a,b,c):e.indexOf(":")>-1?A(a,b):D(a._value,b,c)}function w(a,b){var d,g,h,j,n,c=b,m=!1;if(b.indexOf(":")>-1)a._value=B(b);else if(b===l)a._value=0;else{for("."!==i[k].delimiters.decimal&&(b=b.replace(/\./g,"").replace(i[k].delimiters.decimal,".")),d=new RegExp("[^a-zA-Z]"+i[k].abbreviations.thousand+"(?:\\)|(\\"+i[k].currency.symbol+")?(?:\\))?)?$"),g=new RegExp("[^a-zA-Z]"+i[k].abbreviations.million+"(?:\\)|(\\"+i[k].currency.symbol+")?(?:\\))?)?$"),h=new RegExp("[^a-zA-Z]"+i[k].abbreviations.billion+"(?:\\)|(\\"+i[k].currency.symbol+")?(?:\\))?)?$"),j=new RegExp("[^a-zA-Z]"+i[k].abbreviations.trillion+"(?:\\)|(\\"+i[k].currency.symbol+")?(?:\\))?)?$"),n=1;n<e.length&&!m;++n)b.indexOf(e[n])>-1?m=Math.pow(1024,n):b.indexOf(f[n])>-1&&(m=Math.pow(1e3,n));var o=b.replace(/[^0-9\.]+/g,"");""===o?a._value=NaN:(a._value=(m||1)*(c.match(d)?Math.pow(10,3):1)*(c.match(g)?Math.pow(10,6):1)*(c.match(h)?Math.pow(10,9):1)*(c.match(j)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(o),a._value=m?Math.ceil(a._value):a._value)}return a._value}function x(a,b,c,d){var n,o,e=c,f=e.indexOf("$"),g=e.indexOf("("),h=e.indexOf("+"),j=e.indexOf("-"),l="",m="";if(-1===e.indexOf("$")?"infix"===i[k].currency.position?(m=b,i[k].currency.spaceSeparated&&(m=" "+m+" ")):i[k].currency.spaceSeparated&&(l=" "):e.indexOf(" $")>-1?(l=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(l=" ",e=e.replace("$ ","")):e=e.replace("$",""),o=D(a._value,e,d,m),-1===c.indexOf("$"))switch(i[k].currency.position){case"postfix":o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,l+b),o=o.join("")):o=o+l+b;break;case"infix":break;case"prefix":o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),n=Math.max(g,j)+1,o.splice(n,0,b+l),o=o.join("")):o=b+l+o;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else f<=1?o.indexOf("(")>-1||o.indexOf("+")>-1||o.indexOf("-")>-1?(o=o.split(""),n=1,(f<g||f<h||f<j)&&(n=0),o.splice(n,0,b+l),o=o.join("")):o=b+l+o:o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,l+b),o=o.join("")):o=o+l+b;return o}function y(a,b,c,d){return x(a,b,c,d)}function z(a,b,c){var e,d="",f=100*a._value;return b.indexOf(" %")>-1?(d=" ",b=b.replace(" %","")):b=b.replace("%",""),e=D(f,b,c),e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,d+"%"),e=e.join("")):e=e+d+"%",e}function A(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(c<10?"0"+c:c)+":"+(d<10?"0"+d:d)}function B(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function C(a,b,c){var e,f,g,d=b[0],h=Math.abs(a);if(h>=c){for(e=1;e<b.length;++e)if(f=Math.pow(c,e),g=Math.pow(c,e+1),h>=f&&h<g){d=b[e],a/=f;break}d===b[0]&&(a/=Math.pow(c,b.length-1),d=b[b.length-1])}return{value:a,suffix:d}}function D(a,b,c,d){var v,w,z,A,B,D,E,F,G,H,I,J,N,O,Q,R,e=!1,f=!1,g=!1,j="",m=!1,n=!1,o=!1,p=!1,q=!1,t="",x="",y=Math.abs(a),K="",L=!1,M=!1,P="";if(0===a&&null!==l)return l;if(!isFinite(a))return""+a;if(0===b.indexOf("{")){var S=b.indexOf("}");if(-1===S)throw Error('Format should also contain a "}"');H=b.slice(1,S),b=b.slice(S+1)}else H="";if(b.indexOf("}")===b.length-1&&b.length){var T=b.indexOf("{");if(-1===T)throw Error('Format should also contain a "{"');I=b.slice(T+1,-1),b=b.slice(0,T+1)}else I="";var U;for(U=-1===b.indexOf(".")?b.match(/([0-9]+).*/):b.match(/([0-9]+)\..*/),Q=null===U?-1:U[1].length,-1!==b.indexOf("-")&&(L=!0),b.indexOf("(")>-1?(e=!0,b=b.slice(1,-1)):b.indexOf("+")>-1&&(f=!0,b=b.replace(/\+/g,"")),b.indexOf("a")>-1&&(F=b.split(".")[0].match(/[0-9]+/g)||["0"],F=parseInt(F[0],10),m=b.indexOf("aK")>=0,n=b.indexOf("aM")>=0,o=b.indexOf("aB")>=0,p=b.indexOf("aT")>=0,q=m||n||o||p,b.indexOf(" a")>-1?(j=" ",b=b.replace(" a","")):b=b.replace("a",""),z=r(a),B=z%3,B=0===B?3:B,F&&0!==y&&(D=3*~~((Math.min(F,z)-B)/3),y/=Math.pow(10,D)),z!==F&&(y>=Math.pow(10,12)&&!q||p?(j+=i[k].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!q||o?(j+=i[k].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!q||n?(j+=i[k].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!q||m)&&(j+=i[k].abbreviations.thousand,a/=Math.pow(10,3))),A=r(a),F&&A<F&&-1===b.indexOf(".")&&(b+="[.]",b+=s(F-A))),R=0;R<h.length;++R)if(v=h[R],b.indexOf(v.marker)>-1){b.indexOf(" "+v.marker)>-1&&(t=" "),b=b.replace(t+v.marker,""),w=C(a,v.suffixes,v.scale),a=w.value,t+=w.suffix;break}if(b.indexOf("o")>-1&&(b.indexOf(" o")>-1?(x=" ",b=b.replace(" o","")):b=b.replace("o",""),i[k].ordinal&&(x+=i[k].ordinal(a))),b.indexOf("[.]")>-1&&(g=!0,b=b.replace("[.]",".")),G=b.split(".")[1],J=b.indexOf(","),G){var V=[];if(-1!==G.indexOf("*")?(K=a.toString(),V=K.split("."),V.length>1&&(K=u(a,V[1].length,c))):G.indexOf("[")>-1?(G=G.replace("]",""),G=G.split("["),K=u(a,G[0].length+G[1].length,c,G[1].length)):K=u(a,G.length,c),V=K.split("."),E=V[0],V.length>1&&V[1].length){K=(d?j+d:i[k].delimiters.decimal)+V[1]}else K="";g&&0===Number(K.slice(1))&&(K="")}else E=u(a,0,c);return E.indexOf("-")>-1&&(E=E.slice(1),M=!0),E.length<Q&&(E=s(Q-E.length)+E),J>-1&&(E=E.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+i[k].delimiters.thousands)),0===b.indexOf(".")&&(E=""),N=b.indexOf("("),O=b.indexOf("-"),P=N<O?(e&&M?"(":"")+(L&&M||!e&&M?"-":""):(L&&M||!e&&M?"-":"")+(e&&M?"(":""),H+P+(!M&&f&&0!==a?"+":"")+E+K+(x||"")+(j&&!d?j:"")+(t||"")+(e&&M?")":"")+I}function E(a,b){i[a]=b}function F(a){k=a;var b=i[a].defaults;b&&b.format&&c.defaultFormat(b.format),b&&b.currencyFormat&&c.defaultCurrencyFormat(b.currencyFormat)}function G(){return"undefined"!=typeof process&&void 0===process.browser&&process.title&&(-1!==process.title.indexOf("node")||process.title.indexOf("meteor-tool")>0||"grunt"===process.title||"gulp"===process.title)&&void 0!==a}function H(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function I(){return Array.prototype.slice.call(arguments).reduce(function(a,b){var c=H(a),d=H(b);return c>d?c:d},-1/0)}var c,e=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],f=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g={general:{scale:1024,suffixes:f,marker:"bd"},binary:{scale:1024,suffixes:e,marker:"b"},decimal:{scale:1e3,suffixes:f,marker:"d"}},h=[g.general,g.binary,g.decimal],i={},j=i,k="en-US",l=null,m="0,0",n="0$",o=void 0!==b&&b.exports,p={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};c=function(a){return a=c.isNumbro(a)?a.value():"string"==typeof a||"number"==typeof a?c.fn.unformat(a):NaN,new q(Number(a))},c.version="1.10.1",c.isNumbro=function(a){return a instanceof q},c.setLanguage=function(a,b){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var c=a,d=a.split("-")[0],e=null;j[c]||(Object.keys(j).forEach(function(a){e||a.split("-")[0]!==d||(e=a)}),c=e||b||"en-US"),F(c)},c.setCulture=function(a,b){var c=a,d=a.split("-")[1],e=null;i[c]||(d&&Object.keys(i).forEach(function(a){e||a.split("-")[1]!==d||(e=a)}),c=e||b||"en-US"),F(c)},c.language=function(a,b){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!a)return k;if(a&&!b){if(!j[a])throw new Error("Unknown language : "+a);F(a)}return!b&&j[a]||E(a,b),c},c.culture=function(a,b){if(!a)return k;if(a&&!b){if(!i[a])throw new Error("Unknown culture : "+a);F(a)}return!b&&i[a]||E(a,b),c},c.languageData=function(a){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!a)return j[k];if(!j[a])throw new Error("Unknown language : "+a);return j[a]},c.cultureData=function(a){if(!a)return i[k];if(!i[a])throw new Error("Unknown culture : "+a);return i[a]},c.culture("en-US",p),c.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),j},c.cultures=function(){return i},c.zeroFormat=function(a){l="string"==typeof a?a:null},c.defaultFormat=function(a){m="string"==typeof a?a:"0.0"},c.defaultCurrencyFormat=function(a){n="string"==typeof a?a:"0$"},c.validate=function(a,b){var d,e,f,g,h,i,j,k;if("string"!=typeof a&&(a+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",a)),a=a.trim(),a=a.replace(/^[+-]?/,""),a.match(/^\d+$/))return!0;if(""===a)return!1;try{j=c.cultureData(b)}catch(a){j=c.cultureData(c.culture())}return f=j.currency.symbol,h=j.abbreviations,d=j.delimiters.decimal,e="."===j.delimiters.thousands?"\\.":j.delimiters.thousands,!(null!==(k=a.match(/^[^\d\.\,]+/))&&(a=a.substr(1),k[0]!==f)||null!==(k=a.match(/[^\d]+$/))&&(a=a.slice(0,-1),k[0]!==h.thousand&&k[0]!==h.million&&k[0]!==h.billion&&k[0]!==h.trillion)||(i=new RegExp(e+"{2}"),a.match(/[^\d.,]/g)||(g=a.split(d),g.length>2||(g.length<2?!g[0].match(/^\d+.*\d$/)||g[0].match(i):""===g[0]?g[0].match(i)||!g[1].match(/^\d+$/):1===g[0].length?!g[0].match(/^\d+$/)||g[0].match(i)||!g[1].match(/^\d+$/):!g[0].match(/^\d+.*\d$/)||g[0].match(i)||!g[1].match(/^\d+$/)))))},c.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),c.loadCulturesInNode()},c.loadCulturesInNode=function(){var b=a("./languages");for(var d in b)d&&c.culture(d,b[d])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),c.fn=q.prototype={clone:function(){return c(this)},format:function(a,b){return v(this,a||m,void 0!==b?b:Math.round)},formatCurrency:function(a,b){return x(this,i[k].currency.symbol,a||n,void 0!==b?b:Math.round)},formatForeignCurrency:function(a,b,c){return y(this,a,b||n,void 0!==c?c:Math.round)},unformat:function(a){if("number"==typeof a)return a;if("string"==typeof a){var b=w(this,a);return isNaN(b)?void 0:b}},binaryByteUnits:function(){return C(this._value,g.binary.suffixes,g.binary.scale).suffix},byteUnits:function(){return C(this._value,g.general.suffixes,g.general.scale).suffix},decimalByteUnits:function(){return C(this._value,g.decimal.suffixes,g.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function c(a,c){return a+b*c}var b=I.call(null,this._value,a);return this._value=[this._value,a].reduce(c,0)/b,this},subtract:function(a){function c(a,c){return a-b*c}var b=I.call(null,this._value,a);return this._value=[a].reduce(c,this._value*b)/b,this},multiply:function(a){function b(a,b){var c=I(a,b),d=a*c;return d*=b*c,d/=c*c}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=I(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(c(this._value).subtract(a).value())}},G()&&c.loadCulturesInNode(),o?b.exports=c:("undefined"==typeof ender&&(this.numbro=c),"function"==typeof define&&define.amd&&define([],function(){return c}))}).call("undefined"==typeof window?this:window)},{languages:1}],pikaday:[function(a,b,c){!function(d,e){"use strict";var f;if("object"==typeof c){try{f=a("moment")}catch(a){}b.exports=e(f)}else"function"==typeof define&&define.amd?define(function(a){try{f=a("moment")}catch(a){}return e(f)}):d.Pikaday=e(d.moment)}(this,function(a){"use strict";var b="function"==typeof a,c=!!window.addEventListener,d=window.document,e=window.setTimeout,f=function(a,b,d,e){c?a.addEventListener(b,d,!!e):a.attachEvent("on"+b,d)},g=function(a,b,d,e){c?a.removeEventListener(b,d,!!e):a.detachEvent("on"+b,d)},h=function(a,b,c){var e;d.createEvent?(e=d.createEvent("HTMLEvents"),e.initEvent(b,!0,!1),e=t(e,c),a.dispatchEvent(e)):d.createEventObject&&(e=d.createEventObject(),e=t(e,c),a.fireEvent("on"+b,e))},i=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},j=function(a,b){return-1!==(" "+a.className+" ").indexOf(" "+b+" ")},k=function(a,b){j(a,b)||(a.className=""===a.className?b:a.className+" "+b)},l=function(a,b){a.className=i((" "+a.className+" ").replace(" "+b+" "," "))},m=function(a){return/Array/.test(Object.prototype.toString.call(a))},n=function(a){return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},o=function(a){var b=a.getDay();return 0===b||6===b},p=function(a){return a%4==0&&a%100!=0||a%400==0},q=function(a,b){return[31,p(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},r=function(a){n(a)&&a.setHours(0,0,0,0)},s=function(a,b){return a.getTime()===b.getTime()},t=function(a,b,c){var d,e;for(d in b)e=void 0!==a[d],e&&"object"==typeof b[d]&&null!==b[d]&&void 0===b[d].nodeName?n(b[d])?c&&(a[d]=new Date(b[d].getTime())):m(b[d])?c&&(a[d]=b[d].slice(0)):a[d]=t({},b[d],c):!c&&e||(a[d]=b[d]);return a},u=function(a){return a.month<0&&(a.year-=Math.ceil(Math.abs(a.month)/12),a.month+=12),a.month>11&&(a.year+=Math.floor(Math.abs(a.month)/12),a.month-=12),a},v={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},w=function(a,b,c){for(b+=a.firstDay;b>=7;)b-=7;return c?a.i18n.weekdaysShort[b]:a.i18n.weekdays[b]},x=function(a){var b=[],c="false";if(a.isEmpty){if(!a.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';b.push("is-outside-current-month")}return a.isDisabled&&b.push("is-disabled"),a.isToday&&b.push("is-today"),a.isSelected&&(b.push("is-selected"),c="true"),a.isInRange&&b.push("is-inrange"),a.isStartRange&&b.push("is-startrange"),a.isEndRange&&b.push("is-endrange"),'<td data-day="'+a.day+'" class="'+b.join(" ")+'" aria-selected="'+c+'"><button class="pika-button pika-day" type="button" data-pika-year="'+a.year+'" data-pika-month="'+a.month+'" data-pika-day="'+a.day+'">'+a.day+"</button></td>"},y=function(a,b,c){var d=new Date(c,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(c,b,a)-d)/864e5+d.getDay()+1)/7)+"</td>"},z=function(a,b){return"<tr>"+(b?a.reverse():a).join("")+"</tr>"},A=function(a){return"<tbody>"+a.join("")+"</tbody>"},B=function(a){var b,c=[];for(a.showWeekNumber&&c.push("<th></th>"),b=0;b<7;b++)c.push('<th scope="col"><abbr title="'+w(a,b)+'">'+w(a,b,!0)+"</abbr></th>");return"<thead><tr>"+(a.isRTL?c.reverse():c).join("")+"</tr></thead>"},C=function(a,b,c,d,e,f){var g,h,i,o,p,j=a._o,k=c===j.minYear,l=c===j.maxYear,n='<div id="'+f+'" class="pika-title" role="heading" aria-live="assertive">',q=!0,r=!0;for(i=[],g=0;g<12;g++)i.push('<option value="'+(c===e?g-b:12+g-b)+'"'+(g===d?' selected="selected"':"")+(k&&g<j.minMonth||l&&g>j.maxMonth?'disabled="disabled"':"")+">"+j.i18n.months[g]+"</option>");for(o='<div class="pika-label">'+j.i18n.months[d]+'<select class="pika-select pika-select-month" tabindex="-1">'+i.join("")+"</select></div>",m(j.yearRange)?(g=j.yearRange[0],h=j.yearRange[1]+1):(g=c-j.yearRange,h=1+c+j.yearRange),i=[];g<h&&g<=j.maxYear;g++)g>=j.minYear&&i.push('<option value="'+g+'"'+(g===c?' selected="selected"':"")+">"+g+"</option>");return p='<div class="pika-label">'+c+j.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+i.join("")+"</select></div>",j.showMonthAfterYear?n+=p+o:n+=o+p,k&&(0===d||j.minMonth>=d)&&(q=!1),l&&(11===d||j.maxMonth<=d)&&(r=!1),0===b&&(n+='<button class="pika-prev'+(q?"":" is-disabled")+'" type="button">'+j.i18n.previousMonth+"</button>"),b===a._o.numberOfMonths-1&&(n+='<button class="pika-next'+(r?"":" is-disabled")+'" type="button">'+j.i18n.nextMonth+"</button>"),n+="</div>"},D=function(a,b,c){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+c+'">'+B(a)+A(b)+"</table>"},E=function(g){var h=this,i=h.config(g);h._onMouseDown=function(a){if(h._v){a=a||window.event;var b=a.target||a.srcElement;if(b)if(j(b,"is-disabled")||(!j(b,"pika-button")||j(b,"is-empty")||j(b.parentNode,"is-disabled")?j(b,"pika-prev")?h.prevMonth():j(b,"pika-next")&&h.nextMonth():(h.setDate(new Date(b.getAttribute("data-pika-year"),b.getAttribute("data-pika-month"),b.getAttribute("data-pika-day"))),i.bound&&e(function(){h.hide(),i.field&&i.field.blur()},100))),j(b,"pika-select"))h._c=!0;else{if(!a.preventDefault)return a.returnValue=!1,!1;a.preventDefault()}}},h._onChange=function(a){a=a||window.event;var b=a.target||a.srcElement;b&&(j(b,"pika-select-month")?h.gotoMonth(b.value):j(b,"pika-select-year")&&h.gotoYear(b.value))},h._onKeyChange=function(a){if(a=a||window.event,h.isVisible())switch(a.keyCode){case 13:case 27:i.field.blur();break;case 37:a.preventDefault(),h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7)}},h._onInputChange=function(c){var d;c.firedBy!==h&&(b?(d=a(i.field.value,i.format,i.formatStrict),d=d&&d.isValid()?d.toDate():null):d=new Date(Date.parse(i.field.value)),n(d)&&h.setDate(d),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var a=d.activeElement;do{if(j(a,"pika-single"))return}while(a=a.parentNode);h._c||(h._b=e(function(){h.hide()},50)),h._c=!1},h._onClick=function(a){a=a||window.event;var b=a.target||a.srcElement,d=b;if(b){!c&&j(b,"pika-select")&&(b.onchange||(b.setAttribute("onchange","return;"),f(b,"change",h._onChange)));do{if(j(d,"pika-single")||d===i.trigger)return}while(d=d.parentNode);h._v&&b!==i.trigger&&d!==i.trigger&&h.hide()}},h.el=d.createElement("div"),h.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),f(h.el,"mousedown",h._onMouseDown,!0),f(h.el,"touchend",h._onMouseDown,!0),f(h.el,"change",h._onChange),f(d,"keydown",h._onKeyChange),i.field&&(i.container?i.container.appendChild(h.el):i.bound?d.body.appendChild(h.el):i.field.parentNode.insertBefore(h.el,i.field.nextSibling),f(i.field,"change",h._onInputChange),i.defaultDate||(b&&i.field.value?i.defaultDate=a(i.field.value,i.format).toDate():i.defaultDate=new Date(Date.parse(i.field.value)),i.setDefaultDate=!0));var k=i.defaultDate;n(k)?i.setDefaultDate?h.setDate(k,!0):h.gotoDate(k):h.gotoDate(new Date),i.bound?(this.hide(),h.el.className+=" is-bound",f(i.trigger,"click",h._onInputClick),f(i.trigger,"focus",h._onInputFocus),f(i.trigger,"blur",h._onInputBlur)):this.show()};return E.prototype={config:function(a){this._o||(this._o=t({},v,!0));var b=t(this._o,a,!0);b.isRTL=!!b.isRTL,b.field=b.field&&b.field.nodeName?b.field:null,b.theme="string"==typeof b.theme&&b.theme?b.theme:null,b.bound=!!(void 0!==b.bound?b.field&&b.bound:b.field),b.trigger=b.trigger&&b.trigger.nodeName?b.trigger:b.field,b.disableWeekends=!!b.disableWeekends,b.disableDayFn="function"==typeof b.disableDayFn?b.disableDayFn:null;var c=parseInt(b.numberOfMonths,10)||1;if(b.numberOfMonths=c>4?4:c,n(b.minDate)||(b.minDate=!1),n(b.maxDate)||(b.maxDate=!1),b.minDate&&b.maxDate&&b.maxDate<b.minDate&&(b.maxDate=b.minDate=!1),b.minDate&&this.setMinDate(b.minDate),b.maxDate&&this.setMaxDate(b.maxDate),m(b.yearRange)){var d=(new Date).getFullYear()-10;b.yearRange[0]=parseInt(b.yearRange[0],10)||d,b.yearRange[1]=parseInt(b.yearRange[1],10)||d}else b.yearRange=Math.abs(parseInt(b.yearRange,10))||v.yearRange,b.yearRange>100&&(b.yearRange=100);return b},toString:function(c){return n(this._d)?b?a(this._d).format(c||this._o.format):this._d.toDateString():""},getMoment:function(){return b?a(this._d):null},setMoment:function(c,d){b&&a.isMoment(c)&&this.setDate(c.toDate(),d)},getDate:function(){return n(this._d)?new Date(this._d.getTime()):new Date},setDate:function(a,b){if(!a)return this._d=null,this._o.field&&(this._o.field.value="",h(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof a&&(a=new Date(Date.parse(a))),n(a)){var c=this._o.minDate,d=this._o.maxDate;n(c)&&a<c?a=c:n(d)&&a>d&&(a=d),this._d=new Date(a.getTime()),r(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),h(this._o.field,"change",{firedBy:this})),b||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(a){var b=!0;if(n(a)){if(this.calendars){var c=new Date(this.calendars[0].year,this.calendars[0].month,1),d=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),e=a.getTime();d.setMonth(d.getMonth()+1),d.setDate(d.getDate()-1),b=e<c.getTime()||d.getTime()<e}b&&(this.calendars=[{month:a.getMonth(),year:a.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(c,d){var g,e=this.getDate(),f=24*parseInt(d)*60*60*1e3;"add"===c?g=new Date(e.valueOf()+f):"subtract"===c&&(g=new Date(e.valueOf()-f)),b&&("add"===c?g=a(e).add(d,"days").toDate():"subtract"===c&&(g=a(e).subtract(d,"days").toDate())),this.setDate(g)},adjustCalendars:function(){this.calendars[0]=u(this.calendars[0]);for(var a=1;a<this._o.numberOfMonths;a++)this.calendars[a]=u({month:this.calendars[0].month+a,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(a){isNaN(a)||(this.calendars[0].month=parseInt(a,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(a){isNaN(a)||(this.calendars[0].year=parseInt(a,10),this.adjustCalendars())},setMinDate:function(a){a instanceof Date?(r(a),this._o.minDate=a,this._o.minYear=a.getFullYear(),this._o.minMonth=a.getMonth()):(this._o.minDate=v.minDate,this._o.minYear=v.minYear,this._o.minMonth=v.minMonth,this._o.startRange=v.startRange),this.draw()},setMaxDate:function(a){a instanceof Date?(r(a),this._o.maxDate=a,this._o.maxYear=a.getFullYear(),this._o.maxMonth=a.getMonth()):(this._o.maxDate=v.maxDate,this._o.maxYear=v.maxYear,this._o.maxMonth=v.maxMonth,this._o.endRange=v.endRange),this.draw()},setStartRange:function(a){this._o.startRange=a},setEndRange:function(a){this._o.endRange=a},draw:function(a){if(this._v||a){var i,b=this._o,c=b.minYear,d=b.maxYear,f=b.minMonth,g=b.maxMonth,h="";this._y<=c&&(this._y=c,!isNaN(f)&&this._m<f&&(this._m=f)),this._y>=d&&(this._y=d,!isNaN(g)&&this._m>g&&(this._m=g)),i="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var j=0;j<b.numberOfMonths;j++)h+='<div class="pika-lendar">'+C(this,j,this.calendars[j].year,this.calendars[j].month,this.calendars[0].year,i)+this.render(this.calendars[j].year,this.calendars[j].month,i)+"</div>";this.el.innerHTML=h,b.bound&&"hidden"!==b.field.type&&e(function(){b.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),b.bound&&b.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var a,b,c,e,f,g,h,i,j,k;if(!this._o.container){if(this.el.style.position="absolute",a=this._o.trigger,b=a,c=this.el.offsetWidth,e=this.el.offsetHeight,f=window.innerWidth||d.documentElement.clientWidth,g=window.innerHeight||d.documentElement.clientHeight,h=window.pageYOffset||d.body.scrollTop||d.documentElement.scrollTop,"function"==typeof a.getBoundingClientRect)k=a.getBoundingClientRect(),i=k.left+window.pageXOffset,j=k.bottom+window.pageYOffset;else for(i=b.offsetLeft,j=b.offsetTop+b.offsetHeight;b=b.offsetParent;)i+=b.offsetLeft,j+=b.offsetTop;(this._o.reposition&&i+c>f||this._o.position.indexOf("right")>-1&&i-c+a.offsetWidth>0)&&(i=i-c+a.offsetWidth),(this._o.reposition&&j+e>g+h||this._o.position.indexOf("top")>-1&&j-e-a.offsetHeight>0)&&(j=j-e-a.offsetHeight),this.el.style.left=i+"px",this.el.style.top=j+"px"}},render:function(a,b,c){var d=this._o,e=new Date,f=q(a,b),g=new Date(a,b,1).getDay(),h=[],i=[];r(e),d.firstDay>0&&(g-=d.firstDay)<0&&(g+=7);for(var j=0===b?11:b-1,k=11===b?0:b+1,l=0===b?a-1:a,m=11===b?a+1:a,p=q(l,j),t=f+g,u=t;u>7;)u-=7;t+=7-u;for(var v=0,w=0;v<t;v++){var A=new Date(a,b,v-g+1),B=!!n(this._d)&&s(A,this._d),C=s(A,e),E=v<g||v>=f+g,F=v-g+1,G=b,H=a,I=d.startRange&&s(d.startRange,A),J=d.endRange&&s(d.endRange,A),K=d.startRange&&d.endRange&&d.startRange<A&&A<d.endRange,L=d.minDate&&A<d.minDate||d.maxDate&&A>d.maxDate||d.disableWeekends&&o(A)||d.disableDayFn&&d.disableDayFn(A);E&&(v<g?(F=p+F,G=j,H=l):(F-=f,G=k,H=m));var M={day:F,month:G,year:H,isSelected:B,isToday:C,isDisabled:L,isEmpty:E,isStartRange:I,isEndRange:J,isInRange:K,showDaysInNextAndPreviousMonths:d.showDaysInNextAndPreviousMonths};i.push(x(M)),7==++w&&(d.showWeekNumber&&i.unshift(y(v-g,b,a)),h.push(z(i,d.isRTL)),i=[],w=0)}return D(d,h,c)},isVisible:function(){return this._v},show:function(){this.isVisible()||(l(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(f(d,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var a=this._v;!1!==a&&(this._o.bound&&g(d,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",k(this.el,"is-hidden"),this._v=!1,void 0!==a&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),g(this.el,"mousedown",this._onMouseDown,!0),g(this.el,"touchend",this._onMouseDown,!0),g(this.el,"change",this._onChange),this._o.field&&(g(this._o.field,"change",this._onInputChange),this._o.bound&&(g(this._o.trigger,"click",this._onInputClick),g(this._o.trigger,"focus",this._onInputFocus),g(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},E})},{moment:"moment"}],zeroclipboard:[function(a,b,c){!function(a,c){"use strict";var O,Q,R,d=a,e=d.document,f=d.navigator,g=d.setTimeout,h=d.clearTimeout,i=d.setInterval,j=d.clearInterval,k=d.getComputedStyle,l=d.encodeURIComponent,m=d.ActiveXObject,n=d.Error,o=d.Number.parseInt||d.parseInt,p=d.Number.parseFloat||d.parseFloat,q=d.Number.isNaN||d.isNaN,r=d.Date.now,s=d.Object.keys,t=d.Object.prototype.hasOwnProperty,u=d.Array.prototype.slice,v=function(){var a=function(a){return a};if("function"==typeof d.wrap&&"function"==typeof d.unwrap)try{var b=e.createElement("div"),c=d.unwrap(b);1===b.nodeType&&c&&1===c.nodeType&&(a=d.unwrap)}catch(a){}return a}(),w=function(a){return u.call(a,0)},x=function(){var a,b,d,e,g,h=w(arguments),i=h[0]||{};for(a=1,b=h.length;a<b;a++)if(null!=(d=h[a]))for(e in d)t.call(d,e)&&(i[e],g=d[e],i!==g&&g!==c&&(i[e]=g));return i},y=function(a){var b,c,d,e;if("object"!=typeof a||null==a||"number"==typeof a.nodeType)b=a;else if("number"==typeof a.length)for(b=[],c=0,d=a.length;c<d;c++)t.call(a,c)&&(b[c]=y(a[c]));else{b={};for(e in a)t.call(a,e)&&(b[e]=y(a[e]))}return b},z=function(a,b){for(var c={},d=0,e=b.length;d<e;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c},A=function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},B=function(a){if(a)for(var b in a)t.call(a,b)&&delete a[b];return a},C=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument))do{if(a===b)return!0;a=a.parentNode}while(a);return!1},D=function(a){var b;return"string"==typeof a&&a&&(b=a.split("#")[0].split("?")[0],b=a.slice(0,a.lastIndexOf("/")+1)),b},E=function(a){var b,c;return"string"==typeof a&&a&&(c=a.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]?b=c[1]:(c=a.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&c[1]&&(b=c[1])),b},F=function(){var a,b;try{throw new n}catch(a){b=a}return b&&(a=b.sourceURL||b.fileName||E(b.stack)),a},G=function(){var a,b,d;if(e.currentScript&&(a=e.currentScript.src))return a;if(b=e.getElementsByTagName("script"),1===b.length)return b[0].src||c;if("readyState"in(b[0]||document.createElement("script")))for(d=b.length;d--;)if("interactive"===b[d].readyState&&(a=b[d].src))return a;return"loading"===e.readyState&&(a=b[b.length-1].src)?a:(a=F())?a:c},H=function(){var a,b,d,f=e.getElementsByTagName("script");for(a=f.length;a--;){if(!(d=f[a].src)){b=null;break}if(d=D(d),null==b)b=d;else if(b!==d){b=null;break}}return b||c},I=function(){return(D(G())||H()||"")+"ZeroClipboard.swf"},J=function(){var a=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!f&&(a.test(f.appVersion||"")||a.test(f.platform||"")||-1!==(f.userAgent||"").indexOf("Windows"))},K=function(){return null==d.opener&&(!!d.top&&d!=d.top||!!d.parent&&d!=d.parent)}(),L="html"===e.documentElement.nodeName,M={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},N="11.0.0",P={},S={},T=null,U=0,V=0,W={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}},X=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],Y=["flash-sandboxed","flash-disabled","flash-outdated","flash-insecure","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],Z=new RegExp("^flash-("+Y.map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),$=new RegExp("^flash-("+Y.filter(function(a){return"flash-disabled"!==a}).map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),_={swfPath:I(),trustedDomains:d.location.host?[d.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},aa=function(a){"object"!=typeof a||!a||"length"in a||s(a).forEach(function(b){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(b))_[b]=a[b];else if(null==M.bridge)if("containerId"===b||"swfObjectId"===b){if(!ra(a[b]))throw new Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");_[b]=a[b]}else _[b]=a[b]});{if("string"!=typeof a||!a)return y(_);if(t.call(_,a))return _[a]}},ba=function(){return Za(),{browser:x(z(f,["userAgent","platform","appName","appVersion"]),{isSupported:ca()}),flash:A(M,["bridge"]),zeroclipboard:{version:_a.version,config:_a.config()}}},ca=function(){return!!(e.addEventListener&&d.Object.keys&&d.Array.prototype.map)},da=function(){return!!(M.sandboxed||M.disabled||M.outdated||M.unavailable||M.degraded||M.deactivated)},ea=function(a,b){var d,e,f,g={};if("string"==typeof a&&a?f=a.toLowerCase().split(/\s+/):"object"!=typeof a||!a||"length"in a||void 0!==b||s(a).forEach(function(b){var c=a[b];"function"==typeof c&&_a.on(b,c)}),f&&f.length&&b){for(d=0,e=f.length;d<e;d++)a=f[d].replace(/^on/,""),g[a]=!0,P[a]||(P[a]=[]),P[a].push(b);if(g.ready&&M.ready&&_a.emit({type:"ready"}),g.error){for(ca()||_a.emit({type:"error",name:"browser-unsupported"}),d=0,e=Y.length;d<e;d++)if(!0===M[Y[d].replace(/^flash-/,"")]){_a.emit({type:"error",name:Y[d]});break}O!==c&&_a.version!==O&&_a.emit({type:"error",name:"version-mismatch",jsVersion:_a.version,swfVersion:O})}}return _a},fa=function(a,b){var c,d,e,f,g;if(0===arguments.length?f=s(P):"string"==typeof a&&a?f=a.toLowerCase().split(/\s+/):"object"!=typeof a||!a||"length"in a||void 0!==b||s(a).forEach(function(b){var c=a[b];"function"==typeof c&&_a.off(b,c)}),f&&f.length)for(c=0,d=f.length;c<d;c++)if(a=f[c].replace(/^on/,""),(g=P[a])&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return _a},ga=function(a){return"string"==typeof a&&a?y(P[a])||null:y(P)},ha=function(a){var b,c,d;if((a=sa(a))&&!za(a))return"ready"===a.type&&!0===M.overdue?_a.emit({type:"error",name:"flash-overdue"}):(b=x({},a),xa.call(this,b),"copy"===a.type&&(d=Ia(S),c=d.data,T=d.formatMap),c)},ia=function(){var a=_.swfPath||"",b=a.slice(0,2),c=a.slice(0,a.indexOf("://")+1);return"\\\\"===b?"file:":"//"===b||""===c?d.location.protocol:c},ja=function(){var a,b,c=M.sandboxed;if(!ca())return M.ready=!1,void _a.emit({type:"error",name:"browser-unsupported"});Za(),"boolean"!=typeof M.ready&&(M.ready=!1),M.sandboxed!==c&&!0===M.sandboxed?(M.ready=!1,_a.emit({type:"error",name:"flash-sandboxed"})):_a.isFlashUnusable()||null!==M.bridge||(b=ia(),b&&b!==d.location.protocol?_a.emit({type:"error",name:"flash-insecure"}):(a=_.flashLoadTimeout,"number"==typeof a&&a>=0&&(U=g(function(){"boolean"!=typeof M.deactivated&&(M.deactivated=!0),!0===M.deactivated&&_a.emit({type:"error",name:"flash-deactivated"})},a)),M.overdue=!1,Ga()))},ka=function(){_a.clearData(),_a.blur(),_a.emit("destroy"),Ha(),_a.off()},la=function(a,b){var c;if("object"==typeof a&&a&&void 0===b)c=a,_a.clearData();else{if("string"!=typeof a||!a)return;c={},c[a]=b}for(var d in c)"string"==typeof d&&d&&t.call(c,d)&&"string"==typeof c[d]&&c[d]&&(S[d]=Ya(c[d]))},ma=function(a){void 0===a?(B(S),T=null):"string"==typeof a&&t.call(S,a)&&delete S[a]},na=function(a){return void 0===a?y(S):"string"==typeof a&&t.call(S,a)?S[a]:void 0},oa=function(a){if(a&&1===a.nodeType){Q&&(Qa(Q,_.activeClass),Q!==a&&Qa(Q,_.hoverClass)),Q=a,Pa(a,_.hoverClass);var b=a.getAttribute("title")||_.title;if("string"==typeof b&&b){var c=Ea(M.bridge);c&&c.setAttribute("title",b)}var d=!0===_.forceHandCursor||"pointer"===Ra(a,"cursor");Wa(d),Va()}},pa=function(){var a=Ea(M.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px"),Q&&(Qa(Q,_.hoverClass),Qa(Q,_.activeClass),Q=null)},qa=function(){return Q||null},ra=function(a){return"string"==typeof a&&a&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(a)},sa=function(a){var b;if("string"==typeof a&&a?(b=a,a={}):"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(b=a.type),b){b=b.toLowerCase(),!a.target&&(/^(copy|aftercopy|_click)$/.test(b)||"error"===b&&"clipboard-error"===a.name)&&(a.target=R),x(a,{type:b,target:a.target||Q||null,relatedTarget:a.relatedTarget||null,currentTarget:M&&M.bridge||null,timeStamp:a.timeStamp||r()||null});var c=W[a.type];return"error"===a.type&&a.name&&c&&(c=c[a.name]),c&&(a.message=c),"ready"===a.type&&x(a,{target:null,version:M.version}),"error"===a.type&&(Z.test(a.name)&&x(a,{target:null,minimumVersion:N}),$.test(a.name)&&x(a,{version:M.version}),"flash-insecure"===a.name&&x(a,{pageProtocol:d.location.protocol,swfProtocol:ia()})),"copy"===a.type&&(a.clipboardData={setData:_a.setData,clearData:_a.clearData}),"aftercopy"===a.type&&(a=Ja(a,T)),a.target&&!a.relatedTarget&&(a.relatedTarget=ta(a.target)),ua(a)}},ta=function(a){var b=a&&a.getAttribute&&a.getAttribute("data-clipboard-target");return b?e.getElementById(b):null},ua=function(a){if(a&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)){var b=a.target,f="_mouseover"===a.type&&a.relatedTarget?a.relatedTarget:c,g="_mouseout"===a.type&&a.relatedTarget?a.relatedTarget:c,h=Sa(b),i=d.screenLeft||d.screenX||0,j=d.screenTop||d.screenY||0,k=e.body.scrollLeft+e.documentElement.scrollLeft,l=e.body.scrollTop+e.documentElement.scrollTop,m=h.left+("number"==typeof a._stageX?a._stageX:0),n=h.top+("number"==typeof a._stageY?a._stageY:0),o=m-k,p=n-l,q=i+o,r=j+p,s="number"==typeof a.movementX?a.movementX:0,t="number"==typeof a.movementY?a.movementY:0;delete a._stageX,delete a._stageY,x(a,{srcElement:b,fromElement:f,toElement:g,screenX:q,screenY:r,pageX:m,pageY:n,clientX:o,clientY:p,x:o,y:p,movementX:s,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return a},va=function(a){return!/^(?:(?:before)?copy|destroy)$/.test(a&&"string"==typeof a.type&&a.type||"")},wa=function(a,b,c,d){d?g(function(){a.apply(b,c)},0):a.apply(b,c)},xa=function(a){if("object"==typeof a&&a&&a.type){var b=va(a),c=P["*"]||[],e=P[a.type]||[],f=c.concat(e);if(f&&f.length){var g,h,i,j,k,l=this;for(g=0,h=f.length;g<h;g++)i=f[g],j=l,"string"==typeof i&&"function"==typeof d[i]&&(i=d[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(j=i,i=i.handleEvent),"function"==typeof i&&(k=x({},a),wa(i,j,[k],b))}return this}},ya=function(a){var b=null;return(!1===K||a&&"error"===a.type&&a.name&&-1!==X.indexOf(a.name))&&(b=!1),b},za=function(a){var b=a.target||Q||null,c="swf"===a._source;switch(delete a._source,a.type){case"error":var d="flash-sandboxed"===a.name||ya(a);"boolean"==typeof d&&(M.sandboxed=d),"browser-unsupported"===a.name?x(M,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):-1!==Y.indexOf(a.name)?x(M,{disabled:"flash-disabled"===a.name,outdated:"flash-outdated"===a.name,insecure:"flash-insecure"===a.name,unavailable:"flash-unavailable"===a.name,degraded:"flash-degraded"===a.name,deactivated:"flash-deactivated"===a.name,overdue:"flash-overdue"===a.name,ready:!1}):"version-mismatch"===a.name&&(O=a.swfVersion,x(M,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Ua();break;case"ready":O=a.swfVersion;var e=!0===M.deactivated;x(M,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:e,ready:!e}),Ua();break;case"beforecopy":R=b;break;case"copy":var f,g,h=a.relatedTarget;!S["text/html"]&&!S["text/plain"]&&h&&(g=h.value||h.outerHTML||h.innerHTML)&&(f=h.value||h.textContent||h.innerText)?(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",f),g!==f&&a.clipboardData.setData("text/html",g)):!S["text/plain"]&&a.target&&(f=a.target.getAttribute("data-clipboard-text"))&&(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",f));break;case"aftercopy":Aa(a),_a.clearData(),b&&b!==Oa()&&b.focus&&b.focus();break;case"_mouseover":_a.focus(b),!0===_.bubbleEvents&&c&&(b&&b!==a.relatedTarget&&!C(a.relatedTarget,b)&&Ba(x({},a,{type:"mouseenter",bubbles:!1,cancelable:!1})),Ba(x({},a,{type:"mouseover"})));break;case"_mouseout":_a.blur(),!0===_.bubbleEvents&&c&&(b&&b!==a.relatedTarget&&!C(a.relatedTarget,b)&&Ba(x({},a,{type:"mouseleave",bubbles:!1,cancelable:!1})),Ba(x({},a,{type:"mouseout"})));break;case"_mousedown":Pa(b,_.activeClass),!0===_.bubbleEvents&&c&&Ba(x({},a,{type:a.type.slice(1)}));break;case"_mouseup":Qa(b,_.activeClass),!0===_.bubbleEvents&&c&&Ba(x({},a,{type:a.type.slice(1)}));break;case"_click":R=null,!0===_.bubbleEvents&&c&&Ba(x({},a,{type:a.type.slice(1)}));break;case"_mousemove":!0===_.bubbleEvents&&c&&Ba(x({},a,{type:a.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type))return!0},Aa=function(a){if(a.errors&&a.errors.length>0){var b=y(a);x(b,{type:"error",name:"clipboard-error"}),delete b.success,g(function(){_a.emit(b)},0)}},Ba=function(a){if(a&&"string"==typeof a.type&&a){var b,c=a.target||null,f=c&&c.ownerDocument||e,g={view:f.defaultView||d,canBubble:!0,cancelable:!0,detail:"click"===a.type?1:0,button:"number"==typeof a.which?a.which-1:"number"==typeof a.button?a.button:f.createEvent?0:1},h=x(g,a);c&&f.createEvent&&c.dispatchEvent&&(h=[h.type,h.canBubble,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget],b=f.createEvent("MouseEvents"),b.initMouseEvent&&(b.initMouseEvent.apply(b,h),b._source="js",c.dispatchEvent(b)))}},Ca=function(){var a=_.flashLoadTimeout;if("number"==typeof a&&a>=0){var b=Math.min(1e3,a/10),c=_.swfObjectId+"_fallbackContent";V=i(function(){var a=e.getElementById(c);Ta(a)&&(Ua(),M.deactivated=null,_a.emit({type:"error",name:"swf-not-found"}))},b)}},Da=function(){var a=e.createElement("div");return a.id=_.containerId,a.className=_.containerClass,a.style.position="absolute",a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px",a.style.zIndex=""+Xa(_.zIndex),a},Ea=function(a){for(var b=a&&a.parentNode;b&&"OBJECT"===b.nodeName&&b.parentNode;)b=b.parentNode;return b||null},Fa=function(a){return"string"==typeof a&&a?a.replace(/["&'<>]/g,function(a){switch(a){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"<":return"&lt;";case">":return"&gt;";default:return a}}):a},Ga=function(){var a,b=M.bridge,c=Ea(b);if(!b){var f=Na(d.location.host,_),g="never"===f?"none":"all",h=La(x({jsVersion:_a.version},_)),i=_.swfPath+Ka(_.swfPath,_);L&&(i=Fa(i)),c=Da();var j=e.createElement("div");c.appendChild(j),e.body.appendChild(c);var k=e.createElement("div"),l="activex"===M.pluginType;k.innerHTML='<object id="'+_.swfObjectId+'" name="'+_.swfObjectId+'" width="100%" height="100%" '+(l?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+i+'"')+">"+(l?'<param name="movie" value="'+i+'"/>':"")+'<param name="allowScriptAccess" value="'+f+'"/><param name="allowNetworking" value="'+g+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+h+'"/><div id="'+_.swfObjectId+'_fallbackContent">&nbsp;</div></object>',b=k.firstChild,k=null,v(b).ZeroClipboard=_a,c.replaceChild(b,j),Ca()}return b||(b=e[_.swfObjectId],b&&(a=b.length)&&(b=b[a-1]),!b&&c&&(b=c.firstChild)),M.bridge=b||null,b},Ha=function(){var a=M.bridge;if(a){var b=Ea(a);b&&("activex"===M.pluginType&&"readyState"in a?(a.style.display="none",function c(){if(4===a.readyState){for(var d in a)"function"==typeof a[d]&&(a[d]=null);a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b)}else g(c,10)}()):(a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b))),Ua(),M.ready=null,M.bridge=null,M.deactivated=null,M.insecure=null,O=c}},Ia=function(a){var b={},c={};if("object"==typeof a&&a){for(var d in a)if(d&&t.call(a,d)&&"string"==typeof a[d]&&a[d])switch(d.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":b.text=a[d],c.text=d;break;case"text/html":case"html":case"air:html":case"flash:html":b.html=a[d],c.html=d;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":b.rtf=a[d],c.rtf=d}return{data:b,formatMap:c}}},Ja=function(a,b){if("object"!=typeof a||!a||"object"!=typeof b||!b)return a;var c={};for(var d in a)if(t.call(a,d))if("errors"===d){c[d]=a[d]?a[d].slice():[];for(var e=0,f=c[d].length;e<f;e++)c[d][e].format=b[c[d][e].format]}else if("success"!==d&&"data"!==d)c[d]=a[d];else{c[d]={};var g=a[d];for(var h in g)h&&t.call(g,h)&&t.call(b,h)&&(c[d][b[h]]=g[h])}return c},Ka=function(a,b){return null==b||b&&!0===b.cacheBust?(-1===a.indexOf("?")?"?":"&")+"noCache="+r():""},La=function(a){var b,c,e,f,g="",h=[];if(a.trustedDomains&&("string"==typeof a.trustedDomains?f=[a.trustedDomains]:"object"==typeof a.trustedDomains&&"length"in a.trustedDomains&&(f=a.trustedDomains)),f&&f.length)for(b=0,c=f.length;b<c;b++)if(t.call(f,b)&&f[b]&&"string"==typeof f[b]){if(!(e=Ma(f[b])))continue;if("*"===e){h.length=0,h.push(e);break}h.push.apply(h,[e,"//"+e,d.location.protocol+"//"+e])}return h.length&&(g+="trustedOrigins="+l(h.join(","))),!0===a.forceEnhancedClipboard&&(g+=(g?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof a.swfObjectId&&a.swfObjectId&&(g+=(g?"&":"")+"swfObjectId="+l(a.swfObjectId)),"string"==typeof a.jsVersion&&a.jsVersion&&(g+=(g?"&":"")+"jsVersion="+l(a.jsVersion)),g},Ma=function(a){if(null==a||""===a)return null;if(""===(a=a.replace(/^\s+|\s+$/g,"")))return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var c=a.indexOf("/");return a=-1===c?a:-1===b||0===c?null:a.slice(0,c),a&&".swf"===a.slice(-4).toLowerCase()?null:a||null},Na=function(){var a=function(a){var b,c,d,e=[];if("string"==typeof a&&(a=[a]),"object"!=typeof a||!a||"number"!=typeof a.length)return e;for(b=0,c=a.length;b<c;b++)if(t.call(a,b)&&(d=Ma(a[b]))){if("*"===d){e.length=0,e.push("*");break}-1===e.indexOf(d)&&e.push(d)}return e};return function(b,c){var d=Ma(c.swfPath);null===d&&(d=b);var e=a(c.trustedDomains),f=e.length;if(f>0){if(1===f&&"*"===e[0])return"always";if(-1!==e.indexOf(b))return 1===f&&b===d?"sameDomain":"always"}return"never"}}(),Oa=function(){try{return e.activeElement}catch(a){return null}},Pa=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0){for(e=(" "+(a.className||"")+" ").replace(/[\t\r\n\f]/g," "),c=0,d=f.length;c<d;c++)-1===e.indexOf(" "+f[c]+" ")&&(e+=f[c]+" ");e=e.replace(/^\s+|\s+$/g,""),e!==a.className&&(a.className=e)}return a},Qa=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0&&a.className){for(e=(" "+a.className+" ").replace(/[\t\r\n\f]/g," "),c=0,d=f.length;c<d;c++)e=e.replace(" "+f[c]+" "," ");e=e.replace(/^\s+|\s+$/g,""),e!==a.className&&(a.className=e)}return a},Ra=function(a,b){var c=k(a,null).getPropertyValue(b);return"cursor"!==b||c&&"auto"!==c||"A"!==a.nodeName?c:"pointer"},Sa=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){var c=a.getBoundingClientRect(),f=d.pageXOffset,g=d.pageYOffset,h=e.documentElement.clientLeft||0,i=e.documentElement.clientTop||0,j=0,k=0;if("relative"===Ra(e.body,"position")){var l=e.body.getBoundingClientRect(),m=e.documentElement.getBoundingClientRect();j=l.left-m.left||0,k=l.top-m.top||0}b.left=c.left+f-h-j,b.top=c.top+g-i-k,b.width="width"in c?c.width:c.right-c.left,b.height="height"in c?c.height:c.bottom-c.top}return b},Ta=function(a){if(!a)return!1;var b=k(a,null);if(!b)return!1;var c=p(b.height)>0,d=p(b.width)>0,e=p(b.top)>=0,f=p(b.left)>=0,g=c&&d&&e&&f,h=g?null:Sa(a);return"none"!==b.display&&"collapse"!==b.visibility&&(g||!!h&&(c||h.height>0)&&(d||h.width>0)&&(e||h.top>=0)&&(f||h.left>=0))},Ua=function(){h(U),U=0,j(V),V=0},Va=function(){var a;if(Q&&(a=Ea(M.bridge))){var b=Sa(Q);x(a.style,{width:b.width+"px",height:b.height+"px",top:b.top+"px",left:b.left+"px",zIndex:""+Xa(_.zIndex)})}},Wa=function(a){!0===M.ready&&(M.bridge&&"function"==typeof M.bridge.setHandCursor?M.bridge.setHandCursor(a):M.ready=!1)},Xa=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;return"number"!=typeof a||q(a)?"string"==typeof a&&(b=Xa(o(a,10))):b=a,"number"==typeof b?b:"auto"},Ya=function(a){var b=/(\r\n|\r|\n)/g;return"string"==typeof a&&!0===_.fixLineEndings&&(J()?/((^|[^\r])\n|\r([^\n]|$))/.test(a)&&(a=a.replace(b,"\r\n")):/\r/.test(a)&&(a=a.replace(b,"\n"))),a},Za=function(b){var c,d,e,f=M.sandboxed,g=null;if(b=!0===b,!1===K)g=!1;else{try{d=a.frameElement||null}catch(a){e={name:a.name,message:a.message}}if(d&&1===d.nodeType&&"IFRAME"===d.nodeName)try{g=d.hasAttribute("sandbox")}catch(a){g=null}else{try{c=document.domain||null}catch(a){c=null}(null===c||e&&"SecurityError"===e.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase()))&&(g=!0)}}return M.sandboxed=g,f===g||b||$a(m),g},$a=function(a){function j(a){var b=a.match(/[\d]+/g);return b.length=3,b.join(".")}function k(a){return!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||"chrome.plugin"===a.slice(-13))}function l(a){a&&(e=!0,a.version&&(i=j(a.version)),!i&&a.description&&(i=j(a.description)),a.filename&&(h=k(a.filename)))}var b,c,d,e=!1,g=!1,h=!1,i="";if(f.plugins&&f.plugins.length)b=f.plugins["Shockwave Flash"],l(b),f.plugins["Shockwave Flash 2.0"]&&(e=!0,i="2.0.0.11");else if(f.mimeTypes&&f.mimeTypes.length)d=f.mimeTypes["application/x-shockwave-flash"],b=d&&d.enabledPlugin,l(b);else if(void 0!==a){g=!0;try{c=new a("ShockwaveFlash.ShockwaveFlash.7"),e=!0,i=j(c.GetVariable("$version"))}catch(b){try{c=new a("ShockwaveFlash.ShockwaveFlash.6"),e=!0,i="6.0.21"}catch(b){try{c=new a("ShockwaveFlash.ShockwaveFlash"),e=!0,i=j(c.GetVariable("$version"))}catch(a){g=!1}}}}M.disabled=!0!==e,M.outdated=i&&p(i)<p(N),M.version=i||"0.0.0",M.pluginType=h?"pepper":g?"activex":e?"netscape":"unknown"};$a(m),Za(!0);var _a=function(){if(!(this instanceof _a))return new _a;"function"==typeof _a._createClient&&_a._createClient.apply(this,w(arguments))};_a.version="2.3.0",_a.config=function(){return aa.apply(this,w(arguments))},_a.state=function(){return ba.apply(this,w(arguments))},_a.isFlashUnusable=function(){return da.apply(this,w(arguments))},_a.on=function(){return ea.apply(this,w(arguments))},_a.off=function(){return fa.apply(this,w(arguments))},_a.handlers=function(){return ga.apply(this,w(arguments))},_a.emit=function(){return ha.apply(this,w(arguments))},_a.create=function(){return ja.apply(this,w(arguments))},_a.destroy=function(){return ka.apply(this,w(arguments))},_a.setData=function(){return la.apply(this,w(arguments))},_a.clearData=function(){return ma.apply(this,w(arguments))},_a.getData=function(){return na.apply(this,w(arguments))},_a.focus=_a.activate=function(){return oa.apply(this,w(arguments))},_a.blur=_a.deactivate=function(){return pa.apply(this,w(arguments))},_a.activeElement=function(){return qa.apply(this,w(arguments))};var ab=0,bb={},cb=0,db={},eb={};x(_,{autoActivate:!0});var fb=function(a){var b,c=this;c.id=""+ab++,b={instance:c,elements:[],handlers:{},coreWildcardHandler:function(a){return c.emit(a)}},bb[c.id]=b,a&&c.clip(a),_a.on("*",b.coreWildcardHandler),_a.on("destroy",function(){c.destroy()}),_a.create()},gb=function(a,b){var d,e,f,g={},h=this,i=bb[h.id],j=i&&i.handlers;if(!i)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof a&&a?f=a.toLowerCase().split(/\s+/):"object"!=typeof a||!a||"length"in a||void 0!==b||s(a).forEach(function(b){var c=a[b];"function"==typeof c&&h.on(b,c)}),f&&f.length&&b){for(d=0,e=f.length;d<e;d++)a=f[d].replace(/^on/,""),g[a]=!0,j[a]||(j[a]=[]),j[a].push(b);if(g.ready&&M.ready&&this.emit({type:"ready",client:this}),g.error){for(d=0,e=Y.length;d<e;d++)if(M[Y[d].replace(/^flash-/,"")]){this.emit({type:"error",name:Y[d],client:this});break}O!==c&&_a.version!==O&&this.emit({type:"error",name:"version-mismatch",jsVersion:_a.version,swfVersion:O})}}return h},hb=function(a,b){var c,d,e,f,g,h=this,i=bb[h.id],j=i&&i.handlers;if(!j)return h;if(0===arguments.length?f=s(j):"string"==typeof a&&a?f=a.split(/\s+/):"object"!=typeof a||!a||"length"in a||void 0!==b||s(a).forEach(function(b){var c=a[b];"function"==typeof c&&h.off(b,c)}),f&&f.length)for(c=0,d=f.length;c<d;c++)if(a=f[c].toLowerCase().replace(/^on/,""),(g=j[a])&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return h},ib=function(a){var b=null,c=bb[this.id]&&bb[this.id].handlers;return c&&(b="string"==typeof a&&a?c[a]?c[a].slice(0):[]:y(c)),b},jb=function(a){var b,c=this;return ob.call(c,a)&&("object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(a=x({},a)),b=x({},sa(a),{client:c}),pb.call(c,b)),c},kb=function(a){if(!bb[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");a=qb(a);for(var b=0;b<a.length;b++)if(t.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===db[a[b].zcClippingId].indexOf(this.id)&&db[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+cb++,db[a[b].zcClippingId]=[this.id],!0===_.autoActivate&&rb(a[b]));var c=bb[this.id]&&bb[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},lb=function(a){var b=bb[this.id];if(!b)return this;var d,c=b.elements;a=void 0===a?c.slice(0):qb(a);for(var e=a.length;e--;)if(t.call(a,e)&&a[e]&&1===a[e].nodeType){for(d=0;-1!==(d=c.indexOf(a[e],d));)c.splice(d,1);var f=db[a[e].zcClippingId];if(f){for(d=0;-1!==(d=f.indexOf(this.id,d));)f.splice(d,1);0===f.length&&(!0===_.autoActivate&&sb(a[e]),delete a[e].zcClippingId)}}return this},mb=function(){var a=bb[this.id];return a&&a.elements?a.elements.slice(0):[]},nb=function(){var a=bb[this.id];a&&(this.unclip(),this.off(),_a.off("*",a.coreWildcardHandler),delete bb[this.id])},ob=function(a){if(!a||!a.type)return!1;if(a.client&&a.client!==this)return!1;var b=bb[this.id],c=b&&b.elements,d=!!c&&c.length>0,e=!a.target||d&&-1!==c.indexOf(a.target),f=a.relatedTarget&&d&&-1!==c.indexOf(a.relatedTarget),g=a.client&&a.client===this;return!(!b||!(e||f||g))},pb=function(a){var b=bb[this.id];if("object"==typeof a&&a&&a.type&&b){var c=va(a),e=b&&b.handlers["*"]||[],f=b&&b.handlers[a.type]||[],g=e.concat(f);if(g&&g.length){var h,i,j,k,l,m=this;for(h=0,i=g.length;h<i;h++)j=g[h],k=m,"string"==typeof j&&"function"==typeof d[j]&&(j=d[j]),"object"==typeof j&&j&&"function"==typeof j.handleEvent&&(k=j,j=j.handleEvent),"function"==typeof j&&(l=x({},a),wa(j,k,[l],c))}}},qb=function(a){return"string"==typeof a&&(a=[]),"number"!=typeof a.length?[a]:a},rb=function(a){if(a&&1===a.nodeType){var b=function(a){(a||(a=d.event))&&("js"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source)},c=function(c){(c||(c=d.event))&&(b(c),_a.focus(a))};a.addEventListener("mouseover",c,!1),a.addEventListener("mouseout",b,!1),a.addEventListener("mouseenter",b,!1),a.addEventListener("mouseleave",b,!1),a.addEventListener("mousemove",b,!1),eb[a.zcClippingId]={mouseover:c,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}},sb=function(a){if(a&&1===a.nodeType){var b=eb[a.zcClippingId];if("object"==typeof b&&b){for(var c,d,e=["move","leave","enter","out","over"],f=0,g=e.length;f<g;f++)c="mouse"+e[f],"function"==typeof(d=b[c])&&a.removeEventListener(c,d,!1);delete eb[a.zcClippingId]}}};_a._createClient=function(){fb.apply(this,w(arguments))},_a.prototype.on=function(){return gb.apply(this,w(arguments))},_a.prototype.off=function(){return hb.apply(this,w(arguments))},_a.prototype.handlers=function(){return ib.apply(this,w(arguments))},_a.prototype.emit=function(){return jb.apply(this,w(arguments))},_a.prototype.clip=function(){return kb.apply(this,w(arguments))},_a.prototype.unclip=function(){return lb.apply(this,w(arguments))},_a.prototype.elements=function(){return mb.apply(this,w(arguments))},_a.prototype.destroy=function(){return nb.apply(this,w(arguments))},_a.prototype.setText=function(a){if(!bb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return _a.setData("text/plain",a),this},_a.prototype.setHtml=function(a){if(!bb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return _a.setData("text/html",a),this},_a.prototype.setRichText=function(a){if(!bb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return _a.setData("application/rtf",a),this},_a.prototype.setData=function(){if(!bb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return _a.setData.apply(this,w(arguments)),this},_a.prototype.clearData=function(){if(!bb[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return _a.clearData.apply(this,w(arguments)),this},_a.prototype.getData=function(){if(!bb[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return _a.getData.apply(this,w(arguments))},"function"==typeof define&&define.amd?define(function(){return _a}):"object"==typeof b&&b&&"object"==typeof b.exports&&b.exports?b.exports=_a:a.ZeroClipboard=_a}(function(){return this||window}())},{}]},{},[141,64,66,67,65,68,111,112,113,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,100,101,102,103,104,106,107,108,109,110,114,115,116,117,135,136,137,138,120,121,122,123,124,125,32,36,33,34,41,35,37,38,39,40,142,143,144,145,146,217,218,211,212,213,147,148,149,150,151,152,154,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,198,199,200,201,202,203,204,205,206,207,208,209,210,214,215,216,219,220,222,223,224,225,226])(141)});